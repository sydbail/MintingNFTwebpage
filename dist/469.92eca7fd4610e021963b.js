"use strict";(self.webpackChunkexample_browser_angular=self.webpackChunkexample_browser_angular||[]).push([[469],{10469:(he,U,o)=>{o.r(U),o.d(U,{default:()=>le});var C=o(8239),p=o(28616),u=o(48415),Z=o(58243),B=o(19663),H=o(13299),I=o(53549);const T=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}put(e,t){return(0,C.Z)(function*(){})()}get(e){return Promise.resolve(this)}eachChildSeries(){return(0,p.Z)(function*(){})()}flush(e){return(0,p.Z)(function*(){})()}};var Y=o(3539);const F=class extends T{constructor(e,t){super(e,t),this._children={}}put(e,t){var n=this;return(0,C.Z)(function*(){n.cid=void 0,n.size=void 0,n._children[e]=t})()}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}eachChildSeries(){var e=this;return(0,p.Z)(function*(){const t=Object.keys(e._children);for(let n=0;n<t.length;n++){const l=t[n];yield{key:l,child:e._children[l]}}})()}flush(e){var t=this;return(0,p.Z)(function*(){const n=Object.keys(t._children),l=[];for(let c=0;c<n.length;c++){let y=t._children[n[c]];if(y instanceof T){var s,i=!0,a=!1;try{for(var f,h,d=(0,Z.Z)(y.flush(e));i=(f=yield(0,u.Z)(d.next())).done,h=yield(0,u.Z)(f.value),!i;i=!0)y=h,yield y}catch(b){a=!0,s=b}finally{try{!i&&null!=d.return&&(yield(0,u.Z)(d.return()))}finally{if(a)throw s}}}null!=y.size&&y.cid&&l.push({Name:n[c],Tsize:y.size,Hash:y.cid})}const g=new I.UnixFS({type:"directory",mtime:t.mtime,mode:t.mode}),S={Data:g.marshal(),Links:l},v=(0,H.encode)((0,H.prepare)(S)),z=yield(0,u.Z)((0,Y.Z)(v,e,t.options)),k=v.length+S.Links.reduce((c,y)=>c+(y.Tsize??0),0);t.cid=z,t.size=k,yield{cid:z,unixfs:g,path:t.path,size:k}})()}};var $=o(82103);const _=class extends T{constructor(e,t){super(e,t),this._bucket=(0,$.createHAMT)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}put(e,t){var n=this;return(0,C.Z)(function*(){yield n._bucket.put(e,t)})()}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}eachChildSeries(){var e=this;return(0,p.Z)(function*(){var l,t=!0,n=!1;try{for(var a,s,i=(0,Z.Z)(e._bucket.eachLeafSeries());t=(a=yield(0,u.Z)(i.next())).done,s=yield(0,u.Z)(a.value),!t;t=!0){const{key:d,value:f}=s;yield{key:d,child:f}}}catch(d){n=!0,l=d}finally{try{!t&&null!=i.return&&(yield(0,u.Z)(i.return()))}finally{if(n)throw l}}})()}flush(e){var t=this;return(0,p.Z)(function*(){var i,n=!0,l=!1;try{for(var s,d,a=(0,Z.Z)(M(t._bucket,e,t,t.options));n=(s=yield(0,u.Z)(a.next())).done,d=yield(0,u.Z)(s.value),!n;n=!0)yield{...d,path:t.path}}catch(f){l=!0,i=f}finally{try{!n&&null!=a.return&&(yield(0,u.Z)(a.return()))}finally{if(l)throw i}}})()}};function M(r,e,t,n){return P.apply(this,arguments)}function P(){return(P=(0,p.Z)(function*(r,e,t,n){const l=r._children,i=[];let a=0;for(let K=0;K<l.length;K++){const w=l.get(K);if(!w)continue;const O=K.toString(16).toUpperCase().padStart(2,"0");if(w instanceof $.Bucket){let m;var f,s=!0,d=!1;try{for(var g,S,h=(0,Z.Z)(yield(0,u.Z)(M(w,e,null,n)));s=(g=yield(0,u.Z)(h.next())).done,S=yield(0,u.Z)(g.value),!s;s=!0)m=S}catch(x){d=!0,f=x}finally{try{!s&&null!=h.return&&(yield(0,u.Z)(h.return()))}finally{if(d)throw f}}if(!m)throw new Error("Could not flush sharded directory, no subshard found");i.push({Name:O,Tsize:m.size,Hash:m.cid}),a+=m.size}else if("function"==typeof w.value.flush){const m=w.value;let x;var k,v=!0,z=!1;try{for(var y,b,c=(0,Z.Z)(m.flush(e));v=(y=yield(0,u.Z)(c.next())).done,b=yield(0,u.Z)(y.value),!v;v=!0)x=b,yield x}catch(X){z=!0,k=X}finally{try{!v&&null!=c.return&&(yield(0,u.Z)(c.return()))}finally{if(z)throw k}}i.push({Name:O+w.key,Tsize:x.size,Hash:x.cid}),a+=x.size}else{const m=w.value;if(!m.cid)continue;const A=m.size;i.push({Name:O+w.key,Tsize:A,Hash:m.cid}),a+=A}}const ue=Uint8Array.from(l.bitField().reverse()),Q=new I.UnixFS({type:"hamt-sharded-directory",data:ue,fanout:r.tableSize(),hashType:n.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),se={Data:Q.marshal(),Links:i},V=(0,H.encode)((0,H.prepare)(se)),ae=yield(0,u.Z)((0,Y.Z)(V,e,n)),de=V.length+a;yield{cid:ae,unixfs:Q,size:de}})).apply(this,arguments)}function W(r,e,t,n){return D.apply(this,arguments)}function D(){return(D=(0,C.Z)(function*(r,e,t,n){let l=e;e instanceof F&&e.directChildrenCount()>=t&&(l=yield ee(e,n));const i=l.parent;if(i){if(l!==e){if(r&&(r.parent=l),!l.parentKey)throw new Error("No parent key found");yield i.put(l.parentKey,l)}return W(l,i,t,n)}return l})).apply(this,arguments)}function ee(r,e){return j.apply(this,arguments)}function j(){return(j=(0,C.Z)(function*(r,e){const t=new _({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);var i,n=!0,l=!1;try{for(var s,d,a=(0,Z.Z)(r.eachChildSeries());n=(s=yield a.next()).done,d=yield s.value,!n;n=!0){const{key:f,child:h}=d;yield t.put(f,h)}}catch(f){l=!0,i=f}finally{try{!n&&null!=a.return&&(yield a.return())}finally{if(l)throw i}}return t})).apply(this,arguments)}const te=W,ne=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);function re(r,e,t){return E.apply(this,arguments)}function E(){return(E=(0,C.Z)(function*(r,e,t){const n=ne(r.path||""),l=n.length-1;let i=e,a="";for(let s=0;s<n.length;s++){const d=n[s];a+=`${a?"/":""}${d}`;const f=s===l;if(i.dirty=!0,i.cid=void 0,i.size=void 0,f)yield i.put(d,r),e=yield te(null,i,t.shardSplitThreshold,t);else{let h=yield i.get(d);(!h||!(h instanceof T))&&(h=new F({root:!1,dir:!0,parent:i,parentKey:d,path:a,dirty:!0,flat:!0,mtime:h&&h.unixfs&&h.unixfs.mtime,mode:h&&h.unixfs&&h.unixfs.mode},t)),yield i.put(d,h),i=h}}return e})).apply(this,arguments)}function J(r,e){return G.apply(this,arguments)}function G(){return(G=(0,p.Z)(function*(r,e){r instanceof T?yield*(0,B.Z)((0,Z.Z)(r.flush(e)),u.Z):r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r)})).apply(this,arguments)}function L(){return(L=(0,p.Z)(function*(r,e,t){let n=new F({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);var a,l=!0,i=!1;try{for(var d,f,s=(0,Z.Z)(r);l=(d=yield(0,u.Z)(s.next())).done,f=yield(0,u.Z)(d.value),!l;l=!0){const c=f;!c||(n=yield(0,u.Z)(re(c,n,t)),(!c.unixfs||!c.unixfs.isDirectory())&&(yield c))}}catch(c){i=!0,a=c}finally{try{!l&&null!=s.return&&(yield(0,u.Z)(s.return()))}finally{if(i)throw a}}if(t.wrapWithDirectory)yield*(0,B.Z)((0,Z.Z)(J(n,e)),u.Z);else{var S,h=!0,g=!1;try{for(var z,k,v=(0,Z.Z)(n.eachChildSeries());h=(z=yield(0,u.Z)(v.next())).done,k=yield(0,u.Z)(z.value),!h;h=!0){const c=k;!c||(yield*(0,B.Z)((0,Z.Z)(J(c.child,e)),u.Z))}}catch(c){g=!0,S=c}finally{try{!h&&null!=v.return&&(yield(0,u.Z)(v.return()))}finally{if(g)throw S}}}})).apply(this,arguments)}const le=function(r,e,t){return L.apply(this,arguments)}}}]);