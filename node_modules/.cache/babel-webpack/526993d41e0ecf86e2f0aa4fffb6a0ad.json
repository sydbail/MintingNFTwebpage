{"ast":null,"code":"import _asyncToGenerator from \"/Users/sydneybailey/Internship/contract-testing/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Observable } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./web3.service\";\n\nconst ipfsNFTArtifacts = require('../../../build/contracts/IPFSNFT.json');\n\nconst contract = require('@truffle/contract');\n\nexport class IpfscontractService {\n  web3Ser;\n  ipfsNFT = contract(ipfsNFTArtifacts);\n\n  constructor(web3Ser) {\n    this.web3Ser = web3Ser;\n    this.ipfsNFT.setProvider(web3Ser.web3.currentProvider);\n  }\n\n  getBalance(account) {\n    let ipfscontract;\n    return Observable.create(observer => {\n      this.ipfsNFT.deployed().then(instance => {\n        ipfscontract = instance; //we use call here so the call doesn't try and write, making it free\n\n        return ipfscontract.balanceOf.call(account, {\n          from: account\n        });\n      }).then(value => {\n        observer.next(value);\n        observer.complete();\n      }).catch(e => {\n        console.log(e);\n        observer.error(e);\n      });\n    });\n  }\n\n  getOwner(id) {\n    let ipfscontract;\n    return Observable.create(observer => {\n      this.ipfsNFT.deployed().then(instance => {\n        ipfscontract = instance; //we use call here so the call doesn't try and write, making it free\n\n        return ipfscontract.ownerOf.call(id, {\n          from: this.web3Ser.web3.eth.defaultAccount\n        });\n      }).then(value => {\n        observer.next(value);\n        observer.complete();\n      }).catch(e => {\n        console.log(e);\n        observer.error(e);\n      });\n    });\n  }\n\n  getTokenUri(id) {\n    let ipfscontract;\n    return Observable.create(observer => {\n      this.ipfsNFT.deployed().then(instance => {\n        ipfscontract = instance; //we use call here so the call doesn't try and write, making it free\n\n        return ipfscontract.tokenURI.call(id, {\n          from: this.web3Ser.web3.eth.defaultAccount\n        });\n      }).then(value => {\n        observer.next(value);\n        observer.complete();\n      }).catch(e => {\n        console.log(e);\n        observer.error(e);\n      });\n    });\n  }\n\n  mintCoin(to, imagehash, metahash) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let ipfscontract = yield _this.ipfsNFT.deployed();\n      const value = yield ipfscontract.mint(to, imagehash, metahash, {\n        from: _this.web3Ser.web3.eth.defaultAccount\n      });\n      return value;\n      /* return Observable.create((observer: any) => {\n        this.ipfsNFT\n          .deployed()\n          .then((instance: any) => {\n            ipfscontract = instance;\n            return ipfscontract.mint(to, imagehash, metahash, {from: this.web3Ser.web3.eth.defaultAccount});\n          })\n          .then(() => {\n            observer.next()\n            observer.next()\n          })\n          .catch((e: any) => {\n            console.log(e);\n            observer.error(e)\n          });\n      }) */\n    })();\n  }\n\n  static ɵfac = function IpfscontractService_Factory(t) {\n    return new (t || IpfscontractService)(i0.ɵɵinject(i1.Web3Service));\n  };\n  static ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: IpfscontractService,\n    factory: IpfscontractService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"sources":["/Users/sydneybailey/Internship/contract-testing/src/app/services/ipfscontract.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { from } from 'rxjs';\nimport { Web3Service } from './web3.service'\n\nconst ipfsNFTArtifacts = require('../../../build/contracts/IPFSNFT.json');\nconst contract = require('@truffle/contract');\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class IpfscontractService {\n\n  ipfsNFT = contract(ipfsNFTArtifacts);\n\n  constructor(private web3Ser: Web3Service) {\n    this.ipfsNFT.setProvider(web3Ser.web3.currentProvider);\n  }\n\n  getBalance(account: any): Observable<number> {\n  let ipfscontract;\n\n  return Observable.create((observer: any) => {\n    this.ipfsNFT\n      .deployed()\n      .then((instance: any) => {\n        ipfscontract = instance;\n        //we use call here so the call doesn't try and write, making it free\n        return ipfscontract.balanceOf.call(account, {\n          from: account\n        });\n      })\n      .then((value: any) => {\n        observer.next(value)\n        observer.complete()\n      })\n      .catch((e: any) => {\n        console.log(e);\n        observer.error(e)\n      });\n    })\n  }\n\n  getOwner(id: any): Observable<number> {\n    let ipfscontract;\n\n    return Observable.create((observer: any) => {\n      this.ipfsNFT\n        .deployed()\n        .then((instance: any) => {\n          ipfscontract = instance;\n          //we use call here so the call doesn't try and write, making it free\n          return ipfscontract.ownerOf.call(id, {\n            from: this.web3Ser.web3.eth.defaultAccount\n          });\n        })\n        .then((value: any) => {\n          observer.next(value)\n          observer.complete()\n        })\n        .catch((e: any) => {\n          console.log(e);\n          observer.error(e)\n        });\n    })\n  }\n\n  getTokenUri(id: number): Observable<number> {\n    let ipfscontract;\n\n    return Observable.create((observer: any) => {\n      this.ipfsNFT\n        .deployed()\n        .then((instance: any) => {\n          ipfscontract = instance;\n          //we use call here so the call doesn't try and write, making it free\n          return ipfscontract.tokenURI.call(id, {\n            from: this.web3Ser.web3.eth.defaultAccount\n          });\n        })\n        .then((value: any) => {\n          observer.next(value)\n          observer.complete()\n        })\n        .catch((e: any) => {\n          console.log(e);\n          observer.error(e)\n        });\n    })\n  }\n\n  async mintCoin(to: any, imagehash: string, metahash: string): Promise<any>{\n    let ipfscontract = await this.ipfsNFT.deployed();\n    const value = await ipfscontract.mint(to, imagehash, metahash, {from: this.web3Ser.web3.eth.defaultAccount});\n    return value;\n\n    /* return Observable.create((observer: any) => {\n      this.ipfsNFT\n        .deployed()\n        .then((instance: any) => {\n          ipfscontract = instance;\n          return ipfscontract.mint(to, imagehash, metahash, {from: this.web3Ser.web3.eth.defaultAccount});\n        })\n        .then(() => {\n          observer.next()\n          observer.next()\n        })\n        .catch((e: any) => {\n          console.log(e);\n          observer.error(e)\n        });\n    }) */\n  }\n\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}