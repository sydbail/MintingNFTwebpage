{"ast":null,"code":"'use strict';\n\nconst inherits = require('inherits');\n\nconst {\n  Readable\n} = require('readable-stream');\n\nmodule.exports = ReadStream;\ninherits(ReadStream, Readable);\n\nfunction ReadStream(iterator, options) {\n  if (!(this instanceof ReadStream)) return new ReadStream(iterator, options);\n  options = options || {};\n  Readable.call(this, Object.assign({}, options, {\n    objectMode: true\n  }));\n  this._iterator = iterator;\n  this._options = options;\n  this.on('end', this.destroy.bind(this, null, null));\n}\n\nReadStream.prototype._read = function () {\n  if (this.destroyed) return;\n\n  this._iterator.next((err, key, value) => {\n    if (this.destroyed) return;\n    if (err) return this.destroy(err);\n\n    if (key === undefined && value === undefined) {\n      this.push(null);\n    } else if (this._options.keys !== false && this._options.values === false) {\n      this.push(key);\n    } else if (this._options.keys === false && this._options.values !== false) {\n      this.push(value);\n    } else {\n      this.push({\n        key,\n        value\n      });\n    }\n  });\n};\n\nReadStream.prototype._destroy = function (err, callback) {\n  this._iterator.end(function (err2) {\n    callback(err || err2);\n  });\n};","map":null,"metadata":{},"sourceType":"script"}