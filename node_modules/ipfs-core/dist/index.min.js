(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsCore = factory()}(typeof self !== 'undefined' ? self : this, function () {
var IpfsCore=(()=>{var x4e=Object.create;var hv=Object.defineProperty;var A4e=Object.getOwnPropertyDescriptor;var I4e=Object.getOwnPropertyNames;var T4e=Object.getPrototypeOf,R4e=Object.prototype.hasOwnProperty;var Gq=r=>hv(r,"__esModule",{value:!0});var ya=r=>{if(typeof require!="undefined")return require(r);throw new Error('Dynamic require of "'+r+'" is not supported')};var xe=(r,e)=>()=>(r&&(e=r(r=0)),e);var y=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),ut=(r,e)=>{Gq(r);for(var t in e)hv(r,t,{get:e[t],enumerable:!0})},C4e=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of I4e(e))!R4e.call(r,i)&&i!=="default"&&hv(r,i,{get:()=>e[i],enumerable:!(t=A4e(e,i))||t.enumerable});return r},Wt=r=>C4e(Gq(hv(r!=null?x4e(T4e(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var Xq=y(pv=>{f();"use strict";pv.byteLength=O4e;pv.toByteArray=q4e;pv.fromByteArray=B4e;var ga=[],qs=[],P4e=typeof Uint8Array!="undefined"?Uint8Array:Array,Yx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(uf=0,Wq=Yx.length;uf<Wq;++uf)ga[uf]=Yx[uf],qs[Yx.charCodeAt(uf)]=uf;var uf,Wq;qs["-".charCodeAt(0)]=62;qs["_".charCodeAt(0)]=63;function Yq(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function O4e(r){var e=Yq(r),t=e[0],i=e[1];return(t+i)*3/4-i}function k4e(r,e,t){return(e+t)*3/4-t}function q4e(r){var e,t=Yq(r),i=t[0],n=t[1],s=new P4e(k4e(r,i,n)),o=0,a=n>0?i-4:i,c;for(c=0;c<a;c+=4)e=qs[r.charCodeAt(c)]<<18|qs[r.charCodeAt(c+1)]<<12|qs[r.charCodeAt(c+2)]<<6|qs[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return n===2&&(e=qs[r.charCodeAt(c)]<<2|qs[r.charCodeAt(c+1)]>>4,s[o++]=e&255),n===1&&(e=qs[r.charCodeAt(c)]<<10|qs[r.charCodeAt(c+1)]<<4|qs[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function N4e(r){return ga[r>>18&63]+ga[r>>12&63]+ga[r>>6&63]+ga[r&63]}function D4e(r,e,t){for(var i,n=[],s=e;s<t;s+=3)i=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),n.push(N4e(i));return n.join("")}function B4e(r){for(var e,t=r.length,i=t%3,n=[],s=16383,o=0,a=t-i;o<a;o+=s)n.push(D4e(r,o,o+s>a?a:o+s));return i===1?(e=r[t-1],n.push(ga[e>>2]+ga[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(ga[e>>10]+ga[e>>4&63]+ga[e<<2&63]+"=")),n.join("")}});var Qq=y(Xx=>{f();Xx.read=function(r,e,t,i,n){var s,o,a=n*8-i-1,c=(1<<a)-1,u=c>>1,l=-7,d=t?n-1:0,h=t?-1:1,p=r[e+d];for(d+=h,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=s*256+r[e+d],d+=h,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=i;l>0;o=o*256+r[e+d],d+=h,l-=8);if(s===0)s=1-u;else{if(s===c)return o?NaN:(p?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(p?-1:1)*o*Math.pow(2,s-i)};Xx.write=function(r,e,t,i,n,s){var o,a,c,u=s*8-n-1,l=(1<<u)-1,d=l>>1,h=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,g=i?1:-1,b=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=h/c:e+=h*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(e*c-1)*Math.pow(2,n),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,n),o=0));n>=8;r[t+p]=a&255,p+=g,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;r[t+p]=o&255,p+=g,o/=256,u-=8);r[t+p-g]|=b*128}});var Vt=y(lh=>{f();"use strict";var Qx=Xq(),ah=Qq(),Zq=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;lh.Buffer=le;lh.SlowBuffer=j4e;lh.INSPECT_MAX_BYTES=50;var yv=2147483647;lh.kMaxLength=yv;le.TYPED_ARRAY_SUPPORT=M4e();!le.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function M4e(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch(r){return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(!!le.isBuffer(this))return this.byteOffset}});function Cc(r){if(r>yv)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,le.prototype),e}function le(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Zx(r)}return Jq(r,e,t)}le.poolSize=8192;function Jq(r,e,t){if(typeof r=="string")return U4e(r,e);if(ArrayBuffer.isView(r))return F4e(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ma(r,ArrayBuffer)||r&&ma(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ma(r,SharedArrayBuffer)||r&&ma(r.buffer,SharedArrayBuffer)))return e6(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return le.from(i,e,t);let n=K4e(r);if(n)return n;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return le.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}le.from=function(r,e,t){return Jq(r,e,t)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function eN(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function L4e(r,e,t){return eN(r),r<=0?Cc(r):e!==void 0?typeof t=="string"?Cc(r).fill(e,t):Cc(r).fill(e):Cc(r)}le.alloc=function(r,e,t){return L4e(r,e,t)};function Zx(r){return eN(r),Cc(r<0?0:t6(r)|0)}le.allocUnsafe=function(r){return Zx(r)};le.allocUnsafeSlow=function(r){return Zx(r)};function U4e(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!le.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=tN(r,e)|0,i=Cc(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function Jx(r){let e=r.length<0?0:t6(r.length)|0,t=Cc(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function F4e(r){if(ma(r,Uint8Array)){let e=new Uint8Array(r);return e6(e.buffer,e.byteOffset,e.byteLength)}return Jx(r)}function e6(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,le.prototype),i}function K4e(r){if(le.isBuffer(r)){let e=t6(r.length)|0,t=Cc(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||n6(r.length)?Cc(0):Jx(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Jx(r.data)}function t6(r){if(r>=yv)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+yv.toString(16)+" bytes");return r|0}function j4e(r){return+r!=r&&(r=0),le.alloc(+r)}le.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==le.prototype};le.compare=function(e,t){if(ma(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),ma(t,Uint8Array)&&(t=le.from(t,t.offset,t.byteLength)),!le.isBuffer(e)||!le.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let s=0,o=Math.min(i,n);s<o;++s)if(e[s]!==t[s]){i=e[s],n=t[s];break}return i<n?-1:n<i?1:0};le.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return le.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=le.allocUnsafe(t),s=0;for(i=0;i<e.length;++i){let o=e[i];if(ma(o,Uint8Array))s+o.length>n.length?(le.isBuffer(o)||(o=le.from(o)),o.copy(n,s)):Uint8Array.prototype.set.call(n,o,s);else if(le.isBuffer(o))o.copy(n,s);else throw new TypeError('"list" argument must be an Array of Buffers');s+=o.length}return n};function tN(r,e){if(le.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ma(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return i6(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return hN(r).length;default:if(n)return i?-1:i6(r).length;e=(""+e).toLowerCase(),n=!0}}le.byteLength=tN;function V4e(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return J4e(this,e,t);case"utf8":case"utf-8":return nN(this,e,t);case"ascii":return Q4e(this,e,t);case"latin1":case"binary":return Z4e(this,e,t);case"base64":return Y4e(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return eTe(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}le.prototype._isBuffer=!0;function lf(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}le.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)lf(this,t,t+1);return this};le.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)lf(this,t,t+3),lf(this,t+1,t+2);return this};le.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)lf(this,t,t+7),lf(this,t+1,t+6),lf(this,t+2,t+5),lf(this,t+3,t+4);return this};le.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?nN(this,0,e):V4e.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(e){if(!le.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:le.compare(this,e)===0};le.prototype.inspect=function(){let e="",t=lh.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};Zq&&(le.prototype[Zq]=le.prototype.inspect);le.prototype.compare=function(e,t,i,n,s){if(ma(e,Uint8Array)&&(e=le.from(e,e.offset,e.byteLength)),!le.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),s===void 0&&(s=this.length),t<0||i>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=i)return 0;if(n>=s)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,s>>>=0,this===e)return 0;let o=s-n,a=i-t,c=Math.min(o,a),u=this.slice(n,s),l=e.slice(t,i);for(let d=0;d<c;++d)if(u[d]!==l[d]){o=u[d],a=l[d];break}return o<a?-1:a<o?1:0};function rN(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,n6(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=le.from(e,i)),le.isBuffer(e))return e.length===0?-1:iN(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):iN(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function iN(r,e,t,i,n){let s=1,o=r.length,a=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;s=2,o/=2,a/=2,t/=2}function c(l,d){return s===1?l[d]:l.readUInt16BE(d*s)}let u;if(n){let l=-1;for(u=t;u<o;u++)if(c(r,u)===c(e,l===-1?0:u-l)){if(l===-1&&(l=u),u-l+1===a)return l*s}else l!==-1&&(u-=u-l),l=-1}else for(t+a>o&&(t=o-a),u=t;u>=0;u--){let l=!0;for(let d=0;d<a;d++)if(c(r,u+d)!==c(e,d)){l=!1;break}if(l)return u}return-1}le.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};le.prototype.indexOf=function(e,t,i){return rN(this,e,t,i,!0)};le.prototype.lastIndexOf=function(e,t,i){return rN(this,e,t,i,!1)};function z4e(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let s=e.length;i>s/2&&(i=s/2);let o;for(o=0;o<i;++o){let a=parseInt(e.substr(o*2,2),16);if(n6(a))return o;r[t+o]=a}return o}function H4e(r,e,t,i){return gv(i6(e,r.length-t),r,t,i)}function $4e(r,e,t,i){return gv(nTe(e),r,t,i)}function G4e(r,e,t,i){return gv(hN(e),r,t,i)}function W4e(r,e,t,i){return gv(sTe(e,r.length-t),r,t,i)}le.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let s=this.length-t;if((i===void 0||i>s)&&(i=s),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let o=!1;for(;;)switch(n){case"hex":return z4e(this,e,t,i);case"utf8":case"utf-8":return H4e(this,e,t,i);case"ascii":case"latin1":case"binary":return $4e(this,e,t,i);case"base64":return G4e(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W4e(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Y4e(r,e,t){return e===0&&t===r.length?Qx.fromByteArray(r):Qx.fromByteArray(r.slice(e,t))}function nN(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let s=r[n],o=null,a=s>239?4:s>223?3:s>191?2:1;if(n+a<=t){let c,u,l,d;switch(a){case 1:s<128&&(o=s);break;case 2:c=r[n+1],(c&192)==128&&(d=(s&31)<<6|c&63,d>127&&(o=d));break;case 3:c=r[n+1],u=r[n+2],(c&192)==128&&(u&192)==128&&(d=(s&15)<<12|(c&63)<<6|u&63,d>2047&&(d<55296||d>57343)&&(o=d));break;case 4:c=r[n+1],u=r[n+2],l=r[n+3],(c&192)==128&&(u&192)==128&&(l&192)==128&&(d=(s&15)<<18|(c&63)<<12|(u&63)<<6|l&63,d>65535&&d<1114112&&(o=d))}}o===null?(o=65533,a=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|o&1023),i.push(o),n+=a}return X4e(i)}var sN=4096;function X4e(r){let e=r.length;if(e<=sN)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=sN));return t}function Q4e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function Z4e(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function J4e(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let s=e;s<t;++s)n+=oTe[r[s]];return n}function eTe(r,e,t){let i=r.slice(e,t),n="";for(let s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+i[s+1]*256);return n}le.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,le.prototype),n};function Pi(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Pi(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return n};le.prototype.readUintBE=le.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Pi(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n};le.prototype.readUint8=le.prototype.readUInt8=function(e,t){return e=e>>>0,t||Pi(e,1,this.length),this[e]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||Pi(e,2,this.length),this[e]|this[e+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||Pi(e,2,this.length),this[e]<<8|this[e+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};le.prototype.readBigUInt64LE=Du(function(e){e=e>>>0,uh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Jy(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,s=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))});le.prototype.readBigUInt64BE=Du(function(e){e=e>>>0,uh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Jy(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],s=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(s)});le.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||Pi(e,t,this.length);let n=this[e],s=1,o=0;for(;++o<t&&(s*=256);)n+=this[e+o]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n};le.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||Pi(e,t,this.length);let n=t,s=1,o=this[e+--n];for(;n>0&&(s*=256);)o+=this[e+--n]*s;return s*=128,o>=s&&(o-=Math.pow(2,8*t)),o};le.prototype.readInt8=function(e,t){return e=e>>>0,t||Pi(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};le.prototype.readInt16LE=function(e,t){e=e>>>0,t||Pi(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};le.prototype.readInt16BE=function(e,t){e=e>>>0,t||Pi(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};le.prototype.readInt32LE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};le.prototype.readInt32BE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};le.prototype.readBigInt64LE=Du(function(e){e=e>>>0,uh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Jy(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});le.prototype.readBigInt64BE=Du(function(e){e=e>>>0,uh(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&Jy(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});le.prototype.readFloatLE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),ah.read(this,e,!0,23,4)};le.prototype.readFloatBE=function(e,t){return e=e>>>0,t||Pi(e,4,this.length),ah.read(this,e,!1,23,4)};le.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||Pi(e,8,this.length),ah.read(this,e,!0,52,8)};le.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||Pi(e,8,this.length),ah.read(this,e,!1,52,8)};function Gn(r,e,t,i,n,s){if(!le.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Gn(this,e,t,i,a,0)}let s=1,o=0;for(this[t]=e&255;++o<i&&(s*=256);)this[t+o]=e/s&255;return t+i};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let a=Math.pow(2,8*i)-1;Gn(this,e,t,i,a,0)}let s=i-1,o=1;for(this[t+s]=e&255;--s>=0&&(o*=256);)this[t+s]=e/o&255;return t+i};le.prototype.writeUint8=le.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,1,255,0),this[t]=e&255,t+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function oN(r,e,t,i,n){dN(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,t}function aN(r,e,t,i,n){dN(e,i,n,r,t,7);let s=Number(e&BigInt(4294967295));r[t+7]=s,s=s>>8,r[t+6]=s,s=s>>8,r[t+5]=s,s=s>>8,r[t+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=o,o=o>>8,r[t+2]=o,o=o>>8,r[t+1]=o,o=o>>8,r[t]=o,t+8}le.prototype.writeBigUInt64LE=Du(function(e,t=0){return oN(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=Du(function(e,t=0){return aN(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Gn(this,e,t,i,c-1,-c)}let s=0,o=1,a=0;for(this[t]=e&255;++s<i&&(o*=256);)e<0&&a===0&&this[t+s-1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};le.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let c=Math.pow(2,8*i-1);Gn(this,e,t,i,c-1,-c)}let s=i-1,o=1,a=0;for(this[t+s]=e&255;--s>=0&&(o*=256);)e<0&&a===0&&this[t+s+1]!==0&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+i};le.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};le.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};le.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};le.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};le.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||Gn(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};le.prototype.writeBigInt64LE=Du(function(e,t=0){return oN(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=Du(function(e,t=0){return aN(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function cN(r,e,t,i,n,s){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function uN(r,e,t,i,n){return e=+e,t=t>>>0,n||cN(r,e,t,4,34028234663852886e22,-34028234663852886e22),ah.write(r,e,t,i,23,4),t+4}le.prototype.writeFloatLE=function(e,t,i){return uN(this,e,t,!0,i)};le.prototype.writeFloatBE=function(e,t,i){return uN(this,e,t,!1,i)};function lN(r,e,t,i,n){return e=+e,t=t>>>0,n||cN(r,e,t,8,17976931348623157e292,-17976931348623157e292),ah.write(r,e,t,i,52,8),t+8}le.prototype.writeDoubleLE=function(e,t,i){return lN(this,e,t,!0,i)};le.prototype.writeDoubleBE=function(e,t,i){return lN(this,e,t,!1,i)};le.prototype.copy=function(e,t,i,n){if(!le.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let s=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),s};le.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!le.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let o=e.charCodeAt(0);(n==="utf8"&&o<128||n==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let s;if(typeof e=="number")for(s=t;s<i;++s)this[s]=e;else{let o=le.isBuffer(e)?e:le.from(e,n),a=o.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<i-t;++s)this[s+t]=o[s%a]}return this};var ch={};function r6(r,e,t){ch[r]=class extends t{constructor(){super();Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}r6("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);r6("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);r6("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=fN(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=fN(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function fN(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function tTe(r,e,t){uh(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&Jy(e,r.length-(t+1))}function dN(r,e,t,i,n,s){if(r>t||r<e){let o=typeof e=="bigint"?"n":"",a;throw s>3?e===0||e===BigInt(0)?a=`>= 0${o} and < 2${o} ** ${(s+1)*8}${o}`:a=`>= -(2${o} ** ${(s+1)*8-1}${o}) and < 2 ** ${(s+1)*8-1}${o}`:a=`>= ${e}${o} and <= ${t}${o}`,new ch.ERR_OUT_OF_RANGE("value",a,r)}tTe(i,n,s)}function uh(r,e){if(typeof r!="number")throw new ch.ERR_INVALID_ARG_TYPE(e,"number",r)}function Jy(r,e,t){throw Math.floor(r)!==r?(uh(r,t),new ch.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new ch.ERR_BUFFER_OUT_OF_BOUNDS:new ch.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var rTe=/[^+/0-9A-Za-z-_]/g;function iTe(r){if(r=r.split("=")[0],r=r.trim().replace(rTe,""),r.length<2)return"";for(;r.length%4!=0;)r=r+"=";return r}function i6(r,e){e=e||1/0;let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function nTe(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function sTe(r,e){let t,i,n,s=[];for(let o=0;o<r.length&&!((e-=2)<0);++o)t=r.charCodeAt(o),i=t>>8,n=t%256,s.push(n),s.push(i);return s}function hN(r){return Qx.toByteArray(iTe(r))}function gv(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function ma(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function n6(r){return r!==r}var oTe=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function Du(r){return typeof BigInt=="undefined"?aTe:r}function aTe(){throw new Error("BigInt not supported")}});var bN=y((j6t,mN)=>{f();var Zr=mN.exports={},ba,va;function s6(){throw new Error("setTimeout has not been defined")}function o6(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ba=setTimeout:ba=s6}catch(r){ba=s6}try{typeof clearTimeout=="function"?va=clearTimeout:va=o6}catch(r){va=o6}})();function pN(r){if(ba===setTimeout)return setTimeout(r,0);if((ba===s6||!ba)&&setTimeout)return ba=setTimeout,setTimeout(r,0);try{return ba(r,0)}catch(e){try{return ba.call(null,r,0)}catch(t){return ba.call(this,r,0)}}}function cTe(r){if(va===clearTimeout)return clearTimeout(r);if((va===o6||!va)&&clearTimeout)return va=clearTimeout,clearTimeout(r);try{return va(r)}catch(e){try{return va.call(null,r)}catch(t){return va.call(this,r)}}}var Pc=[],fh=!1,ff,mv=-1;function uTe(){!fh||!ff||(fh=!1,ff.length?Pc=ff.concat(Pc):mv=-1,Pc.length&&yN())}function yN(){if(!fh){var r=pN(uTe);fh=!0;for(var e=Pc.length;e;){for(ff=Pc,Pc=[];++mv<e;)ff&&ff[mv].run();mv=-1,e=Pc.length}ff=null,fh=!1,cTe(r)}}Zr.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];Pc.push(new gN(r,e)),Pc.length===1&&!fh&&pN(yN)};function gN(r,e){this.fun=r,this.array=e}gN.prototype.run=function(){this.fun.apply(null,this.array)};Zr.title="browser";Zr.browser=!0;Zr.env={};Zr.argv=[];Zr.version="";Zr.versions={};function Oc(){}Zr.on=Oc;Zr.addListener=Oc;Zr.once=Oc;Zr.off=Oc;Zr.removeListener=Oc;Zr.removeAllListeners=Oc;Zr.emit=Oc;Zr.prependListener=Oc;Zr.prependOnceListener=Oc;Zr.listeners=function(r){return[]};Zr.binding=function(r){throw new Error("process.binding is not supported")};Zr.cwd=function(){return"/"};Zr.chdir=function(r){throw new Error("process.chdir is not supported")};Zr.umask=function(){return 0}});var Buffer,process,f=xe(()=>{({Buffer}=Vt()),process=bN()});var a6=y(()=>{f()});var c6=y(bv=>{f();"use strict";var vN=class extends Error{constructor(e="Request timed out"){super(e);this.name="TimeoutError"}};bv.TimeoutError=vN;var wN=class extends Error{constructor(e="The operation was aborted."){super(e);this.name="AbortError"}};bv.AbortError=wN;var _N=class extends Error{constructor(e){super(e.statusText);this.name="HTTPError",this.response=e}};bv.HTTPError=_N});var u6=y((G6t,EN)=>{f();function lTe(){return typeof window!="undefined"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process!="undefined"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}EN.exports=lTe});var tg=y((W6t,SN)=>{f();"use strict";var fTe=u6(),vv=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,eg=fTe(),dTe=vv&&!eg,hTe=eg&&!vv,pTe=eg&&vv,yTe=typeof ya=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!eg,gTe=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,mTe=typeof process!="undefined"&&typeof process.env!="undefined"&&!1,bTe=typeof navigator!="undefined"&&navigator.product==="ReactNative";SN.exports={isTest:mTe,isElectron:eg,isElectronMain:hTe,isElectronRenderer:pTe,isNode:yTe,isBrowser:dTe,isWebWorker:gTe,isEnvWithDom:vv,isReactNative:bTe}});var xN=y(()=>{f()});var rg=y((dh,AN)=>{f();"use strict";var vTe=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof kc!="undefined")return kc;throw new Error("unable to locate global object")},kc=vTe();AN.exports=dh=kc.fetch;kc.fetch&&(dh.default=kc.fetch.bind(kc));dh.Headers=kc.Headers;dh.Request=kc.Request;dh.Response=kc.Response});var f6=y((Q6t,l6)=>{f();"use strict";globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?l6.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:l6.exports={default:rg().default,Headers:rg().Headers,Request:rg().Request,Response:rg().Response}});var IN=y((Z6t,d6)=>{f();"use strict";var{isElectronMain:wTe}=tg();wTe?d6.exports=xN():d6.exports=f6()});var PN=y((J6t,CN)=>{f();"use strict";var{TimeoutError:_Te,AbortError:ETe}=c6(),{Response:TN,Request:STe,Headers:h6,default:xTe}=IN(),ATe=(r,e={})=>{let t=new XMLHttpRequest;t.open(e.method||"GET",r.toString(),!0);let{timeout:i,headers:n}=e;if(i&&i>0&&i<1/0&&(t.timeout=i),e.overrideMimeType!=null&&t.overrideMimeType(e.overrideMimeType),n)for(let[s,o]of new h6(n))t.setRequestHeader(s,o);return e.signal&&(e.signal.onabort=()=>t.abort()),e.onUploadProgress&&(t.upload.onprogress=e.onUploadProgress),t.responseType="arraybuffer",new Promise((s,o)=>{let a=c=>{switch(c.type){case"error":{s(TN.error());break}case"load":{s(new RN(t.responseURL,t.response,{status:t.status,statusText:t.statusText,headers:RTe(t.getAllResponseHeaders())}));break}case"timeout":{o(new _Te);break}case"abort":{o(new ETe);break}default:break}};t.onerror=a,t.onload=a,t.ontimeout=a,t.onabort=a,t.send(e.body)})},ITe=xTe,TTe=(r,e={})=>e.onUploadProgress!=null?ATe(r,e):ITe(r,e),RTe=r=>{let e=new h6;for(let t of r.trim().split(/[\r\n]+/)){let i=t.indexOf(": ");i>0&&e.set(t.slice(0,i),t.slice(i+1))}return e},RN=class extends TN{constructor(e,t,i){super(t,i);Object.defineProperty(this,"url",{value:e})}};CN.exports={fetch:TTe,Request:STe,Headers:h6}});var kN=y((eAt,ON)=>{f();"use strict";ON.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var gr=y((BN,MN)=>{f();"use strict";var wv=kN(),{hasOwnProperty:qN}=Object.prototype,{propertyIsEnumerable:CTe}=Object,hh=(r,e,t)=>Object.defineProperty(r,e,{value:t,writable:!0,enumerable:!0,configurable:!0}),PTe=BN,NN={concatArrays:!1,ignoreUndefined:!1},_v=r=>{let e=[];for(let t in r)qN.call(r,t)&&e.push(t);if(Object.getOwnPropertySymbols){let t=Object.getOwnPropertySymbols(r);for(let i of t)CTe.call(r,i)&&e.push(i)}return e};function ph(r){return Array.isArray(r)?OTe(r):wv(r)?kTe(r):r}function OTe(r){let e=r.slice(0,0);return _v(r).forEach(t=>{hh(e,t,ph(r[t]))}),e}function kTe(r){let e=Object.getPrototypeOf(r)===null?Object.create(null):{};return _v(r).forEach(t=>{hh(e,t,ph(r[t]))}),e}var DN=(r,e,t,i)=>(t.forEach(n=>{typeof e[n]=="undefined"&&i.ignoreUndefined||(n in r&&r[n]!==Object.getPrototypeOf(r)?hh(r,n,p6(r[n],e[n],i)):hh(r,n,ph(e[n])))}),r),qTe=(r,e,t)=>{let i=r.slice(0,0),n=0;return[r,e].forEach(s=>{let o=[];for(let a=0;a<s.length;a++)!qN.call(s,a)||(o.push(String(a)),s===r?hh(i,n++,s[a]):hh(i,n++,ph(s[a])));i=DN(i,s,_v(s).filter(a=>!o.includes(a)),t)}),i};function p6(r,e,t){return t.concatArrays&&Array.isArray(r)&&Array.isArray(e)?qTe(r,e,t):!wv(e)||!wv(r)?ph(e):DN(r,e,_v(e),t)}MN.exports=function(...r){let e=p6(ph(NN),this!==PTe&&this||{},NN),t={_:{}};for(let i of r)if(i!==void 0){if(!wv(i))throw new TypeError("`"+i+"` is not an Option Object");t=p6(t,{_:i},e)}return t._}});var y6=y((tAt,FN)=>{f();"use strict";var NTe=typeof navigator!="undefined"&&navigator.product==="ReactNative";function DTe(){return NTe?"http://localhost":self.location.protocol+"//"+self.location.host}var ig=self.URL,LN=DTe(),UN=class{constructor(e="",t=LN){this.super=new ig(e,t),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return ig.createObjectURL(e)}static revokeObjectURL(e){ig.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function BTe(r){if(typeof r=="string")return new ig(r).toString();if(!(r instanceof ig)){let e=r.username&&r.password?`${r.username}:${r.password}@`:"",t=r.auth?r.auth+"@":"",i=r.port?":"+r.port:"",n=r.protocol?r.protocol+"//":"",s=r.host||"",o=r.hostname||"",a=r.search||(r.query?"?"+r.query:""),c=r.hash||"",u=r.pathname||"",l=r.path||u+a;return`${n}${e||t}${s||o+i}${l}${c}`}}FN.exports={URLWithLegacySupport:UN,URLSearchParams:self.URLSearchParams,defaultBase:LN,format:BTe}});var VN=y((rAt,jN)=>{f();"use strict";var{URLWithLegacySupport:KN,format:MTe}=y6();jN.exports=(r,e={},t={},i)=>{let n=e.protocol?e.protocol.replace(":",""):"http";n=(t[n]||i||n)+":";let s;try{s=new KN(r)}catch(a){s={}}let o=Object.assign({},e,{protocol:n||s.protocol,host:e.host||s.host});return new KN(r,MTe(o)).toString()}});var Ev=y((iAt,zN)=>{f();"use strict";var{URLWithLegacySupport:LTe,format:UTe,URLSearchParams:FTe,defaultBase:KTe}=y6(),jTe=VN();zN.exports={URL:LTe,URLSearchParams:FTe,format:UTe,relative:jTe,defaultBase:KTe}});var df=y((nAt,Sv)=>{f();"use strict";var{AbortController:HN,AbortSignal:VTe}=typeof self!="undefined"?self:typeof window!="undefined"?window:void 0;Sv.exports=HN;Sv.exports.AbortSignal=VTe;Sv.exports.default=HN});var rn=y((sAt,$N)=>{f();"use strict";var xv;globalThis.AbortController&&globalThis.AbortSignal?xv=globalThis:xv=df();$N.exports={AbortController:xv.AbortController,AbortSignal:xv.AbortSignal}});var hf=y((oAt,g6)=>{f();var{AbortController:zTe}=rn();function GN(r){let e=new zTe;function t(){e.abort();for(let i of r)!i||!i.removeEventListener||i.removeEventListener("abort",t)}for(let i of r)if(!(!i||!i.addEventListener)){if(i.aborted){t();break}i.addEventListener("abort",t)}return e.signal}g6.exports=GN;g6.exports.anySignal=GN});var ng=y((aAt,JN)=>{f();"use strict";var{fetch:HTe,Request:$Te,Headers:GTe}=PN(),{TimeoutError:m6,HTTPError:WN}=c6(),YN=gr().bind({ignoreUndefined:!0}),{URL:XN,URLSearchParams:QN}=Ev(),{AbortController:WTe}=rn(),YTe=hf(),XTe=(r,e,t)=>{if(e===void 0)return r;let i=Date.now(),n=()=>Date.now()-i>=e;return new Promise((s,o)=>{let a=setTimeout(()=>{n()&&(o(new m6),t.abort())},e),c=u=>d=>{if(clearTimeout(a),n()){o(new m6);return}u(d)};r.then(c(s),c(o))})},QTe={throwHttpErrors:!0,credentials:"same-origin"},Rn=class{constructor(e={}){this.opts=YN(QTe,e)}async fetch(e,t={}){let i=YN(this.opts,t),n=new GTe(i.headers);if(typeof e!="string"&&!(e instanceof XN||e instanceof $Te))throw new TypeError("`resource` must be a string, URL, or Request");let s=new XN(e.toString(),i.base),{searchParams:o,transformSearchParams:a,json:c}=i;o&&(typeof a=="function"?s.search=a(new QN(i.searchParams)):s.search=new QN(i.searchParams)),c&&(i.body=JSON.stringify(i.json),n.set("content-type","application/json"));let u=new WTe,l=YTe([u.signal,i.signal]),d=await XTe(HTe(s.toString(),{...i,signal:l,timeout:void 0,headers:n}),i.timeout,u);if(!d.ok&&i.throwHttpErrors)throw i.handleError&&await i.handleError(d),new WN(d);return d.iterator=function(){return ZN(d.body)},d.ndjson=async function*(){for await(let h of ZTe(d.iterator()))t.transform?yield t.transform(h):yield h},d}post(e,t={}){return this.fetch(e,{...t,method:"POST"})}get(e,t={}){return this.fetch(e,{...t,method:"GET"})}put(e,t={}){return this.fetch(e,{...t,method:"PUT"})}delete(e,t={}){return this.fetch(e,{...t,method:"DELETE"})}options(e,t={}){return this.fetch(e,{...t,method:"OPTIONS"})}},ZTe=async function*(r){let e=new TextDecoder,t="";for await(let i of r){t+=e.decode(i,{stream:!0});let n=t.split(/\r?\n/);for(let s=0;s<n.length-1;s++){let o=n[s].trim();o.length>0&&(yield JSON.parse(o))}t=n[n.length-1]}t+=e.decode(),t=t.trim(),t.length!==0&&(yield JSON.parse(t))},ZN=r=>{if(t5e(r)){let e=r[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(t){return r.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:t})}}}}}if(e5e(r)){let e=r.getReader();return async function*(){try{for(;;){let{done:t,value:i}=await e.read();if(t)return;i&&(yield i)}}finally{e.releaseLock()}}()}if(JTe(r))return r;throw new TypeError("Body can't be converted to AsyncIterable")},JTe=r=>typeof r=="object"&&r!==null&&typeof r[Symbol.asyncIterator]=="function",e5e=r=>r&&typeof r.getReader=="function",t5e=r=>Object.prototype.hasOwnProperty.call(r,"readable")&&Object.prototype.hasOwnProperty.call(r,"writable");Rn.HTTPError=WN;Rn.TimeoutError=m6;Rn.streamToAsyncIterator=ZN;Rn.post=(r,e)=>new Rn(e).post(r,e);Rn.get=(r,e)=>new Rn(e).get(r,e);Rn.put=(r,e)=>new Rn(e).put(r,e);Rn.delete=(r,e)=>new Rn(e).delete(r,e);Rn.options=(r,e)=>new Rn(e).options(r,e);JN.exports=Rn});var b6=y((cAt,eD)=>{f();"use strict";var r5e=ng(),i5e=(r,e)=>({path:decodeURIComponent(new URL(r).pathname.split("/").pop()||""),content:n5e(r,e)});async function*n5e(r,e){yield*(await new r5e().get(r,e)).iterator()}eD.exports=i5e});function rD(r,e,t){e=e||[],t=t||0;for(var i=t;r>=c5e;)e[t++]=r&255|tD,r/=128;for(;r&a5e;)e[t++]=r&255|tD,r>>>=7;return e[t]=r|0,rD.bytes=t-i+1,e}function v6(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw v6.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&iD)<<i:(s&iD)*Math.pow(2,i),i+=7}while(s>=l5e);return v6.bytes=n-e,t}var s5e,tD,o5e,a5e,c5e,u5e,l5e,iD,f5e,d5e,h5e,p5e,y5e,g5e,m5e,b5e,v5e,w5e,_5e,E5e,sg,nD=xe(()=>{f();s5e=rD,tD=128,o5e=127,a5e=~o5e,c5e=Math.pow(2,31);u5e=v6,l5e=128,iD=127;f5e=Math.pow(2,7),d5e=Math.pow(2,14),h5e=Math.pow(2,21),p5e=Math.pow(2,28),y5e=Math.pow(2,35),g5e=Math.pow(2,42),m5e=Math.pow(2,49),b5e=Math.pow(2,56),v5e=Math.pow(2,63),w5e=function(r){return r<f5e?1:r<d5e?2:r<h5e?3:r<p5e?4:r<y5e?5:r<g5e?6:r<m5e?7:r<b5e?8:r<v5e?9:10},_5e={encode:s5e,decode:u5e,encodingLength:w5e},E5e=_5e,sg=E5e});var og={};ut(og,{decode:()=>yh,encodeTo:()=>pf,encodingLength:()=>yf});var yh,pf,yf,Av=xe(()=>{f();nD();yh=r=>[sg.decode(r),sg.decode.bytes],pf=(r,e,t=0)=>(sg.encode(r,e,t),e),yf=r=>sg.encodingLength(r)});var qc={};ut(qc,{coerce:()=>Ao,empty:()=>sD,equals:()=>w6,fromHex:()=>x5e,fromString:()=>_6,isBinary:()=>A5e,toHex:()=>S5e,toString:()=>E6});var sD,S5e,x5e,w6,Ao,A5e,_6,E6,Bu=xe(()=>{f();sD=new Uint8Array(0),S5e=r=>r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),x5e=r=>{let e=r.match(/../g);return e?new Uint8Array(e.map(t=>parseInt(t,16))):sD},w6=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},Ao=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},A5e=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),_6=r=>new TextEncoder().encode(r),E6=r=>new TextDecoder().decode(r)});var Wn={};ut(Wn,{Digest:()=>gh,create:()=>ag,decode:()=>Mu,equals:()=>S6});var ag,Mu,S6,gh,Cn=xe(()=>{f();Bu();Av();ag=(r,e)=>{let t=e.byteLength,i=yf(r),n=i+yf(t),s=new Uint8Array(n+t);return pf(r,s,0),pf(t,s,i),s.set(e,n),new gh(r,t,e,s)},Mu=r=>{let e=Ao(r),[t,i]=yh(e),[n,s]=yh(e.subarray(i)),o=e.subarray(i+s);if(o.byteLength!==n)throw new Error("Incorrect length");return new gh(t,n,o,e)},S6=(r,e)=>r===e?!0:r.code===e.code&&r.size===e.size&&w6(r.bytes,e.bytes),gh=class{constructor(e,t,i,n){this.code=e,this.size=t,this.digest=i,this.bytes=n}}});function I5e(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),i=0;i<t.length;i++)t[i]=255;for(var n=0;n<r.length;n++){var s=r.charAt(n),o=s.charCodeAt(0);if(t[o]!==255)throw new TypeError(s+" is ambiguous");t[o]=n}var a=r.length,c=r.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var b=0,E=0,v=0,A=g.length;v!==A&&g[v]===0;)v++,b++;for(var R=(A-v)*l+1>>>0,F=new Uint8Array(R);v!==A;){for(var q=g[v],N=0,z=R-1;(q!==0||N<E)&&z!==-1;z--,N++)q+=256*F[z]>>>0,F[z]=q%a>>>0,q=q/a>>>0;if(q!==0)throw new Error("Non-zero carry");E=N,v++}for(var G=R-E;G!==R&&F[G]===0;)G++;for(var Y=c.repeat(b);G<R;++G)Y+=r.charAt(F[G]);return Y}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var b=0;if(g[b]!==" "){for(var E=0,v=0;g[b]===c;)E++,b++;for(var A=(g.length-b)*u+1>>>0,R=new Uint8Array(A);g[b];){var F=t[g.charCodeAt(b)];if(F===255)return;for(var q=0,N=A-1;(F!==0||q<v)&&N!==-1;N--,q++)F+=a*R[N]>>>0,R[N]=F%256>>>0,F=F/256>>>0;if(F!==0)throw new Error("Non-zero carry");v=q,b++}if(g[b]!==" "){for(var z=A-v;z!==A&&R[z]===0;)z++;for(var G=new Uint8Array(E+(A-z)),Y=E;z!==A;)G[Y++]=R[z++];return G}}}function p(g){var b=h(g);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var T5e,R5e,oD,aD=xe(()=>{f();T5e=I5e,R5e=T5e,oD=R5e});var cD,uD,Iv,lD,Tv,Lu,C5e,P5e,Kr,wa=xe(()=>{f();aD();Bu();cD=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},uD=class{constructor(e,t,i){this.name=e,this.prefix=t,this.baseDecode=i}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){let t={[this.prefix]:this,...e.decoders||{[e.prefix]:e}};return new Iv(t)}},Iv=class{constructor(e){this.decoders=e}or(e){let t=e.decoders||{[e.prefix]:e};return new Iv({...this.decoders,...t})}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},lD=class{constructor(e,t,i,n){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=n,this.encoder=new cD(e,t,i),this.decoder=new uD(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Tv=({name:r,prefix:e,encode:t,decode:i})=>new lD(r,e,t,i),Lu=({prefix:r,name:e,alphabet:t})=>{let{encode:i,decode:n}=oD(t,e);return Tv({prefix:r,name:e,encode:i,decode:s=>Ao(n(s))})},C5e=(r,e,t,i)=>{let n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=r.length;for(;r[s-1]==="=";)--s;let o=new Uint8Array(s*t/8|0),a=0,c=0,u=0;for(let l=0;l<s;++l){let d=n[r[l]];if(d===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<t|d,a+=t,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},P5e=(r,e,t)=>{let i=e[e.length-1]==="=",n=(1<<t)-1,s="",o=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],o+=8;o>t;)o-=t,s+=e[n&a>>o];if(o&&(s+=e[n&a<<t-o]),i)for(;s.length*t&7;)s+="=";return s},Kr=({name:r,prefix:e,bitsPerChar:t,alphabet:i})=>Tv({prefix:e,name:r,encode(n){return P5e(n,i,t)},decode(n){return C5e(n,i,t,r)}})});var Jr={};ut(Jr,{base58btc:()=>_a,base58flickr:()=>O5e});var _a,O5e,ei=xe(()=>{f();wa();_a=Lu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),O5e=Lu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var nn={};ut(nn,{base32:()=>mh,base32hex:()=>D5e,base32hexpad:()=>M5e,base32hexpadupper:()=>L5e,base32hexupper:()=>B5e,base32pad:()=>q5e,base32padupper:()=>N5e,base32upper:()=>k5e,base32z:()=>U5e});var mh,k5e,q5e,N5e,D5e,B5e,M5e,L5e,U5e,sn=xe(()=>{f();wa();mh=Kr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),k5e=Kr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),q5e=Kr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),N5e=Kr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),D5e=Kr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),B5e=Kr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),M5e=Kr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),L5e=Kr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),U5e=Kr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var De={};ut(De,{CID:()=>We});var We,F5e,K5e,j5e,cg,V5e,fD,dD,Rv,Cv,z5e,H5e,$5e,Ie=xe(()=>{f();Av();Cn();ei();sn();Bu();We=class{constructor(e,t,i,n){this.code=t,this.version=e,this.multihash=i,this.bytes=n,this.byteOffset=n.byteOffset,this.byteLength=n.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Cv,byteLength:Cv,code:Rv,version:Rv,multihash:Rv,bytes:Rv,_baseCache:Cv,asCID:Cv})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:t}=this;if(e!==cg)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==V5e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return We.createV0(t)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,i=ag(e,t);return We.createV1(this.code,i)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&S6(this.multihash,e.multihash)}toString(e){let{bytes:t,version:i,_baseCache:n}=this;switch(i){case 0:return K5e(t,n,e||_a.encoder);default:return j5e(t,n,e||mh.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return H5e(/^0\.0/,$5e),!!(e&&(e[dD]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof We)return e;if(e!=null&&e.asCID===e){let{version:t,code:i,multihash:n,bytes:s}=e;return new We(t,i,n,s||fD(t,i,n.bytes))}else if(e!=null&&e[dD]===!0){let{version:t,multihash:i,code:n}=e,s=Mu(i);return We.create(t,n,s)}else return null}static create(e,t,i){if(typeof t!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(t!==cg)throw new Error(`Version 0 CID must use dag-pb (code: ${cg}) block encoding`);return new We(e,t,i,i.bytes)}case 1:{let n=fD(e,t,i.bytes);return new We(e,t,i,n)}default:throw new Error("Invalid version")}}static createV0(e){return We.create(0,cg,e)}static createV1(e,t){return We.create(1,e,t)}static decode(e){let[t,i]=We.decodeFirst(e);if(i.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=We.inspectBytes(e),i=t.size-t.multihashSize,n=Ao(e.subarray(i,i+t.multihashSize));if(n.byteLength!==t.multihashSize)throw new Error("Incorrect length");let s=n.subarray(t.multihashSize-t.digestSize),o=new gh(t.multihashCode,t.digestSize,s,n);return[t.version===0?We.createV0(o):We.createV1(t.codec,o),e.subarray(t.size)]}static inspectBytes(e){let t=0,i=()=>{let[d,h]=yh(e.subarray(t));return t+=h,d},n=i(),s=cg;if(n===18?(n=0,t=0):n===1&&(s=i()),n!==0&&n!==1)throw new RangeError(`Invalid CID version ${n}`);let o=t,a=i(),c=i(),u=t+c,l=u-o;return{version:n,codec:s,multihashCode:a,digestSize:c,multihashSize:l,size:u}}static parse(e,t){let[i,n]=F5e(e,t),s=We.decode(n);return s._baseCache.set(i,e),s}},F5e=(r,e)=>{switch(r[0]){case"Q":{let t=e||_a;return[_a.prefix,t.decode(`${_a.prefix}${r}`)]}case _a.prefix:{let t=e||_a;return[_a.prefix,t.decode(r)]}case mh.prefix:{let t=e||mh;return[mh.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},K5e=(r,e,t)=>{let{prefix:i}=t;if(i!==_a.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let n=e.get(i);if(n==null){let s=t.encode(r).slice(1);return e.set(i,s),s}else return n},j5e=(r,e,t)=>{let{prefix:i}=t,n=e.get(i);if(n==null){let s=t.encode(r);return e.set(i,s),s}else return n},cg=112,V5e=18,fD=(r,e,t)=>{let i=yf(r),n=i+yf(e),s=new Uint8Array(n+t.byteLength);return pf(r,s,0),pf(e,s,i),s.set(t,n),s},dD=Symbol.for("@ipld/js-cid/CID"),Rv={writable:!1,configurable:!1,enumerable:!0},Cv={writable:!1,enumerable:!1,configurable:!1},z5e="0.0.0-dev",H5e=(r,e)=>{if(r.test(z5e))console.warn(e);else throw new Error(e)},$5e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});var Pv={};ut(Pv,{base36:()=>G5e,base36upper:()=>W5e});var G5e,W5e,x6=xe(()=>{f();wa();G5e=Lu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),W5e=Lu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var bh={};ut(bh,{base64:()=>Y5e,base64pad:()=>X5e,base64url:()=>Q5e,base64urlpad:()=>Z5e});var Y5e,X5e,Q5e,Z5e,ug=xe(()=>{f();wa();Y5e=Kr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),X5e=Kr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Q5e=Kr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Z5e=Kr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var Ov={};ut(Ov,{base16:()=>J5e,base16upper:()=>eRe});var J5e,eRe,A6=xe(()=>{f();wa();J5e=Kr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),eRe=Kr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var pD=y((TAt,hD)=>{f();"use strict";hD.exports=tRe;function tRe(r,e){for(var t=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)t[i++]=arguments[n++];return new Promise(function(a,c){t[i]=function(l){if(s)if(s=!1,l)c(l);else{for(var d=new Array(arguments.length-1),h=0;h<d.length;)d[h++]=arguments[h];a.apply(null,d)}};try{r.apply(e||null,t)}catch(u){s&&(s=!1,c(u))}})}});var bD=y(mD=>{f();"use strict";var kv=mD;kv.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&e.charAt(t)==="=";)++i;return Math.ceil(e.length*3)/4-i};var vh=new Array(64),yD=new Array(123);for(Io=0;Io<64;)yD[vh[Io]=Io<26?Io+65:Io<52?Io+71:Io<62?Io-4:Io-59|43]=Io++;var Io;kv.encode=function(e,t,i){for(var n=null,s=[],o=0,a=0,c;t<i;){var u=e[t++];switch(a){case 0:s[o++]=vh[u>>2],c=(u&3)<<4,a=1;break;case 1:s[o++]=vh[c|u>>4],c=(u&15)<<2,a=2;break;case 2:s[o++]=vh[c|u>>6],s[o++]=vh[u&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=vh[c],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var gD="invalid encoding";kv.decode=function(e,t,i){for(var n=i,s=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&s>1)break;if((c=yD[c])===void 0)throw Error(gD);switch(s){case 0:o=c,s=1;break;case 1:t[i++]=o<<2|(c&48)>>4,o=c,s=2;break;case 2:t[i++]=(o&15)<<4|(c&60)>>2,o=c,s=3;break;case 3:t[i++]=(o&3)<<6|c,s=0;break}}if(s===1)throw Error(gD);return i-n};kv.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var wD=y((CAt,vD)=>{f();"use strict";vD.exports=qv;function qv(){this._listeners={}}qv.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this};qv.prototype.off=function(e,t){if(e===void 0)this._listeners={};else if(t===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this};qv.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}});var TD=y((PAt,ID)=>{f();"use strict";ID.exports=_D(_D);function _D(r){return typeof Float32Array!="undefined"?function(){var e=new Float32Array([-0]),t=new Uint8Array(e.buffer),i=t[3]===128;function n(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3]}function s(c,u,l){e[0]=c,u[l]=t[3],u[l+1]=t[2],u[l+2]=t[1],u[l+3]=t[0]}r.writeFloatLE=i?n:s,r.writeFloatBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],e[0]}function a(c,u){return t[3]=c[u],t[2]=c[u+1],t[1]=c[u+2],t[0]=c[u+3],e[0]}r.readFloatLE=i?o:a,r.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var c=Math.floor(Math.log(n)/Math.LN2),u=Math.round(n*Math.pow(2,-c)*8388608)&8388607;i((a<<31|c+127<<23|u)>>>0,s,o)}}r.writeFloatLE=e.bind(null,ED),r.writeFloatBE=e.bind(null,SD);function t(i,n,s){var o=i(n,s),a=(o>>31)*2+1,c=o>>>23&255,u=o&8388607;return c===255?u?NaN:a*(1/0):c===0?a*1401298464324817e-60*u:a*Math.pow(2,c-150)*(u+8388608)}r.readFloatLE=t.bind(null,xD),r.readFloatBE=t.bind(null,AD)}(),typeof Float64Array!="undefined"?function(){var e=new Float64Array([-0]),t=new Uint8Array(e.buffer),i=t[7]===128;function n(c,u,l){e[0]=c,u[l]=t[0],u[l+1]=t[1],u[l+2]=t[2],u[l+3]=t[3],u[l+4]=t[4],u[l+5]=t[5],u[l+6]=t[6],u[l+7]=t[7]}function s(c,u,l){e[0]=c,u[l]=t[7],u[l+1]=t[6],u[l+2]=t[5],u[l+3]=t[4],u[l+4]=t[3],u[l+5]=t[2],u[l+6]=t[1],u[l+7]=t[0]}r.writeDoubleLE=i?n:s,r.writeDoubleBE=i?s:n;function o(c,u){return t[0]=c[u],t[1]=c[u+1],t[2]=c[u+2],t[3]=c[u+3],t[4]=c[u+4],t[5]=c[u+5],t[6]=c[u+6],t[7]=c[u+7],e[0]}function a(c,u){return t[7]=c[u],t[6]=c[u+1],t[5]=c[u+2],t[4]=c[u+3],t[3]=c[u+4],t[2]=c[u+5],t[1]=c[u+6],t[0]=c[u+7],e[0]}r.readDoubleLE=i?o:a,r.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,c){var u=o<0?1:0;if(u&&(o=-o),o===0)i(0,a,c+n),i(1/o>0?0:2147483648,a,c+s);else if(isNaN(o))i(0,a,c+n),i(2146959360,a,c+s);else if(o>17976931348623157e292)i(0,a,c+n),i((u<<31|2146435072)>>>0,a,c+s);else{var l;if(o<22250738585072014e-324)l=o/5e-324,i(l>>>0,a,c+n),i((u<<31|l/4294967296)>>>0,a,c+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),l=o*Math.pow(2,-d),i(l*4503599627370496>>>0,a,c+n),i((u<<31|d+1023<<20|l*1048576&1048575)>>>0,a,c+s)}}}r.writeDoubleLE=e.bind(null,ED,0,4),r.writeDoubleBE=e.bind(null,SD,4,0);function t(i,n,s,o,a){var c=i(o,a+n),u=i(o,a+s),l=(u>>31)*2+1,d=u>>>20&2047,h=4294967296*(u&1048575)+c;return d===2047?h?NaN:l*(1/0):d===0?l*5e-324*h:l*Math.pow(2,d-1075)*(h+4503599627370496)}r.readDoubleLE=t.bind(null,xD,0,4),r.readDoubleBE=t.bind(null,AD,4,0)}(),r}function ED(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}function SD(r,e,t){e[t]=r>>>24,e[t+1]=r>>>16&255,e[t+2]=r>>>8&255,e[t+3]=r&255}function xD(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0}function AD(r,e){return(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}});var RD=y((exports,module)=>{f();"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var PD=y(CD=>{f();"use strict";var I6=CD;I6.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?t+=1:i<2048?t+=2:(i&64512)==55296&&(e.charCodeAt(n+1)&64512)==56320?(++n,t+=4):t+=3;return t};I6.read=function(e,t,i){var n=i-t;if(n<1)return"";for(var s=null,o=[],a=0,c;t<i;)c=e[t++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[t++]&63:c>239&&c<365?(c=((c&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[t++]&63)<<6|e[t++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};I6.write=function(e,t,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):(s&64512)==55296&&((o=e.charCodeAt(a+1))&64512)==56320?(s=65536+((s&1023)<<10)+(o&1023),++a,t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128);return i-n}});var kD=y((kAt,OD)=>{f();"use strict";OD.exports=rRe;function rRe(r,e,t){var i=t||8192,n=i>>>1,s=null,o=i;return function(c){if(c<1||c>n)return r(c);o+c>i&&(s=r(i),o=0);var u=e.call(s,o,o+=c);return o&7&&(o=(o|7)+1),u}}});var ND=y((qAt,qD)=>{f();"use strict";qD.exports=Oi;var lg=Fu();function Oi(r,e){this.lo=r>>>0,this.hi=e>>>0}var gf=Oi.zero=new Oi(0,0);gf.toNumber=function(){return 0};gf.zzEncode=gf.zzDecode=function(){return this};gf.length=function(){return 1};var iRe=Oi.zeroHash="\0\0\0\0\0\0\0\0";Oi.fromNumber=function(e){if(e===0)return gf;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new Oi(i,n)};Oi.from=function(e){if(typeof e=="number")return Oi.fromNumber(e);if(lg.isString(e))if(lg.Long)e=lg.Long.fromString(e);else return Oi.fromNumber(parseInt(e,10));return e.low||e.high?new Oi(e.low>>>0,e.high>>>0):gf};Oi.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+i*4294967296)}return this.lo+this.hi*4294967296};Oi.prototype.toLong=function(e){return lg.Long?new lg.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Uu=String.prototype.charCodeAt;Oi.fromHash=function(e){return e===iRe?gf:new Oi((Uu.call(e,0)|Uu.call(e,1)<<8|Uu.call(e,2)<<16|Uu.call(e,3)<<24)>>>0,(Uu.call(e,4)|Uu.call(e,5)<<8|Uu.call(e,6)<<16|Uu.call(e,7)<<24)>>>0)};Oi.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Oi.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Oi.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Oi.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}});var Fu=y(T6=>{f();"use strict";var $e=T6;$e.asPromise=pD();$e.base64=bD();$e.EventEmitter=wD();$e.float=TD();$e.inquire=RD();$e.utf8=PD();$e.pool=kD();$e.LongBits=ND();$e.isNode=Boolean(typeof globalThis!="undefined"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);$e.global=$e.isNode&&globalThis||typeof window!="undefined"&&window||typeof self!="undefined"&&self||T6;$e.emptyArray=Object.freeze?Object.freeze([]):[];$e.emptyObject=Object.freeze?Object.freeze({}):{};$e.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};$e.isString=function(e){return typeof e=="string"||e instanceof String};$e.isObject=function(e){return e&&typeof e=="object"};$e.isset=$e.isSet=function(e,t){var i=e[t];return i!=null&&e.hasOwnProperty(t)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};$e.Buffer=function(){try{var r=$e.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch(e){return null}}();$e._Buffer_from=null;$e._Buffer_allocUnsafe=null;$e.newBuffer=function(e){return typeof e=="number"?$e.Buffer?$e._Buffer_allocUnsafe(e):new $e.Array(e):$e.Buffer?$e._Buffer_from(e):typeof Uint8Array=="undefined"?e:new Uint8Array(e)};$e.Array=typeof Uint8Array!="undefined"?Uint8Array:Array;$e.Long=$e.global.dcodeIO&&$e.global.dcodeIO.Long||$e.global.Long||$e.inquire("long");$e.key2Re=/^true|false|0|1$/;$e.key32Re=/^-?(?:0|[1-9][0-9]*)$/;$e.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;$e.longToHash=function(e){return e?$e.LongBits.from(e).toHash():$e.LongBits.zeroHash};$e.longFromHash=function(e,t){var i=$e.LongBits.fromHash(e);return $e.Long?$e.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))};function DD(r,e,t){for(var i=Object.keys(e),n=0;n<i.length;++n)(r[i[n]]===void 0||!t)&&(r[i[n]]=e[i[n]]);return r}$e.merge=DD;$e.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function BD(r){function e(t,i){if(!(this instanceof e))return new e(t,i);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&DD(this,i)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return r}}),e.prototype.toString=function(){return this.name+": "+this.message},e}$e.newError=BD;$e.ProtocolError=BD("ProtocolError");$e.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(t[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};$e.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}};$e.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};$e._configure=function(){var r=$e.Buffer;if(!r){$e._Buffer_from=$e._Buffer_allocUnsafe=null;return}$e._Buffer_from=r.from!==Uint8Array.from&&r.from||function(t,i){return new r(t,i)},$e._Buffer_allocUnsafe=r.allocUnsafe||function(t){return new r(t)}}});var N6=y((DAt,FD)=>{f();"use strict";FD.exports=kt;var Ns=Fu(),R6,Nv=Ns.LongBits,MD=Ns.base64,LD=Ns.utf8;function fg(r,e,t){this.fn=r,this.len=e,this.next=void 0,this.val=t}function C6(){}function nRe(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function kt(){this.len=0,this.head=new fg(C6,0,0),this.tail=this.head,this.states=null}var UD=function(){return Ns.Buffer?function(){return(kt.create=function(){return new R6})()}:function(){return new kt}};kt.create=UD();kt.alloc=function(e){return new Ns.Array(e)};Ns.Array!==Array&&(kt.alloc=Ns.pool(kt.alloc,Ns.Array.prototype.subarray));kt.prototype._push=function(e,t,i){return this.tail=this.tail.next=new fg(e,t,i),this.len+=t,this};function P6(r,e,t){e[t]=r&255}function sRe(r,e,t){for(;r>127;)e[t++]=r&127|128,r>>>=7;e[t]=r}function O6(r,e){this.len=r,this.next=void 0,this.val=e}O6.prototype=Object.create(fg.prototype);O6.prototype.fn=sRe;kt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new O6((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};kt.prototype.int32=function(e){return e<0?this._push(k6,10,Nv.fromNumber(e)):this.uint32(e)};kt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function k6(r,e,t){for(;r.hi;)e[t++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)e[t++]=r.lo&127|128,r.lo=r.lo>>>7;e[t++]=r.lo}kt.prototype.uint64=function(e){var t=Nv.from(e);return this._push(k6,t.length(),t)};kt.prototype.int64=kt.prototype.uint64;kt.prototype.sint64=function(e){var t=Nv.from(e).zzEncode();return this._push(k6,t.length(),t)};kt.prototype.bool=function(e){return this._push(P6,1,e?1:0)};function q6(r,e,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24}kt.prototype.fixed32=function(e){return this._push(q6,4,e>>>0)};kt.prototype.sfixed32=kt.prototype.fixed32;kt.prototype.fixed64=function(e){var t=Nv.from(e);return this._push(q6,4,t.lo)._push(q6,4,t.hi)};kt.prototype.sfixed64=kt.prototype.fixed64;kt.prototype.float=function(e){return this._push(Ns.float.writeFloatLE,4,e)};kt.prototype.double=function(e){return this._push(Ns.float.writeDoubleLE,8,e)};var oRe=Ns.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};kt.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(P6,1,0);if(Ns.isString(e)){var i=kt.alloc(t=MD.length(e));MD.decode(e,i,0),e=i}return this.uint32(t)._push(oRe,t,e)};kt.prototype.string=function(e){var t=LD.length(e);return t?this.uint32(t)._push(LD.write,t,e):this._push(P6,1,0)};kt.prototype.fork=function(){return this.states=new nRe(this),this.head=this.tail=new fg(C6,0,0),this.len=0,this};kt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new fg(C6,0,0),this.len=0),this};kt.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this};kt.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t};kt._configure=function(r){R6=r,kt.create=UD(),R6._configure()}});var VD=y((BAt,jD)=>{f();"use strict";jD.exports=Ea;var KD=N6();(Ea.prototype=Object.create(KD.prototype)).constructor=Ea;var Ku=Fu();function Ea(){KD.call(this)}Ea._configure=function(){Ea.alloc=Ku._Buffer_allocUnsafe,Ea.writeBytesBuffer=Ku.Buffer&&Ku.Buffer.prototype instanceof Uint8Array&&Ku.Buffer.prototype.set.name==="set"?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]}};Ea.prototype.bytes=function(e){Ku.isString(e)&&(e=Ku._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(Ea.writeBytesBuffer,t,e),this};function aRe(r,e,t){r.length<40?Ku.utf8.write(r,e,t):e.utf8Write?e.utf8Write(r,t):e.write(r,t)}Ea.prototype.string=function(e){var t=Ku.Buffer.byteLength(e);return this.uint32(t),t&&this._push(aRe,t,e),this};Ea._configure()});var M6=y((MAt,WD)=>{f();"use strict";WD.exports=ti;var Sa=Fu(),D6,zD=Sa.LongBits,cRe=Sa.utf8;function To(r,e){return RangeError("index out of range: "+r.pos+" + "+(e||1)+" > "+r.len)}function ti(r){this.buf=r,this.pos=0,this.len=r.length}var HD=typeof Uint8Array!="undefined"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ti(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ti(e);throw Error("illegal buffer")},$D=function(){return Sa.Buffer?function(t){return(ti.create=function(n){return Sa.Buffer.isBuffer(n)?new D6(n):HD(n)})(t)}:HD};ti.create=$D();ti.prototype._slice=Sa.Array.prototype.subarray||Sa.Array.prototype.slice;ti.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,To(this,10);return e}}();ti.prototype.int32=function(){return this.uint32()|0};ti.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function B6(){var r=new zD(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw To(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,r}if(this.len-this.pos>4){for(;e<5;++e)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;e<5;++e){if(this.pos>=this.len)throw To(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}ti.prototype.bool=function(){return this.uint32()!==0};function Dv(r,e){return(r[e-4]|r[e-3]<<8|r[e-2]<<16|r[e-1]<<24)>>>0}ti.prototype.fixed32=function(){if(this.pos+4>this.len)throw To(this,4);return Dv(this.buf,this.pos+=4)};ti.prototype.sfixed32=function(){if(this.pos+4>this.len)throw To(this,4);return Dv(this.buf,this.pos+=4)|0};function GD(){if(this.pos+8>this.len)throw To(this,8);return new zD(Dv(this.buf,this.pos+=4),Dv(this.buf,this.pos+=4))}ti.prototype.float=function(){if(this.pos+4>this.len)throw To(this,4);var e=Sa.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ti.prototype.double=function(){if(this.pos+8>this.len)throw To(this,4);var e=Sa.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ti.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw To(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,i):t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)};ti.prototype.string=function(){var e=this.bytes();return cRe.read(e,0,e.length)};ti.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw To(this,e);this.pos+=e}else do if(this.pos>=this.len)throw To(this);while(this.buf[this.pos++]&128);return this};ti.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!=4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};ti._configure=function(r){D6=r,ti.create=$D(),D6._configure();var e=Sa.Long?"toLong":"toNumber";Sa.merge(ti.prototype,{int64:function(){return B6.call(this)[e](!1)},uint64:function(){return B6.call(this)[e](!0)},sint64:function(){return B6.call(this).zzDecode()[e](!1)},fixed64:function(){return GD.call(this)[e](!0)},sfixed64:function(){return GD.call(this)[e](!1)}})}});var ZD=y((LAt,QD)=>{f();"use strict";QD.exports=mf;var YD=M6();(mf.prototype=Object.create(YD.prototype)).constructor=mf;var XD=Fu();function mf(r){YD.call(this,r)}mf._configure=function(){XD.Buffer&&(mf.prototype._slice=XD.Buffer.prototype.slice)};mf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};mf._configure()});var eB=y((UAt,JD)=>{f();"use strict";JD.exports=dg;var L6=Fu();(dg.prototype=Object.create(L6.EventEmitter.prototype)).constructor=dg;function dg(r,e,t){if(typeof r!="function")throw TypeError("rpcImpl must be a function");L6.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(t)}dg.prototype.rpcCall=function r(e,t,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return L6.asPromise(r,o,e,t,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,t[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(c,u){if(c)return o.emit("error",c,e),s(c);if(u===null){o.end(!0);return}if(!(u instanceof i))try{u=i[o.responseDelimited?"decodeDelimited":"decode"](u)}catch(l){return o.emit("error",l,e),s(l)}return o.emit("data",u,e),s(null,u)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};dg.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var rB=y(tB=>{f();"use strict";var uRe=tB;uRe.Service=eB()});var nB=y((KAt,iB)=>{f();"use strict";iB.exports={}});var aB=y(oB=>{f();"use strict";var Yn=oB;Yn.build="minimal";Yn.Writer=N6();Yn.BufferWriter=VD();Yn.Reader=M6();Yn.BufferReader=ZD();Yn.util=Fu();Yn.rpc=rB();Yn.roots=nB();Yn.configure=sB;function sB(){Yn.util._configure(),Yn.Writer._configure(Yn.BufferWriter),Yn.Reader._configure(Yn.BufferReader)}sB()});var ki=y((VAt,cB)=>{f();"use strict";cB.exports=aB()});var Mv=y((zAt,lB)=>{f();"use strict";var bf=ki(),Bv=bf.Reader,uB=bf.Writer,on=bf.util,Ds=bf.roots["libp2p-crypto-keys"]||(bf.roots["libp2p-crypto-keys"]={});Ds.KeyType=function(){var r={},e=Object.create(r);return e[r[0]="RSA"]=0,e[r[1]="Ed25519"]=1,e[r[2]="Secp256k1"]=2,e}();Ds.PublicKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=on.newBuffer([]),r.encode=function(t,i){return i||(i=uB.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof Bv||(t=Bv.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ds.PublicKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw on.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw on.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ds.PublicKey)return t;var i=new Ds.PublicKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?on.base64.decode(t.Data,i.Data=on.newBuffer(on.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=on.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Ds.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?on.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,bf.util.toJSONOptions)},r}();Ds.PrivateKey=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=on.newBuffer([]),r.encode=function(t,i){return i||(i=uB.create()),i.uint32(8).int32(t.Type),i.uint32(18).bytes(t.Data),i},r.decode=function(t,i){t instanceof Bv||(t=Bv.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ds.PrivateKey;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw on.ProtocolError("missing required 'Type'",{instance:s});if(!s.hasOwnProperty("Data"))throw on.ProtocolError("missing required 'Data'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Ds.PrivateKey)return t;var i=new Ds.PrivateKey;switch(t.Type){case"RSA":case 0:i.Type=0;break;case"Ed25519":case 1:i.Type=1;break;case"Secp256k1":case 2:i.Type=2;break}return t.Data!=null&&(typeof t.Data=="string"?on.base64.decode(t.Data,i.Data=on.newBuffer(on.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.Type=i.enums===String?"RSA":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=on.newBuffer(n.Data)))),t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Ds.KeyType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?on.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,bf.util.toJSONOptions)},r}();lB.exports=Ds});var dt=y((HAt,fB)=>{f();fB.exports={options:{usePureJavaScript:!1}}});var pB=y(($At,hB)=>{f();var U6={};hB.exports=U6;var dB={};U6.encode=function(r,e,t){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(t!==void 0&&typeof t!="number")throw new TypeError('"maxline" must be a number.');var i="";if(!(r instanceof Uint8Array))i=lRe(r,e);else{var n=0,s=e.length,o=e.charAt(0),a=[0];for(n=0;n<r.length;++n){for(var c=0,u=r[n];c<a.length;++c)u+=a[c]<<8,a[c]=u%s,u=u/s|0;for(;u>0;)a.push(u%s),u=u/s|0}for(n=0;r[n]===0&&n<r.length-1;++n)i+=o;for(n=a.length-1;n>=0;--n)i+=e[a[n]]}if(t){var l=new RegExp(".{1,"+t+"}","g");i=i.match(l).join(`\r
`)}return i};U6.decode=function(r,e){if(typeof r!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var t=dB[e];if(!t){t=dB[e]=[];for(var i=0;i<e.length;++i)t[e.charCodeAt(i)]=i}r=r.replace(/\s/g,"");for(var n=e.length,s=e.charAt(0),o=[0],i=0;i<r.length;i++){var a=t[r.charCodeAt(i)];if(a===void 0)return;for(var c=0,u=a;c<o.length;++c)u+=o[c]*n,o[c]=u&255,u>>=8;for(;u>0;)o.push(u&255),u>>=8}for(var l=0;r[l]===s&&l<r.length-1;++l)o.push(0);return typeof Buffer!="undefined"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function lRe(r,e){var t=0,i=e.length,n=e.charAt(0),s=[0];for(t=0;t<r.length();++t){for(var o=0,a=r.at(t);o<s.length;++o)a+=s[o]<<8,s[o]=a%i,a=a/i|0;for(;a>0;)s.push(a%i),a=a/i|0}var c="";for(t=0;r.at(t)===0&&t<r.length()-1;++t)c+=n;for(t=s.length-1;t>=0;--t)c+=e[s[t]];return c}});var Qt=y((GAt,bB)=>{f();var yB=dt(),gB=pB(),re=bB.exports=yB.util=yB.util||{};(function(){if(typeof process!="undefined"&&process.nextTick&&!process.browser){re.nextTick=process.nextTick,typeof setImmediate=="function"?re.setImmediate=setImmediate:re.setImmediate=re.nextTick;return}if(typeof setImmediate=="function"){re.setImmediate=function(){return setImmediate.apply(void 0,arguments)},re.nextTick=function(a){return setImmediate(a)};return}if(re.setImmediate=function(a){setTimeout(a,0)},typeof window!="undefined"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===r){c.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(l){l()})}};var o=a,r="forge.setImmediate",e=[];re.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(r,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver!="undefined"){var t=Date.now(),i=!0,n=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(u){u()})}).observe(n,{attributes:!0});var s=re.setImmediate;re.setImmediate=function(c){Date.now()-t>15?(t=Date.now(),s(c)):(e.push(c),e.length===1&&n.setAttribute("a",i=!i))}}re.nextTick=re.setImmediate})();re.isNodejs=typeof process!="undefined"&&process.versions&&process.versions.node;re.globalScope=function(){return re.isNodejs?globalThis:typeof self=="undefined"?window:self}();re.isArray=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};re.isArrayBuffer=function(r){return typeof ArrayBuffer!="undefined"&&r instanceof ArrayBuffer};re.isArrayBufferView=function(r){return r&&re.isArrayBuffer(r.buffer)&&r.byteLength!==void 0};function hg(r){if(!(r===8||r===16||r===24||r===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+r)}re.ByteBuffer=F6;function F6(r){if(this.data="",this.read=0,typeof r=="string")this.data=r;else if(re.isArrayBuffer(r)||re.isArrayBufferView(r))if(typeof Buffer!="undefined"&&r instanceof Buffer)this.data=r.toString("binary");else{var e=new Uint8Array(r);try{this.data=String.fromCharCode.apply(null,e)}catch(i){for(var t=0;t<e.length;++t)this.putByte(e[t])}}else(r instanceof F6||typeof r=="object"&&typeof r.data=="string"&&typeof r.read=="number")&&(this.data=r.data,this.read=r.read);this._constructedStringLength=0}re.ByteStringBuffer=F6;var fRe=4096;re.ByteStringBuffer.prototype._optimizeConstructedString=function(r){this._constructedStringLength+=r,this._constructedStringLength>fRe&&(this.data.substr(0,1),this._constructedStringLength=0)};re.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};re.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};re.ByteStringBuffer.prototype.putByte=function(r){return this.putBytes(String.fromCharCode(r))};re.ByteStringBuffer.prototype.fillWithByte=function(r,e){r=String.fromCharCode(r);for(var t=this.data;e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return this.data=t,this._optimizeConstructedString(e),this};re.ByteStringBuffer.prototype.putBytes=function(r){return this.data+=r,this._optimizeConstructedString(r.length),this};re.ByteStringBuffer.prototype.putString=function(r){return this.putBytes(re.encodeUtf8(r))};re.ByteStringBuffer.prototype.putInt16=function(r){return this.putBytes(String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt24=function(r){return this.putBytes(String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt32=function(r){return this.putBytes(String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255))};re.ByteStringBuffer.prototype.putInt16Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255))};re.ByteStringBuffer.prototype.putInt24Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255))};re.ByteStringBuffer.prototype.putInt32Le=function(r){return this.putBytes(String.fromCharCode(r&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>24&255))};re.ByteStringBuffer.prototype.putInt=function(r,e){hg(e);var t="";do e-=8,t+=String.fromCharCode(r>>e&255);while(e>0);return this.putBytes(t)};re.ByteStringBuffer.prototype.putSignedInt=function(r,e){return r<0&&(r+=2<<e-1),this.putInt(r,e)};re.ByteStringBuffer.prototype.putBuffer=function(r){return this.putBytes(r.getBytes())};re.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};re.ByteStringBuffer.prototype.getInt16=function(){var r=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,r};re.ByteStringBuffer.prototype.getInt24=function(){var r=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,r};re.ByteStringBuffer.prototype.getInt32=function(){var r=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,r};re.ByteStringBuffer.prototype.getInt16Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,r};re.ByteStringBuffer.prototype.getInt24Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,r};re.ByteStringBuffer.prototype.getInt32Le=function(){var r=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,r};re.ByteStringBuffer.prototype.getInt=function(r){hg(r);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),r-=8;while(r>0);return e};re.ByteStringBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};re.ByteStringBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.ByteStringBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};re.ByteStringBuffer.prototype.at=function(r){return this.data.charCodeAt(this.read+r)};re.ByteStringBuffer.prototype.setAt=function(r,e){return this.data=this.data.substr(0,this.read+r)+String.fromCharCode(e)+this.data.substr(this.read+r+1),this};re.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};re.ByteStringBuffer.prototype.copy=function(){var r=re.createBuffer(this.data);return r.read=this.read,r};re.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};re.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};re.ByteStringBuffer.prototype.truncate=function(r){var e=Math.max(0,this.length()-r);return this.data=this.data.substr(this.read,e),this.read=0,this};re.ByteStringBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.length;++e){var t=this.data.charCodeAt(e);t<16&&(r+="0"),r+=t.toString(16)}return r};re.ByteStringBuffer.prototype.toString=function(){return re.decodeUtf8(this.bytes())};function dRe(r,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var t=re.isArrayBuffer(r),i=re.isArrayBufferView(r);if(t||i){t?this.data=new DataView(r):this.data=new DataView(r.buffer,r.byteOffset,r.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,r!=null&&this.putBytes(r),"writeOffset"in e&&(this.write=e.writeOffset)}re.DataBuffer=dRe;re.DataBuffer.prototype.length=function(){return this.write-this.read};re.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};re.DataBuffer.prototype.accommodate=function(r,e){if(this.length()>=r)return this;e=Math.max(e||this.growSize,r);var t=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),i=new Uint8Array(this.length()+e);return i.set(t),this.data=new DataView(i.buffer),this};re.DataBuffer.prototype.putByte=function(r){return this.accommodate(1),this.data.setUint8(this.write++,r),this};re.DataBuffer.prototype.fillWithByte=function(r,e){this.accommodate(e);for(var t=0;t<e;++t)this.data.setUint8(r);return this};re.DataBuffer.prototype.putBytes=function(r,e){if(re.isArrayBufferView(r)){var t=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),i=t.byteLength-t.byteOffset;this.accommodate(i);var n=new Uint8Array(this.data.buffer,this.write);return n.set(t),this.write+=i,this}if(re.isArrayBuffer(r)){var t=new Uint8Array(r);this.accommodate(t.byteLength);var n=new Uint8Array(this.data.buffer);return n.set(t,this.write),this.write+=t.byteLength,this}if(r instanceof re.DataBuffer||typeof r=="object"&&typeof r.read=="number"&&typeof r.write=="number"&&re.isArrayBufferView(r.data)){var t=new Uint8Array(r.data.byteLength,r.read,r.length());this.accommodate(t.byteLength);var n=new Uint8Array(r.data.byteLength,this.write);return n.set(t),this.write+=t.byteLength,this}if(r instanceof re.ByteStringBuffer&&(r=r.data,e="binary"),e=e||"binary",typeof r=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(r.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.hex.decode(r,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(r.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.base64.decode(r,s,this.write),this;if(e==="utf8"&&(r=re.encodeUtf8(r),e="binary"),e==="binary"||e==="raw")return this.accommodate(r.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=re.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(r.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=re.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+r)};re.DataBuffer.prototype.putBuffer=function(r){return this.putBytes(r),r.clear(),this};re.DataBuffer.prototype.putString=function(r){return this.putBytes(r,"utf16")};re.DataBuffer.prototype.putInt16=function(r){return this.accommodate(2),this.data.setInt16(this.write,r),this.write+=2,this};re.DataBuffer.prototype.putInt24=function(r){return this.accommodate(3),this.data.setInt16(this.write,r>>8&65535),this.data.setInt8(this.write,r>>16&255),this.write+=3,this};re.DataBuffer.prototype.putInt32=function(r){return this.accommodate(4),this.data.setInt32(this.write,r),this.write+=4,this};re.DataBuffer.prototype.putInt16Le=function(r){return this.accommodate(2),this.data.setInt16(this.write,r,!0),this.write+=2,this};re.DataBuffer.prototype.putInt24Le=function(r){return this.accommodate(3),this.data.setInt8(this.write,r>>16&255),this.data.setInt16(this.write,r>>8&65535,!0),this.write+=3,this};re.DataBuffer.prototype.putInt32Le=function(r){return this.accommodate(4),this.data.setInt32(this.write,r,!0),this.write+=4,this};re.DataBuffer.prototype.putInt=function(r,e){hg(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,r>>e&255);while(e>0);return this};re.DataBuffer.prototype.putSignedInt=function(r,e){return hg(e),this.accommodate(e/8),r<0&&(r+=2<<e-1),this.putInt(r,e)};re.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};re.DataBuffer.prototype.getInt16=function(){var r=this.data.getInt16(this.read);return this.read+=2,r};re.DataBuffer.prototype.getInt24=function(){var r=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,r};re.DataBuffer.prototype.getInt32=function(){var r=this.data.getInt32(this.read);return this.read+=4,r};re.DataBuffer.prototype.getInt16Le=function(){var r=this.data.getInt16(this.read,!0);return this.read+=2,r};re.DataBuffer.prototype.getInt24Le=function(){var r=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,r};re.DataBuffer.prototype.getInt32Le=function(){var r=this.data.getInt32(this.read,!0);return this.read+=4,r};re.DataBuffer.prototype.getInt=function(r){hg(r);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),r-=8;while(r>0);return e};re.DataBuffer.prototype.getSignedInt=function(r){var e=this.getInt(r),t=2<<r-2;return e>=t&&(e-=t<<1),e};re.DataBuffer.prototype.getBytes=function(r){var e;return r?(r=Math.min(this.length(),r),e=this.data.slice(this.read,this.read+r),this.read+=r):r===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};re.DataBuffer.prototype.bytes=function(r){return typeof r=="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+r)};re.DataBuffer.prototype.at=function(r){return this.data.getUint8(this.read+r)};re.DataBuffer.prototype.setAt=function(r,e){return this.data.setUint8(r,e),this};re.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};re.DataBuffer.prototype.copy=function(){return new re.DataBuffer(this)};re.DataBuffer.prototype.compact=function(){if(this.read>0){var r=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(r.byteLength);e.set(r),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};re.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};re.DataBuffer.prototype.truncate=function(r){return this.write=Math.max(0,this.length()-r),this.read=Math.min(this.read,this.write),this};re.DataBuffer.prototype.toHex=function(){for(var r="",e=this.read;e<this.data.byteLength;++e){var t=this.data.getUint8(e);t<16&&(r+="0"),r+=t.toString(16)}return r};re.DataBuffer.prototype.toString=function(r){var e=new Uint8Array(this.data,this.read,this.length());if(r=r||"utf8",r==="binary"||r==="raw")return re.binary.raw.encode(e);if(r==="hex")return re.binary.hex.encode(e);if(r==="base64")return re.binary.base64.encode(e);if(r==="utf8")return re.text.utf8.decode(e);if(r==="utf16")return re.text.utf16.decode(e);throw new Error("Invalid encoding: "+r)};re.createBuffer=function(r,e){return e=e||"raw",r!==void 0&&e==="utf8"&&(r=re.encodeUtf8(r)),new re.ByteBuffer(r)};re.fillString=function(r,e){for(var t="";e>0;)e&1&&(t+=r),e>>>=1,e>0&&(r+=r);return t};re.xorBytes=function(r,e,t){for(var i="",n="",s="",o=0,a=0;t>0;--t,++o)n=r.charCodeAt(o)^e.charCodeAt(o),a>=10&&(i+=s,s="",a=0),s+=String.fromCharCode(n),++a;return i+=s,i};re.hexToBytes=function(r){var e="",t=0;for(r.length&!0&&(t=1,e+=String.fromCharCode(parseInt(r[0],16)));t<r.length;t+=2)e+=String.fromCharCode(parseInt(r.substr(t,2),16));return e};re.bytesToHex=function(r){return re.createBuffer(r).toHex()};re.int32ToBytes=function(r){return String.fromCharCode(r>>24&255)+String.fromCharCode(r>>16&255)+String.fromCharCode(r>>8&255)+String.fromCharCode(r&255)};var ju="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Vu=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],mB="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";re.encode64=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.length;)n=r.charCodeAt(a++),s=r.charCodeAt(a++),o=r.charCodeAt(a++),t+=ju.charAt(n>>2),t+=ju.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=ju.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":ju.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};re.decode64=function(r){r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",t,i,n,s,o=0;o<r.length;)t=Vu[r.charCodeAt(o++)-43],i=Vu[r.charCodeAt(o++)-43],n=Vu[r.charCodeAt(o++)-43],s=Vu[r.charCodeAt(o++)-43],e+=String.fromCharCode(t<<2|i>>4),n!==64&&(e+=String.fromCharCode((i&15)<<4|n>>2),s!==64&&(e+=String.fromCharCode((n&3)<<6|s)));return e};re.encodeUtf8=function(r){return unescape(encodeURIComponent(r))};re.decodeUtf8=function(r){return decodeURIComponent(escape(r))};re.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:gB.encode,decode:gB.decode}};re.binary.raw.encode=function(r){return String.fromCharCode.apply(null,r)};re.binary.raw.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};re.binary.hex.encode=re.bytesToHex;re.binary.hex.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/2))),t=t||0;var n=0,s=t;for(r.length&1&&(n=1,i[s++]=parseInt(r[0],16));n<r.length;n+=2)i[s++]=parseInt(r.substr(n,2),16);return e?s-t:i};re.binary.base64.encode=function(r,e){for(var t="",i="",n,s,o,a=0;a<r.byteLength;)n=r[a++],s=r[a++],o=r[a++],t+=ju.charAt(n>>2),t+=ju.charAt((n&3)<<4|s>>4),isNaN(s)?t+="==":(t+=ju.charAt((s&15)<<2|o>>6),t+=isNaN(o)?"=":ju.charAt(o&63)),e&&t.length>e&&(i+=t.substr(0,e)+`\r
`,t=t.substr(e));return i+=t,i};re.binary.base64.decode=function(r,e,t){var i=e;i||(i=new Uint8Array(Math.ceil(r.length/4)*3)),r=r.replace(/[^A-Za-z0-9\+\/\=]/g,""),t=t||0;for(var n,s,o,a,c=0,u=t;c<r.length;)n=Vu[r.charCodeAt(c++)-43],s=Vu[r.charCodeAt(c++)-43],o=Vu[r.charCodeAt(c++)-43],a=Vu[r.charCodeAt(c++)-43],i[u++]=n<<2|s>>4,o!==64&&(i[u++]=(s&15)<<4|o>>2,a!==64&&(i[u++]=(o&3)<<6|a));return e?u-t:i.subarray(0,u)};re.binary.base58.encode=function(r,e){return re.binary.baseN.encode(r,mB,e)};re.binary.base58.decode=function(r,e){return re.binary.baseN.decode(r,mB,e)};re.text={utf8:{},utf16:{}};re.text.utf8.encode=function(r,e,t){r=re.encodeUtf8(r);var i=e;i||(i=new Uint8Array(r.length)),t=t||0;for(var n=t,s=0;s<r.length;++s)i[n++]=r.charCodeAt(s);return e?n-t:i};re.text.utf8.decode=function(r){return re.decodeUtf8(String.fromCharCode.apply(null,r))};re.text.utf16.encode=function(r,e,t){var i=e;i||(i=new Uint8Array(r.length*2));var n=new Uint16Array(i.buffer);t=t||0;for(var s=t,o=t,a=0;a<r.length;++a)n[o++]=r.charCodeAt(a),s+=2;return e?s-t:i};re.text.utf16.decode=function(r){return String.fromCharCode.apply(null,new Uint16Array(r.buffer))};re.deflate=function(r,e,t){if(e=re.decode64(r.deflate(re.encode64(e)).rval),t){var i=2,n=e.charCodeAt(1);n&32&&(i=6),e=e.substring(i,e.length-4)}return e};re.inflate=function(r,e,t){var i=r.inflate(re.encode64(e)).rval;return i===null?null:re.decode64(i)};var K6=function(r,e,t){if(!r)throw new Error("WebStorage not available.");var i;if(t===null?i=r.removeItem(e):(t=re.encode64(JSON.stringify(t)),i=r.setItem(e,t)),typeof i!="undefined"&&i.rval!==!0){var n=new Error(i.error.message);throw n.id=i.error.id,n.name=i.error.name,n}},j6=function(r,e){if(!r)throw new Error("WebStorage not available.");var t=r.getItem(e);if(r.init)if(t.rval===null){if(t.error){var i=new Error(t.error.message);throw i.id=t.error.id,i.name=t.error.name,i}t=null}else t=t.rval;return t!==null&&(t=JSON.parse(re.decode64(t))),t},hRe=function(r,e,t,i){var n=j6(r,e);n===null&&(n={}),n[t]=i,K6(r,e,n)},pRe=function(r,e,t){var i=j6(r,e);return i!==null&&(i=t in i?i[t]:null),i},yRe=function(r,e,t){var i=j6(r,e);if(i!==null&&t in i){delete i[t];var n=!0;for(var s in i){n=!1;break}n&&(i=null),K6(r,e,i)}},gRe=function(r,e){K6(r,e,null)},Lv=function(r,e,t){var i=null;typeof t=="undefined"&&(t=["web","flash"]);var n,s=!1,o=null;for(var a in t){n=t[a];try{if(n==="flash"||n==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");i=r.apply(this,e),s=n==="flash"}(n==="web"||n==="both")&&(e[0]=localStorage,i=r.apply(this,e),s=!0)}catch(c){o=c}if(s)break}if(!s)throw o;return i};re.setItem=function(r,e,t,i,n){Lv(hRe,arguments,n)};re.getItem=function(r,e,t,i){return Lv(pRe,arguments,i)};re.removeItem=function(r,e,t,i){Lv(yRe,arguments,i)};re.clearItems=function(r,e,t){Lv(gRe,arguments,t)};re.parseUrl=function(r){var e=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;e.lastIndex=0;var t=e.exec(r),i=t===null?null:{full:r,scheme:t[1],host:t[2],port:t[3],path:t[4]};return i&&(i.fullHost=i.host,i.port?(i.port!==80&&i.scheme==="http"||i.port!==443&&i.scheme==="https")&&(i.fullHost+=":"+i.port):i.scheme==="http"?i.port=80:i.scheme==="https"&&(i.port=443),i.full=i.scheme+"://"+i.fullHost),i};var Uv=null;re.getQueryVariables=function(r){var e=function(i){for(var n={},s=i.split("&"),o=0;o<s.length;o++){var a=s[o].indexOf("="),c,u;a>0?(c=s[o].substring(0,a),u=s[o].substring(a+1)):(c=s[o],u=null),c in n||(n[c]=[]),!(c in Object.prototype)&&u!==null&&n[c].push(unescape(u))}return n},t;return typeof r=="undefined"?(Uv===null&&(typeof window!="undefined"&&window.location&&window.location.search?Uv=e(window.location.search.substring(1)):Uv={}),t=Uv):t=e(r),t};re.parseFragment=function(r){var e=r,t="",i=r.indexOf("?");i>0&&(e=r.substring(0,i),t=r.substring(i+1));var n=e.split("/");n.length>0&&n[0]===""&&n.shift();var s=t===""?{}:re.getQueryVariables(t);return{pathString:e,queryString:t,path:n,query:s}};re.makeRequest=function(r){var e=re.parseFragment(r),t={path:e.pathString,query:e.queryString,getPath:function(i){return typeof i=="undefined"?e.path:e.path[i]},getQuery:function(i,n){var s;return typeof i=="undefined"?s=e.query:(s=e.query[i],s&&typeof n!="undefined"&&(s=s[n])),s},getQueryLast:function(i,n){var s,o=t.getQuery(i);return o?s=o[o.length-1]:s=n,s}};return t};re.makeLink=function(r,e,t){r=jQuery.isArray(r)?r.join("/"):r;var i=jQuery.param(e||{});return t=t||"",r+(i.length>0?"?"+i:"")+(t.length>0?"#"+t:"")};re.isEmpty=function(r){for(var e in r)if(r.hasOwnProperty(e))return!1;return!0};re.format=function(r){for(var e=/%./g,t,i,n=0,s=[],o=0;t=e.exec(r);){i=r.substring(o,e.lastIndex-2),i.length>0&&s.push(i),o=e.lastIndex;var a=t[0][1];switch(a){case"s":case"o":n<arguments.length?s.push(arguments[n+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+a+"?>")}}return s.push(r.substring(o)),s.join("")};re.formatNumber=function(r,e,t,i){var n=r,s=isNaN(e=Math.abs(e))?2:e,o=t===void 0?",":t,a=i===void 0?".":i,c=n<0?"-":"",u=parseInt(n=Math.abs(+n||0).toFixed(s),10)+"",l=u.length>3?u.length%3:0;return c+(l?u.substr(0,l)+a:"")+u.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+a)+(s?o+Math.abs(n-u).toFixed(s).slice(2):"")};re.formatSize=function(r){return r>=1073741824?r=re.formatNumber(r/1073741824,2,".","")+" GiB":r>=1048576?r=re.formatNumber(r/1048576,2,".","")+" MiB":r>=1024?r=re.formatNumber(r/1024,0)+" KiB":r=re.formatNumber(r,0)+" bytes",r};re.bytesFromIP=function(r){return r.indexOf(".")!==-1?re.bytesFromIPv4(r):r.indexOf(":")!==-1?re.bytesFromIPv6(r):null};re.bytesFromIPv4=function(r){if(r=r.split("."),r.length!==4)return null;for(var e=re.createBuffer(),t=0;t<r.length;++t){var i=parseInt(r[t],10);if(isNaN(i))return null;e.putByte(i)}return e.getBytes()};re.bytesFromIPv6=function(r){var e=0;r=r.split(":").filter(function(o){return o.length===0&&++e,!0});for(var t=(8-r.length+e)*2,i=re.createBuffer(),n=0;n<8;++n){if(!r[n]||r[n].length===0){i.fillWithByte(0,t),t=0;continue}var s=re.hexToBytes(r[n]);s.length<2&&i.putByte(0),i.putBytes(s)}return i.getBytes()};re.bytesToIP=function(r){return r.length===4?re.bytesToIPv4(r):r.length===16?re.bytesToIPv6(r):null};re.bytesToIPv4=function(r){if(r.length!==4)return null;for(var e=[],t=0;t<r.length;++t)e.push(r.charCodeAt(t));return e.join(".")};re.bytesToIPv6=function(r){if(r.length!==16)return null;for(var e=[],t=[],i=0,n=0;n<r.length;n+=2){for(var s=re.bytesToHex(r[n]+r[n+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var o=t[t.length-1],a=e.length;!o||a!==o.end+1?t.push({start:a,end:a}):(o.end=a,o.end-o.start>t[i].end-t[i].start&&(i=t.length-1))}e.push(s)}if(t.length>0){var c=t[i];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};re.estimateCores=function(r,e){if(typeof r=="function"&&(e=r,r={}),r=r||{},"cores"in re&&!r.update)return e(null,re.cores);if(typeof navigator!="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return re.cores=navigator.hardwareConcurrency,e(null,re.cores);if(typeof Worker=="undefined")return re.cores=1,e(null,re.cores);if(typeof Blob=="undefined")return re.cores=2,e(null,re.cores);var t=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));i([],5,16);function i(o,a,c){if(a===0){var u=Math.floor(o.reduce(function(l,d){return l+d},0)/o.length);return re.cores=Math.max(1,u),URL.revokeObjectURL(t),e(null,re.cores)}n(c,function(l,d){o.push(s(c,d)),i(o,a-1,c)})}function n(o,a){for(var c=[],u=[],l=0;l<o;++l){var d=new Worker(t);d.addEventListener("message",function(h){if(u.push(h.data),u.length===o){for(var p=0;p<o;++p)c[p].terminate();a(null,u)}}),c.push(d)}for(var l=0;l<o;++l)c[l].postMessage(l)}function s(o,a){for(var c=[],u=0;u<o;++u)for(var l=a[u],d=c[u]=[],h=0;h<o;++h)if(u!==h){var p=a[h];(l.st>p.st&&l.st<p.et||p.st>l.st&&p.st<l.et)&&d.push(h)}return c.reduce(function(g,b){return Math.max(g,b.length)},0)}}});var wh=y((WAt,vB)=>{f();var pg=dt();pg.pki=pg.pki||{};var V6=vB.exports=pg.pki.oids=pg.oids=pg.oids||{};function Ae(r,e){V6[r]=e,V6[e]=r}function Ht(r,e){V6[r]=e}Ae("1.2.840.113549.1.1.1","rsaEncryption");Ae("1.2.840.113549.1.1.4","md5WithRSAEncryption");Ae("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Ae("1.2.840.113549.1.1.7","RSAES-OAEP");Ae("1.2.840.113549.1.1.8","mgf1");Ae("1.2.840.113549.1.1.9","pSpecified");Ae("1.2.840.113549.1.1.10","RSASSA-PSS");Ae("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Ae("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Ae("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Ae("1.3.101.112","EdDSA25519");Ae("1.2.840.10040.4.3","dsa-with-sha1");Ae("1.3.14.3.2.7","desCBC");Ae("1.3.14.3.2.26","sha1");Ae("2.16.840.1.101.3.4.2.1","sha256");Ae("2.16.840.1.101.3.4.2.2","sha384");Ae("2.16.840.1.101.3.4.2.3","sha512");Ae("1.2.840.113549.2.5","md5");Ae("1.2.840.113549.1.7.1","data");Ae("1.2.840.113549.1.7.2","signedData");Ae("1.2.840.113549.1.7.3","envelopedData");Ae("1.2.840.113549.1.7.4","signedAndEnvelopedData");Ae("1.2.840.113549.1.7.5","digestedData");Ae("1.2.840.113549.1.7.6","encryptedData");Ae("1.2.840.113549.1.9.1","emailAddress");Ae("1.2.840.113549.1.9.2","unstructuredName");Ae("1.2.840.113549.1.9.3","contentType");Ae("1.2.840.113549.1.9.4","messageDigest");Ae("1.2.840.113549.1.9.5","signingTime");Ae("1.2.840.113549.1.9.6","counterSignature");Ae("1.2.840.113549.1.9.7","challengePassword");Ae("1.2.840.113549.1.9.8","unstructuredAddress");Ae("1.2.840.113549.1.9.14","extensionRequest");Ae("1.2.840.113549.1.9.20","friendlyName");Ae("1.2.840.113549.1.9.21","localKeyId");Ae("1.2.840.113549.1.9.22.1","x509Certificate");Ae("1.2.840.113549.1.12.10.1.1","keyBag");Ae("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Ae("1.2.840.113549.1.12.10.1.3","certBag");Ae("1.2.840.113549.1.12.10.1.4","crlBag");Ae("1.2.840.113549.1.12.10.1.5","secretBag");Ae("1.2.840.113549.1.12.10.1.6","safeContentsBag");Ae("1.2.840.113549.1.5.13","pkcs5PBES2");Ae("1.2.840.113549.1.5.12","pkcs5PBKDF2");Ae("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Ae("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Ae("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Ae("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Ae("1.2.840.113549.2.7","hmacWithSHA1");Ae("1.2.840.113549.2.8","hmacWithSHA224");Ae("1.2.840.113549.2.9","hmacWithSHA256");Ae("1.2.840.113549.2.10","hmacWithSHA384");Ae("1.2.840.113549.2.11","hmacWithSHA512");Ae("1.2.840.113549.3.7","des-EDE3-CBC");Ae("2.16.840.1.101.3.4.1.2","aes128-CBC");Ae("2.16.840.1.101.3.4.1.22","aes192-CBC");Ae("2.16.840.1.101.3.4.1.42","aes256-CBC");Ae("2.5.4.3","commonName");Ae("2.5.4.5","serialName");Ae("2.5.4.6","countryName");Ae("2.5.4.7","localityName");Ae("2.5.4.8","stateOrProvinceName");Ae("2.5.4.9","streetAddress");Ae("2.5.4.10","organizationName");Ae("2.5.4.11","organizationalUnitName");Ae("2.5.4.13","description");Ae("2.5.4.15","businessCategory");Ae("2.5.4.17","postalCode");Ae("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Ae("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Ae("2.16.840.1.113730.1.1","nsCertType");Ae("2.16.840.1.113730.1.13","nsComment");Ht("2.5.29.1","authorityKeyIdentifier");Ht("2.5.29.2","keyAttributes");Ht("2.5.29.3","certificatePolicies");Ht("2.5.29.4","keyUsageRestriction");Ht("2.5.29.5","policyMapping");Ht("2.5.29.6","subtreesConstraint");Ht("2.5.29.7","subjectAltName");Ht("2.5.29.8","issuerAltName");Ht("2.5.29.9","subjectDirectoryAttributes");Ht("2.5.29.10","basicConstraints");Ht("2.5.29.11","nameConstraints");Ht("2.5.29.12","policyConstraints");Ht("2.5.29.13","basicConstraints");Ae("2.5.29.14","subjectKeyIdentifier");Ae("2.5.29.15","keyUsage");Ht("2.5.29.16","privateKeyUsagePeriod");Ae("2.5.29.17","subjectAltName");Ae("2.5.29.18","issuerAltName");Ae("2.5.29.19","basicConstraints");Ht("2.5.29.20","cRLNumber");Ht("2.5.29.21","cRLReason");Ht("2.5.29.22","expirationDate");Ht("2.5.29.23","instructionCode");Ht("2.5.29.24","invalidityDate");Ht("2.5.29.25","cRLDistributionPoints");Ht("2.5.29.26","issuingDistributionPoint");Ht("2.5.29.27","deltaCRLIndicator");Ht("2.5.29.28","issuingDistributionPoint");Ht("2.5.29.29","certificateIssuer");Ht("2.5.29.30","nameConstraints");Ae("2.5.29.31","cRLDistributionPoints");Ae("2.5.29.32","certificatePolicies");Ht("2.5.29.33","policyMappings");Ht("2.5.29.34","policyConstraints");Ae("2.5.29.35","authorityKeyIdentifier");Ht("2.5.29.36","policyConstraints");Ae("2.5.29.37","extKeyUsage");Ht("2.5.29.46","freshestCRL");Ht("2.5.29.54","inhibitAnyPolicy");Ae("1.3.6.1.4.1.11129.2.4.2","timestampList");Ae("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Ae("1.3.6.1.5.5.7.3.1","serverAuth");Ae("1.3.6.1.5.5.7.3.2","clientAuth");Ae("1.3.6.1.5.5.7.3.3","codeSigning");Ae("1.3.6.1.5.5.7.3.4","emailProtection");Ae("1.3.6.1.5.5.7.3.8","timeStamping")});var Nc=y((YAt,_B)=>{f();var mr=dt();Qt();wh();var Me=_B.exports=mr.asn1=mr.asn1||{};Me.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Me.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Me.create=function(r,e,t,i,n){if(mr.util.isArray(i)){for(var s=[],o=0;o<i.length;++o)i[o]!==void 0&&s.push(i[o]);i=s}var a={tagClass:r,type:e,constructed:t,composed:t||mr.util.isArray(i),value:i};return n&&"bitStringContents"in n&&(a.bitStringContents=n.bitStringContents,a.original=Me.copy(a)),a};Me.copy=function(r,e){var t;if(mr.util.isArray(r)){t=[];for(var i=0;i<r.length;++i)t.push(Me.copy(r[i],e));return t}return typeof r=="string"?r:(t={tagClass:r.tagClass,type:r.type,constructed:r.constructed,composed:r.composed,value:Me.copy(r.value,e)},e&&!e.excludeBitStringContents&&(t.bitStringContents=r.bitStringContents),t)};Me.equals=function(r,e,t){if(mr.util.isArray(r)){if(!mr.util.isArray(e)||r.length!==e.length)return!1;for(var i=0;i<r.length;++i)if(!Me.equals(r[i],e[i]))return!1;return!0}if(typeof r!=typeof e)return!1;if(typeof r=="string")return r===e;var n=r.tagClass===e.tagClass&&r.type===e.type&&r.constructed===e.constructed&&r.composed===e.composed&&Me.equals(r.value,e.value);return t&&t.includeBitStringContents&&(n=n&&r.bitStringContents===e.bitStringContents),n};Me.getBerValueLength=function(r){var e=r.getByte();if(e!==128){var t,i=e&128;return i?t=r.getInt((e&127)<<3):t=e,t}};function yg(r,e,t){if(t>e){var i=new Error("Too few bytes to parse DER.");throw i.available=r.length(),i.remaining=e,i.requested=t,i}}var mRe=function(r,e){var t=r.getByte();if(e--,t!==128){var i,n=t&128;if(!n)i=t;else{var s=t&127;yg(r,e,s),i=r.getInt(s<<3)}if(i<0)throw new Error("Negative length: "+i);return i}};Me.fromDer=function(r,e){return e===void 0&&(e={strict:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof r=="string"&&(r=mr.util.createBuffer(r)),Fv(r,r.length(),0,e)};function Fv(r,e,t,i){var n;yg(r,e,2);var s=r.getByte();e--;var o=s&192,a=s&31;n=r.length();var c=mRe(r,e);if(e-=n-r.length(),c!==void 0&&c>e){if(i.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=r.length(),u.remaining=e,u.requested=c,u}c=e}var l,d,h=(s&32)==32;if(h)if(l=[],c===void 0)for(;;){if(yg(r,e,2),r.bytes(2)===String.fromCharCode(0,0)){r.getBytes(2),e-=2;break}n=r.length(),l.push(Fv(r,e,t+1,i)),e-=n-r.length()}else for(;c>0;)n=r.length(),l.push(Fv(r,c,t+1,i)),e-=n-r.length(),c-=n-r.length();if(l===void 0&&o===Me.Class.UNIVERSAL&&a===Me.Type.BITSTRING&&(d=r.bytes(c)),l===void 0&&i.decodeBitStrings&&o===Me.Class.UNIVERSAL&&a===Me.Type.BITSTRING&&c>1){var p=r.read,g=e,b=0;if(a===Me.Type.BITSTRING&&(yg(r,e,1),b=r.getByte(),e--),b===0)try{n=r.length();var E={verbose:i.verbose,strict:!0,decodeBitStrings:!0},v=Fv(r,e,t+1,E),A=n-r.length();e-=A,a==Me.Type.BITSTRING&&A++;var R=v.tagClass;A===c&&(R===Me.Class.UNIVERSAL||R===Me.Class.CONTEXT_SPECIFIC)&&(l=[v])}catch(q){}l===void 0&&(r.read=p,e=g)}if(l===void 0){if(c===void 0){if(i.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===Me.Type.BMPSTRING)for(l="";c>0;c-=2)yg(r,e,2),l+=String.fromCharCode(r.getInt16()),e-=2;else l=r.getBytes(c)}var F=d===void 0?null:{bitStringContents:d};return Me.create(o,a,h,l,F)}Me.toDer=function(r){var e=mr.util.createBuffer(),t=r.tagClass|r.type,i=mr.util.createBuffer(),n=!1;if("bitStringContents"in r&&(n=!0,r.original&&(n=Me.equals(r,r.original))),n)i.putBytes(r.bitStringContents);else if(r.composed){r.constructed?t|=32:i.putByte(0);for(var s=0;s<r.value.length;++s)r.value[s]!==void 0&&i.putBuffer(Me.toDer(r.value[s]))}else if(r.type===Me.Type.BMPSTRING)for(var s=0;s<r.value.length;++s)i.putInt16(r.value.charCodeAt(s));else r.type===Me.Type.INTEGER&&r.value.length>1&&(r.value.charCodeAt(0)===0&&(r.value.charCodeAt(1)&128)==0||r.value.charCodeAt(0)===255&&(r.value.charCodeAt(1)&128)==128)?i.putBytes(r.value.substr(1)):i.putBytes(r.value);if(e.putByte(t),i.length()<=127)e.putByte(i.length()&127);else{var o=i.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var s=a.length-1;s>=0;--s)e.putByte(a.charCodeAt(s))}return e.putBuffer(i),e};Me.oidToDer=function(r){var e=r.split("."),t=mr.util.createBuffer();t.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var i,n,s,o,a=2;a<e.length;++a){i=!0,n=[],s=parseInt(e[a],10);do o=s&127,s=s>>>7,i||(o|=128),n.push(o),i=!1;while(s>0);for(var c=n.length-1;c>=0;--c)t.putByte(n[c])}return t};Me.derToOid=function(r){var e;typeof r=="string"&&(r=mr.util.createBuffer(r));var t=r.getByte();e=Math.floor(t/40)+"."+t%40;for(var i=0;r.length()>0;)t=r.getByte(),i=i<<7,t&128?i+=t&127:(e+="."+(i+t),i=0);return e};Me.utcTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,2),10);t=t>=50?1900+t:2e3+t;var i=parseInt(r.substr(2,2),10)-1,n=parseInt(r.substr(4,2),10),s=parseInt(r.substr(6,2),10),o=parseInt(r.substr(8,2),10),a=0;if(r.length>11){var c=r.charAt(10),u=10;c!=="+"&&c!=="-"&&(a=parseInt(r.substr(10,2),10),u+=2)}if(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,0),u&&(c=r.charAt(u),c==="+"||c==="-")){var l=parseInt(r.substr(u+1,2),10),d=parseInt(r.substr(u+4,2),10),h=l*60+d;h*=6e4,c==="+"?e.setTime(+e-h):e.setTime(+e+h)}return e};Me.generalizedTimeToDate=function(r){var e=new Date,t=parseInt(r.substr(0,4),10),i=parseInt(r.substr(4,2),10)-1,n=parseInt(r.substr(6,2),10),s=parseInt(r.substr(8,2),10),o=parseInt(r.substr(10,2),10),a=parseInt(r.substr(12,2),10),c=0,u=0,l=!1;r.charAt(r.length-1)==="Z"&&(l=!0);var d=r.length-5,h=r.charAt(d);if(h==="+"||h==="-"){var p=parseInt(r.substr(d+1,2),10),g=parseInt(r.substr(d+4,2),10);u=p*60+g,u*=6e4,h==="+"&&(u*=-1),l=!0}return r.charAt(14)==="."&&(c=parseFloat(r.substr(14),10)*1e3),l?(e.setUTCFullYear(t,i,n),e.setUTCHours(s,o,a,c),e.setTime(+e+u)):(e.setFullYear(t,i,n),e.setHours(s,o,a,c)),e};Me.dateToUtcTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push((""+r.getUTCFullYear()).substr(2)),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Me.dateToGeneralizedTime=function(r){if(typeof r=="string")return r;var e="",t=[];t.push(""+r.getUTCFullYear()),t.push(""+(r.getUTCMonth()+1)),t.push(""+r.getUTCDate()),t.push(""+r.getUTCHours()),t.push(""+r.getUTCMinutes()),t.push(""+r.getUTCSeconds());for(var i=0;i<t.length;++i)t[i].length<2&&(e+="0"),e+=t[i];return e+="Z",e};Me.integerToDer=function(r){var e=mr.util.createBuffer();if(r>=-128&&r<128)return e.putSignedInt(r,8);if(r>=-32768&&r<32768)return e.putSignedInt(r,16);if(r>=-8388608&&r<8388608)return e.putSignedInt(r,24);if(r>=-2147483648&&r<2147483648)return e.putSignedInt(r,32);var t=new Error("Integer too large; max is 32-bits.");throw t.integer=r,t};Me.derToInteger=function(r){typeof r=="string"&&(r=mr.util.createBuffer(r));var e=r.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return r.getSignedInt(e)};Me.validate=function(r,e,t,i){var n=!1;if((r.tagClass===e.tagClass||typeof e.tagClass=="undefined")&&(r.type===e.type||typeof e.type=="undefined"))if(r.constructed===e.constructed||typeof e.constructed=="undefined"){if(n=!0,e.value&&mr.util.isArray(e.value))for(var s=0,o=0;n&&o<e.value.length;++o)n=e.value[o].optional||!1,r.value[s]&&(n=Me.validate(r.value[s],e.value[o],t,i),n?++s:e.value[o].optional&&(n=!0)),!n&&i&&i.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+r.value.length+'"');if(n&&t&&(e.capture&&(t[e.capture]=r.value),e.captureAsn1&&(t[e.captureAsn1]=r),e.captureBitStringContents&&"bitStringContents"in r&&(t[e.captureBitStringContents]=r.bitStringContents),e.captureBitStringValue&&"bitStringContents"in r)){var a;if(r.bitStringContents.length<2)t[e.captureBitStringValue]="";else{var c=r.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");t[e.captureBitStringValue]=r.bitStringContents.slice(1)}}}else i&&i.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+r.constructed+'"');else i&&(r.tagClass!==e.tagClass&&i.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+r.tagClass+'"'),r.type!==e.type&&i.push("["+e.name+'] Expected type "'+e.type+'", got "'+r.type+'"'));return n};var wB=/[^\\u0000-\\u00ff]/;Me.prettyPrint=function(r,e,t){var i="";e=e||0,t=t||2,e>0&&(i+=`
`);for(var n="",s=0;s<e*t;++s)n+=" ";switch(i+=n+"Tag: ",r.tagClass){case Me.Class.UNIVERSAL:i+="Universal:";break;case Me.Class.APPLICATION:i+="Application:";break;case Me.Class.CONTEXT_SPECIFIC:i+="Context-Specific:";break;case Me.Class.PRIVATE:i+="Private:";break}if(r.tagClass===Me.Class.UNIVERSAL)switch(i+=r.type,r.type){case Me.Type.NONE:i+=" (None)";break;case Me.Type.BOOLEAN:i+=" (Boolean)";break;case Me.Type.INTEGER:i+=" (Integer)";break;case Me.Type.BITSTRING:i+=" (Bit string)";break;case Me.Type.OCTETSTRING:i+=" (Octet string)";break;case Me.Type.NULL:i+=" (Null)";break;case Me.Type.OID:i+=" (Object Identifier)";break;case Me.Type.ODESC:i+=" (Object Descriptor)";break;case Me.Type.EXTERNAL:i+=" (External or Instance of)";break;case Me.Type.REAL:i+=" (Real)";break;case Me.Type.ENUMERATED:i+=" (Enumerated)";break;case Me.Type.EMBEDDED:i+=" (Embedded PDV)";break;case Me.Type.UTF8:i+=" (UTF8)";break;case Me.Type.ROID:i+=" (Relative Object Identifier)";break;case Me.Type.SEQUENCE:i+=" (Sequence)";break;case Me.Type.SET:i+=" (Set)";break;case Me.Type.PRINTABLESTRING:i+=" (Printable String)";break;case Me.Type.IA5String:i+=" (IA5String (ASCII))";break;case Me.Type.UTCTIME:i+=" (UTC time)";break;case Me.Type.GENERALIZEDTIME:i+=" (Generalized time)";break;case Me.Type.BMPSTRING:i+=" (BMP String)";break}else i+=r.type;if(i+=`
`,i+=n+"Constructed: "+r.constructed+`
`,r.composed){for(var o=0,a="",s=0;s<r.value.length;++s)r.value[s]!==void 0&&(o+=1,a+=Me.prettyPrint(r.value[s],e+1,t),s+1<r.value.length&&(a+=","));i+=n+"Sub values: "+o+a}else{if(i+=n+"Value: ",r.type===Me.Type.OID){var c=Me.derToOid(r.value);i+=c,mr.pki&&mr.pki.oids&&c in mr.pki.oids&&(i+=" ("+mr.pki.oids[c]+") ")}if(r.type===Me.Type.INTEGER)try{i+=Me.derToInteger(r.value)}catch(l){i+="0x"+mr.util.bytesToHex(r.value)}else if(r.type===Me.Type.BITSTRING){if(r.value.length>1?i+="0x"+mr.util.bytesToHex(r.value.slice(1)):i+="(none)",r.value.length>0){var u=r.value.charCodeAt(0);u==1?i+=" (1 unused bit shown)":u>1&&(i+=" ("+u+" unused bits shown)")}}else r.type===Me.Type.OCTETSTRING?(wB.test(r.value)||(i+="("+r.value+") "),i+="0x"+mr.util.bytesToHex(r.value)):r.type===Me.Type.UTF8?i+=mr.util.decodeUtf8(r.value):r.type===Me.Type.PRINTABLESTRING||r.type===Me.Type.IA5String?i+=r.value:wB.test(r.value)?i+="0x"+mr.util.bytesToHex(r.value):r.value.length===0?i+="[null]":i+=r.value}return i}});var H6=y((XAt,EB)=>{f();var qi=dt();Qt();EB.exports=qi.cipher=qi.cipher||{};qi.cipher.algorithms=qi.cipher.algorithms||{};qi.cipher.createCipher=function(r,e){var t=r;if(typeof t=="string"&&(t=qi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new qi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!1})};qi.cipher.createDecipher=function(r,e){var t=r;if(typeof t=="string"&&(t=qi.cipher.getAlgorithm(t),t&&(t=t())),!t)throw new Error("Unsupported algorithm: "+r);return new qi.cipher.BlockCipher({algorithm:t,key:e,decrypt:!0})};qi.cipher.registerAlgorithm=function(r,e){r=r.toUpperCase(),qi.cipher.algorithms[r]=e};qi.cipher.getAlgorithm=function(r){return r=r.toUpperCase(),r in qi.cipher.algorithms?qi.cipher.algorithms[r]:null};var z6=qi.cipher.BlockCipher=function(r){this.algorithm=r.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=r.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=r.decrypt,this.algorithm.initialize(r)};z6.prototype.start=function(r){r=r||{};var e={};for(var t in r)e[t]=r[t];e.decrypt=this._decrypt,this._finish=!1,this._input=qi.util.createBuffer(),this.output=r.output||qi.util.createBuffer(),this.mode.start(e)};z6.prototype.update=function(r){for(r&&this._input.putBuffer(r);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};z6.prototype.finish=function(r){r&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(t){return r(this.blockSize,t,!1)},this.mode.unpad=function(t){return r(this.blockSize,t,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var G6=y((QAt,SB)=>{f();var Ni=dt();Qt();Ni.cipher=Ni.cipher||{};var vt=SB.exports=Ni.cipher.modes=Ni.cipher.modes||{};vt.ecb=function(r){r=r||{},this.name="ECB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};vt.ecb.prototype.start=function(r){};vt.ecb.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};vt.ecb.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i])};vt.ecb.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};vt.ecb.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};vt.cbc=function(r){r=r||{},this.name="CBC",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};vt.cbc.prototype.start=function(r){if(r.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in r)this._iv=Kv(r.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};vt.cbc.prototype.encrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=this._prev[i]^r.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]);this._prev=this._outBlock};vt.cbc.prototype.decrypt=function(r,e,t){if(r.length()<this.blockSize&&!(t&&r.length()>0))return!0;for(var i=0;i<this._ints;++i)this._inBlock[i]=r.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._prev[i]^this._outBlock[i]);this._prev=this._inBlock.slice(0)};vt.cbc.prototype.pad=function(r,e){var t=r.length()===this.blockSize?this.blockSize:this.blockSize-r.length();return r.fillWithByte(t,t),!0};vt.cbc.prototype.unpad=function(r,e){if(e.overflow>0)return!1;var t=r.length(),i=r.at(t-1);return i>this.blockSize<<2?!1:(r.truncate(i),!0)};vt.cfb=function(r){r=r||{},this.name="CFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Ni.util.createBuffer(),this._partialBytes=0};vt.cfb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=Kv(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.cfb.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32()^this._outBlock[n],e.putInt32(this._inBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32()^this._outBlock[n],this._partialOutput.putInt32(this._partialBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.cfb.prototype.decrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)this._inBlock[n]=r.getInt32(),e.putInt32(this._inBlock[n]^this._outBlock[n]);return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialBlock[n]=r.getInt32(),this._partialOutput.putInt32(this._partialBlock[n]^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._partialBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.ofb=function(r){r=r||{},this.name="OFB",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ni.util.createBuffer(),this._partialBytes=0};vt.ofb.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=Kv(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.ofb.prototype.encrypt=function(r,e,t){var i=r.length();if(r.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]),this._inBlock[n]=this._outBlock[n];return}var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0)r.read-=this.blockSize;else for(var n=0;n<this._ints;++n)this._inBlock[n]=this._outBlock[n];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0};vt.ofb.prototype.decrypt=vt.ofb.prototype.encrypt;vt.ctr=function(r){r=r||{},this.name="CTR",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Ni.util.createBuffer(),this._partialBytes=0};vt.ctr.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");this._iv=Kv(r.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};vt.ctr.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize)for(var n=0;n<this._ints;++n)e.putInt32(r.getInt32()^this._outBlock[n]);else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s>0&&(r.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}jv(this._inBlock)};vt.ctr.prototype.decrypt=vt.ctr.prototype.encrypt;vt.gcm=function(r){r=r||{},this.name="GCM",this.cipher=r.cipher,this.blockSize=r.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Ni.util.createBuffer(),this._partialBytes=0,this._R=3774873600};vt.gcm.prototype.start=function(r){if(!("iv"in r))throw new Error("Invalid IV parameter.");var e=Ni.util.createBuffer(r.iv);this._cipherLength=0;var t;if("additionalData"in r?t=Ni.util.createBuffer(r.additionalData):t=Ni.util.createBuffer(),"tagLength"in r?this._tagLength=r.tagLength:this._tagLength=128,this._tag=null,r.decrypt&&(this._tag=Ni.util.createBuffer(r.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=e.length();if(i===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat($6(i*8)))}this._inBlock=this._j0.slice(0),jv(this._inBlock),this._partialBytes=0,t=Ni.util.createBuffer(t),this._aDataLength=$6(t.length()*8);var n=t.length()%this.blockSize;for(n&&t.fillWithByte(0,this.blockSize-n),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])};vt.gcm.prototype.encrypt=function(r,e,t){var i=r.length();if(i===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&i>=this.blockSize){for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^=r.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-i)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var n=0;n<this._ints;++n)this._partialOutput.putInt32(r.getInt32()^this._outBlock[n]);if(s<=0||t){if(t){var o=i%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var n=0;n<this._ints;++n)this._outBlock[n]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!t)return r.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),jv(this._inBlock)};vt.gcm.prototype.decrypt=function(r,e,t){var i=r.length();if(i<this.blockSize&&!(t&&i>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),jv(this._inBlock),this._hashBlock[0]=r.getInt32(),this._hashBlock[1]=r.getInt32(),this._hashBlock[2]=r.getInt32(),this._hashBlock[3]=r.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]^this._hashBlock[n]);i<this.blockSize?this._cipherLength+=i%this.blockSize:this._cipherLength+=this.blockSize};vt.gcm.prototype.afterFinish=function(r,e){var t=!0;e.decrypt&&e.overflow&&r.truncate(this.blockSize-e.overflow),this.tag=Ni.util.createBuffer();var i=this._aDataLength.concat($6(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,i);var n=[];this.cipher.encrypt(this._j0,n);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^n[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(t=!1),t};vt.gcm.prototype.multiply=function(r,e){for(var t=[0,0,0,0],i=e.slice(0),n=0;n<128;++n){var s=r[n/32|0]&1<<31-n%32;s&&(t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]),this.pow(i,i)}return t};vt.gcm.prototype.pow=function(r,e){for(var t=r[3]&1,i=3;i>0;--i)e[i]=r[i]>>>1|(r[i-1]&1)<<31;e[0]=r[0]>>>1,t&&(e[0]^=this._R)};vt.gcm.prototype.tableMultiply=function(r){for(var e=[0,0,0,0],t=0;t<32;++t){var i=t/8|0,n=r[i]>>>(7-t%8)*4&15,s=this._m[t][n];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};vt.gcm.prototype.ghash=function(r,e,t){return e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3],this.tableMultiply(e)};vt.gcm.prototype.generateHashTable=function(r,e){for(var t=8/e,i=4*t,n=16*t,s=new Array(n),o=0;o<n;++o){var a=[0,0,0,0],c=o/i|0,u=(i-1-o%i)*e;a[c]=1<<e-1<<u,s[o]=this.generateSubHashTable(this.multiply(a,r),e)}return s};vt.gcm.prototype.generateSubHashTable=function(r,e){var t=1<<e,i=t>>>1,n=new Array(t);n[i]=r.slice(0);for(var s=i>>>1;s>0;)this.pow(n[2*s],n[s]=[]),s>>=1;for(s=2;s<i;){for(var o=1;o<s;++o){var a=n[s],c=n[o];n[s+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}s*=2}for(n[0]=[0,0,0,0],s=i+1;s<t;++s){var u=n[s^i];n[s]=[r[0]^u[0],r[1]^u[1],r[2]^u[2],r[3]^u[3]]}return n};function Kv(r,e){if(typeof r=="string"&&(r=Ni.util.createBuffer(r)),Ni.util.isArray(r)&&r.length>4){var t=r;r=Ni.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}if(r.length()<e)throw new Error("Invalid IV length; got "+r.length()+" bytes and expected "+e+" bytes.");if(!Ni.util.isArray(r)){for(var n=[],s=e/4,i=0;i<s;++i)n.push(r.getInt32());r=n}return r}function jv(r){r[r.length-1]=r[r.length-1]+1&4294967295}function $6(r){return[r/4294967296|0,r&4294967295]}});var Sh=y((ZAt,TB)=>{f();var sr=dt();H6();G6();Qt();TB.exports=sr.aes=sr.aes||{};sr.aes.startEncrypting=function(r,e,t,i){var n=Vv({key:r,output:t,decrypt:!1,mode:i});return n.start(e),n};sr.aes.createEncryptionCipher=function(r,e){return Vv({key:r,output:null,decrypt:!1,mode:e})};sr.aes.startDecrypting=function(r,e,t,i){var n=Vv({key:r,output:t,decrypt:!0,mode:i});return n.start(e),n};sr.aes.createDecryptionCipher=function(r,e){return Vv({key:r,output:null,decrypt:!0,mode:e})};sr.aes.Algorithm=function(r,e){W6||AB();var t=this;t.name=r,t.mode=new e({blockSize:16,cipher:{encrypt:function(i,n){return X6(t._w,i,n,!1)},decrypt:function(i,n){return X6(t._w,i,n,!0)}}}),t._init=!1};sr.aes.Algorithm.prototype.initialize=function(r){if(!this._init){var e=r.key,t;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=sr.util.createBuffer(e);else if(sr.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){t=e,e=sr.util.createBuffer();for(var i=0;i<t.length;++i)e.putByte(t[i])}if(!sr.util.isArray(e)){t=e,e=[];var n=t.length();if(n===16||n===24||n===32){n=n>>>2;for(var i=0;i<n;++i)e.push(t.getInt32())}}if(!sr.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=IB(e,r.decrypt&&!o),this._init=!0}};sr.aes._expandKey=function(r,e){return W6||AB(),IB(r,e)};sr.aes._updateBlock=X6;_h("AES-ECB",sr.cipher.modes.ecb);_h("AES-CBC",sr.cipher.modes.cbc);_h("AES-CFB",sr.cipher.modes.cfb);_h("AES-OFB",sr.cipher.modes.ofb);_h("AES-CTR",sr.cipher.modes.ctr);_h("AES-GCM",sr.cipher.modes.gcm);function _h(r,e){var t=function(){return new sr.aes.Algorithm(r,e)};sr.cipher.registerAlgorithm(r,t)}var W6=!1,Eh=4,Pn,Y6,xB,vf,Ro;function AB(){W6=!0,xB=[0,1,2,4,8,16,32,64,128,27,54];for(var r=new Array(256),e=0;e<128;++e)r[e]=e<<1,r[e+128]=e+128<<1^283;Pn=new Array(256),Y6=new Array(256),vf=new Array(4),Ro=new Array(4);for(var e=0;e<4;++e)vf[e]=new Array(256),Ro[e]=new Array(256);for(var t=0,i=0,n,s,o,a,c,u,l,e=0;e<256;++e){a=i^i<<1^i<<2^i<<3^i<<4,a=a>>8^a&255^99,Pn[t]=a,Y6[a]=t,c=r[a],n=r[t],s=r[n],o=r[s],u=c<<24^a<<16^a<<8^(a^c),l=(n^s^o)<<24^(t^o)<<16^(t^s^o)<<8^(t^n^o);for(var d=0;d<4;++d)vf[d][t]=u,Ro[d][a]=l,u=u<<24|u>>>8,l=l<<24|l>>>8;t===0?t=i=1:(t=n^r[r[r[n^o]]],i^=r[r[i]])}}function IB(r,e){for(var t=r.slice(0),i,n=1,s=t.length,o=s+6+1,a=Eh*o,c=s;c<a;++c)i=t[c-1],c%s==0?(i=Pn[i>>>16&255]<<24^Pn[i>>>8&255]<<16^Pn[i&255]<<8^Pn[i>>>24]^xB[n]<<24,n++):s>6&&c%s==4&&(i=Pn[i>>>24]<<24^Pn[i>>>16&255]<<16^Pn[i>>>8&255]<<8^Pn[i&255]),t[c]=t[c-s]^i;if(e){var u,l=Ro[0],d=Ro[1],h=Ro[2],p=Ro[3],g=t.slice(0);a=t.length;for(var c=0,b=a-Eh;c<a;c+=Eh,b-=Eh)if(c===0||c===a-Eh)g[c]=t[b],g[c+1]=t[b+3],g[c+2]=t[b+2],g[c+3]=t[b+1];else for(var E=0;E<Eh;++E)u=t[b+E],g[c+(3&-E)]=l[Pn[u>>>24]]^d[Pn[u>>>16&255]]^h[Pn[u>>>8&255]]^p[Pn[u&255]];t=g}return t}function X6(r,e,t,i){var n=r.length/4-1,s,o,a,c,u;i?(s=Ro[0],o=Ro[1],a=Ro[2],c=Ro[3],u=Y6):(s=vf[0],o=vf[1],a=vf[2],c=vf[3],u=Pn);var l,d,h,p,g,b,E;l=e[0]^r[0],d=e[i?3:1]^r[1],h=e[2]^r[2],p=e[i?1:3]^r[3];for(var v=3,A=1;A<n;++A)g=s[l>>>24]^o[d>>>16&255]^a[h>>>8&255]^c[p&255]^r[++v],b=s[d>>>24]^o[h>>>16&255]^a[p>>>8&255]^c[l&255]^r[++v],E=s[h>>>24]^o[p>>>16&255]^a[l>>>8&255]^c[d&255]^r[++v],p=s[p>>>24]^o[l>>>16&255]^a[d>>>8&255]^c[h&255]^r[++v],l=g,d=b,h=E;t[0]=u[l>>>24]<<24^u[d>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^r[++v],t[i?3:1]=u[d>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[l&255]^r[++v],t[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[l>>>8&255]<<8^u[d&255]^r[++v],t[i?1:3]=u[p>>>24]<<24^u[l>>>16&255]<<16^u[d>>>8&255]<<8^u[h&255]^r[++v]}function Vv(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="AES-"+e,i;r.decrypt?i=sr.cipher.createDecipher(t,r.key):i=sr.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof sr.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var Hv=y((JAt,CB)=>{f();var br=dt();H6();G6();Qt();CB.exports=br.des=br.des||{};br.des.startEncrypting=function(r,e,t,i){var n=zv({key:r,output:t,decrypt:!1,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};br.des.createEncryptionCipher=function(r,e){return zv({key:r,output:null,decrypt:!1,mode:e})};br.des.startDecrypting=function(r,e,t,i){var n=zv({key:r,output:t,decrypt:!0,mode:i||(e===null?"ECB":"CBC")});return n.start(e),n};br.des.createDecryptionCipher=function(r,e){return zv({key:r,output:null,decrypt:!0,mode:e})};br.des.Algorithm=function(r,e){var t=this;t.name=r,t.mode=new e({blockSize:8,cipher:{encrypt:function(i,n){return RB(t._keys,i,n,!1)},decrypt:function(i,n){return RB(t._keys,i,n,!0)}}}),t._init=!1};br.des.Algorithm.prototype.initialize=function(r){if(!this._init){var e=br.util.createBuffer(r.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=IRe(e),this._init=!0}};xa("DES-ECB",br.cipher.modes.ecb);xa("DES-CBC",br.cipher.modes.cbc);xa("DES-CFB",br.cipher.modes.cfb);xa("DES-OFB",br.cipher.modes.ofb);xa("DES-CTR",br.cipher.modes.ctr);xa("3DES-ECB",br.cipher.modes.ecb);xa("3DES-CBC",br.cipher.modes.cbc);xa("3DES-CFB",br.cipher.modes.cfb);xa("3DES-OFB",br.cipher.modes.ofb);xa("3DES-CTR",br.cipher.modes.ctr);function xa(r,e){var t=function(){return new br.des.Algorithm(r,e)};br.cipher.registerAlgorithm(r,t)}var bRe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],vRe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],wRe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],_Re=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],ERe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],SRe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],xRe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],ARe=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function IRe(r){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],t=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],n=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],d=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],b=r.length()>8?3:1,E=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],A=0,R,F=0;F<b;F++){var q=r.getInt32(),N=r.getInt32();R=(q>>>4^N)&252645135,N^=R,q^=R<<4,R=(N>>>-16^q)&65535,q^=R,N^=R<<-16,R=(q>>>2^N)&858993459,N^=R,q^=R<<2,R=(N>>>-16^q)&65535,q^=R,N^=R<<-16,R=(q>>>1^N)&1431655765,N^=R,q^=R<<1,R=(N>>>8^q)&16711935,q^=R,N^=R<<8,R=(q>>>1^N)&1431655765,N^=R,q^=R<<1,R=q<<8|N>>>20&240,q=N<<24|N<<8&16711680|N>>>8&65280|N>>>24&240,N=R;for(var z=0;z<v.length;++z){v[z]?(q=q<<2|q>>>26,N=N<<2|N>>>26):(q=q<<1|q>>>27,N=N<<1|N>>>27),q&=-15,N&=-15;var G=e[q>>>28]|t[q>>>24&15]|i[q>>>20&15]|n[q>>>16&15]|s[q>>>12&15]|o[q>>>8&15]|a[q>>>4&15],Y=c[N>>>28]|u[N>>>24&15]|l[N>>>20&15]|d[N>>>16&15]|h[N>>>12&15]|p[N>>>8&15]|g[N>>>4&15];R=(Y>>>16^G)&65535,E[A++]=G^R,E[A++]=Y^R<<16}}return E}function RB(r,e,t,i){var n=r.length===32?3:9,s;n===3?s=i?[30,-2,-2]:[0,32,2]:s=i?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var u=0;u<n;u+=3){for(var l=s[u+1],d=s[u+2],h=s[u];h!=l;h+=d){var p=c^r[h],g=(c>>>4|c<<28)^r[h+1];o=a,a=c,c=o^(vRe[p>>>24&63]|_Re[p>>>16&63]|SRe[p>>>8&63]|ARe[p&63]|bRe[g>>>24&63]|wRe[g>>>16&63]|ERe[g>>>8&63]|xRe[g&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,t[0]=a,t[1]=c}function zv(r){r=r||{};var e=(r.mode||"CBC").toUpperCase(),t="DES-"+e,i;r.decrypt?i=br.cipher.createDecipher(t,r.key):i=br.cipher.createCipher(t,r.key);var n=i.start;return i.start=function(s,o){var a=null;o instanceof br.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=s,n.call(i,o)},i}});var zu=y((eIt,PB)=>{f();var $v=dt();PB.exports=$v.md=$v.md||{};$v.md.algorithms=$v.md.algorithms||{}});var kB=y((tIt,OB)=>{f();var Dc=dt();zu();Qt();var TRe=OB.exports=Dc.hmac=Dc.hmac||{};TRe.create=function(){var r=null,e=null,t=null,i=null,n={};return n.start=function(s,o){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Dc.md.algorithms)e=Dc.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(o===null)o=r;else{if(typeof o=="string")o=Dc.util.createBuffer(o);else if(Dc.util.isArray(o)){var a=o;o=Dc.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var u=o.length();u>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),t=Dc.util.createBuffer(),i=Dc.util.createBuffer(),u=o.length();for(var c=0;c<u;++c){var a=o.at(c);t.putByte(54^a),i.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,c=0;c<a;++c)t.putByte(54),i.putByte(92);r=o,t=t.bytes(),i=i.bytes()}e.start(),e.update(t)},n.update=function(s){e.update(s)},n.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(i),e.update(s),e.digest()},n.digest=n.getMac,n}});var xh=y(()=>{f()});var Q6=y((nIt,qB)=>{f();var On=dt();kB();zu();Qt();var RRe=On.pkcs5=On.pkcs5||{},Bc;On.util.isNodejs&&!On.options.usePureJavaScript&&(Bc=xh());qB.exports=On.pbkdf2=RRe.pbkdf2=function(r,e,t,i,n,s){if(typeof n=="function"&&(s=n,n=null),On.util.isNodejs&&!On.options.usePureJavaScript&&Bc.pbkdf2&&(n===null||typeof n!="object")&&(Bc.pbkdf2Sync.length>4||!n||n==="sha1"))return typeof n!="string"&&(n="sha1"),r=Buffer.from(r,"binary"),e=Buffer.from(e,"binary"),s?Bc.pbkdf2Sync.length===4?Bc.pbkdf2(r,e,t,i,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Bc.pbkdf2(r,e,t,i,n,function(R,F){if(R)return s(R);s(null,F.toString("binary"))}):Bc.pbkdf2Sync.length===4?Bc.pbkdf2Sync(r,e,t,i).toString("binary"):Bc.pbkdf2Sync(r,e,t,i,n).toString("binary");if((typeof n=="undefined"||n===null)&&(n="sha1"),typeof n=="string"){if(!(n in On.md.algorithms))throw new Error("Unknown hash algorithm: "+n);n=On.md[n].create()}var o=n.digestLength;if(i>4294967295*o){var a=new Error("Derived key is too long.");if(s)return s(a);throw a}var c=Math.ceil(i/o),u=i-(c-1)*o,l=On.hmac.create();l.start(n,r);var d="",h,p,g;if(!s){for(var b=1;b<=c;++b){l.start(null,null),l.update(e),l.update(On.util.int32ToBytes(b)),h=g=l.digest().getBytes();for(var E=2;E<=t;++E)l.start(null,null),l.update(g),p=l.digest().getBytes(),h=On.util.xorBytes(h,p,o),g=p;d+=b<c?h:h.substr(0,u)}return d}var b=1,E;function v(){if(b>c)return s(null,d);l.start(null,null),l.update(e),l.update(On.util.int32ToBytes(b)),h=g=l.digest().getBytes(),E=2,A()}function A(){if(E<=t)return l.start(null,null),l.update(g),p=l.digest().getBytes(),h=On.util.xorBytes(h,p,o),g=p,++E,On.util.setImmediate(A);d+=b<c?h:h.substr(0,u),++b,v()}v()}});var Yv=y((sIt,DB)=>{f();var Gv=dt();Qt();var NB=DB.exports=Gv.pem=Gv.pem||{};NB.encode=function(r,e){e=e||{};var t="-----BEGIN "+r.type+`-----\r
`,i;if(r.procType&&(i={name:"Proc-Type",values:[String(r.procType.version),r.procType.type]},t+=Wv(i)),r.contentDomain&&(i={name:"Content-Domain",values:[r.contentDomain]},t+=Wv(i)),r.dekInfo&&(i={name:"DEK-Info",values:[r.dekInfo.algorithm]},r.dekInfo.parameters&&i.values.push(r.dekInfo.parameters),t+=Wv(i)),r.headers)for(var n=0;n<r.headers.length;++n)t+=Wv(r.headers[n]);return r.procType&&(t+=`\r
`),t+=Gv.util.encode64(r.body,e.maxline||64)+`\r
`,t+="-----END "+r.type+`-----\r
`,t};NB.decode=function(r){for(var e=[],t=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,i=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,n=/\r?\n/,s;s=t.exec(r),!!s;){var o={type:s[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:Gv.util.decode64(s[3])};if(e.push(o),!!s[2]){for(var a=s[2].split(n),c=0;s&&c<a.length;){for(var u=a[c].replace(/\s+$/,""),l=c+1;l<a.length;++l){var d=a[l];if(!/\s/.test(d[0]))break;u+=d,c=l}if(s=u.match(i),s){for(var h={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)h.values.push(CRe(p[g]));if(o.procType)if(!o.contentDomain&&h.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&h.name==="DEK-Info"){if(h.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(h);else{if(h.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(h.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Wv(r){for(var e=r.name+": ",t=[],i=function(c,u){return" "+u},n=0;n<r.values.length;++n)t.push(r.values[n].replace(/^(\S+\r\n)/,i));e+=t.join(",")+`\r
`;for(var s=0,o=-1,n=0;n<e.length;++n,++s)if(s>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),s=n-o-1,o=-1,++n}else(e[n]===" "||e[n]==="	"||e[n]===",")&&(o=n);return e}function CRe(r){return r.replace(/^\s+/,"")}});var KB=y((oIt,FB)=>{f();var Aa=dt();zu();Qt();var BB=FB.exports=Aa.sha256=Aa.sha256||{};Aa.md.sha256=Aa.md.algorithms.sha256=BB;BB.create=function(){MB||PRe();var r=null,e=Aa.util.createBuffer(),t=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Aa.util.createBuffer(),r={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Aa.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),UB(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Aa.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(Z6.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4,h5:r.h5,h6:r.h6,h7:r.h7};UB(d,t,n);var h=Aa.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h.putInt32(d.h5),h.putInt32(d.h6),h.putInt32(d.h7),h},i};var Z6=null,MB=!1,LB=null;function PRe(){Z6=String.fromCharCode(128),Z6+=Aa.util.fillString(String.fromCharCode(0),64),LB=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],MB=!0}function UB(r,e,t){for(var i,n,s,o,a,c,u,l,d,h,p,g,b,E,v,A=t.length();A>=64;){for(u=0;u<16;++u)e[u]=t.getInt32();for(;u<64;++u)i=e[u-2],i=(i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,n=e[u-15],n=(n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3,e[u]=i+e[u-7]+n+e[u-16]|0;for(l=r.h0,d=r.h1,h=r.h2,p=r.h3,g=r.h4,b=r.h5,E=r.h6,v=r.h7,u=0;u<64;++u)o=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),a=E^g&(b^E),s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),c=l&d|h&(l^d),i=v+o+a+LB[u]+e[u],n=s+c,v=E,E=b,b=g,g=p+i>>>0,p=h,h=d,d=l,l=i+n>>>0;r.h0=r.h0+l|0,r.h1=r.h1+d|0,r.h2=r.h2+h|0,r.h3=r.h3+p|0,r.h4=r.h4+g|0,r.h5=r.h5+b|0,r.h6=r.h6+E|0,r.h7=r.h7+v|0,A-=64}}});var VB=y((aIt,jB)=>{f();var Ia=dt();Qt();var Xv=null;Ia.util.isNodejs&&!Ia.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Xv=xh());var ORe=jB.exports=Ia.prng=Ia.prng||{};ORe.create=function(r){for(var e={plugin:r,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},t=r.md,i=new Array(32),n=0;n<32;++n)i[n]=t.create();e.pools=i,e.pool=0,e.generate=function(u,l){if(!l)return e.generateSync(u);var d=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,g=e.plugin.formatSeed,b=Ia.util.createBuffer();e.key=null,E();function E(v){if(v)return l(v);if(b.length()>=u)return l(null,b.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return Ia.util.nextTick(function(){s(E)});var A=d(e.key,e.seed);e.generated+=A.length,b.putBytes(A),e.key=p(d(e.key,h(e.seed))),e.seed=g(d(e.key,e.seed)),Ia.util.setImmediate(E)}},e.generateSync=function(u){var l=e.plugin.cipher,d=e.plugin.increment,h=e.plugin.formatKey,p=e.plugin.formatSeed;e.key=null;for(var g=Ia.util.createBuffer();g.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&o();var b=l(e.key,e.seed);e.generated+=b.length,g.putBytes(b),e.key=h(l(e.key,d(e.seed))),e.seed=p(l(e.key,e.seed))}return g.getBytes(u)};function s(u){if(e.pools[0].messageLength>=32)return a(),u();var l=32-e.pools[0].messageLength<<5;e.seedFile(l,function(d,h){if(d)return u(d);e.collect(h),a(),u()})}function o(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var l=1,d=0;d<32;++d)e.reseeds%l==0&&(u.update(e.pools[d].digest().getBytes()),e.pools[d].start()),l=l<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var h=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(h),e.generated=0}function c(u){var l=null,d=Ia.util.globalScope,h=d.crypto||d.msCrypto;h&&h.getRandomValues&&(l=function(q){return h.getRandomValues(q)});var p=Ia.util.createBuffer();if(l)for(;p.length()<u;){var g=Math.max(1,Math.min(u-p.length(),65536)/4),b=new Uint32Array(Math.floor(g));try{l(b);for(var E=0;E<b.length;++E)p.putInt32(b[E])}catch(q){if(!(typeof QuotaExceededError!="undefined"&&q instanceof QuotaExceededError))throw q}}if(p.length()<u)for(var v,A,R,F=Math.floor(Math.random()*65536);p.length()<u;){A=16807*(F&65535),v=16807*(F>>16),A+=(v&32767)<<16,A+=v>>15,A=(A&2147483647)+(A>>31),F=A&4294967295;for(var E=0;E<3;++E)R=F>>>(E<<3),R^=Math.floor(Math.random()*256),p.putByte(String.fromCharCode(R&255))}return p.getBytes(u)}return Xv?(e.seedFile=function(u,l){Xv.randomBytes(u,function(d,h){if(d)return l(d);l(null,h.toString())})},e.seedFileSync=function(u){return Xv.randomBytes(u).toString()}):(e.seedFile=function(u,l){try{l(null,c(u))}catch(d){l(d)}},e.seedFileSync=c),e.collect=function(u){for(var l=u.length,d=0;d<l;++d)e.pools[e.pool].update(u.substr(d,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,l){for(var d="",h=0;h<l;h+=8)d+=String.fromCharCode(u>>h&255);e.collect(d)},e.registerWorker=function(u){if(u===self)e.seedFile=function(d,h){function p(g){var b=g.data;b.forge&&b.forge.prng&&(self.removeEventListener("message",p),h(b.forge.prng.err,b.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:d}}})};else{var l=function(d){var h=d.data;h.forge&&h.forge.prng&&e.seedFile(h.forge.prng.needed,function(p,g){u.postMessage({forge:{prng:{err:p,bytes:g}}})})};u.addEventListener("message",l)}},e}});var Hu=y((cIt,J6)=>{f();var Di=dt();Sh();KB();VB();Qt();(function(){if(Di.random&&Di.random.getBytes){J6.exports=Di.random;return}(function(r){var e={},t=new Array(4),i=Di.util.createBuffer();e.formatKey=function(d){var h=Di.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),Di.aes._expandKey(d,!1)},e.formatSeed=function(d){var h=Di.util.createBuffer(d);return d=new Array(4),d[0]=h.getInt32(),d[1]=h.getInt32(),d[2]=h.getInt32(),d[3]=h.getInt32(),d},e.cipher=function(d,h){return Di.aes._updateBlock(d,h,t,!1),i.putInt32(t[0]),i.putInt32(t[1]),i.putInt32(t[2]),i.putInt32(t[3]),i.getBytes()},e.increment=function(d){return++d[3],d},e.md=Di.md.sha256;function n(){var d=Di.prng.create(e);return d.getBytes=function(h,p){return d.generate(h,p)},d.getBytesSync=function(h){return d.generate(h)},d}var s=n(),o=null,a=Di.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(d){return c.getRandomValues(d)}),Di.options.usePureJavaScript||!Di.util.isNodejs&&!o){if(typeof window=="undefined"||window.document===void 0,s.collectInt(+new Date,32),typeof navigator!="undefined"){var u="";for(var l in navigator)try{typeof navigator[l]=="string"&&(u+=navigator[l])}catch(d){}s.collect(u),u=null}r&&(r().mousemove(function(d){s.collectInt(d.clientX,16),s.collectInt(d.clientY,16)}),r().keypress(function(d){s.collectInt(d.charCode,8)}))}if(!Di.random)Di.random=s;else for(var l in s)Di.random[l]=s[l];Di.random.createInstance=n,J6.exports=Di.random})(typeof jQuery!="undefined"?jQuery:null)})()});var GB=y((uIt,$B)=>{f();var Xn=dt();Qt();var eA=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],zB=[1,2,3,5],kRe=function(r,e){return r<<e&65535|(r&65535)>>16-e},qRe=function(r,e){return(r&65535)>>e|r<<16-e&65535};$B.exports=Xn.rc2=Xn.rc2||{};Xn.rc2.expandKey=function(r,e){typeof r=="string"&&(r=Xn.util.createBuffer(r)),e=e||128;var t=r,i=r.length(),n=e,s=Math.ceil(n/8),o=255>>(n&7),a;for(a=i;a<128;a++)t.putByte(eA[t.at(a-1)+t.at(a-i)&255]);for(t.setAt(128-s,eA[t.at(128-s)&o]),a=127-s;a>=0;a--)t.setAt(a,eA[t.at(a+1)^t.at(a+s)]);return t};var HB=function(r,e,t){var i=!1,n=null,s=null,o=null,a,c,u,l,d=[];for(r=Xn.rc2.expandKey(r,e),u=0;u<64;u++)d.push(r.getInt16Le());t?(a=function(g){for(u=0;u<4;u++)g[u]+=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=kRe(g[u],zB[u]),l++},c=function(g){for(u=0;u<4;u++)g[u]+=d[g[(u+3)%4]&63]}):(a=function(g){for(u=3;u>=0;u--)g[u]=qRe(g[u],zB[u]),g[u]-=d[l]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),l--},c=function(g){for(u=3;u>=0;u--)g[u]-=d[g[(u+3)%4]&63]});var h=function(g){var b=[];for(u=0;u<4;u++){var E=n.getInt16Le();o!==null&&(t?E^=o.getInt16Le():o.putInt16Le(E)),b.push(E&65535)}l=t?0:63;for(var v=0;v<g.length;v++)for(var A=0;A<g[v][0];A++)g[v][1](b);for(u=0;u<4;u++)o!==null&&(t?o.putInt16Le(b[u]):b[u]^=o.getInt16Le()),s.putInt16Le(b[u])},p=null;return p={start:function(g,b){g&&typeof g=="string"&&(g=Xn.util.createBuffer(g)),i=!1,n=Xn.util.createBuffer(),s=b||new Xn.util.createBuffer,o=g,p.output=s},update:function(g){for(i||n.putBuffer(g);n.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(g){var b=!0;if(t)if(g)b=g(8,n,!t);else{var E=n.length()===8?8:8-n.length();n.fillWithByte(E,E)}if(b&&(i=!0,p.update()),!t&&(b=n.length()===0,b))if(g)b=g(8,s,!t);else{var v=s.length(),A=s.at(v-1);A>v?b=!1:s.truncate(A)}return b}},p};Xn.rc2.startEncrypting=function(r,e,t){var i=Xn.rc2.createEncryptionCipher(r,128);return i.start(e,t),i};Xn.rc2.createEncryptionCipher=function(r,e){return HB(r,e,!0)};Xn.rc2.startDecrypting=function(r,e,t){var i=Xn.rc2.createDecryptionCipher(r,128);return i.start(e,t),i};Xn.rc2.createDecryptionCipher=function(r,e){return HB(r,e,!1)}});var mg=y((lIt,tM)=>{f();var tA=dt();tM.exports=tA.jsbn=tA.jsbn||{};var Mc,NRe=244837814094590,WB=(NRe&16777215)==15715070;function we(r,e,t){this.data=[],r!=null&&(typeof r=="number"?this.fromNumber(r,e,t):e==null&&typeof r!="string"?this.fromString(r,256):this.fromString(r,e))}tA.jsbn.BigInteger=we;function qt(){return new we(null)}function DRe(r,e,t,i,n,s){for(;--s>=0;){var o=e*this.data[r++]+t.data[i]+n;n=Math.floor(o/67108864),t.data[i++]=o&67108863}return n}function BRe(r,e,t,i,n,s){for(var o=e&32767,a=e>>15;--s>=0;){var c=this.data[r]&32767,u=this.data[r++]>>15,l=a*c+u*o;c=o*c+((l&32767)<<15)+t.data[i]+(n&1073741823),n=(c>>>30)+(l>>>15)+a*u+(n>>>30),t.data[i++]=c&1073741823}return n}function YB(r,e,t,i,n,s){for(var o=e&16383,a=e>>14;--s>=0;){var c=this.data[r]&16383,u=this.data[r++]>>14,l=a*c+u*o;c=o*c+((l&16383)<<14)+t.data[i]+n,n=(c>>28)+(l>>14)+a*u,t.data[i++]=c&268435455}return n}typeof navigator=="undefined"?(we.prototype.am=YB,Mc=28):WB&&navigator.appName=="Microsoft Internet Explorer"?(we.prototype.am=BRe,Mc=30):WB&&navigator.appName!="Netscape"?(we.prototype.am=DRe,Mc=26):(we.prototype.am=YB,Mc=28);we.prototype.DB=Mc;we.prototype.DM=(1<<Mc)-1;we.prototype.DV=1<<Mc;var rA=52;we.prototype.FV=Math.pow(2,rA);we.prototype.F1=rA-Mc;we.prototype.F2=2*Mc-rA;var MRe="0123456789abcdefghijklmnopqrstuvwxyz",Qv=new Array,Ah,Bs;Ah="0".charCodeAt(0);for(Bs=0;Bs<=9;++Bs)Qv[Ah++]=Bs;Ah="a".charCodeAt(0);for(Bs=10;Bs<36;++Bs)Qv[Ah++]=Bs;Ah="A".charCodeAt(0);for(Bs=10;Bs<36;++Bs)Qv[Ah++]=Bs;function XB(r){return MRe.charAt(r)}function QB(r,e){var t=Qv[r.charCodeAt(e)];return t??-1}function LRe(r){for(var e=this.t-1;e>=0;--e)r.data[e]=this.data[e];r.t=this.t,r.s=this.s}function URe(r){this.t=1,this.s=r<0?-1:0,r>0?this.data[0]=r:r<-1?this.data[0]=r+this.DV:this.t=0}function $u(r){var e=qt();return e.fromInt(r),e}function FRe(r,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(r,e);return}this.t=0,this.s=0;for(var i=r.length,n=!1,s=0;--i>=0;){var o=t==8?r[i]&255:QB(r,i);if(o<0){r.charAt(i)=="-"&&(n=!0);continue}n=!1,s==0?this.data[this.t++]=o:s+t>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this.data[this.t++]=o>>this.DB-s):this.data[this.t-1]|=o<<s,s+=t,s>=this.DB&&(s-=this.DB)}t==8&&(r[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&we.ZERO.subTo(this,this)}function KRe(){for(var r=this.s&this.DM;this.t>0&&this.data[this.t-1]==r;)--this.t}function jRe(r){if(this.s<0)return"-"+this.negate().toString(r);var e;if(r==16)e=4;else if(r==8)e=3;else if(r==2)e=1;else if(r==32)e=5;else if(r==4)e=2;else return this.toRadix(r);var t=(1<<e)-1,i,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this.data[o]>>a)>0&&(n=!0,s=XB(i));o>=0;)a<e?(i=(this.data[o]&(1<<a)-1)<<e-a,i|=this.data[--o]>>(a+=this.DB-e)):(i=this.data[o]>>(a-=e)&t,a<=0&&(a+=this.DB,--o)),i>0&&(n=!0),n&&(s+=XB(i));return n?s:"0"}function VRe(){var r=qt();return we.ZERO.subTo(this,r),r}function zRe(){return this.s<0?this.negate():this}function HRe(r){var e=this.s-r.s;if(e!=0)return e;var t=this.t;if(e=t-r.t,e!=0)return this.s<0?-e:e;for(;--t>=0;)if((e=this.data[t]-r.data[t])!=0)return e;return 0}function Zv(r){var e=1,t;return(t=r>>>16)!=0&&(r=t,e+=16),(t=r>>8)!=0&&(r=t,e+=8),(t=r>>4)!=0&&(r=t,e+=4),(t=r>>2)!=0&&(r=t,e+=2),(t=r>>1)!=0&&(r=t,e+=1),e}function $Re(){return this.t<=0?0:this.DB*(this.t-1)+Zv(this.data[this.t-1]^this.s&this.DM)}function GRe(r,e){var t;for(t=this.t-1;t>=0;--t)e.data[t+r]=this.data[t];for(t=r-1;t>=0;--t)e.data[t]=0;e.t=this.t+r,e.s=this.s}function WRe(r,e){for(var t=r;t<this.t;++t)e.data[t-r]=this.data[t];e.t=Math.max(this.t-r,0),e.s=this.s}function YRe(r,e){var t=r%this.DB,i=this.DB-t,n=(1<<i)-1,s=Math.floor(r/this.DB),o=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+s+1]=this.data[a]>>i|o,o=(this.data[a]&n)<<t;for(a=s-1;a>=0;--a)e.data[a]=0;e.data[s]=o,e.t=this.t+s+1,e.s=this.s,e.clamp()}function XRe(r,e){e.s=this.s;var t=Math.floor(r/this.DB);if(t>=this.t){e.t=0;return}var i=r%this.DB,n=this.DB-i,s=(1<<i)-1;e.data[0]=this.data[t]>>i;for(var o=t+1;o<this.t;++o)e.data[o-t-1]|=(this.data[o]&s)<<n,e.data[o-t]=this.data[o]>>i;i>0&&(e.data[this.t-t-1]|=(this.s&s)<<n),e.t=this.t-t,e.clamp()}function QRe(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]-r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i-=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i-=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i-=r.s}e.s=i<0?-1:0,i<-1?e.data[t++]=this.DV+i:i>0&&(e.data[t++]=i),e.t=t,e.clamp()}function ZRe(r,e){var t=this.abs(),i=r.abs(),n=t.t;for(e.t=n+i.t;--n>=0;)e.data[n]=0;for(n=0;n<i.t;++n)e.data[n+t.t]=t.am(0,i.data[n],e,n,0,t.t);e.s=0,e.clamp(),this.s!=r.s&&we.ZERO.subTo(e,e)}function JRe(r){for(var e=this.abs(),t=r.t=2*e.t;--t>=0;)r.data[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e.data[t],r,2*t,0,1);(r.data[t+e.t]+=e.am(t+1,2*e.data[t],r,2*t+1,i,e.t-t-1))>=e.DV&&(r.data[t+e.t]-=e.DV,r.data[t+e.t+1]=1)}r.t>0&&(r.data[r.t-1]+=e.am(t,e.data[t],r,2*t,0,1)),r.s=0,r.clamp()}function e8e(r,e,t){var i=r.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t){e!=null&&e.fromInt(0),t!=null&&this.copyTo(t);return}t==null&&(t=qt());var s=qt(),o=this.s,a=r.s,c=this.DB-Zv(i.data[i.t-1]);c>0?(i.lShiftTo(c,s),n.lShiftTo(c,t)):(i.copyTo(s),n.copyTo(t));var u=s.t,l=s.data[u-1];if(l!=0){var d=l*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/d,p=(1<<this.F1)/d,g=1<<this.F2,b=t.t,E=b-u,v=e??qt();for(s.dlShiftTo(E,v),t.compareTo(v)>=0&&(t.data[t.t++]=1,t.subTo(v,t)),we.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--E>=0;){var A=t.data[--b]==l?this.DM:Math.floor(t.data[b]*h+(t.data[b-1]+g)*p);if((t.data[b]+=s.am(0,A,t,E,0,u))<A)for(s.dlShiftTo(E,v),t.subTo(v,t);t.data[b]<--A;)t.subTo(v,t)}e!=null&&(t.drShiftTo(u,e),o!=a&&we.ZERO.subTo(e,e)),t.t=u,t.clamp(),c>0&&t.rShiftTo(c,t),o<0&&we.ZERO.subTo(t,t)}}}function t8e(r){var e=qt();return this.abs().divRemTo(r,null,e),this.s<0&&e.compareTo(we.ZERO)>0&&r.subTo(e,e),e}function wf(r){this.m=r}function r8e(r){return r.s<0||r.compareTo(this.m)>=0?r.mod(this.m):r}function i8e(r){return r}function n8e(r){r.divRemTo(this.m,null,r)}function s8e(r,e,t){r.multiplyTo(e,t),this.reduce(t)}function o8e(r,e){r.squareTo(e),this.reduce(e)}wf.prototype.convert=r8e;wf.prototype.revert=i8e;wf.prototype.reduce=n8e;wf.prototype.mulTo=s8e;wf.prototype.sqrTo=o8e;function a8e(){if(this.t<1)return 0;var r=this.data[0];if((r&1)==0)return 0;var e=r&3;return e=e*(2-(r&15)*e)&15,e=e*(2-(r&255)*e)&255,e=e*(2-((r&65535)*e&65535))&65535,e=e*(2-r*e%this.DV)%this.DV,e>0?this.DV-e:-e}function _f(r){this.m=r,this.mp=r.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<r.DB-15)-1,this.mt2=2*r.t}function c8e(r){var e=qt();return r.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),r.s<0&&e.compareTo(we.ZERO)>0&&this.m.subTo(e,e),e}function u8e(r){var e=qt();return r.copyTo(e),this.reduce(e),e}function l8e(r){for(;r.t<=this.mt2;)r.data[r.t++]=0;for(var e=0;e<this.m.t;++e){var t=r.data[e]&32767,i=t*this.mpl+((t*this.mph+(r.data[e]>>15)*this.mpl&this.um)<<15)&r.DM;for(t=e+this.m.t,r.data[t]+=this.m.am(0,i,r,e,0,this.m.t);r.data[t]>=r.DV;)r.data[t]-=r.DV,r.data[++t]++}r.clamp(),r.drShiftTo(this.m.t,r),r.compareTo(this.m)>=0&&r.subTo(this.m,r)}function f8e(r,e){r.squareTo(e),this.reduce(e)}function d8e(r,e,t){r.multiplyTo(e,t),this.reduce(t)}_f.prototype.convert=c8e;_f.prototype.revert=u8e;_f.prototype.reduce=l8e;_f.prototype.mulTo=d8e;_f.prototype.sqrTo=f8e;function h8e(){return(this.t>0?this.data[0]&1:this.s)==0}function p8e(r,e){if(r>4294967295||r<1)return we.ONE;var t=qt(),i=qt(),n=e.convert(this),s=Zv(r)-1;for(n.copyTo(t);--s>=0;)if(e.sqrTo(t,i),(r&1<<s)>0)e.mulTo(i,n,t);else{var o=t;t=i,i=o}return e.revert(t)}function y8e(r,e){var t;return r<256||e.isEven()?t=new wf(e):t=new _f(e),this.exp(r,t)}we.prototype.copyTo=LRe;we.prototype.fromInt=URe;we.prototype.fromString=FRe;we.prototype.clamp=KRe;we.prototype.dlShiftTo=GRe;we.prototype.drShiftTo=WRe;we.prototype.lShiftTo=YRe;we.prototype.rShiftTo=XRe;we.prototype.subTo=QRe;we.prototype.multiplyTo=ZRe;we.prototype.squareTo=JRe;we.prototype.divRemTo=e8e;we.prototype.invDigit=a8e;we.prototype.isEven=h8e;we.prototype.exp=p8e;we.prototype.toString=jRe;we.prototype.negate=VRe;we.prototype.abs=zRe;we.prototype.compareTo=HRe;we.prototype.bitLength=$Re;we.prototype.mod=t8e;we.prototype.modPowInt=y8e;we.ZERO=$u(0);we.ONE=$u(1);function g8e(){var r=qt();return this.copyTo(r),r}function m8e(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function b8e(){return this.t==0?this.s:this.data[0]<<24>>24}function v8e(){return this.t==0?this.s:this.data[0]<<16>>16}function w8e(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function _8e(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function E8e(r){if(r==null&&(r=10),this.signum()==0||r<2||r>36)return"0";var e=this.chunkSize(r),t=Math.pow(r,e),i=$u(t),n=qt(),s=qt(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(t+s.intValue()).toString(r).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(r)+o}function S8e(r,e){this.fromInt(0),e==null&&(e=10);for(var t=this.chunkSize(e),i=Math.pow(e,t),n=!1,s=0,o=0,a=0;a<r.length;++a){var c=QB(r,a);if(c<0){r.charAt(a)=="-"&&this.signum()==0&&(n=!0);continue}o=e*o+c,++s>=t&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&we.ZERO.subTo(this,this)}function x8e(r,e,t){if(typeof e=="number")if(r<2)this.fromInt(1);else for(this.fromNumber(r,t),this.testBit(r-1)||this.bitwiseTo(we.ONE.shiftLeft(r-1),iA,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>r&&this.subTo(we.ONE.shiftLeft(r-1),this);else{var i=new Array,n=r&7;i.length=(r>>3)+1,e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}}function A8e(){var r=this.t,e=new Array;e[0]=this.s;var t=this.DB-r*this.DB%8,i,n=0;if(r-- >0)for(t<this.DB&&(i=this.data[r]>>t)!=(this.s&this.DM)>>t&&(e[n++]=i|this.s<<this.DB-t);r>=0;)t<8?(i=(this.data[r]&(1<<t)-1)<<8-t,i|=this.data[--r]>>(t+=this.DB-8)):(i=this.data[r]>>(t-=8)&255,t<=0&&(t+=this.DB,--r)),(i&128)!=0&&(i|=-256),n==0&&(this.s&128)!=(i&128)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function I8e(r){return this.compareTo(r)==0}function T8e(r){return this.compareTo(r)<0?this:r}function R8e(r){return this.compareTo(r)>0?this:r}function C8e(r,e,t){var i,n,s=Math.min(r.t,this.t);for(i=0;i<s;++i)t.data[i]=e(this.data[i],r.data[i]);if(r.t<this.t){for(n=r.s&this.DM,i=s;i<this.t;++i)t.data[i]=e(this.data[i],n);t.t=this.t}else{for(n=this.s&this.DM,i=s;i<r.t;++i)t.data[i]=e(n,r.data[i]);t.t=r.t}t.s=e(this.s,r.s),t.clamp()}function P8e(r,e){return r&e}function O8e(r){var e=qt();return this.bitwiseTo(r,P8e,e),e}function iA(r,e){return r|e}function k8e(r){var e=qt();return this.bitwiseTo(r,iA,e),e}function ZB(r,e){return r^e}function q8e(r){var e=qt();return this.bitwiseTo(r,ZB,e),e}function JB(r,e){return r&~e}function N8e(r){var e=qt();return this.bitwiseTo(r,JB,e),e}function D8e(){for(var r=qt(),e=0;e<this.t;++e)r.data[e]=this.DM&~this.data[e];return r.t=this.t,r.s=~this.s,r}function B8e(r){var e=qt();return r<0?this.rShiftTo(-r,e):this.lShiftTo(r,e),e}function M8e(r){var e=qt();return r<0?this.lShiftTo(-r,e):this.rShiftTo(r,e),e}function L8e(r){if(r==0)return-1;var e=0;return(r&65535)==0&&(r>>=16,e+=16),(r&255)==0&&(r>>=8,e+=8),(r&15)==0&&(r>>=4,e+=4),(r&3)==0&&(r>>=2,e+=2),(r&1)==0&&++e,e}function U8e(){for(var r=0;r<this.t;++r)if(this.data[r]!=0)return r*this.DB+L8e(this.data[r]);return this.s<0?this.t*this.DB:-1}function F8e(r){for(var e=0;r!=0;)r&=r-1,++e;return e}function K8e(){for(var r=0,e=this.s&this.DM,t=0;t<this.t;++t)r+=F8e(this.data[t]^e);return r}function j8e(r){var e=Math.floor(r/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<r%this.DB)!=0}function V8e(r,e){var t=we.ONE.shiftLeft(r);return this.bitwiseTo(t,e,t),t}function z8e(r){return this.changeBit(r,iA)}function H8e(r){return this.changeBit(r,JB)}function $8e(r){return this.changeBit(r,ZB)}function G8e(r,e){for(var t=0,i=0,n=Math.min(r.t,this.t);t<n;)i+=this.data[t]+r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;if(r.t<this.t){for(i+=r.s;t<this.t;)i+=this.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;t<r.t;)i+=r.data[t],e.data[t++]=i&this.DM,i>>=this.DB;i+=r.s}e.s=i<0?-1:0,i>0?e.data[t++]=i:i<-1&&(e.data[t++]=this.DV+i),e.t=t,e.clamp()}function W8e(r){var e=qt();return this.addTo(r,e),e}function Y8e(r){var e=qt();return this.subTo(r,e),e}function X8e(r){var e=qt();return this.multiplyTo(r,e),e}function Q8e(r){var e=qt();return this.divRemTo(r,e,null),e}function Z8e(r){var e=qt();return this.divRemTo(r,null,e),e}function J8e(r){var e=qt(),t=qt();return this.divRemTo(r,e,t),new Array(e,t)}function eCe(r){this.data[this.t]=this.am(0,r-1,this,0,0,this.t),++this.t,this.clamp()}function tCe(r,e){if(r!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=r;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function gg(){}function eM(r){return r}function rCe(r,e,t){r.multiplyTo(e,t)}function iCe(r,e){r.squareTo(e)}gg.prototype.convert=eM;gg.prototype.revert=eM;gg.prototype.mulTo=rCe;gg.prototype.sqrTo=iCe;function nCe(r){return this.exp(r,new gg)}function sCe(r,e,t){var i=Math.min(this.t+r.t,e);for(t.s=0,t.t=i;i>0;)t.data[--i]=0;var n;for(n=t.t-this.t;i<n;++i)t.data[i+this.t]=this.am(0,r.data[i],t,i,0,this.t);for(n=Math.min(r.t,e);i<n;++i)this.am(0,r.data[i],t,i,0,e-i);t.clamp()}function oCe(r,e,t){--e;var i=t.t=this.t+r.t-e;for(t.s=0;--i>=0;)t.data[i]=0;for(i=Math.max(e-this.t,0);i<r.t;++i)t.data[this.t+i-e]=this.am(e-i,r.data[i],t,0,0,this.t+i-e);t.clamp(),t.drShiftTo(1,t)}function Ih(r){this.r2=qt(),this.q3=qt(),we.ONE.dlShiftTo(2*r.t,this.r2),this.mu=this.r2.divide(r),this.m=r}function aCe(r){if(r.s<0||r.t>2*this.m.t)return r.mod(this.m);if(r.compareTo(this.m)<0)return r;var e=qt();return r.copyTo(e),this.reduce(e),e}function cCe(r){return r}function uCe(r){for(r.drShiftTo(this.m.t-1,this.r2),r.t>this.m.t+1&&(r.t=this.m.t+1,r.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);r.compareTo(this.r2)<0;)r.dAddOffset(1,this.m.t+1);for(r.subTo(this.r2,r);r.compareTo(this.m)>=0;)r.subTo(this.m,r)}function lCe(r,e){r.squareTo(e),this.reduce(e)}function fCe(r,e,t){r.multiplyTo(e,t),this.reduce(t)}Ih.prototype.convert=aCe;Ih.prototype.revert=cCe;Ih.prototype.reduce=uCe;Ih.prototype.mulTo=fCe;Ih.prototype.sqrTo=lCe;function dCe(r,e){var t=r.bitLength(),i,n=$u(1),s;if(t<=0)return n;t<18?i=1:t<48?i=3:t<144?i=4:t<768?i=5:i=6,t<8?s=new wf(e):e.isEven()?s=new Ih(e):s=new _f(e);var o=new Array,a=3,c=i-1,u=(1<<i)-1;if(o[1]=s.convert(this),i>1){var l=qt();for(s.sqrTo(o[1],l);a<=u;)o[a]=qt(),s.mulTo(l,o[a-2],o[a]),a+=2}var d=r.t-1,h,p=!0,g=qt(),b;for(t=Zv(r.data[d])-1;d>=0;){for(t>=c?h=r.data[d]>>t-c&u:(h=(r.data[d]&(1<<t+1)-1)<<c-t,d>0&&(h|=r.data[d-1]>>this.DB+t-c)),a=i;(h&1)==0;)h>>=1,--a;if((t-=a)<0&&(t+=this.DB,--d),p)o[h].copyTo(n),p=!1;else{for(;a>1;)s.sqrTo(n,g),s.sqrTo(g,n),a-=2;a>0?s.sqrTo(n,g):(b=n,n=g,g=b),s.mulTo(g,o[h],n)}for(;d>=0&&(r.data[d]&1<<t)==0;)s.sqrTo(n,g),b=n,n=g,g=b,--t<0&&(t=this.DB-1,--d)}return s.revert(n)}function hCe(r){var e=this.s<0?this.negate():this.clone(),t=r.s<0?r.negate():r.clone();if(e.compareTo(t)<0){var i=e;e=t,t=i}var n=e.getLowestSetBit(),s=t.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),t.rShiftTo(s,t));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return s>0&&t.lShiftTo(s,t),t}function pCe(r){if(r<=0)return 0;var e=this.DV%r,t=this.s<0?r-1:0;if(this.t>0)if(e==0)t=this.data[0]%r;else for(var i=this.t-1;i>=0;--i)t=(e*t+this.data[i])%r;return t}function yCe(r){var e=r.isEven();if(this.isEven()&&e||r.signum()==0)return we.ZERO;for(var t=r.clone(),i=this.clone(),n=$u(1),s=$u(0),o=$u(0),a=$u(1);t.signum()!=0;){for(;t.isEven();)t.rShiftTo(1,t),e?((!n.isEven()||!s.isEven())&&(n.addTo(this,n),s.subTo(r,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(r,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(r,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(r,a),a.rShiftTo(1,a);t.compareTo(i)>=0?(t.subTo(i,t),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(t,i),e&&o.subTo(n,o),a.subTo(s,a))}if(i.compareTo(we.ONE)!=0)return we.ZERO;if(a.compareTo(r)>=0)return a.subtract(r);if(a.signum()<0)a.addTo(r,a);else return a;return a.signum()<0?a.add(r):a}var Co=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],gCe=(1<<26)/Co[Co.length-1];function mCe(r){var e,t=this.abs();if(t.t==1&&t.data[0]<=Co[Co.length-1]){for(e=0;e<Co.length;++e)if(t.data[0]==Co[e])return!0;return!1}if(t.isEven())return!1;for(e=1;e<Co.length;){for(var i=Co[e],n=e+1;n<Co.length&&i<gCe;)i*=Co[n++];for(i=t.modInt(i);e<n;)if(i%Co[e++]==0)return!1}return t.millerRabin(r)}function bCe(r){var e=this.subtract(we.ONE),t=e.getLowestSetBit();if(t<=0)return!1;for(var i=e.shiftRight(t),n=vCe(),s,o=0;o<r;++o){do s=new we(this.bitLength(),n);while(s.compareTo(we.ONE)<=0||s.compareTo(e)>=0);var a=s.modPow(i,this);if(a.compareTo(we.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<t&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(we.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function vCe(){return{nextBytes:function(r){for(var e=0;e<r.length;++e)r[e]=Math.floor(Math.random()*256)}}}we.prototype.chunkSize=w8e;we.prototype.toRadix=E8e;we.prototype.fromRadix=S8e;we.prototype.fromNumber=x8e;we.prototype.bitwiseTo=C8e;we.prototype.changeBit=V8e;we.prototype.addTo=G8e;we.prototype.dMultiply=eCe;we.prototype.dAddOffset=tCe;we.prototype.multiplyLowerTo=sCe;we.prototype.multiplyUpperTo=oCe;we.prototype.modInt=pCe;we.prototype.millerRabin=bCe;we.prototype.clone=g8e;we.prototype.intValue=m8e;we.prototype.byteValue=b8e;we.prototype.shortValue=v8e;we.prototype.signum=_8e;we.prototype.toByteArray=A8e;we.prototype.equals=I8e;we.prototype.min=T8e;we.prototype.max=R8e;we.prototype.and=O8e;we.prototype.or=k8e;we.prototype.xor=q8e;we.prototype.andNot=N8e;we.prototype.not=D8e;we.prototype.shiftLeft=B8e;we.prototype.shiftRight=M8e;we.prototype.getLowestSetBit=U8e;we.prototype.bitCount=K8e;we.prototype.testBit=j8e;we.prototype.setBit=z8e;we.prototype.clearBit=H8e;we.prototype.flipBit=$8e;we.prototype.add=W8e;we.prototype.subtract=Y8e;we.prototype.multiply=X8e;we.prototype.divide=Q8e;we.prototype.remainder=Z8e;we.prototype.divideAndRemainder=J8e;we.prototype.modPow=dCe;we.prototype.modInverse=yCe;we.prototype.pow=nCe;we.prototype.gcd=hCe;we.prototype.isProbablePrime=mCe});var oM=y((fIt,sM)=>{f();var Ta=dt();zu();Qt();var rM=sM.exports=Ta.sha1=Ta.sha1||{};Ta.md.sha1=Ta.md.algorithms.sha1=rM;rM.create=function(){iM||wCe();var r=null,e=Ta.util.createBuffer(),t=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return i.start=function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,s=0;s<n;++s)i.fullMessageLength.push(0);return e=Ta.util.createBuffer(),r={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i},i.start(),i.update=function(n,s){s==="utf8"&&(n=Ta.util.encodeUtf8(n));var o=n.length;i.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=i.fullMessageLength.length-1;a>=0;--a)i.fullMessageLength[a]+=o[1],o[1]=o[0]+(i.fullMessageLength[a]/4294967296>>>0),i.fullMessageLength[a]=i.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(n),nM(r,t,e),(e.read>2048||e.length()===0)&&e.compact(),i},i.digest=function(){var n=Ta.util.createBuffer();n.putBytes(e.bytes());var s=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize,o=s&i.blockLength-1;n.putBytes(nA.substr(0,i.blockLength-o));for(var a,c,u=i.fullMessageLength[0]*8,l=0;l<i.fullMessageLength.length-1;++l)a=i.fullMessageLength[l+1]*8,c=a/4294967296>>>0,u+=c,n.putInt32(u>>>0),u=a>>>0;n.putInt32(u);var d={h0:r.h0,h1:r.h1,h2:r.h2,h3:r.h3,h4:r.h4};nM(d,t,n);var h=Ta.util.createBuffer();return h.putInt32(d.h0),h.putInt32(d.h1),h.putInt32(d.h2),h.putInt32(d.h3),h.putInt32(d.h4),h},i};var nA=null,iM=!1;function wCe(){nA=String.fromCharCode(128),nA+=Ta.util.fillString(String.fromCharCode(0),64),iM=!0}function nM(r,e,t){for(var i,n,s,o,a,c,u,l,d=t.length();d>=64;){for(n=r.h0,s=r.h1,o=r.h2,a=r.h3,c=r.h4,l=0;l<16;++l)i=t.getInt32(),e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<20;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=a^s&(o^a),i=(n<<5|n>>>27)+u+c+1518500249+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<32;++l)i=e[l-3]^e[l-8]^e[l-14]^e[l-16],i=i<<1|i>>>31,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<40;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+1859775393+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<60;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s&o|a&(s^o),i=(n<<5|n>>>27)+u+c+2400959708+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;for(;l<80;++l)i=e[l-6]^e[l-16]^e[l-28]^e[l-32],i=i<<2|i>>>30,e[l]=i,u=s^o^a,i=(n<<5|n>>>27)+u+c+3395469782+i,c=a,a=o,o=(s<<30|s>>>2)>>>0,s=n,n=i;r.h0=r.h0+n|0,r.h1=r.h1+s|0,r.h2=r.h2+o|0,r.h3=r.h3+a|0,r.h4=r.h4+c|0,d-=64}}});var uM=y((dIt,cM)=>{f();var Ra=dt();Qt();Hu();oM();var aM=cM.exports=Ra.pkcs1=Ra.pkcs1||{};aM.encode_rsa_oaep=function(r,e,t){var i,n,s,o;typeof t=="string"?(i=t,n=arguments[3]||void 0,s=arguments[4]||void 0):t&&(i=t.label||void 0,n=t.seed||void 0,s=t.md||void 0,t.mgf1&&t.mgf1.md&&(o=t.mgf1.md)),s?s.start():s=Ra.md.sha1.create(),o||(o=s);var a=Math.ceil(r.n.bitLength()/8),c=a-2*s.digestLength-2;if(e.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=c,u}i||(i=""),s.update(i,"raw");for(var l=s.digest(),d="",h=c-e.length,p=0;p<h;p++)d+="\0";var g=l.getBytes()+d+""+e;if(!n)n=Ra.random.getBytes(s.digestLength);else if(n.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=n.length,u.digestLength=s.digestLength,u}var b=Jv(n,a-s.digestLength-1,o),E=Ra.util.xorBytes(g,b,g.length),v=Jv(E,s.digestLength,o),A=Ra.util.xorBytes(n,v,n.length);return"\0"+A+E};aM.decode_rsa_oaep=function(r,e,t){var i,n,s;typeof t=="string"?(i=t,n=arguments[3]||void 0):t&&(i=t.label||void 0,n=t.md||void 0,t.mgf1&&t.mgf1.md&&(s=t.mgf1.md));var o=Math.ceil(r.n.bitLength()/8);if(e.length!==o){var E=new Error("RSAES-OAEP encoded message length is invalid.");throw E.length=e.length,E.expectedLength=o,E}if(n===void 0?n=Ra.md.sha1.create():n.start(),s||(s=n),o<2*n.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),n.update(i,"raw");for(var a=n.digest().getBytes(),c=e.charAt(0),u=e.substring(1,n.digestLength+1),l=e.substring(1+n.digestLength),d=Jv(l,n.digestLength,s),h=Ra.util.xorBytes(u,d,u.length),p=Jv(h,o-n.digestLength-1,s),g=Ra.util.xorBytes(l,p,l.length),b=g.substring(0,n.digestLength),E=c!=="\0",v=0;v<n.digestLength;++v)E|=a.charAt(v)!==b.charAt(v);for(var A=1,R=n.digestLength,F=n.digestLength;F<g.length;F++){var q=g.charCodeAt(F),N=q&1^1,z=A?65534:0;E|=q&z,A=A&N,R+=A}if(E||g.charCodeAt(R)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(R+1)};function Jv(r,e,t){t||(t=Ra.md.sha1.create());for(var i="",n=Math.ceil(e/t.digestLength),s=0;s<n;++s){var o=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);t.start(),t.update(r+o),i+=t.digest().getBytes()}return i.substring(0,e)}});var lM=y((hIt,sA)=>{f();var Gu=dt();Qt();mg();Hu();(function(){if(Gu.prime){sA.exports=Gu.prime;return}var r=sA.exports=Gu.prime=Gu.prime||{},e=Gu.jsbn.BigInteger,t=[6,4,2,4,2,4,6,2],i=new e(null);i.fromInt(30);var n=function(d,h){return d|h};r.generateProbablePrime=function(d,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var g=h.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var b=h.prng||Gu.random,E={nextBytes:function(v){for(var A=b.getBytesSync(v.length),R=0;R<v.length;++R)v[R]=A.charCodeAt(R)}};if(g.name==="PRIMEINC")return s(d,E,g.options,p);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(d,h,p,g){return"workers"in p?c(d,h,p,g):o(d,h,p,g)}function o(d,h,p,g){var b=u(d,h),E=0,v=l(b.bitLength());"millerRabinTests"in p&&(v=p.millerRabinTests);var A=10;"maxBlockTime"in p&&(A=p.maxBlockTime),a(b,d,h,E,v,A,g)}function a(d,h,p,g,b,E,v){var A=+new Date;do{if(d.bitLength()>h&&(d=u(h,p)),d.isProbablePrime(b))return v(null,d);d.dAddOffset(t[g++%8],0)}while(E<0||+new Date-A<E);Gu.util.setImmediate(function(){a(d,h,p,g,b,E,v)})}function c(d,h,p,g){if(typeof Worker=="undefined")return o(d,h,p,g);var b=u(d,h),E=p.workers,v=p.workLoad||100,A=v*30/8,R=p.workerScript||"forge/prime.worker.js";if(E===-1)return Gu.util.estimateCores(function(q,N){q&&(N=2),E=N-1,F()});F();function F(){E=Math.max(1,E);for(var q=[],N=0;N<E;++N)q[N]=new Worker(R);for(var z=E,N=0;N<E;++N)q[N].addEventListener("message",Y);var G=!1;function Y(C){if(!G){--z;var m=C.data;if(m.found){for(var w=0;w<q.length;++w)q[w].terminate();return G=!0,g(null,new e(m.prime,16))}b.bitLength()>d&&(b=u(d,h));var S=b.toString(16);C.target.postMessage({hex:S,workLoad:v}),b.dAddOffset(A,0)}}}}function u(d,h){var p=new e(d,h),g=d-1;return p.testBit(g)||p.bitwiseTo(e.ONE.shiftLeft(g),n,p),p.dAddOffset(31-p.mod(i).byteValue(),0),p}function l(d){return d<=100?27:d<=150?18:d<=200?15:d<=250?12:d<=300?9:d<=350?8:d<=400?7:d<=500?6:d<=600?5:d<=800?4:d<=1250?3:2}})()});var bg=y((pIt,mM)=>{f();var at=dt();Nc();mg();wh();uM();lM();Hu();Qt();typeof Ct=="undefined"&&(Ct=at.jsbn.BigInteger);var Ct,oA=at.util.isNodejs?xh():null,se=at.asn1,Ms=at.util;at.pki=at.pki||{};mM.exports=at.pki.rsa=at.rsa=at.rsa||{};var ct=at.pki,_Ce=[6,4,2,4,2,4,6,2],ECe={name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},SCe={name:"RSAPrivateKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},xCe={name:"RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:se.Class.UNIVERSAL,type:se.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},ACe=at.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:se.Class.UNIVERSAL,type:se.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:se.Class.UNIVERSAL,type:se.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},ICe=function(r){var e;if(r.algorithm in ct.oids)e=ct.oids[r.algorithm];else{var t=new Error("Unknown message digest algorithm.");throw t.algorithm=r.algorithm,t}var i=se.oidToDer(e).getBytes(),n=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]),s=se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[]);s.value.push(se.create(se.Class.UNIVERSAL,se.Type.OID,!1,i)),s.value.push(se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,""));var o=se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,r.digest().getBytes());return n.value.push(s),n.value.push(o),se.toDer(n).getBytes()},fM=function(r,e,t){if(t)return r.modPow(e.e,e.n);if(!e.p||!e.q)return r.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Ct.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Ct.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var i;do i=new Ct(at.util.bytesToHex(at.random.getBytes(e.n.bitLength()/8)),16);while(i.compareTo(e.n)>=0||!i.gcd(e.n).equals(Ct.ONE));r=r.multiply(i.modPow(e.e,e.n)).mod(e.n);for(var n=r.mod(e.p).modPow(e.dP,e.p),s=r.mod(e.q).modPow(e.dQ,e.q);n.compareTo(s)<0;)n=n.add(e.p);var o=n.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return o=o.multiply(i.modInverse(e.n)).mod(e.n),o};ct.rsa.encrypt=function(r,e,t){var i=t,n,s=Math.ceil(e.n.bitLength()/8);t!==!1&&t!==!0?(i=t===2,n=dM(r,e,t)):(n=at.util.createBuffer(),n.putBytes(r));for(var o=new Ct(n.toHex(),16),a=fM(o,e,i),c=a.toString(16),u=at.util.createBuffer(),l=s-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(at.util.hexToBytes(c)),u.getBytes()};ct.rsa.decrypt=function(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8);if(r.length!==n){var s=new Error("Encrypted message length is invalid.");throw s.length=r.length,s.expected=n,s}var o=new Ct(at.util.createBuffer(r).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=fM(o,e,t),c=a.toString(16),u=at.util.createBuffer(),l=n-Math.ceil(c.length/2);l>0;)u.putByte(0),--l;return u.putBytes(at.util.hexToBytes(c)),i!==!1?ew(u.getBytes(),e,t):u.getBytes()};ct.rsa.createKeyPairGenerationState=function(r,e,t){typeof r=="string"&&(r=parseInt(r,10)),r=r||2048,t=t||{};var i=t.prng||at.random,n={nextBytes:function(a){for(var c=i.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=c.charCodeAt(u)}},s=t.algorithm||"PRIMEINC",o;if(s==="PRIMEINC")o={algorithm:s,state:0,bits:r,rng:n,eInt:e||65537,e:new Ct(null),p:null,q:null,qBits:r>>1,pBits:r-(r>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+s);return o};ct.rsa.stepKeyPairGenerationState=function(r,e){"algorithm"in r||(r.algorithm="PRIMEINC");var t=new Ct(null);t.fromInt(30);for(var i=0,n=function(d,h){return d|h},s=+new Date,o,a=0;r.keys===null&&(e<=0||a<e);){if(r.state===0){var c=r.p===null?r.pBits:r.qBits,u=c-1;r.pqState===0?(r.num=new Ct(c,r.rng),r.num.testBit(u)||r.num.bitwiseTo(Ct.ONE.shiftLeft(u),n,r.num),r.num.dAddOffset(31-r.num.mod(t).byteValue(),0),i=0,++r.pqState):r.pqState===1?r.num.bitLength()>c?r.pqState=0:r.num.isProbablePrime(RCe(r.num.bitLength()))?++r.pqState:r.num.dAddOffset(_Ce[i++%8],0):r.pqState===2?r.pqState=r.num.subtract(Ct.ONE).gcd(r.e).compareTo(Ct.ONE)===0?3:0:r.pqState===3&&(r.pqState=0,r.p===null?r.p=r.num:r.q=r.num,r.p!==null&&r.q!==null&&++r.state,r.num=null)}else if(r.state===1)r.p.compareTo(r.q)<0&&(r.num=r.p,r.p=r.q,r.q=r.num),++r.state;else if(r.state===2)r.p1=r.p.subtract(Ct.ONE),r.q1=r.q.subtract(Ct.ONE),r.phi=r.p1.multiply(r.q1),++r.state;else if(r.state===3)r.phi.gcd(r.e).compareTo(Ct.ONE)===0?++r.state:(r.p=null,r.q=null,r.state=0);else if(r.state===4)r.n=r.p.multiply(r.q),r.n.bitLength()===r.bits?++r.state:(r.q=null,r.state=0);else if(r.state===5){var l=r.e.modInverse(r.phi);r.keys={privateKey:ct.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:ct.rsa.setPublicKey(r.n,r.e)}}o=+new Date,a+=o-s,s=o}return r.keys!==null};ct.rsa.generateKeyPair=function(r,e,t,i){if(arguments.length===1?typeof r=="object"?(t=r,r=void 0):typeof r=="function"&&(i=r,r=void 0):arguments.length===2?typeof r=="number"?typeof e=="function"?(i=e,e=void 0):typeof e!="number"&&(t=e,e=void 0):(t=r,i=e,r=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof t=="function"&&(i=t,t=void 0):(i=t,t=e,e=void 0)),t=t||{},r===void 0&&(r=t.bits||2048),e===void 0&&(e=t.e||65537),!at.options.usePureJavaScript&&!t.prng&&r>=256&&r<=16384&&(e===65537||e===3)){if(i){if(hM("generateKeyPair"))return oA.generateKeyPair("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,u){if(a)return i(a);i(null,{privateKey:ct.privateKeyFromPem(u),publicKey:ct.publicKeyFromPem(c)})});if(pM("generateKey")&&pM("exportKey"))return Ms.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:gM(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ms.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){i(a)}).then(function(a){if(a){var c=ct.privateKeyFromAsn1(se.fromDer(at.util.createBuffer(a)));i(null,{privateKey:c,publicKey:ct.setRsaPublicKey(c.n,c.e)})}});if(yM("generateKey")&&yM("exportKey")){var n=Ms.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:gM(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);n.oncomplete=function(a){var c=a.target.result,u=Ms.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(l){var d=l.target.result,h=ct.privateKeyFromAsn1(se.fromDer(at.util.createBuffer(d)));i(null,{privateKey:h,publicKey:ct.setRsaPublicKey(h.n,h.e)})},u.onerror=function(l){i(l)}},n.onerror=function(a){i(a)};return}}else if(hM("generateKeyPairSync")){var s=oA.generateKeyPairSync("rsa",{modulusLength:r,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:ct.privateKeyFromPem(s.privateKey),publicKey:ct.publicKeyFromPem(s.publicKey)}}}var o=ct.rsa.createKeyPairGenerationState(r,e,t);if(!i)return ct.rsa.stepKeyPairGenerationState(o,0),o.keys;TCe(o,t,i)};ct.setRsaPublicKey=ct.rsa.setPublicKey=function(r,e){var t={n:r,e};return t.encrypt=function(i,n,s){if(typeof n=="string"?n=n.toUpperCase():n===void 0&&(n="RSAES-PKCS1-V1_5"),n==="RSAES-PKCS1-V1_5")n={encode:function(a,c,u){return dM(a,c,2).getBytes()}};else if(n==="RSA-OAEP"||n==="RSAES-OAEP")n={encode:function(a,c){return at.pkcs1.encode_rsa_oaep(c,a,s)}};else if(["RAW","NONE","NULL",null].indexOf(n)!==-1)n={encode:function(a){return a}};else if(typeof n=="string")throw new Error('Unsupported encryption scheme: "'+n+'".');var o=n.encode(i,t,!0);return ct.rsa.encrypt(o,t,!0)},t.verify=function(i,n,s){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),s==="RSASSA-PKCS1-V1_5"?s={verify:function(a,c){c=ew(c,t,!0);var u=se.fromDer(c);return a===u.value[1].value}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(a,c){return c=ew(c,t,!0),a===c}});var o=ct.rsa.decrypt(n,t,!0,!1);return s.verify(i,o,t.n.bitLength())},t};ct.setRsaPrivateKey=ct.rsa.setPrivateKey=function(r,e,t,i,n,s,o,a){var c={n:r,e,d:t,p:i,q:n,dP:s,dQ:o,qInv:a};return c.decrypt=function(u,l,d){typeof l=="string"?l=l.toUpperCase():l===void 0&&(l="RSAES-PKCS1-V1_5");var h=ct.rsa.decrypt(u,c,!1,!1);if(l==="RSAES-PKCS1-V1_5")l={decode:ew};else if(l==="RSA-OAEP"||l==="RSAES-OAEP")l={decode:function(p,g){return at.pkcs1.decode_rsa_oaep(g,p,d)}};else if(["RAW","NONE","NULL",null].indexOf(l)!==-1)l={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+l+'".');return l.decode(h,c,!1)},c.sign=function(u,l){var d=!1;typeof l=="string"&&(l=l.toUpperCase()),l===void 0||l==="RSASSA-PKCS1-V1_5"?(l={encode:ICe},d=1):(l==="NONE"||l==="NULL"||l===null)&&(l={encode:function(){return u}},d=1);var h=l.encode(u,c.n.bitLength());return ct.rsa.encrypt(h,c,d)},c};ct.wrapRsaPrivateKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(ct.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.OCTETSTRING,!1,se.toDer(r).getBytes())])};ct.privateKeyFromAsn1=function(r){var e={},t=[];if(se.validate(r,ECe,e,t)&&(r=se.fromDer(at.util.createBuffer(e.privateKey))),e={},t=[],!se.validate(r,SCe,e,t)){var i=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw i.errors=t,i}var n,s,o,a,c,u,l,d;return n=at.util.createBuffer(e.privateKeyModulus).toHex(),s=at.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=at.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=at.util.createBuffer(e.privateKeyPrime1).toHex(),c=at.util.createBuffer(e.privateKeyPrime2).toHex(),u=at.util.createBuffer(e.privateKeyExponent1).toHex(),l=at.util.createBuffer(e.privateKeyExponent2).toHex(),d=at.util.createBuffer(e.privateKeyCoefficient).toHex(),ct.setRsaPrivateKey(new Ct(n,16),new Ct(s,16),new Ct(o,16),new Ct(a,16),new Ct(c,16),new Ct(u,16),new Ct(l,16),new Ct(d,16))};ct.privateKeyToAsn1=ct.privateKeyToRSAPrivateKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,se.integerToDer(0).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.e)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.d)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.p)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.q)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.dP)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.dQ)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.qInv))])};ct.publicKeyFromAsn1=function(r){var e={},t=[];if(se.validate(r,ACe,e,t)){var i=se.derToOid(e.publicKeyOid);if(i!==ct.oids.rsaEncryption){var n=new Error("Cannot read public key. Unknown OID.");throw n.oid=i,n}r=e.rsaPublicKey}if(t=[],!se.validate(r,xCe,e,t)){var n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw n.errors=t,n}var s=at.util.createBuffer(e.publicKeyModulus).toHex(),o=at.util.createBuffer(e.publicKeyExponent).toHex();return ct.setRsaPublicKey(new Ct(s,16),new Ct(o,16))};ct.publicKeyToAsn1=ct.publicKeyToSubjectPublicKeyInfo=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.OID,!1,se.oidToDer(ct.oids.rsaEncryption).getBytes()),se.create(se.Class.UNIVERSAL,se.Type.NULL,!1,"")]),se.create(se.Class.UNIVERSAL,se.Type.BITSTRING,!1,[ct.publicKeyToRSAPublicKey(r)])])};ct.publicKeyToRSAPublicKey=function(r){return se.create(se.Class.UNIVERSAL,se.Type.SEQUENCE,!0,[se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.n)),se.create(se.Class.UNIVERSAL,se.Type.INTEGER,!1,Ca(r.e))])};function dM(r,e,t){var i=at.util.createBuffer(),n=Math.ceil(e.n.bitLength()/8);if(r.length>n-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=r.length,s.max=n-11,s}i.putByte(0),i.putByte(t);var o=n-3-r.length,a;if(t===0||t===1){a=t===0?0:255;for(var c=0;c<o;++c)i.putByte(a)}else for(;o>0;){for(var u=0,l=at.random.getBytes(o),c=0;c<o;++c)a=l.charCodeAt(c),a===0?++u:i.putByte(a);o=u}return i.putByte(0),i.putBytes(r),i}function ew(r,e,t,i){var n=Math.ceil(e.n.bitLength()/8),s=at.util.createBuffer(r),o=s.getByte(),a=s.getByte();if(o!==0||t&&a!==0&&a!==1||!t&&a!=2||t&&a===0&&typeof i=="undefined")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=n-3-i;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(a===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var l=s.getByte();if(l!==0||c!==n-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function TCe(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};var i={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(i.prng=e.prng),n();function n(){s(r.pBits,function(a,c){if(a)return t(a);if(r.p=c,r.q!==null)return o(a,r.q);s(r.qBits,o)})}function s(a,c){at.prime.generateProbablePrime(a,i,c)}function o(a,c){if(a)return t(a);if(r.q=c,r.p.compareTo(r.q)<0){var u=r.p;r.p=r.q,r.q=u}if(r.p.subtract(Ct.ONE).gcd(r.e).compareTo(Ct.ONE)!==0){r.p=null,n();return}if(r.q.subtract(Ct.ONE).gcd(r.e).compareTo(Ct.ONE)!==0){r.q=null,s(r.qBits,o);return}if(r.p1=r.p.subtract(Ct.ONE),r.q1=r.q.subtract(Ct.ONE),r.phi=r.p1.multiply(r.q1),r.phi.gcd(r.e).compareTo(Ct.ONE)!==0){r.p=r.q=null,n();return}if(r.n=r.p.multiply(r.q),r.n.bitLength()!==r.bits){r.q=null,s(r.qBits,o);return}var l=r.e.modInverse(r.phi);r.keys={privateKey:ct.rsa.setPrivateKey(r.n,r.e,l,r.p,r.q,l.mod(r.p1),l.mod(r.q1),r.q.modInverse(r.p)),publicKey:ct.rsa.setPublicKey(r.n,r.e)},t(null,r.keys)}}function Ca(r){var e=r.toString(16);e[0]>="8"&&(e="00"+e);var t=at.util.hexToBytes(e);return t.length>1&&(t.charCodeAt(0)===0&&(t.charCodeAt(1)&128)==0||t.charCodeAt(0)===255&&(t.charCodeAt(1)&128)==128)?t.substr(1):t}function RCe(r){return r<=100?27:r<=150?18:r<=200?15:r<=250?12:r<=300?9:r<=350?8:r<=400?7:r<=500?6:r<=600?5:r<=800?4:r<=1250?3:2}function hM(r){return at.util.isNodejs&&typeof oA[r]=="function"}function pM(r){return typeof Ms.globalScope!="undefined"&&typeof Ms.globalScope.crypto=="object"&&typeof Ms.globalScope.crypto.subtle=="object"&&typeof Ms.globalScope.crypto.subtle[r]=="function"}function yM(r){return typeof Ms.globalScope!="undefined"&&typeof Ms.globalScope.msCrypto=="object"&&typeof Ms.globalScope.msCrypto.subtle=="object"&&typeof Ms.globalScope.msCrypto.subtle[r]=="function"}function gM(r){for(var e=at.util.hexToBytes(r.toString(16)),t=new Uint8Array(e.length),i=0;i<e.length;++i)t[i]=e.charCodeAt(i);return t}});var aA=y((yIt,EM)=>{f();var Ue=dt();Sh();Nc();Hv();zu();wh();Q6();Yv();Hu();GB();bg();Qt();typeof bM=="undefined"&&(bM=Ue.jsbn.BigInteger);var bM,fe=Ue.asn1,lt=Ue.pki=Ue.pki||{};EM.exports=lt.pbe=Ue.pbe=Ue.pbe||{};var Ef=lt.oids,CCe={name:"EncryptedPrivateKeyInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PCe={name:"PBES2Algorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},OCe={name:"pkcs-12PbeParams",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"iterations"}]};lt.encryptPrivateKeyInfo=function(r,e,t){t=t||{},t.saltSize=t.saltSize||8,t.count=t.count||2048,t.algorithm=t.algorithm||"aes128",t.prfAlgorithm=t.prfAlgorithm||"sha1";var i=Ue.random.getBytesSync(t.saltSize),n=t.count,s=fe.integerToDer(n),o,a,c;if(t.algorithm.indexOf("aes")===0||t.algorithm==="des"){var u,l,d;switch(t.algorithm){case"aes128":o=16,u=16,l=Ef["aes128-CBC"],d=Ue.aes.createEncryptionCipher;break;case"aes192":o=24,u=16,l=Ef["aes192-CBC"],d=Ue.aes.createEncryptionCipher;break;case"aes256":o=32,u=16,l=Ef["aes256-CBC"],d=Ue.aes.createEncryptionCipher;break;case"des":o=8,u=8,l=Ef.desCBC,d=Ue.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var p="hmacWith"+t.prfAlgorithm.toUpperCase(),g=_M(p),b=Ue.pkcs5.pbkdf2(e,i,n,o,g),E=Ue.random.getBytesSync(u),v=d(b);v.start(E),v.update(fe.toDer(r)),v.finish(),c=v.output.getBytes();var A=kCe(i,s,o,p);a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Ef.pkcs5PBES2).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Ef.pkcs5PBKDF2).getBytes()),A]),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(l).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,E)])])])}else if(t.algorithm==="3des"){o=24;var R=new Ue.util.ByteBuffer(i),b=lt.pbe.generatePkcs12Key(e,R,1,n,o),E=lt.pbe.generatePkcs12Key(e,R,2,n,o),v=Ue.des.createEncryptionCipher(b);v.start(E),v.update(fe.toDer(r)),v.finish(),c=v.output.getBytes(),a=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(Ef["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,i),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=t.algorithm,h}var F=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[a,fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,c)]);return F};lt.decryptPrivateKeyInfo=function(r,e){var t=null,i={},n=[];if(!fe.validate(r,CCe,i,n)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=fe.derToOid(i.encryptionOid),a=lt.pbe.getCipher(o,i.encryptionParams,e),c=Ue.util.createBuffer(i.encryptedData);return a.update(c),a.finish()&&(t=fe.fromDer(a.output)),t};lt.encryptedPrivateKeyToPem=function(r,e){var t={type:"ENCRYPTED PRIVATE KEY",body:fe.toDer(r).getBytes()};return Ue.pem.encode(t,{maxline:e})};lt.encryptedPrivateKeyFromPem=function(r){var e=Ue.pem.decode(r)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var t=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return fe.fromDer(e.body)};lt.encryptRsaPrivateKey=function(r,e,t){if(t=t||{},!t.legacy){var i=lt.wrapRsaPrivateKey(lt.privateKeyToAsn1(r));return i=lt.encryptPrivateKeyInfo(i,e,t),lt.encryptedPrivateKeyToPem(i)}var n,s,o,a;switch(t.algorithm){case"aes128":n="AES-128-CBC",o=16,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"aes192":n="AES-192-CBC",o=24,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"aes256":n="AES-256-CBC",o=32,s=Ue.random.getBytesSync(16),a=Ue.aes.createEncryptionCipher;break;case"3des":n="DES-EDE3-CBC",o=24,s=Ue.random.getBytesSync(8),a=Ue.des.createEncryptionCipher;break;case"des":n="DES-CBC",o=8,s=Ue.random.getBytesSync(8),a=Ue.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+t.algorithm+'".');throw c.algorithm=t.algorithm,c}var u=Ue.pbe.opensslDeriveBytes(e,s.substr(0,8),o),l=a(u);l.start(s),l.update(fe.toDer(lt.privateKeyToAsn1(r))),l.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:n,parameters:Ue.util.bytesToHex(s).toUpperCase()},body:l.output.getBytes()};return Ue.pem.encode(d)};lt.decryptRsaPrivateKey=function(r,e){var t=null,i=Ue.pem.decode(r)[0];if(i.type!=="ENCRYPTED PRIVATE KEY"&&i.type!=="PRIVATE KEY"&&i.type!=="RSA PRIVATE KEY"){var n=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw n.headerType=n,n}if(i.procType&&i.procType.type==="ENCRYPTED"){var s,o;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,o=Ue.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,o=Ue.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,o=Ue.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,o=Ue.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,o=Ue.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,o=function(d){return Ue.rc2.createDecryptionCipher(d,40)};break;case"RC2-64-CBC":s=8,o=function(d){return Ue.rc2.createDecryptionCipher(d,64)};break;case"RC2-128-CBC":s=16,o=function(d){return Ue.rc2.createDecryptionCipher(d,128)};break;default:var n=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".');throw n.algorithm=i.dekInfo.algorithm,n}var a=Ue.util.hexToBytes(i.dekInfo.parameters),c=Ue.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);if(u.start(a),u.update(Ue.util.createBuffer(i.body)),u.finish())t=u.output.getBytes();else return t}else t=i.body;return i.type==="ENCRYPTED PRIVATE KEY"?t=lt.decryptPrivateKeyInfo(fe.fromDer(t),e):t=fe.fromDer(t),t!==null&&(t=lt.privateKeyFromAsn1(t)),t};lt.pbe.generatePkcs12Key=function(r,e,t,i,n,s){var o,a;if(typeof s=="undefined"||s===null){if(!("sha1"in Ue.md))throw new Error('"sha1" hash algorithm unavailable.');s=Ue.md.sha1.create()}var c=s.digestLength,u=s.blockLength,l=new Ue.util.ByteBuffer,d=new Ue.util.ByteBuffer;if(r!=null){for(a=0;a<r.length;a++)d.putInt16(r.charCodeAt(a));d.putInt16(0)}var h=d.length(),p=e.length(),g=new Ue.util.ByteBuffer;g.fillWithByte(t,u);var b=u*Math.ceil(p/u),E=new Ue.util.ByteBuffer;for(a=0;a<b;a++)E.putByte(e.at(a%p));var v=u*Math.ceil(h/u),A=new Ue.util.ByteBuffer;for(a=0;a<v;a++)A.putByte(d.at(a%h));var R=E;R.putBuffer(A);for(var F=Math.ceil(n/c),q=1;q<=F;q++){var N=new Ue.util.ByteBuffer;N.putBytes(g.bytes()),N.putBytes(R.bytes());for(var z=0;z<i;z++)s.start(),s.update(N.getBytes()),N=s.digest();var G=new Ue.util.ByteBuffer;for(a=0;a<u;a++)G.putByte(N.at(a%c));var Y=Math.ceil(p/u)+Math.ceil(h/u),C=new Ue.util.ByteBuffer;for(o=0;o<Y;o++){var m=new Ue.util.ByteBuffer(R.getBytes(u)),w=511;for(a=G.length()-1;a>=0;a--)w=w>>8,w+=G.at(a)+m.at(a),m.setAt(a,w&255);C.putBuffer(m)}R=C,l.putBuffer(N)}return l.truncate(l.length()-n),l};lt.pbe.getCipher=function(r,e,t){switch(r){case lt.oids.pkcs5PBES2:return lt.pbe.getCipherForPBES2(r,e,t);case lt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case lt.oids["pbewithSHAAnd40BitRC2-CBC"]:return lt.pbe.getCipherForPKCS12PBE(r,e,t);default:var i=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw i.oid=r,i.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],i}};lt.pbe.getCipherForPBES2=function(r,e,t){var i={},n=[];if(!fe.validate(e,PCe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}if(r=fe.derToOid(i.kdfOid),r!==lt.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=r,s.supportedOids=["pkcs5PBKDF2"],s}if(r=fe.derToOid(i.encOid),r!==lt.oids["aes128-CBC"]&&r!==lt.oids["aes192-CBC"]&&r!==lt.oids["aes256-CBC"]&&r!==lt.oids["des-EDE3-CBC"]&&r!==lt.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=r,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var o=i.kdfSalt,a=Ue.util.createBuffer(i.kdfIterationCount);a=a.getInt(a.length()<<3);var c,u;switch(lt.oids[r]){case"aes128-CBC":c=16,u=Ue.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=Ue.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=Ue.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=Ue.des.createDecryptionCipher;break;case"desCBC":c=8,u=Ue.des.createDecryptionCipher;break}var l=wM(i.prfOid),d=Ue.pkcs5.pbkdf2(t,o,a,c,l),h=i.encIv,p=u(d);return p.start(h),p};lt.pbe.getCipherForPKCS12PBE=function(r,e,t){var i={},n=[];if(!fe.validate(e,OCe,i,n)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=n,s}var o=Ue.util.createBuffer(i.salt),a=Ue.util.createBuffer(i.iterations);a=a.getInt(a.length()<<3);var c,u,l;switch(r){case lt.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,l=Ue.des.startDecrypting;break;case lt.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,l=function(b,E){var v=Ue.rc2.createDecryptionCipher(b,40);return v.start(E,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=r,s}var d=wM(i.prfOid),h=lt.pbe.generatePkcs12Key(t,o,1,a,c,d);d.start();var p=lt.pbe.generatePkcs12Key(t,o,2,a,u,d);return l(h,p)};lt.pbe.opensslDeriveBytes=function(r,e,t,i){if(typeof i=="undefined"||i===null){if(!("md5"in Ue.md))throw new Error('"md5" hash algorithm unavailable.');i=Ue.md.md5.create()}e===null&&(e="");for(var n=[vM(i,r+e)],s=16,o=1;s<t;++o,s+=16)n.push(vM(i,n[o-1]+r+e));return n.join("").substr(0,t)};function vM(r,e){return r.start().update(e).digest().getBytes()}function wM(r){var e;if(!r)e="hmacWithSHA1";else if(e=lt.oids[fe.derToOid(r)],!e){var t=new Error("Unsupported PRF OID.");throw t.oid=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}return _M(e)}function _M(r){var e=Ue.md;switch(r){case"hmacWithSHA224":e=Ue.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":r=r.substr(8).toLowerCase();break;default:var t=new Error("Unsupported PRF algorithm.");throw t.algorithm=r,t.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],t}if(!e||!(r in e))throw new Error("Unknown hash algorithm: "+r);return e[r].create()}function kCe(r,e,t,i){var n=fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OCTETSTRING,!1,r),fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,e.getBytes())]);return i!=="hmacWithSHA1"&&n.value.push(fe.create(fe.Class.UNIVERSAL,fe.Type.INTEGER,!1,Ue.util.hexToBytes(t.toString(16))),fe.create(fe.Class.UNIVERSAL,fe.Type.SEQUENCE,!0,[fe.create(fe.Class.UNIVERSAL,fe.Type.OID,!1,fe.oidToDer(lt.oids[i]).getBytes()),fe.create(fe.Class.UNIVERSAL,fe.Type.NULL,!1,"")])),n}});var ae=y((gIt,xM)=>{f();"use strict";function SM(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function qCe(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return SM(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),SM(new n,t)}}xM.exports=qCe});var cA={};ut(cA,{identity:()=>NCe});var NCe,AM=xe(()=>{f();wa();Bu();NCe=Tv({prefix:"\0",name:"identity",encode:r=>E6(r),decode:r=>_6(r)})});var uA={};ut(uA,{base2:()=>DCe});var DCe,IM=xe(()=>{f();wa();DCe=Kr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var lA={};ut(lA,{base8:()=>BCe});var BCe,TM=xe(()=>{f();wa();BCe=Kr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var fA={};ut(fA,{base10:()=>MCe});var MCe,RM=xe(()=>{f();wa();MCe=Lu({prefix:"9",name:"base10",alphabet:"0123456789"})});var vg={};ut(vg,{Hasher:()=>dA,from:()=>Lc});var Lc,dA,wg=xe(()=>{f();Cn();Lc=({name:r,code:e,encode:t})=>new dA(r,e,t),dA=class{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}async digest(e){if(e instanceof Uint8Array){let t=await this.encode(e);return ag(this.code,t)}else throw Error("Unknown type, must be binary type")}}});var li={};ut(li,{sha256:()=>Th,sha512:()=>LCe});var CM,Th,LCe,ri=xe(()=>{f();wg();CM=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Th=Lc({name:"sha2-256",code:18,encode:CM("SHA-256")}),LCe=Lc({name:"sha2-512",code:19,encode:CM("SHA-512")})});var Uc={};ut(Uc,{identity:()=>hA});var hA,Fc=xe(()=>{f();wg();Bu();hA=Lc({name:"identity",code:0,encode:r=>Ao(r)})});var Po={};ut(Po,{code:()=>Kc,decode:()=>KCe,encode:()=>FCe,name:()=>UCe});var PM,UCe,Kc,FCe,KCe,Ls=xe(()=>{f();Bu();PM=r=>Ao(r),{name:UCe,code:Kc,encode:FCe,decode:KCe}={name:"raw",code:85,decode:PM,encode:PM}});var tw={};ut(tw,{code:()=>VCe,decode:()=>HCe,encode:()=>zCe,name:()=>jCe});var jCe,VCe,zCe,HCe,pA=xe(()=>{f();({name:jCe,code:VCe,encode:zCe,decode:HCe}={name:"json",code:512,encode:r=>new TextEncoder().encode(JSON.stringify(r)),decode:r=>JSON.parse(new TextDecoder().decode(r))})});var Rh={};ut(Rh,{CID:()=>We,bytes:()=>qc,digest:()=>Wn,hasher:()=>vg,varint:()=>og});var jc=xe(()=>{f();Ie();Av();Bu();wg();Cn()});var yA={};ut(yA,{CID:()=>We,bases:()=>rw,bytes:()=>qc,codecs:()=>GCe,digest:()=>Wn,hasher:()=>vg,hashes:()=>$Ce,varint:()=>og});var rw,$Ce,GCe,iw=xe(()=>{f();AM();IM();TM();RM();A6();sn();x6();ei();ug();ri();Fc();Ls();pA();jc();rw={...cA,...uA,...lA,...fA,...Ov,...nn,...Pv,...Jr,...bh},$Ce={...li,...Uc},GCe={raw:Po,json:tw}});function OM(r,e,t,i){return{name:r,prefix:e,encoder:{name:r,prefix:e,encode:t},decoder:{decode:i}}}var kM,gA,WCe,nw,mA=xe(()=>{f();iw();kM=OM("utf8","u",r=>{let e=new TextDecoder("utf8");return"u"+e.decode(r)},r=>new TextEncoder().encode(r.substring(1))),gA=OM("ascii","a",r=>{let e="a";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e},r=>{r=r.substring(1);let e=new Uint8Array(r.length);for(let t=0;t<r.length;t++)e[t]=r.charCodeAt(t);return e}),WCe={utf8:kM,"utf-8":kM,hex:rw.base16,latin1:gA,ascii:gA,binary:gA,...rw},nw=WCe});var ht={};ut(ht,{fromString:()=>bA});function bA(r,e="utf8"){let t=nw[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.decoder.decode(`${t.prefix}${r}`)}var ft=xe(()=>{f();mA()});var an={};ut(an,{concat:()=>YCe});function YCe(r,e){e||(e=r.reduce((n,s)=>n+s.length,0));let t=new Uint8Array(e),i=0;for(let n of r)t.set(n,i),i+=n.length;return t}var cn=xe(()=>{f()});var _g=y(qM=>{f();"use strict";qM.get=(r=self)=>{let e=r.crypto||r.msCrypto;if(!e||!e.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}});var vA=y((qIt,DM)=>{f();"use strict";var{concat:XCe}=(cn(),an),{fromString:NM}=(ft(),ht),QCe=_g();function ZCe({algorithm:r="AES-GCM",nonceLength:e=12,keyLength:t=16,digest:i="SHA-256",saltLength:n=16,iterations:s=32767}={}){let o=QCe.get();t*=8;async function a(u,l){let d=o.getRandomValues(new Uint8Array(n)),h=o.getRandomValues(new Uint8Array(e)),p={name:r,iv:h},g={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await o.subtle.importKey("raw",NM(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await o.subtle.deriveKey(g,b,{name:r,length:t},!0,["encrypt"]),v=await o.subtle.encrypt(p,E,u);return XCe([d,p.iv,new Uint8Array(v)])}async function c(u,l){let d=u.slice(0,n),h=u.slice(n,n+e),p=u.slice(n+e),g={name:r,iv:h},b={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},E=await o.subtle.importKey("raw",NM(l),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await o.subtle.deriveKey(b,E,{name:r,length:t},!0,["decrypt"]),A=await o.subtle.decrypt(g,v,p);return new Uint8Array(A)}return{encrypt:a,decrypt:c}}DM.exports={create:ZCe}});var MM=y((NIt,BM)=>{f();"use strict";var{base64:JCe}=(ug(),bh),ePe=vA();BM.exports={import:async function(r,e){let t=JCe.decode(r);return await ePe.create().decrypt(t,e)}}});var fi={};ut(fi,{equals:()=>tPe});function tPe(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}var di=xe(()=>{f()});var et={};ut(et,{toString:()=>rPe});function rPe(r,e="utf8"){let t=nw[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return t.encoder.encode(r).substring(1)}var tt=xe(()=>{f();mA()});var sw=y((BIt,KM)=>{f();var pr=dt();zu();Qt();var Eg=KM.exports=pr.sha512=pr.sha512||{};pr.md.sha512=pr.md.algorithms.sha512=Eg;var LM=pr.sha384=pr.sha512.sha384=pr.sha512.sha384||{};LM.create=function(){return Eg.create("SHA-384")};pr.md.sha384=pr.md.algorithms.sha384=LM;pr.sha512.sha256=pr.sha512.sha256||{create:function(){return Eg.create("SHA-512/256")}};pr.md["sha512/256"]=pr.md.algorithms["sha512/256"]=pr.sha512.sha256;pr.sha512.sha224=pr.sha512.sha224||{create:function(){return Eg.create("SHA-512/224")}};pr.md["sha512/224"]=pr.md.algorithms["sha512/224"]=pr.sha512.sha224;Eg.create=function(r){if(UM||iPe(),typeof r=="undefined"&&(r="SHA-512"),!(r in Sf))throw new Error("Invalid SHA-512 algorithm: "+r);for(var e=Sf[r],t=null,i=pr.util.createBuffer(),n=new Array(80),s=0;s<80;++s)n[s]=new Array(2);var o=64;switch(r){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:r.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,u=0;u<c;++u)a.fullMessageLength.push(0);i=pr.util.createBuffer(),t=new Array(e.length);for(var u=0;u<e.length;++u)t[u]=e[u].slice(0);return a},a.start(),a.update=function(c,u){u==="utf8"&&(c=pr.util.encodeUtf8(c));var l=c.length;a.messageLength+=l,l=[l/4294967296>>>0,l>>>0];for(var d=a.fullMessageLength.length-1;d>=0;--d)a.fullMessageLength[d]+=l[1],l[1]=l[0]+(a.fullMessageLength[d]/4294967296>>>0),a.fullMessageLength[d]=a.fullMessageLength[d]>>>0,l[0]=l[1]/4294967296>>>0;return i.putBytes(c),FM(t,n,i),(i.read>2048||i.length()===0)&&i.compact(),a},a.digest=function(){var c=pr.util.createBuffer();c.putBytes(i.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,l=u&a.blockLength-1;c.putBytes(wA.substr(0,a.blockLength-l));for(var d,h,p=a.fullMessageLength[0]*8,g=0;g<a.fullMessageLength.length-1;++g)d=a.fullMessageLength[g+1]*8,h=d/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=d>>>0;c.putInt32(p);for(var b=new Array(t.length),g=0;g<t.length;++g)b[g]=t[g].slice(0);FM(b,n,c);var E=pr.util.createBuffer(),v;r==="SHA-512"?v=b.length:r==="SHA-384"?v=b.length-2:v=b.length-4;for(var g=0;g<v;++g)E.putInt32(b[g][0]),(g!==v-1||r!=="SHA-512/224")&&E.putInt32(b[g][1]);return E},a};var wA=null,UM=!1,_A=null,Sf=null;function iPe(){wA=String.fromCharCode(128),wA+=pr.util.fillString(String.fromCharCode(0),128),_A=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Sf={},Sf["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Sf["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Sf["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Sf["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],UM=!0}function FM(r,e,t){for(var i,n,s,o,a,c,u,l,d,h,p,g,b,E,v,A,R,F,q,N,z,G,Y,C,m,w,S,P,B,W,j,M,_,L,ce,X=t.length();X>=128;){for(B=0;B<16;++B)e[B][0]=t.getInt32()>>>0,e[B][1]=t.getInt32()>>>0;for(;B<80;++B)M=e[B-2],W=M[0],j=M[1],i=((W>>>19|j<<13)^(j>>>29|W<<3)^W>>>6)>>>0,n=((W<<13|j>>>19)^(j<<3|W>>>29)^(W<<26|j>>>6))>>>0,L=e[B-15],W=L[0],j=L[1],s=((W>>>1|j<<31)^(W>>>8|j<<24)^W>>>7)>>>0,o=((W<<31|j>>>1)^(W<<24|j>>>8)^(W<<25|j>>>7))>>>0,_=e[B-7],ce=e[B-16],j=n+_[1]+o+ce[1],e[B][0]=i+_[0]+s+ce[0]+(j/4294967296>>>0)>>>0,e[B][1]=j>>>0;for(b=r[0][0],E=r[0][1],v=r[1][0],A=r[1][1],R=r[2][0],F=r[2][1],q=r[3][0],N=r[3][1],z=r[4][0],G=r[4][1],Y=r[5][0],C=r[5][1],m=r[6][0],w=r[6][1],S=r[7][0],P=r[7][1],B=0;B<80;++B)u=((z>>>14|G<<18)^(z>>>18|G<<14)^(G>>>9|z<<23))>>>0,l=((z<<18|G>>>14)^(z<<14|G>>>18)^(G<<23|z>>>9))>>>0,d=(m^z&(Y^m))>>>0,h=(w^G&(C^w))>>>0,a=((b>>>28|E<<4)^(E>>>2|b<<30)^(E>>>7|b<<25))>>>0,c=((b<<4|E>>>28)^(E<<30|b>>>2)^(E<<25|b>>>7))>>>0,p=(b&v|R&(b^v))>>>0,g=(E&A|F&(E^A))>>>0,j=P+l+h+_A[B][1]+e[B][1],i=S+u+d+_A[B][0]+e[B][0]+(j/4294967296>>>0)>>>0,n=j>>>0,j=c+g,s=a+p+(j/4294967296>>>0)>>>0,o=j>>>0,S=m,P=w,m=Y,w=C,Y=z,C=G,j=N+n,z=q+i+(j/4294967296>>>0)>>>0,G=j>>>0,q=R,N=F,R=v,F=A,v=b,A=E,j=n+o,b=i+s+(j/4294967296>>>0)>>>0,E=j>>>0;j=r[0][1]+E,r[0][0]=r[0][0]+b+(j/4294967296>>>0)>>>0,r[0][1]=j>>>0,j=r[1][1]+A,r[1][0]=r[1][0]+v+(j/4294967296>>>0)>>>0,r[1][1]=j>>>0,j=r[2][1]+F,r[2][0]=r[2][0]+R+(j/4294967296>>>0)>>>0,r[2][1]=j>>>0,j=r[3][1]+N,r[3][0]=r[3][0]+q+(j/4294967296>>>0)>>>0,r[3][1]=j>>>0,j=r[4][1]+G,r[4][0]=r[4][0]+z+(j/4294967296>>>0)>>>0,r[4][1]=j>>>0,j=r[5][1]+C,r[5][0]=r[5][0]+Y+(j/4294967296>>>0)>>>0,r[5][1]=j>>>0,j=r[6][1]+w,r[6][0]=r[6][0]+m+(j/4294967296>>>0)>>>0,r[6][1]=j>>>0,j=r[7][1]+P,r[7][0]=r[7][0]+S+(j/4294967296>>>0)>>>0,r[7][1]=j>>>0,X-=128}}});var jM=y(EA=>{f();var nPe=dt();Nc();var Bi=nPe.asn1;EA.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};EA.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Bi.Class.UNIVERSAL,type:Bi.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var OA=y((LIt,e7)=>{f();var $i=dt();mg();Hu();sw();Qt();var VM=jM(),sPe=VM.publicKeyValidator,oPe=VM.privateKeyValidator;typeof zM=="undefined"&&(zM=$i.jsbn.BigInteger);var zM,SA=$i.util.ByteBuffer,Qn=typeof Buffer=="undefined"?Uint8Array:Buffer;$i.pki=$i.pki||{};e7.exports=$i.pki.ed25519=$i.ed25519=$i.ed25519||{};var wt=$i.ed25519;wt.constants={};wt.constants.PUBLIC_KEY_BYTE_LENGTH=32;wt.constants.PRIVATE_KEY_BYTE_LENGTH=64;wt.constants.SEED_BYTE_LENGTH=32;wt.constants.SIGN_BYTE_LENGTH=64;wt.constants.HASH_BYTE_LENGTH=64;wt.generateKeyPair=function(r){r=r||{};var e=r.seed;if(e===void 0)e=$i.random.getBytesSync(wt.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==wt.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+wt.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Vc({message:e,encoding:"binary"});for(var t=new Qn(wt.constants.PUBLIC_KEY_BYTE_LENGTH),i=new Qn(wt.constants.PRIVATE_KEY_BYTE_LENGTH),n=0;n<32;++n)i[n]=e[n];return lPe(t,i),{publicKey:t,privateKey:i}};wt.privateKeyFromAsn1=function(r){var e={},t=[],i=$i.asn1.validate(r,oPe,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=$i.asn1.derToOid(e.privateKeyOid),o=$i.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.privateKey,c=Vc({message:$i.asn1.fromDer(a).value,encoding:"binary"});return{privateKeyBytes:c}};wt.publicKeyFromAsn1=function(r){var e={},t=[],i=$i.asn1.validate(r,sPe,e,t);if(!i){var n=new Error("Invalid Key.");throw n.errors=t,n}var s=$i.asn1.derToOid(e.publicKeyOid),o=$i.oids.EdDSA25519;if(s!==o)throw new Error('Invalid OID "'+s+'"; OID must be "'+o+'".');var a=e.ed25519PublicKey;if(a.length!==wt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Vc({message:a,encoding:"binary"})};wt.publicKeyFromPrivateKey=function(r){r=r||{};var e=Vc({message:r.privateKey,encoding:"binary"});if(e.length!==wt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+wt.constants.PRIVATE_KEY_BYTE_LENGTH);for(var t=new Qn(wt.constants.PUBLIC_KEY_BYTE_LENGTH),i=0;i<t.length;++i)t[i]=e[32+i];return t};wt.sign=function(r){r=r||{};var e=Vc(r),t=Vc({message:r.privateKey,encoding:"binary"});if(t.length===wt.constants.SEED_BYTE_LENGTH){var i=wt.generateKeyPair({seed:t});t=i.privateKey}else if(t.length!==wt.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+wt.constants.SEED_BYTE_LENGTH+" or "+wt.constants.PRIVATE_KEY_BYTE_LENGTH);var n=new Qn(wt.constants.SIGN_BYTE_LENGTH+e.length);fPe(n,e,e.length,t);for(var s=new Qn(wt.constants.SIGN_BYTE_LENGTH),o=0;o<s.length;++o)s[o]=n[o];return s};wt.verify=function(r){r=r||{};var e=Vc(r);if(r.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var t=Vc({message:r.signature,encoding:"binary"});if(t.length!==wt.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+wt.constants.SIGN_BYTE_LENGTH);var i=Vc({message:r.publicKey,encoding:"binary"});if(i.length!==wt.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+wt.constants.PUBLIC_KEY_BYTE_LENGTH);var n=new Qn(wt.constants.SIGN_BYTE_LENGTH+e.length),s=new Qn(wt.constants.SIGN_BYTE_LENGTH+e.length),o;for(o=0;o<wt.constants.SIGN_BYTE_LENGTH;++o)n[o]=t[o];for(o=0;o<e.length;++o)n[o+wt.constants.SIGN_BYTE_LENGTH]=e[o];return dPe(s,n,n.length,i)>=0};function Vc(r){var e=r.message;if(e instanceof Uint8Array||e instanceof Qn)return e;var t=r.encoding;if(e===void 0)if(r.md)e=r.md.digest().getBytes(),t="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!t)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer!="undefined")return Buffer.from(e,t);e=new SA(e,t)}else if(!(e instanceof SA))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var i=new Qn(e.length()),n=0;n<i.length;++n)i[n]=e.at(n);return i}var xA=Xe(),ow=Xe([1]),aPe=Xe([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),cPe=Xe([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),HM=Xe([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),$M=Xe([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),AA=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),uPe=Xe([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Sg(r,e){var t=$i.md.sha512.create(),i=new SA(r);t.update(i.getBytes(e),"binary");var n=t.digest().getBytes();if(typeof Buffer!="undefined")return Buffer.from(n,"binary");for(var s=new Qn(wt.constants.HASH_BYTE_LENGTH),o=0;o<64;++o)s[o]=n.charCodeAt(o);return s}function lPe(r,e){var t=[Xe(),Xe(),Xe(),Xe()],i,n=Sg(e,32);for(n[0]&=248,n[31]&=127,n[31]|=64,CA(t,n),RA(r,t),i=0;i<32;++i)e[i+32]=r[i];return 0}function fPe(r,e,t,i){var n,s,o=new Float64Array(64),a=[Xe(),Xe(),Xe(),Xe()],c=Sg(i,32);c[0]&=248,c[31]&=127,c[31]|=64;var u=t+64;for(n=0;n<t;++n)r[64+n]=e[n];for(n=0;n<32;++n)r[32+n]=c[32+n];var l=Sg(r.subarray(32),t+32);for(IA(l),CA(a,l),RA(r,a),n=32;n<64;++n)r[n]=i[n];var d=Sg(r,t+64);for(IA(d),n=32;n<64;++n)o[n]=0;for(n=0;n<32;++n)o[n]=l[n];for(n=0;n<32;++n)for(s=0;s<32;s++)o[n+s]+=d[n]*c[s];return GM(r.subarray(32),o),u}function dPe(r,e,t,i){var n,s,o=new Qn(32),a=[Xe(),Xe(),Xe(),Xe()],c=[Xe(),Xe(),Xe(),Xe()];if(s=-1,t<64||hPe(c,i))return-1;for(n=0;n<t;++n)r[n]=e[n];for(n=0;n<32;++n)r[n+32]=i[n];var u=Sg(r,t);if(IA(u),ZM(a,c,u),CA(c,e.subarray(32)),TA(a,c),RA(o,a),t-=64,XM(e,0,o,0)){for(n=0;n<t;++n)r[n]=0;return-1}for(n=0;n<t;++n)r[n]=e[n+64];return s=t,s}function GM(r,e){var t,i,n,s;for(i=63;i>=32;--i){for(t=0,n=i-32,s=i-12;n<s;++n)e[n]+=t-16*e[i]*AA[n-(i-32)],t=e[n]+128>>8,e[n]-=t*256;e[n]+=t,e[i]=0}for(t=0,n=0;n<32;++n)e[n]+=t-(e[31]>>4)*AA[n],t=e[n]>>8,e[n]&=255;for(n=0;n<32;++n)e[n]-=t*AA[n];for(i=0;i<32;++i)e[i+1]+=e[i]>>8,r[i]=e[i]&255}function IA(r){for(var e=new Float64Array(64),t=0;t<64;++t)e[t]=r[t],r[t]=0;GM(r,e)}function TA(r,e){var t=Xe(),i=Xe(),n=Xe(),s=Xe(),o=Xe(),a=Xe(),c=Xe(),u=Xe(),l=Xe();Ph(t,r[1],r[0]),Ph(l,e[1],e[0]),Zt(t,t,l),Ch(i,r[0],r[1]),Ch(l,e[0],e[1]),Zt(i,i,l),Zt(n,r[3],e[3]),Zt(n,n,cPe),Zt(s,r[2],e[2]),Ch(s,s,s),Ph(o,i,t),Ph(a,s,n),Ch(c,s,n),Ch(u,i,t),Zt(r[0],o,a),Zt(r[1],u,c),Zt(r[2],c,a),Zt(r[3],o,u)}function WM(r,e,t){for(var i=0;i<4;++i)JM(r[i],e[i],t)}function RA(r,e){var t=Xe(),i=Xe(),n=Xe();mPe(n,e[2]),Zt(t,e[0],n),Zt(i,e[1],n),aw(r,i),r[31]^=QM(t)<<7}function aw(r,e){var t,i,n,s=Xe(),o=Xe();for(t=0;t<16;++t)o[t]=e[t];for(PA(o),PA(o),PA(o),i=0;i<2;++i){for(s[0]=o[0]-65517,t=1;t<15;++t)s[t]=o[t]-65535-(s[t-1]>>16&1),s[t-1]&=65535;s[15]=o[15]-32767-(s[14]>>16&1),n=s[15]>>16&1,s[14]&=65535,JM(o,s,1-n)}for(t=0;t<16;t++)r[2*t]=o[t]&255,r[2*t+1]=o[t]>>8}function hPe(r,e){var t=Xe(),i=Xe(),n=Xe(),s=Xe(),o=Xe(),a=Xe(),c=Xe();return Wu(r[2],ow),pPe(r[1],e),xf(n,r[1]),Zt(s,n,aPe),Ph(n,n,r[2]),Ch(s,r[2],s),xf(o,s),xf(a,o),Zt(c,a,o),Zt(t,c,n),Zt(t,t,s),yPe(t,t),Zt(t,t,n),Zt(t,t,s),Zt(t,t,s),Zt(r[0],t,s),xf(i,r[0]),Zt(i,i,s),YM(i,n)&&Zt(r[0],r[0],uPe),xf(i,r[0]),Zt(i,i,s),YM(i,n)?-1:(QM(r[0])===e[31]>>7&&Ph(r[0],xA,r[0]),Zt(r[3],r[0],r[1]),0)}function pPe(r,e){var t;for(t=0;t<16;++t)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function yPe(r,e){var t=Xe(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=250;i>=0;--i)xf(t,t),i!==1&&Zt(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function YM(r,e){var t=new Qn(32),i=new Qn(32);return aw(t,r),aw(i,e),XM(t,0,i,0)}function XM(r,e,t,i){return gPe(r,e,t,i,32)}function gPe(r,e,t,i,n){var s,o=0;for(s=0;s<n;++s)o|=r[e+s]^t[i+s];return(1&o-1>>>8)-1}function QM(r){var e=new Qn(32);return aw(e,r),e[0]&1}function ZM(r,e,t){var i,n;for(Wu(r[0],xA),Wu(r[1],ow),Wu(r[2],ow),Wu(r[3],xA),n=255;n>=0;--n)i=t[n/8|0]>>(n&7)&1,WM(r,e,i),TA(e,r),TA(r,r),WM(r,e,i)}function CA(r,e){var t=[Xe(),Xe(),Xe(),Xe()];Wu(t[0],HM),Wu(t[1],$M),Wu(t[2],ow),Zt(t[3],HM,$M),ZM(r,t,e)}function Wu(r,e){var t;for(t=0;t<16;t++)r[t]=e[t]|0}function mPe(r,e){var t=Xe(),i;for(i=0;i<16;++i)t[i]=e[i];for(i=253;i>=0;--i)xf(t,t),i!==2&&i!==4&&Zt(t,t,e);for(i=0;i<16;++i)r[i]=t[i]}function PA(r){var e,t,i=1;for(e=0;e<16;++e)t=r[e]+i+65535,i=Math.floor(t/65536),r[e]=t-i*65536;r[0]+=i-1+37*(i-1)}function JM(r,e,t){for(var i,n=~(t-1),s=0;s<16;++s)i=n&(r[s]^e[s]),r[s]^=i,e[s]^=i}function Xe(r){var e,t=new Float64Array(16);if(r)for(e=0;e<r.length;++e)t[e]=r[e];return t}function Ch(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]+t[i]}function Ph(r,e,t){for(var i=0;i<16;++i)r[i]=e[i]-t[i]}function xf(r,e){Zt(r,e,e)}function Zt(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,p=0,g=0,b=0,E=0,v=0,A=0,R=0,F=0,q=0,N=0,z=0,G=0,Y=0,C=0,m=0,w=0,S=0,P=0,B=0,W=0,j=0,M=0,_=0,L=t[0],ce=t[1],X=t[2],ne=t[3],oe=t[4],he=t[5],pe=t[6],_e=t[7],k=t[8],K=t[9],$=t[10],Z=t[11],I=t[12],U=t[13],V=t[14],D=t[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,p+=i*k,g+=i*K,b+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*D,i=e[1],o+=i*L,a+=i*ce,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,p+=i*_e,g+=i*k,b+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*D,i=e[2],a+=i*L,c+=i*ce,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,p+=i*pe,g+=i*_e,b+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,N+=i*D,i=e[3],c+=i*L,u+=i*ce,l+=i*X,d+=i*ne,h+=i*oe,p+=i*he,g+=i*pe,b+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,N+=i*V,z+=i*D,i=e[4],u+=i*L,l+=i*ce,d+=i*X,h+=i*ne,p+=i*oe,g+=i*he,b+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,N+=i*U,z+=i*V,G+=i*D,i=e[5],l+=i*L,d+=i*ce,h+=i*X,p+=i*ne,g+=i*oe,b+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,N+=i*I,z+=i*U,G+=i*V,Y+=i*D,i=e[6],d+=i*L,h+=i*ce,p+=i*X,g+=i*ne,b+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,N+=i*Z,z+=i*I,G+=i*U,Y+=i*V,C+=i*D,i=e[7],h+=i*L,p+=i*ce,g+=i*X,b+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,N+=i*$,z+=i*Z,G+=i*I,Y+=i*U,C+=i*V,m+=i*D,i=e[8],p+=i*L,g+=i*ce,b+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,N+=i*K,z+=i*$,G+=i*Z,Y+=i*I,C+=i*U,m+=i*V,w+=i*D,i=e[9],g+=i*L,b+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,N+=i*k,z+=i*K,G+=i*$,Y+=i*Z,C+=i*I,m+=i*U,w+=i*V,S+=i*D,i=e[10],b+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,N+=i*_e,z+=i*k,G+=i*K,Y+=i*$,C+=i*Z,m+=i*I,w+=i*U,S+=i*V,P+=i*D,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,N+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,C+=i*$,m+=i*Z,w+=i*I,S+=i*U,P+=i*V,B+=i*D,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,N+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,C+=i*K,m+=i*$,w+=i*Z,S+=i*I,P+=i*U,B+=i*V,W+=i*D,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,N+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,C+=i*k,m+=i*K,w+=i*$,S+=i*Z,P+=i*I,B+=i*U,W+=i*V,j+=i*D,i=e[14],R+=i*L,F+=i*ce,q+=i*X,N+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,C+=i*_e,m+=i*k,w+=i*K,S+=i*$,P+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*D,i=e[15],F+=i*L,q+=i*ce,N+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,C+=i*pe,m+=i*_e,w+=i*k,S+=i*K,P+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*D,s+=38*q,o+=38*N,a+=38*z,c+=38*G,u+=38*Y,l+=38*C,d+=38*m,h+=38*w,p+=38*S,g+=38*P,b+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=l,r[6]=d,r[7]=h,r[8]=p,r[9]=g,r[10]=b,r[11]=E,r[12]=v,r[13]=A,r[14]=R,r[15]=F}});var r7=y((UIt,t7)=>{f();"use strict";var cw=65536;function bPe(r){let e=new Uint8Array(r),t=0;if(r>0)if(r>cw)for(;t<r;)t+cw>r?(crypto.getRandomValues(e.subarray(t,t+(r-t))),t+=r-t):(crypto.getRandomValues(e.subarray(t,t+cw)),t+=cw);else crypto.getRandomValues(e);return e}t7.exports=bPe});var xg=y((FIt,i7)=>{f();"use strict";var vPe=r7(),wPe=ae();i7.exports=function(r){if(isNaN(r)||r<=0)throw wPe(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return vPe(r)}});var uw=y(Ag=>{f();"use strict";Qt();mg();var _Pe=dt(),{fromString:EPe}=(ft(),ht),{toString:n7}=(tt(),et),{concat:s7}=(cn(),an);Ag.bigIntegerToUintBase64url=(r,e)=>{let t=Uint8Array.from(r.abs().toByteArray());if(t=t[0]===0?t.slice(1):t,e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=s7([new Uint8Array(e-t.length),t])}return n7(t,"base64url")};Ag.base64urlToBigInteger=r=>{let e=Ag.base64urlToBuffer(r);return new _Pe.jsbn.BigInteger(n7(e,"base16"),16)};Ag.base64urlToBuffer=(r,e)=>{let t=EPe(r,"base64urlpad");if(e!=null){if(t.length>e)throw new Error("byte array longer than desired length");t=s7([new Uint8Array(e-t.length),t])}return t}});var c7=y(Ig=>{f();"use strict";Nc();bg();var Yu=dt(),{bigIntegerToUintBase64url:Pa,base64urlToBigInteger:Oa}=uw(),{fromString:o7}=(ft(),ht),{toString:a7}=(tt(),et);Ig.pkcs1ToJwk=function(r){let e=Yu.asn1.fromDer(a7(r,"ascii")),t=Yu.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Pa(t.n),e:Pa(t.e),d:Pa(t.d),p:Pa(t.p),q:Pa(t.q),dp:Pa(t.dP),dq:Pa(t.dQ),qi:Pa(t.qInv),alg:"RS256",kid:"2011-04-29"}};Ig.jwkToPkcs1=function(r){let e=Yu.pki.privateKeyToAsn1({n:Oa(r.n),e:Oa(r.e),d:Oa(r.d),p:Oa(r.p),q:Oa(r.q),dP:Oa(r.dp),dQ:Oa(r.dq),qInv:Oa(r.qi)});return o7(Yu.asn1.toDer(e).getBytes(),"ascii")};Ig.pkixToJwk=function(r){let e=Yu.asn1.fromDer(a7(r,"ascii")),t=Yu.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Pa(t.n),e:Pa(t.e),alg:"RS256",kid:"2011-04-29"}};Ig.jwkToPkix=function(r){let e=Yu.pki.publicKeyToAsn1({n:Oa(r.n),e:Oa(r.e)});return o7(Yu.asn1.toDer(e).getBytes(),"ascii")}});var d7=y((VIt,f7)=>{f();"use strict";bg();var u7=dt(),{base64urlToBigInteger:SPe}=uw();function l7(r,e){return e.map(t=>SPe(r[t]))}function xPe(r){return u7.pki.setRsaPrivateKey(...l7(r,["n","e","d","p","q","dp","dq","qi"]))}function APe(r){return u7.pki.setRsaPublicKey(...l7(r,["n","e"]))}f7.exports={jwk2pub:APe,jwk2priv:xPe}});var y7=y(Hc=>{f();"use strict";var zc=_g(),IPe=xg(),{toString:TPe}=(tt(),et),{fromString:RPe}=(ft(),ht);Hc.utils=c7();Hc.generateKey=async function(r){let e=await zc.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:r,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),t=await h7(e);return{privateKey:t[0],publicKey:t[1]}};Hc.unmarshalPrivateKey=async function(r){let t=[await zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await CPe(r)],i=await h7({privateKey:t[0],publicKey:t[1]});return{privateKey:i[0],publicKey:i[1]}};Hc.getRandomValues=IPe;Hc.hashAndSign=async function(r,e){let t=await zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),i=await zc.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},t,Uint8Array.from(e));return new Uint8Array(i,i.byteOffset,i.byteLength)};Hc.hashAndVerify=async function(r,e,t){let i=await zc.get().subtle.importKey("jwk",r,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return zc.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},i,e,t)};function h7(r){return Promise.all([zc.get().subtle.exportKey("jwk",r.privateKey),zc.get().subtle.exportKey("jwk",r.publicKey)])}function CPe(r){return zc.get().subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}var{jwk2pub:PPe,jwk2priv:OPe}=d7();function p7(r,e,t,i){let n=e?PPe(r):OPe(r),s=TPe(Uint8Array.from(t),"ascii"),o=i(s,n);return RPe(o,"ascii")}Hc.encrypt=function(r,e){return p7(r,!0,e,(t,i)=>i.encrypt(t))};Hc.decrypt=function(r,e){return p7(r,!1,e,(t,i)=>i.decrypt(t))}});var lw=y((HIt,g7)=>{f();"use strict";var{base64:kPe}=(ug(),bh),qPe=vA();g7.exports={export:async function(r,e){let i=await qPe.create().encrypt(r,e);return kPe.encode(i)}}});var _7=y(($It,w7)=>{f();"use strict";var{sha256:m7}=(ri(),li),b7=ae(),{equals:v7}=(di(),fi),{toString:NPe}=(tt(),et);sw();OA();var fw=dt(),Us=y7(),dw=Mv(),DPe=lw(),hw=class{constructor(e){this._key=e}async verify(e,t){return Us.hashAndVerify(this._key,t,e)}marshal(){return Us.utils.jwkToPkix(this._key)}get bytes(){return dw.PublicKey.encode({Type:dw.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(e){return Us.encrypt(this._key,e)}equals(e){return v7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await m7.digest(this.bytes);return e}},Tg=class{constructor(e,t){this._key=e,this._publicKey=t}genSecret(){return Us.getRandomValues(16)}async sign(e){return Us.hashAndSign(this._key,e)}get public(){if(!this._publicKey)throw b7(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new hw(this._publicKey)}decrypt(e){return Us.decrypt(this._key,e)}marshal(){return Us.utils.jwkToPkcs1(this._key)}get bytes(){return dw.PrivateKey.encode({Type:dw.KeyType.RSA,Data:this.marshal()}).finish()}equals(e){return v7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await m7.digest(this.bytes);return e}async id(){let e=await this.public.hash();return NPe(e,"base58btc")}async export(e,t="pkcs-8"){if(t==="pkcs-8"){let i=new fw.util.ByteBuffer(this.marshal()),n=fw.asn1.fromDer(i),s=fw.pki.privateKeyFromAsn1(n),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return fw.pki.encryptRsaPrivateKey(s,e,o)}else{if(t==="libp2p-key")return DPe.export(this.bytes,e);throw b7(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function BPe(r){let e=Us.utils.pkcs1ToJwk(r),t=await Us.unmarshalPrivateKey(e);return new Tg(t.privateKey,t.publicKey)}function MPe(r){let e=Us.utils.pkixToJwk(r);return new hw(e)}async function LPe(r){let e=await Us.unmarshalPrivateKey(r);return new Tg(e.privateKey,e.publicKey)}async function UPe(r){let e=await Us.generateKey(r);return new Tg(e.privateKey,e.publicKey)}w7.exports={RsaPublicKey:hw,RsaPrivateKey:Tg,unmarshalRsaPublicKey:MPe,unmarshalRsaPrivateKey:BPe,generateKeyPair:UPe,fromJwk:LPe}});var E7=y(Af=>{f();"use strict";OA();var Oh=dt();Af.publicKeyLength=Oh.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH;Af.privateKeyLength=Oh.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH;Af.generateKey=async function(){return Oh.pki.ed25519.generateKeyPair()};Af.generateKeyFromSeed=async function(r){return Oh.pki.ed25519.generateKeyPair({seed:r})};Af.hashAndSign=async function(r,e){return Oh.pki.ed25519.sign({message:e,privateKey:r})};Af.hashAndVerify=async function(r,e,t){return Oh.pki.ed25519.verify({signature:e,message:t,publicKey:r})}});var T7=y((WIt,I7)=>{f();"use strict";var S7=ae(),{equals:x7}=(di(),fi),{sha256:A7}=(ri(),li),{base58btc:FPe}=(ei(),Jr),{identity:KPe}=(Fc(),Uc),un=E7(),pw=Mv(),jPe=lw(),yw=class{constructor(e){this._key=qh(e,un.publicKeyLength)}async verify(e,t){return un.hashAndVerify(this._key,t,e)}marshal(){return this._key}get bytes(){return pw.PublicKey.encode({Type:pw.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return x7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await A7.digest(this.bytes);return e}},kh=class{constructor(e,t){this._key=qh(e,un.privateKeyLength),this._publicKey=qh(t,un.publicKeyLength)}async sign(e){return un.hashAndSign(this._key,e)}get public(){return new yw(this._publicKey)}marshal(){return this._key}get bytes(){return pw.PrivateKey.encode({Type:pw.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(e){return x7(this.bytes,e.bytes)}async hash(){let{bytes:e}=await A7.digest(this.bytes);return e}async id(){let e=await KPe.digest(this.public.bytes);return FPe.encode(e.bytes).substring(1)}async export(e,t="libp2p-key"){if(t==="libp2p-key")return jPe.export(this.bytes,e);throw S7(new Error(`export format '${t}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function VPe(r){if(r.length>un.privateKeyLength){r=qh(r,un.privateKeyLength+un.publicKeyLength);let i=r.slice(0,un.privateKeyLength),n=r.slice(un.privateKeyLength,r.length);return new kh(i,n)}r=qh(r,un.privateKeyLength);let e=r.slice(0,un.privateKeyLength),t=r.slice(un.publicKeyLength);return new kh(e,t)}function zPe(r){return r=qh(r,un.publicKeyLength),new yw(r)}async function HPe(){let{privateKey:r,publicKey:e}=await un.generateKey();return new kh(r,e)}async function $Pe(r){let{privateKey:e,publicKey:t}=await un.generateKeyFromSeed(r);return new kh(e,t)}function qh(r,e){if(r=Uint8Array.from(r||[]),r.length!==e)throw S7(new Error(`Key must be a Uint8Array of length ${e}, got ${r.length}`),"ERR_INVALID_KEY_TYPE");return r}I7.exports={Ed25519PublicKey:yw,Ed25519PrivateKey:kh,unmarshalEd25519PrivateKey:VPe,unmarshalEd25519PublicKey:zPe,generateKeyPair:HPe,generateKeyPairFromSeed:$Pe}});var C7=y((YIt,R7)=>{f();var Bt={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function Fs(r,e){if(!r)throw new Error(e)}function Pt(r,e,t){if(Fs(e instanceof Uint8Array,`Expected ${r} to be an Uint8Array`),t!==void 0)if(Array.isArray(t)){let i=t.join(", "),n=`Expected ${r} to be an Uint8Array with length [${i}]`;Fs(t.includes(e.length),n)}else{let i=`Expected ${r} to be an Uint8Array with length ${t}`;Fs(e.length===t,i)}}function If(r){Fs(Nh(r)==="Boolean","Expected compressed to be a Boolean")}function Oo(r=t=>new Uint8Array(t),e){return typeof r=="function"&&(r=r(e)),Pt("output",r,e),r}function Nh(r){return Object.prototype.toString.call(r).slice(8,-1)}R7.exports=r=>({contextRandomize(e){switch(Fs(e===null||e instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),e!==null&&Pt("seed",e,32),r.contextRandomize(e)){case 1:throw new Error(Bt.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(e){return Pt("private key",e,32),r.privateKeyVerify(e)===0},privateKeyNegate(e){switch(Pt("private key",e,32),r.privateKeyNegate(e)){case 0:return e;case 1:throw new Error(Bt.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(e,t){switch(Pt("private key",e,32),Pt("tweak",t,32),r.privateKeyTweakAdd(e,t)){case 0:return e;case 1:throw new Error(Bt.TWEAK_ADD)}},privateKeyTweakMul(e,t){switch(Pt("private key",e,32),Pt("tweak",t,32),r.privateKeyTweakMul(e,t)){case 0:return e;case 1:throw new Error(Bt.TWEAK_MUL)}},publicKeyVerify(e){return Pt("public key",e,[33,65]),r.publicKeyVerify(e)===0},publicKeyCreate(e,t=!0,i){switch(Pt("private key",e,32),If(t),i=Oo(i,t?33:65),r.publicKeyCreate(i,e)){case 0:return i;case 1:throw new Error(Bt.SECKEY_INVALID);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyConvert(e,t=!0,i){switch(Pt("public key",e,[33,65]),If(t),i=Oo(i,t?33:65),r.publicKeyConvert(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyNegate(e,t=!0,i){switch(Pt("public key",e,[33,65]),If(t),i=Oo(i,t?33:65),r.publicKeyNegate(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyCombine(e,t=!0,i){Fs(Array.isArray(e),"Expected public keys to be an Array"),Fs(e.length>0,"Expected public keys array will have more than zero items");for(let n of e)Pt("public key",n,[33,65]);switch(If(t),i=Oo(i,t?33:65),r.publicKeyCombine(i,e)){case 0:return i;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.PUBKEY_COMBINE);case 3:throw new Error(Bt.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(e,t,i=!0,n){switch(Pt("public key",e,[33,65]),Pt("tweak",t,32),If(i),n=Oo(n,i?33:65),r.publicKeyTweakAdd(n,e,t)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_ADD)}},publicKeyTweakMul(e,t,i=!0,n){switch(Pt("public key",e,[33,65]),Pt("tweak",t,32),If(i),n=Oo(n,i?33:65),r.publicKeyTweakMul(n,e,t)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.TWEAK_MUL)}},signatureNormalize(e){switch(Pt("signature",e,64),r.signatureNormalize(e)){case 0:return e;case 1:throw new Error(Bt.SIG_PARSE)}},signatureExport(e,t){Pt("signature",e,64),t=Oo(t,72);let i={output:t,outputlen:72};switch(r.signatureExport(i,e)){case 0:return t.slice(0,i.outputlen);case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},signatureImport(e,t){switch(Pt("signature",e),t=Oo(t,64),r.signatureImport(t,e)){case 0:return t;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaSign(e,t,i={},n){Pt("message",e,32),Pt("private key",t,32),Fs(Nh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Pt("options.data",i.data),i.noncefn!==void 0&&Fs(Nh(i.noncefn)==="Function","Expected options.noncefn to be a Function"),n=Oo(n,64);let s={signature:n,recid:null};switch(r.ecdsaSign(s,e,t,i.data,i.noncefn)){case 0:return s;case 1:throw new Error(Bt.SIGN);case 2:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdsaVerify(e,t,i){switch(Pt("signature",e,64),Pt("message",t,32),Pt("public key",i,[33,65]),r.ecdsaVerify(e,t,i)){case 0:return!0;case 3:return!1;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.PUBKEY_PARSE)}},ecdsaRecover(e,t,i,n=!0,s){switch(Pt("signature",e,64),Fs(Nh(t)==="Number"&&t>=0&&t<=3,"Expected recovery id to be a Number within interval [0, 3]"),Pt("message",i,32),If(n),s=Oo(s,n?33:65),r.ecdsaRecover(s,e,t,i)){case 0:return s;case 1:throw new Error(Bt.SIG_PARSE);case 2:throw new Error(Bt.RECOVER);case 3:throw new Error(Bt.IMPOSSIBLE_CASE)}},ecdh(e,t,i={},n){switch(Pt("public key",e,[33,65]),Pt("private key",t,32),Fs(Nh(i)==="Object","Expected options to be an Object"),i.data!==void 0&&Pt("options.data",i.data),i.hashfn!==void 0?(Fs(Nh(i.hashfn)==="Function","Expected options.hashfn to be a Function"),i.xbuf!==void 0&&Pt("options.xbuf",i.xbuf,32),i.ybuf!==void 0&&Pt("options.ybuf",i.ybuf,32),Pt("output",n)):n=Oo(n,32),r.ecdh(n,e,t,i.data,i.hashfn,i.xbuf,i.ybuf)){case 0:return n;case 1:throw new Error(Bt.PUBKEY_PARSE);case 2:throw new Error(Bt.ECDH)}}})});var P7=y((XIt,GPe)=>{GPe.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var O7=y(()=>{f()});var ka=y((k7,kA)=>{f();(function(r,e){"use strict";function t(C,m){if(!C)throw new Error(m||"Assertion failed")}function i(C,m){C.super_=m;var w=function(){};w.prototype=m.prototype,C.prototype=new w,C.prototype.constructor=C}function n(C,m,w){if(n.isBN(C))return C;this.negative=0,this.words=null,this.length=0,this.red=null,C!==null&&((m==="le"||m==="be")&&(w=m,m=10),this._init(C||0,m||10,w||"be"))}typeof r=="object"?r.exports=n:e.BN=n,n.BN=n,n.wordSize=26;var s;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?s=window.Buffer:s=O7().Buffer}catch(C){}n.isBN=function(m){return m instanceof n?!0:m!==null&&typeof m=="object"&&m.constructor.wordSize===n.wordSize&&Array.isArray(m.words)},n.max=function(m,w){return m.cmp(w)>0?m:w},n.min=function(m,w){return m.cmp(w)<0?m:w},n.prototype._init=function(m,w,S){if(typeof m=="number")return this._initNumber(m,w,S);if(typeof m=="object")return this._initArray(m,w,S);w==="hex"&&(w=16),t(w===(w|0)&&w>=2&&w<=36),m=m.toString().replace(/\s+/g,"");var P=0;m[0]==="-"&&(P++,this.negative=1),P<m.length&&(w===16?this._parseHex(m,P,S):(this._parseBase(m,w,P),S==="le"&&this._initArray(this.toArray(),w,S)))},n.prototype._initNumber=function(m,w,S){m<0&&(this.negative=1,m=-m),m<67108864?(this.words=[m&67108863],this.length=1):m<4503599627370496?(this.words=[m&67108863,m/67108864&67108863],this.length=2):(t(m<9007199254740992),this.words=[m&67108863,m/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),w,S)},n.prototype._initArray=function(m,w,S){if(t(typeof m.length=="number"),m.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(m.length/3),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var B,W,j=0;if(S==="be")for(P=m.length-1,B=0;P>=0;P-=3)W=m[P]|m[P-1]<<8|m[P-2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);else if(S==="le")for(P=0,B=0;P<m.length;P+=3)W=m[P]|m[P+1]<<8|m[P+2]<<16,this.words[B]|=W<<j&67108863,this.words[B+1]=W>>>26-j&67108863,j+=24,j>=26&&(j-=26,B++);return this.strip()};function o(C,m){var w=C.charCodeAt(m);return w>=65&&w<=70?w-55:w>=97&&w<=102?w-87:w-48&15}function a(C,m,w){var S=o(C,w);return w-1>=m&&(S|=o(C,w-1)<<4),S}n.prototype._parseHex=function(m,w,S){this.length=Math.ceil((m.length-w)/6),this.words=new Array(this.length);for(var P=0;P<this.length;P++)this.words[P]=0;var B=0,W=0,j;if(S==="be")for(P=m.length-1;P>=w;P-=2)j=a(m,w,P)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8;else{var M=m.length-w;for(P=M%2==0?w+1:w;P<m.length;P+=2)j=a(m,w,P)<<B,this.words[W]|=j&67108863,B>=18?(B-=18,W+=1,this.words[W]|=j>>>26):B+=8}this.strip()};function c(C,m,w,S){for(var P=0,B=Math.min(C.length,w),W=m;W<B;W++){var j=C.charCodeAt(W)-48;P*=S,j>=49?P+=j-49+10:j>=17?P+=j-17+10:P+=j}return P}n.prototype._parseBase=function(m,w,S){this.words=[0],this.length=1;for(var P=0,B=1;B<=67108863;B*=w)P++;P--,B=B/w|0;for(var W=m.length-S,j=W%P,M=Math.min(W,W-j)+S,_=0,L=S;L<M;L+=P)_=c(m,L,L+P,w),this.imuln(B),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_);if(j!==0){var ce=1;for(_=c(m,L,m.length,w),L=0;L<j;L++)ce*=w;this.imuln(ce),this.words[0]+_<67108864?this.words[0]+=_:this._iaddn(_)}this.strip()},n.prototype.copy=function(m){m.words=new Array(this.length);for(var w=0;w<this.length;w++)m.words[w]=this.words[w];m.length=this.length,m.negative=this.negative,m.red=this.red},n.prototype.clone=function(){var m=new n(null);return this.copy(m),m},n.prototype._expand=function(m){for(;this.length<m;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},n.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];n.prototype.toString=function(m,w){m=m||10,w=w|0||1;var S;if(m===16||m==="hex"){S="";for(var P=0,B=0,W=0;W<this.length;W++){var j=this.words[W],M=((j<<P|B)&16777215).toString(16);B=j>>>24-P&16777215,B!==0||W!==this.length-1?S=u[6-M.length]+M+S:S=M+S,P+=2,P>=26&&(P-=26,W--)}for(B!==0&&(S=B.toString(16)+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(m===(m|0)&&m>=2&&m<=36){var _=l[m],L=d[m];S="";var ce=this.clone();for(ce.negative=0;!ce.isZero();){var X=ce.modn(L).toString(m);ce=ce.idivn(L),ce.isZero()?S=X+S:S=u[_-X.length]+X+S}for(this.isZero()&&(S="0"+S);S.length%w!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}t(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var m=this.words[0];return this.length===2?m+=this.words[1]*67108864:this.length===3&&this.words[2]===1?m+=4503599627370496+this.words[1]*67108864:this.length>2&&t(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-m:m},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(m,w){return t(typeof s!="undefined"),this.toArrayLike(s,m,w)},n.prototype.toArray=function(m,w){return this.toArrayLike(Array,m,w)},n.prototype.toArrayLike=function(m,w,S){var P=this.byteLength(),B=S||Math.max(1,P);t(P<=B,"byte array longer than desired length"),t(B>0,"Requested array length <= 0"),this.strip();var W=w==="le",j=new m(B),M,_,L=this.clone();if(W){for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[_]=M;for(;_<B;_++)j[_]=0}else{for(_=0;_<B-P;_++)j[_]=0;for(_=0;!L.isZero();_++)M=L.andln(255),L.iushrn(8),j[B-_-1]=M}return j},Math.clz32?n.prototype._countBits=function(m){return 32-Math.clz32(m)}:n.prototype._countBits=function(m){var w=m,S=0;return w>=4096&&(S+=13,w>>>=13),w>=64&&(S+=7,w>>>=7),w>=8&&(S+=4,w>>>=4),w>=2&&(S+=2,w>>>=2),S+w},n.prototype._zeroBits=function(m){if(m===0)return 26;var w=m,S=0;return(w&8191)==0&&(S+=13,w>>>=13),(w&127)==0&&(S+=7,w>>>=7),(w&15)==0&&(S+=4,w>>>=4),(w&3)==0&&(S+=2,w>>>=2),(w&1)==0&&S++,S},n.prototype.bitLength=function(){var m=this.words[this.length-1],w=this._countBits(m);return(this.length-1)*26+w};function h(C){for(var m=new Array(C.bitLength()),w=0;w<m.length;w++){var S=w/26|0,P=w%26;m[w]=(C.words[S]&1<<P)>>>P}return m}n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var m=0,w=0;w<this.length;w++){var S=this._zeroBits(this.words[w]);if(m+=S,S!==26)break}return m},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(m){return this.negative!==0?this.abs().inotn(m).iaddn(1):this.clone()},n.prototype.fromTwos=function(m){return this.testn(m-1)?this.notn(m).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return this.negative!==0},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(m){for(;this.length<m.length;)this.words[this.length++]=0;for(var w=0;w<m.length;w++)this.words[w]=this.words[w]|m.words[w];return this.strip()},n.prototype.ior=function(m){return t((this.negative|m.negative)==0),this.iuor(m)},n.prototype.or=function(m){return this.length>m.length?this.clone().ior(m):m.clone().ior(this)},n.prototype.uor=function(m){return this.length>m.length?this.clone().iuor(m):m.clone().iuor(this)},n.prototype.iuand=function(m){var w;this.length>m.length?w=m:w=this;for(var S=0;S<w.length;S++)this.words[S]=this.words[S]&m.words[S];return this.length=w.length,this.strip()},n.prototype.iand=function(m){return t((this.negative|m.negative)==0),this.iuand(m)},n.prototype.and=function(m){return this.length>m.length?this.clone().iand(m):m.clone().iand(this)},n.prototype.uand=function(m){return this.length>m.length?this.clone().iuand(m):m.clone().iuand(this)},n.prototype.iuxor=function(m){var w,S;this.length>m.length?(w=this,S=m):(w=m,S=this);for(var P=0;P<S.length;P++)this.words[P]=w.words[P]^S.words[P];if(this!==w)for(;P<w.length;P++)this.words[P]=w.words[P];return this.length=w.length,this.strip()},n.prototype.ixor=function(m){return t((this.negative|m.negative)==0),this.iuxor(m)},n.prototype.xor=function(m){return this.length>m.length?this.clone().ixor(m):m.clone().ixor(this)},n.prototype.uxor=function(m){return this.length>m.length?this.clone().iuxor(m):m.clone().iuxor(this)},n.prototype.inotn=function(m){t(typeof m=="number"&&m>=0);var w=Math.ceil(m/26)|0,S=m%26;this._expand(w),S>0&&w--;for(var P=0;P<w;P++)this.words[P]=~this.words[P]&67108863;return S>0&&(this.words[P]=~this.words[P]&67108863>>26-S),this.strip()},n.prototype.notn=function(m){return this.clone().inotn(m)},n.prototype.setn=function(m,w){t(typeof m=="number"&&m>=0);var S=m/26|0,P=m%26;return this._expand(S+1),w?this.words[S]=this.words[S]|1<<P:this.words[S]=this.words[S]&~(1<<P),this.strip()},n.prototype.iadd=function(m){var w;if(this.negative!==0&&m.negative===0)return this.negative=0,w=this.isub(m),this.negative^=1,this._normSign();if(this.negative===0&&m.negative!==0)return m.negative=0,w=this.isub(m),m.negative=1,w._normSign();var S,P;this.length>m.length?(S=this,P=m):(S=m,P=this);for(var B=0,W=0;W<P.length;W++)w=(S.words[W]|0)+(P.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;for(;B!==0&&W<S.length;W++)w=(S.words[W]|0)+B,this.words[W]=w&67108863,B=w>>>26;if(this.length=S.length,B!==0)this.words[this.length]=B,this.length++;else if(S!==this)for(;W<S.length;W++)this.words[W]=S.words[W];return this},n.prototype.add=function(m){var w;return m.negative!==0&&this.negative===0?(m.negative=0,w=this.sub(m),m.negative^=1,w):m.negative===0&&this.negative!==0?(this.negative=0,w=m.sub(this),this.negative=1,w):this.length>m.length?this.clone().iadd(m):m.clone().iadd(this)},n.prototype.isub=function(m){if(m.negative!==0){m.negative=0;var w=this.iadd(m);return m.negative=1,w._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(m),this.negative=1,this._normSign();var S=this.cmp(m);if(S===0)return this.negative=0,this.length=1,this.words[0]=0,this;var P,B;S>0?(P=this,B=m):(P=m,B=this);for(var W=0,j=0;j<B.length;j++)w=(P.words[j]|0)-(B.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;for(;W!==0&&j<P.length;j++)w=(P.words[j]|0)+W,W=w>>26,this.words[j]=w&67108863;if(W===0&&j<P.length&&P!==this)for(;j<P.length;j++)this.words[j]=P.words[j];return this.length=Math.max(this.length,j),P!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(m){return this.clone().isub(m)};function p(C,m,w){w.negative=m.negative^C.negative;var S=C.length+m.length|0;w.length=S,S=S-1|0;var P=C.words[0]|0,B=m.words[0]|0,W=P*B,j=W&67108863,M=W/67108864|0;w.words[0]=j;for(var _=1;_<S;_++){for(var L=M>>>26,ce=M&67108863,X=Math.min(_,m.length-1),ne=Math.max(0,_-C.length+1);ne<=X;ne++){var oe=_-ne|0;P=C.words[oe]|0,B=m.words[ne]|0,W=P*B+ce,L+=W/67108864|0,ce=W&67108863}w.words[_]=ce|0,M=L|0}return M!==0?w.words[_]=M|0:w.length--,w.strip()}var g=function(m,w,S){var P=m.words,B=w.words,W=S.words,j=0,M,_,L,ce=P[0]|0,X=ce&8191,ne=ce>>>13,oe=P[1]|0,he=oe&8191,pe=oe>>>13,_e=P[2]|0,k=_e&8191,K=_e>>>13,$=P[3]|0,Z=$&8191,I=$>>>13,U=P[4]|0,V=U&8191,D=U>>>13,Q=P[5]|0,ee=Q&8191,J=Q>>>13,ue=P[6]|0,ge=ue&8191,me=ue>>>13,je=P[7]|0,Re=je&8191,Ve=je>>>13,Je=P[8]|0,He=Je&8191,ze=Je>>>13,gt=P[9]|0,Yt=gt&8191,ir=gt>>>13,Tn=B[0]|0,zt=Tn&8191,At=Tn>>>13,Qr=B[1]|0,nt=Qr&8191,xr=Qr>>>13,rv=B[2]|0,Ir=rv&8191,Tr=rv>>>13,iv=B[3]|0,Rr=iv&8191,Cr=iv>>>13,nv=B[4]|0,Pr=nv&8191,Or=nv>>>13,sv=B[5]|0,kr=sv&8191,qr=sv>>>13,ov=B[6]|0,Nr=ov&8191,Dr=ov>>>13,av=B[7]|0,Br=av&8191,Mr=av>>>13,cv=B[8]|0,Lr=cv&8191,Ur=cv>>>13,uv=B[9]|0,Fr=uv&8191,nr=uv>>>13;S.negative=m.negative^w.negative,S.length=19,M=Math.imul(X,zt),_=Math.imul(X,At),_=_+Math.imul(ne,zt)|0,L=Math.imul(ne,At);var oh=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(oh>>>26)|0,oh&=67108863,M=Math.imul(he,zt),_=Math.imul(he,At),_=_+Math.imul(pe,zt)|0,L=Math.imul(pe,At),M=M+Math.imul(X,nt)|0,_=_+Math.imul(X,xr)|0,_=_+Math.imul(ne,nt)|0,L=L+Math.imul(ne,xr)|0;var My=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(My>>>26)|0,My&=67108863,M=Math.imul(k,zt),_=Math.imul(k,At),_=_+Math.imul(K,zt)|0,L=Math.imul(K,At),M=M+Math.imul(he,nt)|0,_=_+Math.imul(he,xr)|0,_=_+Math.imul(pe,nt)|0,L=L+Math.imul(pe,xr)|0,M=M+Math.imul(X,Ir)|0,_=_+Math.imul(X,Tr)|0,_=_+Math.imul(ne,Ir)|0,L=L+Math.imul(ne,Tr)|0;var Ly=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ly>>>26)|0,Ly&=67108863,M=Math.imul(Z,zt),_=Math.imul(Z,At),_=_+Math.imul(I,zt)|0,L=Math.imul(I,At),M=M+Math.imul(k,nt)|0,_=_+Math.imul(k,xr)|0,_=_+Math.imul(K,nt)|0,L=L+Math.imul(K,xr)|0,M=M+Math.imul(he,Ir)|0,_=_+Math.imul(he,Tr)|0,_=_+Math.imul(pe,Ir)|0,L=L+Math.imul(pe,Tr)|0,M=M+Math.imul(X,Rr)|0,_=_+Math.imul(X,Cr)|0,_=_+Math.imul(ne,Rr)|0,L=L+Math.imul(ne,Cr)|0;var Uy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Uy>>>26)|0,Uy&=67108863,M=Math.imul(V,zt),_=Math.imul(V,At),_=_+Math.imul(D,zt)|0,L=Math.imul(D,At),M=M+Math.imul(Z,nt)|0,_=_+Math.imul(Z,xr)|0,_=_+Math.imul(I,nt)|0,L=L+Math.imul(I,xr)|0,M=M+Math.imul(k,Ir)|0,_=_+Math.imul(k,Tr)|0,_=_+Math.imul(K,Ir)|0,L=L+Math.imul(K,Tr)|0,M=M+Math.imul(he,Rr)|0,_=_+Math.imul(he,Cr)|0,_=_+Math.imul(pe,Rr)|0,L=L+Math.imul(pe,Cr)|0,M=M+Math.imul(X,Pr)|0,_=_+Math.imul(X,Or)|0,_=_+Math.imul(ne,Pr)|0,L=L+Math.imul(ne,Or)|0;var Fy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Fy>>>26)|0,Fy&=67108863,M=Math.imul(ee,zt),_=Math.imul(ee,At),_=_+Math.imul(J,zt)|0,L=Math.imul(J,At),M=M+Math.imul(V,nt)|0,_=_+Math.imul(V,xr)|0,_=_+Math.imul(D,nt)|0,L=L+Math.imul(D,xr)|0,M=M+Math.imul(Z,Ir)|0,_=_+Math.imul(Z,Tr)|0,_=_+Math.imul(I,Ir)|0,L=L+Math.imul(I,Tr)|0,M=M+Math.imul(k,Rr)|0,_=_+Math.imul(k,Cr)|0,_=_+Math.imul(K,Rr)|0,L=L+Math.imul(K,Cr)|0,M=M+Math.imul(he,Pr)|0,_=_+Math.imul(he,Or)|0,_=_+Math.imul(pe,Pr)|0,L=L+Math.imul(pe,Or)|0,M=M+Math.imul(X,kr)|0,_=_+Math.imul(X,qr)|0,_=_+Math.imul(ne,kr)|0,L=L+Math.imul(ne,qr)|0;var Ky=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Ky>>>26)|0,Ky&=67108863,M=Math.imul(ge,zt),_=Math.imul(ge,At),_=_+Math.imul(me,zt)|0,L=Math.imul(me,At),M=M+Math.imul(ee,nt)|0,_=_+Math.imul(ee,xr)|0,_=_+Math.imul(J,nt)|0,L=L+Math.imul(J,xr)|0,M=M+Math.imul(V,Ir)|0,_=_+Math.imul(V,Tr)|0,_=_+Math.imul(D,Ir)|0,L=L+Math.imul(D,Tr)|0,M=M+Math.imul(Z,Rr)|0,_=_+Math.imul(Z,Cr)|0,_=_+Math.imul(I,Rr)|0,L=L+Math.imul(I,Cr)|0,M=M+Math.imul(k,Pr)|0,_=_+Math.imul(k,Or)|0,_=_+Math.imul(K,Pr)|0,L=L+Math.imul(K,Or)|0,M=M+Math.imul(he,kr)|0,_=_+Math.imul(he,qr)|0,_=_+Math.imul(pe,kr)|0,L=L+Math.imul(pe,qr)|0,M=M+Math.imul(X,Nr)|0,_=_+Math.imul(X,Dr)|0,_=_+Math.imul(ne,Nr)|0,L=L+Math.imul(ne,Dr)|0;var _o=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(_o>>>26)|0,_o&=67108863,M=Math.imul(Re,zt),_=Math.imul(Re,At),_=_+Math.imul(Ve,zt)|0,L=Math.imul(Ve,At),M=M+Math.imul(ge,nt)|0,_=_+Math.imul(ge,xr)|0,_=_+Math.imul(me,nt)|0,L=L+Math.imul(me,xr)|0,M=M+Math.imul(ee,Ir)|0,_=_+Math.imul(ee,Tr)|0,_=_+Math.imul(J,Ir)|0,L=L+Math.imul(J,Tr)|0,M=M+Math.imul(V,Rr)|0,_=_+Math.imul(V,Cr)|0,_=_+Math.imul(D,Rr)|0,L=L+Math.imul(D,Cr)|0,M=M+Math.imul(Z,Pr)|0,_=_+Math.imul(Z,Or)|0,_=_+Math.imul(I,Pr)|0,L=L+Math.imul(I,Or)|0,M=M+Math.imul(k,kr)|0,_=_+Math.imul(k,qr)|0,_=_+Math.imul(K,kr)|0,L=L+Math.imul(K,qr)|0,M=M+Math.imul(he,Nr)|0,_=_+Math.imul(he,Dr)|0,_=_+Math.imul(pe,Nr)|0,L=L+Math.imul(pe,Dr)|0,M=M+Math.imul(X,Br)|0,_=_+Math.imul(X,Mr)|0,_=_+Math.imul(ne,Br)|0,L=L+Math.imul(ne,Mr)|0;var jy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(jy>>>26)|0,jy&=67108863,M=Math.imul(He,zt),_=Math.imul(He,At),_=_+Math.imul(ze,zt)|0,L=Math.imul(ze,At),M=M+Math.imul(Re,nt)|0,_=_+Math.imul(Re,xr)|0,_=_+Math.imul(Ve,nt)|0,L=L+Math.imul(Ve,xr)|0,M=M+Math.imul(ge,Ir)|0,_=_+Math.imul(ge,Tr)|0,_=_+Math.imul(me,Ir)|0,L=L+Math.imul(me,Tr)|0,M=M+Math.imul(ee,Rr)|0,_=_+Math.imul(ee,Cr)|0,_=_+Math.imul(J,Rr)|0,L=L+Math.imul(J,Cr)|0,M=M+Math.imul(V,Pr)|0,_=_+Math.imul(V,Or)|0,_=_+Math.imul(D,Pr)|0,L=L+Math.imul(D,Or)|0,M=M+Math.imul(Z,kr)|0,_=_+Math.imul(Z,qr)|0,_=_+Math.imul(I,kr)|0,L=L+Math.imul(I,qr)|0,M=M+Math.imul(k,Nr)|0,_=_+Math.imul(k,Dr)|0,_=_+Math.imul(K,Nr)|0,L=L+Math.imul(K,Dr)|0,M=M+Math.imul(he,Br)|0,_=_+Math.imul(he,Mr)|0,_=_+Math.imul(pe,Br)|0,L=L+Math.imul(pe,Mr)|0,M=M+Math.imul(X,Lr)|0,_=_+Math.imul(X,Ur)|0,_=_+Math.imul(ne,Lr)|0,L=L+Math.imul(ne,Ur)|0;var Vy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Vy>>>26)|0,Vy&=67108863,M=Math.imul(Yt,zt),_=Math.imul(Yt,At),_=_+Math.imul(ir,zt)|0,L=Math.imul(ir,At),M=M+Math.imul(He,nt)|0,_=_+Math.imul(He,xr)|0,_=_+Math.imul(ze,nt)|0,L=L+Math.imul(ze,xr)|0,M=M+Math.imul(Re,Ir)|0,_=_+Math.imul(Re,Tr)|0,_=_+Math.imul(Ve,Ir)|0,L=L+Math.imul(Ve,Tr)|0,M=M+Math.imul(ge,Rr)|0,_=_+Math.imul(ge,Cr)|0,_=_+Math.imul(me,Rr)|0,L=L+Math.imul(me,Cr)|0,M=M+Math.imul(ee,Pr)|0,_=_+Math.imul(ee,Or)|0,_=_+Math.imul(J,Pr)|0,L=L+Math.imul(J,Or)|0,M=M+Math.imul(V,kr)|0,_=_+Math.imul(V,qr)|0,_=_+Math.imul(D,kr)|0,L=L+Math.imul(D,qr)|0,M=M+Math.imul(Z,Nr)|0,_=_+Math.imul(Z,Dr)|0,_=_+Math.imul(I,Nr)|0,L=L+Math.imul(I,Dr)|0,M=M+Math.imul(k,Br)|0,_=_+Math.imul(k,Mr)|0,_=_+Math.imul(K,Br)|0,L=L+Math.imul(K,Mr)|0,M=M+Math.imul(he,Lr)|0,_=_+Math.imul(he,Ur)|0,_=_+Math.imul(pe,Lr)|0,L=L+Math.imul(pe,Ur)|0,M=M+Math.imul(X,Fr)|0,_=_+Math.imul(X,nr)|0,_=_+Math.imul(ne,Fr)|0,L=L+Math.imul(ne,nr)|0;var zy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(zy>>>26)|0,zy&=67108863,M=Math.imul(Yt,nt),_=Math.imul(Yt,xr),_=_+Math.imul(ir,nt)|0,L=Math.imul(ir,xr),M=M+Math.imul(He,Ir)|0,_=_+Math.imul(He,Tr)|0,_=_+Math.imul(ze,Ir)|0,L=L+Math.imul(ze,Tr)|0,M=M+Math.imul(Re,Rr)|0,_=_+Math.imul(Re,Cr)|0,_=_+Math.imul(Ve,Rr)|0,L=L+Math.imul(Ve,Cr)|0,M=M+Math.imul(ge,Pr)|0,_=_+Math.imul(ge,Or)|0,_=_+Math.imul(me,Pr)|0,L=L+Math.imul(me,Or)|0,M=M+Math.imul(ee,kr)|0,_=_+Math.imul(ee,qr)|0,_=_+Math.imul(J,kr)|0,L=L+Math.imul(J,qr)|0,M=M+Math.imul(V,Nr)|0,_=_+Math.imul(V,Dr)|0,_=_+Math.imul(D,Nr)|0,L=L+Math.imul(D,Dr)|0,M=M+Math.imul(Z,Br)|0,_=_+Math.imul(Z,Mr)|0,_=_+Math.imul(I,Br)|0,L=L+Math.imul(I,Mr)|0,M=M+Math.imul(k,Lr)|0,_=_+Math.imul(k,Ur)|0,_=_+Math.imul(K,Lr)|0,L=L+Math.imul(K,Ur)|0,M=M+Math.imul(he,Fr)|0,_=_+Math.imul(he,nr)|0,_=_+Math.imul(pe,Fr)|0,L=L+Math.imul(pe,nr)|0;var Hy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Hy>>>26)|0,Hy&=67108863,M=Math.imul(Yt,Ir),_=Math.imul(Yt,Tr),_=_+Math.imul(ir,Ir)|0,L=Math.imul(ir,Tr),M=M+Math.imul(He,Rr)|0,_=_+Math.imul(He,Cr)|0,_=_+Math.imul(ze,Rr)|0,L=L+Math.imul(ze,Cr)|0,M=M+Math.imul(Re,Pr)|0,_=_+Math.imul(Re,Or)|0,_=_+Math.imul(Ve,Pr)|0,L=L+Math.imul(Ve,Or)|0,M=M+Math.imul(ge,kr)|0,_=_+Math.imul(ge,qr)|0,_=_+Math.imul(me,kr)|0,L=L+Math.imul(me,qr)|0,M=M+Math.imul(ee,Nr)|0,_=_+Math.imul(ee,Dr)|0,_=_+Math.imul(J,Nr)|0,L=L+Math.imul(J,Dr)|0,M=M+Math.imul(V,Br)|0,_=_+Math.imul(V,Mr)|0,_=_+Math.imul(D,Br)|0,L=L+Math.imul(D,Mr)|0,M=M+Math.imul(Z,Lr)|0,_=_+Math.imul(Z,Ur)|0,_=_+Math.imul(I,Lr)|0,L=L+Math.imul(I,Ur)|0,M=M+Math.imul(k,Fr)|0,_=_+Math.imul(k,nr)|0,_=_+Math.imul(K,Fr)|0,L=L+Math.imul(K,nr)|0;var $y=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+($y>>>26)|0,$y&=67108863,M=Math.imul(Yt,Rr),_=Math.imul(Yt,Cr),_=_+Math.imul(ir,Rr)|0,L=Math.imul(ir,Cr),M=M+Math.imul(He,Pr)|0,_=_+Math.imul(He,Or)|0,_=_+Math.imul(ze,Pr)|0,L=L+Math.imul(ze,Or)|0,M=M+Math.imul(Re,kr)|0,_=_+Math.imul(Re,qr)|0,_=_+Math.imul(Ve,kr)|0,L=L+Math.imul(Ve,qr)|0,M=M+Math.imul(ge,Nr)|0,_=_+Math.imul(ge,Dr)|0,_=_+Math.imul(me,Nr)|0,L=L+Math.imul(me,Dr)|0,M=M+Math.imul(ee,Br)|0,_=_+Math.imul(ee,Mr)|0,_=_+Math.imul(J,Br)|0,L=L+Math.imul(J,Mr)|0,M=M+Math.imul(V,Lr)|0,_=_+Math.imul(V,Ur)|0,_=_+Math.imul(D,Lr)|0,L=L+Math.imul(D,Ur)|0,M=M+Math.imul(Z,Fr)|0,_=_+Math.imul(Z,nr)|0,_=_+Math.imul(I,Fr)|0,L=L+Math.imul(I,nr)|0;var Gy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Gy>>>26)|0,Gy&=67108863,M=Math.imul(Yt,Pr),_=Math.imul(Yt,Or),_=_+Math.imul(ir,Pr)|0,L=Math.imul(ir,Or),M=M+Math.imul(He,kr)|0,_=_+Math.imul(He,qr)|0,_=_+Math.imul(ze,kr)|0,L=L+Math.imul(ze,qr)|0,M=M+Math.imul(Re,Nr)|0,_=_+Math.imul(Re,Dr)|0,_=_+Math.imul(Ve,Nr)|0,L=L+Math.imul(Ve,Dr)|0,M=M+Math.imul(ge,Br)|0,_=_+Math.imul(ge,Mr)|0,_=_+Math.imul(me,Br)|0,L=L+Math.imul(me,Mr)|0,M=M+Math.imul(ee,Lr)|0,_=_+Math.imul(ee,Ur)|0,_=_+Math.imul(J,Lr)|0,L=L+Math.imul(J,Ur)|0,M=M+Math.imul(V,Fr)|0,_=_+Math.imul(V,nr)|0,_=_+Math.imul(D,Fr)|0,L=L+Math.imul(D,nr)|0;var Wy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Wy>>>26)|0,Wy&=67108863,M=Math.imul(Yt,kr),_=Math.imul(Yt,qr),_=_+Math.imul(ir,kr)|0,L=Math.imul(ir,qr),M=M+Math.imul(He,Nr)|0,_=_+Math.imul(He,Dr)|0,_=_+Math.imul(ze,Nr)|0,L=L+Math.imul(ze,Dr)|0,M=M+Math.imul(Re,Br)|0,_=_+Math.imul(Re,Mr)|0,_=_+Math.imul(Ve,Br)|0,L=L+Math.imul(Ve,Mr)|0,M=M+Math.imul(ge,Lr)|0,_=_+Math.imul(ge,Ur)|0,_=_+Math.imul(me,Lr)|0,L=L+Math.imul(me,Ur)|0,M=M+Math.imul(ee,Fr)|0,_=_+Math.imul(ee,nr)|0,_=_+Math.imul(J,Fr)|0,L=L+Math.imul(J,nr)|0;var Yy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Yy>>>26)|0,Yy&=67108863,M=Math.imul(Yt,Nr),_=Math.imul(Yt,Dr),_=_+Math.imul(ir,Nr)|0,L=Math.imul(ir,Dr),M=M+Math.imul(He,Br)|0,_=_+Math.imul(He,Mr)|0,_=_+Math.imul(ze,Br)|0,L=L+Math.imul(ze,Mr)|0,M=M+Math.imul(Re,Lr)|0,_=_+Math.imul(Re,Ur)|0,_=_+Math.imul(Ve,Lr)|0,L=L+Math.imul(Ve,Ur)|0,M=M+Math.imul(ge,Fr)|0,_=_+Math.imul(ge,nr)|0,_=_+Math.imul(me,Fr)|0,L=L+Math.imul(me,nr)|0;var Xy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Xy>>>26)|0,Xy&=67108863,M=Math.imul(Yt,Br),_=Math.imul(Yt,Mr),_=_+Math.imul(ir,Br)|0,L=Math.imul(ir,Mr),M=M+Math.imul(He,Lr)|0,_=_+Math.imul(He,Ur)|0,_=_+Math.imul(ze,Lr)|0,L=L+Math.imul(ze,Ur)|0,M=M+Math.imul(Re,Fr)|0,_=_+Math.imul(Re,nr)|0,_=_+Math.imul(Ve,Fr)|0,L=L+Math.imul(Ve,nr)|0;var bi=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(bi>>>26)|0,bi&=67108863,M=Math.imul(Yt,Lr),_=Math.imul(Yt,Ur),_=_+Math.imul(ir,Lr)|0,L=Math.imul(ir,Ur),M=M+Math.imul(He,Fr)|0,_=_+Math.imul(He,nr)|0,_=_+Math.imul(ze,Fr)|0,L=L+Math.imul(ze,nr)|0;var Qy=(j+M|0)+((_&8191)<<13)|0;j=(L+(_>>>13)|0)+(Qy>>>26)|0,Qy&=67108863,M=Math.imul(Yt,Fr),_=Math.imul(Yt,nr),_=_+Math.imul(ir,Fr)|0,L=Math.imul(ir,nr);var Zy=(j+M|0)+((_&8191)<<13)|0;return j=(L+(_>>>13)|0)+(Zy>>>26)|0,Zy&=67108863,W[0]=oh,W[1]=My,W[2]=Ly,W[3]=Uy,W[4]=Fy,W[5]=Ky,W[6]=_o,W[7]=jy,W[8]=Vy,W[9]=zy,W[10]=Hy,W[11]=$y,W[12]=Gy,W[13]=Wy,W[14]=Yy,W[15]=Xy,W[16]=bi,W[17]=Qy,W[18]=Zy,j!==0&&(W[19]=j,S.length++),S};Math.imul||(g=p);function b(C,m,w){w.negative=m.negative^C.negative,w.length=C.length+m.length;for(var S=0,P=0,B=0;B<w.length-1;B++){var W=P;P=0;for(var j=S&67108863,M=Math.min(B,m.length-1),_=Math.max(0,B-C.length+1);_<=M;_++){var L=B-_,ce=C.words[L]|0,X=m.words[_]|0,ne=ce*X,oe=ne&67108863;W=W+(ne/67108864|0)|0,oe=oe+j|0,j=oe&67108863,W=W+(oe>>>26)|0,P+=W>>>26,W&=67108863}w.words[B]=j,S=W,W=P}return S!==0?w.words[B]=S:w.length--,w.strip()}function E(C,m,w){var S=new v;return S.mulp(C,m,w)}n.prototype.mulTo=function(m,w){var S,P=this.length+m.length;return this.length===10&&m.length===10?S=g(this,m,w):P<63?S=p(this,m,w):P<1024?S=b(this,m,w):S=E(this,m,w),S};function v(C,m){this.x=C,this.y=m}v.prototype.makeRBT=function(m){for(var w=new Array(m),S=n.prototype._countBits(m)-1,P=0;P<m;P++)w[P]=this.revBin(P,S,m);return w},v.prototype.revBin=function(m,w,S){if(m===0||m===S-1)return m;for(var P=0,B=0;B<w;B++)P|=(m&1)<<w-B-1,m>>=1;return P},v.prototype.permute=function(m,w,S,P,B,W){for(var j=0;j<W;j++)P[j]=w[m[j]],B[j]=S[m[j]]},v.prototype.transform=function(m,w,S,P,B,W){this.permute(W,m,w,S,P,B);for(var j=1;j<B;j<<=1)for(var M=j<<1,_=Math.cos(2*Math.PI/M),L=Math.sin(2*Math.PI/M),ce=0;ce<B;ce+=M)for(var X=_,ne=L,oe=0;oe<j;oe++){var he=S[ce+oe],pe=P[ce+oe],_e=S[ce+oe+j],k=P[ce+oe+j],K=X*_e-ne*k;k=X*k+ne*_e,_e=K,S[ce+oe]=he+_e,P[ce+oe]=pe+k,S[ce+oe+j]=he-_e,P[ce+oe+j]=pe-k,oe!==M&&(K=_*X-L*ne,ne=_*ne+L*X,X=K)}},v.prototype.guessLen13b=function(m,w){var S=Math.max(w,m)|1,P=S&1,B=0;for(S=S/2|0;S;S=S>>>1)B++;return 1<<B+1+P},v.prototype.conjugate=function(m,w,S){if(!(S<=1))for(var P=0;P<S/2;P++){var B=m[P];m[P]=m[S-P-1],m[S-P-1]=B,B=w[P],w[P]=-w[S-P-1],w[S-P-1]=-B}},v.prototype.normalize13b=function(m,w){for(var S=0,P=0;P<w/2;P++){var B=Math.round(m[2*P+1]/w)*8192+Math.round(m[2*P]/w)+S;m[P]=B&67108863,B<67108864?S=0:S=B/67108864|0}return m},v.prototype.convert13b=function(m,w,S,P){for(var B=0,W=0;W<w;W++)B=B+(m[W]|0),S[2*W]=B&8191,B=B>>>13,S[2*W+1]=B&8191,B=B>>>13;for(W=2*w;W<P;++W)S[W]=0;t(B===0),t((B&~8191)==0)},v.prototype.stub=function(m){for(var w=new Array(m),S=0;S<m;S++)w[S]=0;return w},v.prototype.mulp=function(m,w,S){var P=2*this.guessLen13b(m.length,w.length),B=this.makeRBT(P),W=this.stub(P),j=new Array(P),M=new Array(P),_=new Array(P),L=new Array(P),ce=new Array(P),X=new Array(P),ne=S.words;ne.length=P,this.convert13b(m.words,m.length,j,P),this.convert13b(w.words,w.length,L,P),this.transform(j,W,M,_,P,B),this.transform(L,W,ce,X,P,B);for(var oe=0;oe<P;oe++){var he=M[oe]*ce[oe]-_[oe]*X[oe];_[oe]=M[oe]*X[oe]+_[oe]*ce[oe],M[oe]=he}return this.conjugate(M,_,P),this.transform(M,_,ne,W,P,B),this.conjugate(ne,W,P),this.normalize13b(ne,P),S.negative=m.negative^w.negative,S.length=m.length+w.length,S.strip()},n.prototype.mul=function(m){var w=new n(null);return w.words=new Array(this.length+m.length),this.mulTo(m,w)},n.prototype.mulf=function(m){var w=new n(null);return w.words=new Array(this.length+m.length),E(this,m,w)},n.prototype.imul=function(m){return this.clone().mulTo(m,this)},n.prototype.imuln=function(m){t(typeof m=="number"),t(m<67108864);for(var w=0,S=0;S<this.length;S++){var P=(this.words[S]|0)*m,B=(P&67108863)+(w&67108863);w>>=26,w+=P/67108864|0,w+=B>>>26,this.words[S]=B&67108863}return w!==0&&(this.words[S]=w,this.length++),this},n.prototype.muln=function(m){return this.clone().imuln(m)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(m){var w=h(m);if(w.length===0)return new n(1);for(var S=this,P=0;P<w.length&&w[P]===0;P++,S=S.sqr());if(++P<w.length)for(var B=S.sqr();P<w.length;P++,B=B.sqr())w[P]!==0&&(S=S.mul(B));return S},n.prototype.iushln=function(m){t(typeof m=="number"&&m>=0);var w=m%26,S=(m-w)/26,P=67108863>>>26-w<<26-w,B;if(w!==0){var W=0;for(B=0;B<this.length;B++){var j=this.words[B]&P,M=(this.words[B]|0)-j<<w;this.words[B]=M|W,W=j>>>26-w}W&&(this.words[B]=W,this.length++)}if(S!==0){for(B=this.length-1;B>=0;B--)this.words[B+S]=this.words[B];for(B=0;B<S;B++)this.words[B]=0;this.length+=S}return this.strip()},n.prototype.ishln=function(m){return t(this.negative===0),this.iushln(m)},n.prototype.iushrn=function(m,w,S){t(typeof m=="number"&&m>=0);var P;w?P=(w-w%26)/26:P=0;var B=m%26,W=Math.min((m-B)/26,this.length),j=67108863^67108863>>>B<<B,M=S;if(P-=W,P=Math.max(0,P),M){for(var _=0;_<W;_++)M.words[_]=this.words[_];M.length=W}if(W!==0)if(this.length>W)for(this.length-=W,_=0;_<this.length;_++)this.words[_]=this.words[_+W];else this.words[0]=0,this.length=1;var L=0;for(_=this.length-1;_>=0&&(L!==0||_>=P);_--){var ce=this.words[_]|0;this.words[_]=L<<26-B|ce>>>B,L=ce&j}return M&&L!==0&&(M.words[M.length++]=L),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(m,w,S){return t(this.negative===0),this.iushrn(m,w,S)},n.prototype.shln=function(m){return this.clone().ishln(m)},n.prototype.ushln=function(m){return this.clone().iushln(m)},n.prototype.shrn=function(m){return this.clone().ishrn(m)},n.prototype.ushrn=function(m){return this.clone().iushrn(m)},n.prototype.testn=function(m){t(typeof m=="number"&&m>=0);var w=m%26,S=(m-w)/26,P=1<<w;if(this.length<=S)return!1;var B=this.words[S];return!!(B&P)},n.prototype.imaskn=function(m){t(typeof m=="number"&&m>=0);var w=m%26,S=(m-w)/26;if(t(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(w!==0&&S++,this.length=Math.min(S,this.length),w!==0){var P=67108863^67108863>>>w<<w;this.words[this.length-1]&=P}return this.strip()},n.prototype.maskn=function(m){return this.clone().imaskn(m)},n.prototype.iaddn=function(m){return t(typeof m=="number"),t(m<67108864),m<0?this.isubn(-m):this.negative!==0?this.length===1&&(this.words[0]|0)<m?(this.words[0]=m-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(m),this.negative=1,this):this._iaddn(m)},n.prototype._iaddn=function(m){this.words[0]+=m;for(var w=0;w<this.length&&this.words[w]>=67108864;w++)this.words[w]-=67108864,w===this.length-1?this.words[w+1]=1:this.words[w+1]++;return this.length=Math.max(this.length,w+1),this},n.prototype.isubn=function(m){if(t(typeof m=="number"),t(m<67108864),m<0)return this.iaddn(-m);if(this.negative!==0)return this.negative=0,this.iaddn(m),this.negative=1,this;if(this.words[0]-=m,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var w=0;w<this.length&&this.words[w]<0;w++)this.words[w]+=67108864,this.words[w+1]-=1;return this.strip()},n.prototype.addn=function(m){return this.clone().iaddn(m)},n.prototype.subn=function(m){return this.clone().isubn(m)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(m,w,S){var P=m.length+S,B;this._expand(P);var W,j=0;for(B=0;B<m.length;B++){W=(this.words[B+S]|0)+j;var M=(m.words[B]|0)*w;W-=M&67108863,j=(W>>26)-(M/67108864|0),this.words[B+S]=W&67108863}for(;B<this.length-S;B++)W=(this.words[B+S]|0)+j,j=W>>26,this.words[B+S]=W&67108863;if(j===0)return this.strip();for(t(j===-1),j=0,B=0;B<this.length;B++)W=-(this.words[B]|0)+j,j=W>>26,this.words[B]=W&67108863;return this.negative=1,this.strip()},n.prototype._wordDiv=function(m,w){var S=this.length-m.length,P=this.clone(),B=m,W=B.words[B.length-1]|0,j=this._countBits(W);S=26-j,S!==0&&(B=B.ushln(S),P.iushln(S),W=B.words[B.length-1]|0);var M=P.length-B.length,_;if(w!=="mod"){_=new n(null),_.length=M+1,_.words=new Array(_.length);for(var L=0;L<_.length;L++)_.words[L]=0}var ce=P.clone()._ishlnsubmul(B,1,M);ce.negative===0&&(P=ce,_&&(_.words[M]=1));for(var X=M-1;X>=0;X--){var ne=(P.words[B.length+X]|0)*67108864+(P.words[B.length+X-1]|0);for(ne=Math.min(ne/W|0,67108863),P._ishlnsubmul(B,ne,X);P.negative!==0;)ne--,P.negative=0,P._ishlnsubmul(B,1,X),P.isZero()||(P.negative^=1);_&&(_.words[X]=ne)}return _&&_.strip(),P.strip(),w!=="div"&&S!==0&&P.iushrn(S),{div:_||null,mod:P}},n.prototype.divmod=function(m,w,S){if(t(!m.isZero()),this.isZero())return{div:new n(0),mod:new n(0)};var P,B,W;return this.negative!==0&&m.negative===0?(W=this.neg().divmod(m,w),w!=="mod"&&(P=W.div.neg()),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.iadd(m)),{div:P,mod:B}):this.negative===0&&m.negative!==0?(W=this.divmod(m.neg(),w),w!=="mod"&&(P=W.div.neg()),{div:P,mod:W.mod}):(this.negative&m.negative)!=0?(W=this.neg().divmod(m.neg(),w),w!=="div"&&(B=W.mod.neg(),S&&B.negative!==0&&B.isub(m)),{div:W.div,mod:B}):m.length>this.length||this.cmp(m)<0?{div:new n(0),mod:this}:m.length===1?w==="div"?{div:this.divn(m.words[0]),mod:null}:w==="mod"?{div:null,mod:new n(this.modn(m.words[0]))}:{div:this.divn(m.words[0]),mod:new n(this.modn(m.words[0]))}:this._wordDiv(m,w)},n.prototype.div=function(m){return this.divmod(m,"div",!1).div},n.prototype.mod=function(m){return this.divmod(m,"mod",!1).mod},n.prototype.umod=function(m){return this.divmod(m,"mod",!0).mod},n.prototype.divRound=function(m){var w=this.divmod(m);if(w.mod.isZero())return w.div;var S=w.div.negative!==0?w.mod.isub(m):w.mod,P=m.ushrn(1),B=m.andln(1),W=S.cmp(P);return W<0||B===1&&W===0?w.div:w.div.negative!==0?w.div.isubn(1):w.div.iaddn(1)},n.prototype.modn=function(m){t(m<=67108863);for(var w=(1<<26)%m,S=0,P=this.length-1;P>=0;P--)S=(w*S+(this.words[P]|0))%m;return S},n.prototype.idivn=function(m){t(m<=67108863);for(var w=0,S=this.length-1;S>=0;S--){var P=(this.words[S]|0)+w*67108864;this.words[S]=P/m|0,w=P%m}return this.strip()},n.prototype.divn=function(m){return this.clone().idivn(m)},n.prototype.egcd=function(m){t(m.negative===0),t(!m.isZero());var w=this,S=m.clone();w.negative!==0?w=w.umod(m):w=w.clone();for(var P=new n(1),B=new n(0),W=new n(0),j=new n(1),M=0;w.isEven()&&S.isEven();)w.iushrn(1),S.iushrn(1),++M;for(var _=S.clone(),L=w.clone();!w.isZero();){for(var ce=0,X=1;(w.words[0]&X)==0&&ce<26;++ce,X<<=1);if(ce>0)for(w.iushrn(ce);ce-- >0;)(P.isOdd()||B.isOdd())&&(P.iadd(_),B.isub(L)),P.iushrn(1),B.iushrn(1);for(var ne=0,oe=1;(S.words[0]&oe)==0&&ne<26;++ne,oe<<=1);if(ne>0)for(S.iushrn(ne);ne-- >0;)(W.isOdd()||j.isOdd())&&(W.iadd(_),j.isub(L)),W.iushrn(1),j.iushrn(1);w.cmp(S)>=0?(w.isub(S),P.isub(W),B.isub(j)):(S.isub(w),W.isub(P),j.isub(B))}return{a:W,b:j,gcd:S.iushln(M)}},n.prototype._invmp=function(m){t(m.negative===0),t(!m.isZero());var w=this,S=m.clone();w.negative!==0?w=w.umod(m):w=w.clone();for(var P=new n(1),B=new n(0),W=S.clone();w.cmpn(1)>0&&S.cmpn(1)>0;){for(var j=0,M=1;(w.words[0]&M)==0&&j<26;++j,M<<=1);if(j>0)for(w.iushrn(j);j-- >0;)P.isOdd()&&P.iadd(W),P.iushrn(1);for(var _=0,L=1;(S.words[0]&L)==0&&_<26;++_,L<<=1);if(_>0)for(S.iushrn(_);_-- >0;)B.isOdd()&&B.iadd(W),B.iushrn(1);w.cmp(S)>=0?(w.isub(S),P.isub(B)):(S.isub(w),B.isub(P))}var ce;return w.cmpn(1)===0?ce=P:ce=B,ce.cmpn(0)<0&&ce.iadd(m),ce},n.prototype.gcd=function(m){if(this.isZero())return m.abs();if(m.isZero())return this.abs();var w=this.clone(),S=m.clone();w.negative=0,S.negative=0;for(var P=0;w.isEven()&&S.isEven();P++)w.iushrn(1),S.iushrn(1);do{for(;w.isEven();)w.iushrn(1);for(;S.isEven();)S.iushrn(1);var B=w.cmp(S);if(B<0){var W=w;w=S,S=W}else if(B===0||S.cmpn(1)===0)break;w.isub(S)}while(!0);return S.iushln(P)},n.prototype.invm=function(m){return this.egcd(m).a.umod(m)},n.prototype.isEven=function(){return(this.words[0]&1)==0},n.prototype.isOdd=function(){return(this.words[0]&1)==1},n.prototype.andln=function(m){return this.words[0]&m},n.prototype.bincn=function(m){t(typeof m=="number");var w=m%26,S=(m-w)/26,P=1<<w;if(this.length<=S)return this._expand(S+1),this.words[S]|=P,this;for(var B=P,W=S;B!==0&&W<this.length;W++){var j=this.words[W]|0;j+=B,B=j>>>26,j&=67108863,this.words[W]=j}return B!==0&&(this.words[W]=B,this.length++),this},n.prototype.isZero=function(){return this.length===1&&this.words[0]===0},n.prototype.cmpn=function(m){var w=m<0;if(this.negative!==0&&!w)return-1;if(this.negative===0&&w)return 1;this.strip();var S;if(this.length>1)S=1;else{w&&(m=-m),t(m<=67108863,"Number is too big");var P=this.words[0]|0;S=P===m?0:P<m?-1:1}return this.negative!==0?-S|0:S},n.prototype.cmp=function(m){if(this.negative!==0&&m.negative===0)return-1;if(this.negative===0&&m.negative!==0)return 1;var w=this.ucmp(m);return this.negative!==0?-w|0:w},n.prototype.ucmp=function(m){if(this.length>m.length)return 1;if(this.length<m.length)return-1;for(var w=0,S=this.length-1;S>=0;S--){var P=this.words[S]|0,B=m.words[S]|0;if(P!==B){P<B?w=-1:P>B&&(w=1);break}}return w},n.prototype.gtn=function(m){return this.cmpn(m)===1},n.prototype.gt=function(m){return this.cmp(m)===1},n.prototype.gten=function(m){return this.cmpn(m)>=0},n.prototype.gte=function(m){return this.cmp(m)>=0},n.prototype.ltn=function(m){return this.cmpn(m)===-1},n.prototype.lt=function(m){return this.cmp(m)===-1},n.prototype.lten=function(m){return this.cmpn(m)<=0},n.prototype.lte=function(m){return this.cmp(m)<=0},n.prototype.eqn=function(m){return this.cmpn(m)===0},n.prototype.eq=function(m){return this.cmp(m)===0},n.red=function(m){return new G(m)},n.prototype.toRed=function(m){return t(!this.red,"Already a number in reduction context"),t(this.negative===0,"red works only with positives"),m.convertTo(this)._forceRed(m)},n.prototype.fromRed=function(){return t(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(m){return this.red=m,this},n.prototype.forceRed=function(m){return t(!this.red,"Already a number in reduction context"),this._forceRed(m)},n.prototype.redAdd=function(m){return t(this.red,"redAdd works only with red numbers"),this.red.add(this,m)},n.prototype.redIAdd=function(m){return t(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,m)},n.prototype.redSub=function(m){return t(this.red,"redSub works only with red numbers"),this.red.sub(this,m)},n.prototype.redISub=function(m){return t(this.red,"redISub works only with red numbers"),this.red.isub(this,m)},n.prototype.redShl=function(m){return t(this.red,"redShl works only with red numbers"),this.red.shl(this,m)},n.prototype.redMul=function(m){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.mul(this,m)},n.prototype.redIMul=function(m){return t(this.red,"redMul works only with red numbers"),this.red._verify2(this,m),this.red.imul(this,m)},n.prototype.redSqr=function(){return t(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return t(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return t(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return t(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return t(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(m){return t(this.red&&!m.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,m)};var A={k256:null,p224:null,p192:null,p25519:null};function R(C,m){this.name=C,this.p=new n(m,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}R.prototype._tmp=function(){var m=new n(null);return m.words=new Array(Math.ceil(this.n/13)),m},R.prototype.ireduce=function(m){var w=m,S;do this.split(w,this.tmp),w=this.imulK(w),w=w.iadd(this.tmp),S=w.bitLength();while(S>this.n);var P=S<this.n?-1:w.ucmp(this.p);return P===0?(w.words[0]=0,w.length=1):P>0?w.isub(this.p):w.strip!==void 0?w.strip():w._strip(),w},R.prototype.split=function(m,w){m.iushrn(this.n,0,w)},R.prototype.imulK=function(m){return m.imul(this.k)};function F(){R.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(F,R),F.prototype.split=function(m,w){for(var S=4194303,P=Math.min(m.length,9),B=0;B<P;B++)w.words[B]=m.words[B];if(w.length=P,m.length<=9){m.words[0]=0,m.length=1;return}var W=m.words[9];for(w.words[w.length++]=W&S,B=10;B<m.length;B++){var j=m.words[B]|0;m.words[B-10]=(j&S)<<4|W>>>22,W=j}W>>>=22,m.words[B-10]=W,W===0&&m.length>10?m.length-=10:m.length-=9},F.prototype.imulK=function(m){m.words[m.length]=0,m.words[m.length+1]=0,m.length+=2;for(var w=0,S=0;S<m.length;S++){var P=m.words[S]|0;w+=P*977,m.words[S]=w&67108863,w=P*64+(w/67108864|0)}return m.words[m.length-1]===0&&(m.length--,m.words[m.length-1]===0&&m.length--),m};function q(){R.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(q,R);function N(){R.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(N,R);function z(){R.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(z,R),z.prototype.imulK=function(m){for(var w=0,S=0;S<m.length;S++){var P=(m.words[S]|0)*19+w,B=P&67108863;P>>>=26,m.words[S]=B,w=P}return w!==0&&(m.words[m.length++]=w),m},n._prime=function(m){if(A[m])return A[m];var w;if(m==="k256")w=new F;else if(m==="p224")w=new q;else if(m==="p192")w=new N;else if(m==="p25519")w=new z;else throw new Error("Unknown prime "+m);return A[m]=w,w};function G(C){if(typeof C=="string"){var m=n._prime(C);this.m=m.p,this.prime=m}else t(C.gtn(1),"modulus must be greater than 1"),this.m=C,this.prime=null}G.prototype._verify1=function(m){t(m.negative===0,"red works only with positives"),t(m.red,"red works only with red numbers")},G.prototype._verify2=function(m,w){t((m.negative|w.negative)==0,"red works only with positives"),t(m.red&&m.red===w.red,"red works only with red numbers")},G.prototype.imod=function(m){return this.prime?this.prime.ireduce(m)._forceRed(this):m.umod(this.m)._forceRed(this)},G.prototype.neg=function(m){return m.isZero()?m.clone():this.m.sub(m)._forceRed(this)},G.prototype.add=function(m,w){this._verify2(m,w);var S=m.add(w);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},G.prototype.iadd=function(m,w){this._verify2(m,w);var S=m.iadd(w);return S.cmp(this.m)>=0&&S.isub(this.m),S},G.prototype.sub=function(m,w){this._verify2(m,w);var S=m.sub(w);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},G.prototype.isub=function(m,w){this._verify2(m,w);var S=m.isub(w);return S.cmpn(0)<0&&S.iadd(this.m),S},G.prototype.shl=function(m,w){return this._verify1(m),this.imod(m.ushln(w))},G.prototype.imul=function(m,w){return this._verify2(m,w),this.imod(m.imul(w))},G.prototype.mul=function(m,w){return this._verify2(m,w),this.imod(m.mul(w))},G.prototype.isqr=function(m){return this.imul(m,m.clone())},G.prototype.sqr=function(m){return this.mul(m,m)},G.prototype.sqrt=function(m){if(m.isZero())return m.clone();var w=this.m.andln(3);if(t(w%2==1),w===3){var S=this.m.add(new n(1)).iushrn(2);return this.pow(m,S)}for(var P=this.m.subn(1),B=0;!P.isZero()&&P.andln(1)===0;)B++,P.iushrn(1);t(!P.isZero());var W=new n(1).toRed(this),j=W.redNeg(),M=this.m.subn(1).iushrn(1),_=this.m.bitLength();for(_=new n(2*_*_).toRed(this);this.pow(_,M).cmp(j)!==0;)_.redIAdd(j);for(var L=this.pow(_,P),ce=this.pow(m,P.addn(1).iushrn(1)),X=this.pow(m,P),ne=B;X.cmp(W)!==0;){for(var oe=X,he=0;oe.cmp(W)!==0;he++)oe=oe.redSqr();t(he<ne);var pe=this.pow(L,new n(1).iushln(ne-he-1));ce=ce.redMul(pe),L=pe.redSqr(),X=X.redMul(L),ne=he}return ce},G.prototype.invm=function(m){var w=m._invmp(this.m);return w.negative!==0?(w.negative=0,this.imod(w).redNeg()):this.imod(w)},G.prototype.pow=function(m,w){if(w.isZero())return new n(1).toRed(this);if(w.cmpn(1)===0)return m.clone();var S=4,P=new Array(1<<S);P[0]=new n(1).toRed(this),P[1]=m;for(var B=2;B<P.length;B++)P[B]=this.mul(P[B-1],m);var W=P[0],j=0,M=0,_=w.bitLength()%26;for(_===0&&(_=26),B=w.length-1;B>=0;B--){for(var L=w.words[B],ce=_-1;ce>=0;ce--){var X=L>>ce&1;if(W!==P[0]&&(W=this.sqr(W)),X===0&&j===0){M=0;continue}j<<=1,j|=X,M++,!(M!==S&&(B!==0||ce!==0))&&(W=this.mul(W,P[j]),M=0,j=0)}_=26}return W},G.prototype.convertTo=function(m){var w=m.umod(this.m);return w===m?w.clone():w},G.prototype.convertFrom=function(m){var w=m.clone();return w.red=null,w},n.mont=function(m){return new Y(m)};function Y(C){G.call(this,C),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(Y,G),Y.prototype.convertTo=function(m){return this.imod(m.ushln(this.shift))},Y.prototype.convertFrom=function(m){var w=this.imod(m.mul(this.rinv));return w.red=null,w},Y.prototype.imul=function(m,w){if(m.isZero()||w.isZero())return m.words[0]=0,m.length=1,m;var S=m.imul(w),P=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(P).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.mul=function(m,w){if(m.isZero()||w.isZero())return new n(0)._forceRed(this);var S=m.mul(w),P=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),B=S.isub(P).iushrn(this.shift),W=B;return B.cmp(this.m)>=0?W=B.isub(this.m):B.cmpn(0)<0&&(W=B.iadd(this.m)),W._forceRed(this)},Y.prototype.invm=function(m){var w=this.imod(m._invmp(this.m).mul(this.r2));return w._forceRed(this)}})(typeof kA=="undefined"||kA,k7)});var Xu=y((JIt,N7)=>{f();N7.exports=q7;function q7(r,e){if(!r)throw new Error(e||"Assertion failed")}q7.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}});var qA=y(M7=>{f();"use strict";var gw=M7;function WPe(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r!="string"){for(var i=0;i<r.length;i++)t[i]=r[i]|0;return t}if(e==="hex"){r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r);for(var i=0;i<r.length;i+=2)t.push(parseInt(r[i]+r[i+1],16))}else for(var i=0;i<r.length;i++){var n=r.charCodeAt(i),s=n>>8,o=n&255;s?t.push(s,o):t.push(o)}return t}gw.toArray=WPe;function D7(r){return r.length===1?"0"+r:r}gw.zero2=D7;function B7(r){for(var e="",t=0;t<r.length;t++)e+=D7(r[t].toString(16));return e}gw.toHex=B7;gw.encode=function(e,t){return t==="hex"?B7(e):e}});var ps=y(L7=>{f();"use strict";var ko=L7,YPe=ka(),XPe=Xu(),mw=qA();ko.assert=XPe;ko.toArray=mw.toArray;ko.zero2=mw.zero2;ko.toHex=mw.toHex;ko.encode=mw.encode;function QPe(r,e,t){var i=new Array(Math.max(r.bitLength(),t)+1);i.fill(0);for(var n=1<<e+1,s=r.clone(),o=0;o<i.length;o++){var a,c=s.andln(n-1);s.isOdd()?(c>(n>>1)-1?a=(n>>1)-c:a=c,s.isubn(a)):a=0,i[o]=a,s.iushrn(1)}return i}ko.getNAF=QPe;function ZPe(r,e){var t=[[],[]];r=r.clone(),e=e.clone();for(var i=0,n=0,s;r.cmpn(-i)>0||e.cmpn(-n)>0;){var o=r.andln(3)+i&3,a=e.andln(3)+n&3;o===3&&(o=-1),a===3&&(a=-1);var c;(o&1)==0?c=0:(s=r.andln(7)+i&7,(s===3||s===5)&&a===2?c=-o:c=o),t[0].push(c);var u;(a&1)==0?u=0:(s=e.andln(7)+n&7,(s===3||s===5)&&o===2?u=-a:u=a),t[1].push(u),2*i===c+1&&(i=1-i),2*n===u+1&&(n=1-n),r.iushrn(1),e.iushrn(1)}return t}ko.getJSF=ZPe;function JPe(r,e,t){var i="_"+e;r.prototype[e]=function(){return this[i]!==void 0?this[i]:this[i]=t.call(this)}}ko.cachedProperty=JPe;function eOe(r){return typeof r=="string"?ko.toArray(r,"hex"):r}ko.parseBytes=eOe;function tOe(r){return new YPe(r,"hex","le")}ko.intFromLE=tOe});var MA=y((r4t,BA)=>{f();var NA;BA.exports=function(e){return NA||(NA=new Qu(null)),NA.generate(e)};function Qu(r){this.rand=r}BA.exports.Rand=Qu;Qu.prototype.generate=function(e){return this._rand(e)};Qu.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Qu.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?Qu.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:typeof window=="object"&&(Qu.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(DA=xh(),typeof DA.randomBytes!="function")throw new Error("Not supported");Qu.prototype._rand=function(e){return DA.randomBytes(e)}}catch(r){}var DA});var Cg=y((i4t,U7)=>{f();"use strict";var Tf=ka(),Rg=ps(),bw=Rg.getNAF,rOe=Rg.getJSF,vw=Rg.assert;function Zu(r,e){this.type=r,this.p=new Tf(e.p,16),this.red=e.prime?Tf.red(e.prime):Tf.mont(this.p),this.zero=new Tf(0).toRed(this.red),this.one=new Tf(1).toRed(this.red),this.two=new Tf(2).toRed(this.red),this.n=e.n&&new Tf(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}U7.exports=Zu;Zu.prototype.point=function(){throw new Error("Not implemented")};Zu.prototype.validate=function(){throw new Error("Not implemented")};Zu.prototype._fixedNafMul=function(e,t){vw(e.precomputed);var i=e._getDoubles(),n=bw(t,1,this._bitLength),s=(1<<i.step+1)-(i.step%2==0?2:1);s/=3;var o=[],a,c;for(a=0;a<n.length;a+=i.step){c=0;for(var u=a+i.step-1;u>=a;u--)c=(c<<1)+n[u];o.push(c)}for(var l=this.jpoint(null,null,null),d=this.jpoint(null,null,null),h=s;h>0;h--){for(a=0;a<o.length;a++)c=o[a],c===h?d=d.mixedAdd(i.points[a]):c===-h&&(d=d.mixedAdd(i.points[a].neg()));l=l.add(d)}return l.toP()};Zu.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,o=bw(t,i,this._bitLength),a=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&o[c]===0;c--)u++;if(c>=0&&u++,a=a.dblp(u),c<0)break;var l=o[c];vw(l!==0),e.type==="affine"?l>0?a=a.mixedAdd(s[l-1>>1]):a=a.mixedAdd(s[-l-1>>1].neg()):l>0?a=a.add(s[l-1>>1]):a=a.add(s[-l-1>>1].neg())}return e.type==="affine"?a.toP():a};Zu.prototype._wnafMulAdd=function(e,t,i,n,s){var o=this._wnafT1,a=this._wnafT2,c=this._wnafT3,u=0,l,d,h;for(l=0;l<n;l++){h=t[l];var p=h._getNAFPoints(e);o[l]=p.wnd,a[l]=p.points}for(l=n-1;l>=1;l-=2){var g=l-1,b=l;if(o[g]!==1||o[b]!==1){c[g]=bw(i[g],o[g],this._bitLength),c[b]=bw(i[b],o[b],this._bitLength),u=Math.max(c[g].length,u),u=Math.max(c[b].length,u);continue}var E=[t[g],null,null,t[b]];t[g].y.cmp(t[b].y)===0?(E[1]=t[g].add(t[b]),E[2]=t[g].toJ().mixedAdd(t[b].neg())):t[g].y.cmp(t[b].y.redNeg())===0?(E[1]=t[g].toJ().mixedAdd(t[b]),E[2]=t[g].add(t[b].neg())):(E[1]=t[g].toJ().mixedAdd(t[b]),E[2]=t[g].toJ().mixedAdd(t[b].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],A=rOe(i[g],i[b]);for(u=Math.max(A[0].length,u),c[g]=new Array(u),c[b]=new Array(u),d=0;d<u;d++){var R=A[0][d]|0,F=A[1][d]|0;c[g][d]=v[(R+1)*3+(F+1)],c[b][d]=0,a[g]=E}}var q=this.jpoint(null,null,null),N=this._wnafT4;for(l=u;l>=0;l--){for(var z=0;l>=0;){var G=!0;for(d=0;d<n;d++)N[d]=c[d][l]|0,N[d]!==0&&(G=!1);if(!G)break;z++,l--}if(l>=0&&z++,q=q.dblp(z),l<0)break;for(d=0;d<n;d++){var Y=N[d];Y!==0&&(Y>0?h=a[d][Y-1>>1]:Y<0&&(h=a[d][-Y-1>>1].neg()),h.type==="affine"?q=q.mixedAdd(h):q=q.add(h))}}for(l=0;l<n;l++)a[l]=null;return s?q:q.toP()};function Ks(r,e){this.curve=r,this.type=e,this.precomputed=null}Zu.BasePoint=Ks;Ks.prototype.eq=function(){throw new Error("Not implemented")};Ks.prototype.validate=function(){return this.curve.validate(this)};Zu.prototype.decodePoint=function(e,t){e=Rg.toArray(e,t);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1==2*i){e[0]===6?vw(e[e.length-1]%2==0):e[0]===7&&vw(e[e.length-1]%2==1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};Ks.prototype.encodeCompressed=function(e){return this.encode(e,!0)};Ks.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))};Ks.prototype.encode=function(e,t){return Rg.encode(this._encode(t),e)};Ks.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this};Ks.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((e.bitLength()+1)/t.step):!1};Ks.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<t;s+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}};Ks.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(n);return{wnd:e,points:t}};Ks.prototype._getBeta=function(){return null};Ks.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}});var Gi=y((n4t,LA)=>{f();typeof Object.create=="function"?LA.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:LA.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}});var K7=y((s4t,F7)=>{f();"use strict";var iOe=ps(),jr=ka(),UA=Gi(),Dh=Cg(),nOe=iOe.assert;function js(r){Dh.call(this,"short",r),this.a=new jr(r.a,16).toRed(this.red),this.b=new jr(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}UA(js,Dh);F7.exports=js;js.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,i;if(e.beta)t=new jr(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(e.lambda)i=new jr(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?i=s[0]:(i=s[1],nOe(this.g.mul(i).x.cmp(this.g.x.redMul(t))===0))}var o;return e.basis?o=e.basis.map(function(a){return{a:new jr(a.a,16),b:new jr(a.b,16)}}):o=this._getEndoBasis(i),{beta:t,lambda:i,basis:o}}};js.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:jr.mont(e),i=new jr(2).toRed(t).redInvm(),n=i.redNeg(),s=new jr(3).toRed(t).redNeg().redSqrt().redMul(i),o=n.redAdd(s).fromRed(),a=n.redSub(s).fromRed();return[o,a]};js.prototype._getEndoBasis=function(e){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new jr(1),o=new jr(0),a=new jr(0),c=new jr(1),u,l,d,h,p,g,b,E=0,v,A;i.cmpn(0)!==0;){var R=n.div(i);v=n.sub(R.mul(i)),A=a.sub(R.mul(s));var F=c.sub(R.mul(o));if(!d&&v.cmp(t)<0)u=b.neg(),l=s,d=v.neg(),h=A;else if(d&&++E==2)break;b=v,n=i,i=v,a=s,s=A,c=o,o=F}p=v.neg(),g=A;var q=d.sqr().add(h.sqr()),N=p.sqr().add(g.sqr());return N.cmp(q)>=0&&(p=u,g=l),d.negative&&(d=d.neg(),h=h.neg()),p.negative&&(p=p.neg(),g=g.neg()),[{a:d,b:h},{a:p,b:g}]};js.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],s=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),c=o.mul(n.a),u=s.mul(i.b),l=o.mul(n.b),d=e.sub(a).sub(c),h=u.add(l).neg();return{k1:d,k2:h}};js.prototype.pointFromX=function(e,t){e=new jr(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)};js.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};js.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(t[o]),c=e[o],u=c._getBeta();a.k1.negative&&(a.k1.ineg(),c=c.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),n[o*2]=c,n[o*2+1]=u,s[o*2]=a.k1,s[o*2+1]=a.k2}for(var l=this._wnafMulAdd(1,n,s,o*2,i),d=0;d<o*2;d++)n[d]=null,s[d]=null;return l};function Mi(r,e,t,i){Dh.BasePoint.call(this,r,"affine"),e===null&&t===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new jr(e,16),this.y=new jr(t,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}UA(Mi,Dh.BasePoint);js.prototype.point=function(e,t,i){return new Mi(this,e,t,i)};js.prototype.pointFromJSON=function(e,t){return Mi.fromJSON(this,e,t)};Mi.prototype._getBeta=function(){if(!!this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}};Mi.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Mi.fromJSON=function(e,t,i){typeof t=="string"&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function s(a){return e.point(a[0],a[1],i)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(s))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(s))}},n};Mi.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Mi.prototype.isInfinity=function(){return this.inf};Mi.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var t=this.y.redSub(e.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Mi.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),o=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)};Mi.prototype.getX=function(){return this.x.fromRed()};Mi.prototype.getY=function(){return this.y.fromRed()};Mi.prototype.mul=function(e){return e=new jr(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Mi.prototype.mulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Mi.prototype.jmulAdd=function(e,t,i){var n=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Mi.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Mi.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t};Mi.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function Wi(r,e,t,i){Dh.BasePoint.call(this,r,"jacobian"),e===null&&t===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new jr(0)):(this.x=new jr(e,16),this.y=new jr(t,16),this.z=new jr(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}UA(Wi,Dh.BasePoint);js.prototype.jpoint=function(e,t,i){return new Wi(this,e,t,i)};Wi.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)};Wi.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Wi.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),s=e.x.redMul(i),o=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),c=n.redSub(s),u=o.redSub(a);if(c.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=c.redSqr(),d=l.redMul(c),h=n.redMul(l),p=u.redSqr().redIAdd(d).redISub(h).redISub(h),g=u.redMul(h.redISub(p)).redISub(o.redMul(d)),b=this.z.redMul(e.z).redMul(c);return this.curve.jpoint(p,g,b)};Wi.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),s=this.y,o=e.y.redMul(t).redMul(this.z),a=i.redSub(n),c=s.redSub(o);if(a.cmpn(0)===0)return c.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),l=u.redMul(a),d=i.redMul(u),h=c.redSqr().redIAdd(l).redISub(d).redISub(d),p=c.redMul(d.redISub(h)).redISub(s.redMul(l)),g=this.z.redMul(a);return this.curve.jpoint(h,p,g)};Wi.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,o=this.x,a=this.y,c=this.z,u=c.redSqr().redSqr(),l=a.redAdd(a);for(t=0;t<e;t++){var d=o.redSqr(),h=l.redSqr(),p=h.redSqr(),g=d.redAdd(d).redIAdd(d).redIAdd(n.redMul(u)),b=o.redMul(h),E=g.redSqr().redISub(b.redAdd(b)),v=b.redISub(E),A=g.redMul(v);A=A.redIAdd(A).redISub(p);var R=l.redMul(c);t+1<e&&(u=u.redMul(p)),o=E,c=R,l=A}return this.curve.jpoint(o,l.redMul(s),c)};Wi.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Wi.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n),u=c.redSqr().redISub(a).redISub(a),l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),e=u,t=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),h=this.y.redSqr(),p=h.redSqr(),g=this.x.redAdd(h).redSqr().redISub(d).redISub(p);g=g.redIAdd(g);var b=d.redAdd(d).redIAdd(d),E=b.redSqr(),v=p.redIAdd(p);v=v.redIAdd(v),v=v.redIAdd(v),e=E.redISub(g).redISub(g),t=b.redMul(g.redISub(e)).redISub(v),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,t,i)};Wi.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),o=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(n).redISub(o);a=a.redIAdd(a);var c=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=c.redSqr().redISub(a).redISub(a);e=u;var l=o.redIAdd(o);l=l.redIAdd(l),l=l.redIAdd(l),t=c.redMul(a.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),h=this.y.redSqr(),p=this.x.redMul(h),g=this.x.redSub(d).redMul(this.x.redAdd(d));g=g.redAdd(g).redIAdd(g);var b=p.redIAdd(p);b=b.redIAdd(b);var E=b.redAdd(b);e=g.redSqr().redISub(E),i=this.y.redAdd(this.z).redSqr().redISub(h).redISub(d);var v=h.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v),t=g.redMul(b.redISub(e)).redISub(v)}return this.curve.jpoint(e,t,i)};Wi.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),o=t.redSqr(),a=i.redSqr(),c=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(s)),u=t.redAdd(t);u=u.redIAdd(u);var l=u.redMul(a),d=c.redSqr().redISub(l.redAdd(l)),h=l.redISub(d),p=a.redSqr();p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var g=c.redMul(h).redISub(p),b=i.redAdd(i).redMul(n);return this.curve.jpoint(d,g,b)};Wi.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),s=e.redAdd(e).redIAdd(e),o=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(n);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(o);var c=a.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var l=s.redIAdd(a).redSqr().redISub(o).redISub(c).redISub(u),d=t.redMul(l);d=d.redIAdd(d),d=d.redIAdd(d);var h=this.x.redMul(c).redISub(d);h=h.redIAdd(h),h=h.redIAdd(h);var p=this.y.redMul(l.redMul(u.redISub(l)).redISub(a.redMul(c)));p=p.redIAdd(p),p=p.redIAdd(p),p=p.redIAdd(p);var g=this.z.redAdd(a).redSqr().redISub(i).redISub(c);return this.curve.jpoint(h,p,g)};Wi.prototype.mul=function(e,t){return e=new jr(e,t),this.curve._wnafMul(this,e)};Wi.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};Wi.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Wi.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Wi.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var z7=y((o4t,V7)=>{f();"use strict";var Bh=ka(),j7=Gi(),ww=Cg(),sOe=ps();function Mh(r){ww.call(this,"mont",r),this.a=new Bh(r.a,16).toRed(this.red),this.b=new Bh(r.b,16).toRed(this.red),this.i4=new Bh(4).toRed(this.red).redInvm(),this.two=new Bh(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}j7(Mh,ww);V7.exports=Mh;Mh.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t),s=n.redSqrt();return s.redSqr().cmp(n)===0};function Li(r,e,t){ww.BasePoint.call(this,r,"projective"),e===null&&t===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Bh(e,16),this.z=new Bh(t,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}j7(Li,ww.BasePoint);Mh.prototype.decodePoint=function(e,t){return this.point(sOe.toArray(e,t),1)};Mh.prototype.point=function(e,t){return new Li(this,e,t)};Mh.prototype.pointFromJSON=function(e){return Li.fromJSON(this,e)};Li.prototype.precompute=function(){};Li.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};Li.fromJSON=function(e,t){return new Li(e,t[0],t[1]||e.one)};Li.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Li.prototype.isInfinity=function(){return this.z.cmpn(0)===0};Li.prototype.dbl=function(){var e=this.x.redAdd(this.z),t=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=t.redSub(n),o=t.redMul(n),a=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(o,a)};Li.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),o=e.x.redSub(e.z),a=o.redMul(i),c=s.redMul(n),u=t.z.redMul(a.redAdd(c).redSqr()),l=t.x.redMul(a.redISub(c).redSqr());return this.curve.point(u,l)};Li.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),s=this,o=[];t.cmpn(0)!==0;t.iushrn(1))o.push(t.andln(1));for(var a=o.length-1;a>=0;a--)o[a]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};Li.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};Li.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};Li.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};Li.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var G7=y((a4t,$7)=>{f();"use strict";var oOe=ps(),$c=ka(),H7=Gi(),_w=Cg(),aOe=oOe.assert;function qa(r){this.twisted=(r.a|0)!=1,this.mOneA=this.twisted&&(r.a|0)==-1,this.extended=this.mOneA,_w.call(this,"edwards",r),this.a=new $c(r.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new $c(r.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new $c(r.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),aOe(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(r.c|0)==1}H7(qa,_w);$7.exports=qa;qa.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};qa.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};qa.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)};qa.prototype.pointFromX=function(e,t){e=new $c(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)};qa.prototype.pointFromY=function(e,t){e=new $c(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(o.cmp(this.zero)===0){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(a.redSqr().redSub(o).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)};qa.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return n.cmp(s)===0};function or(r,e,t,i,n){_w.BasePoint.call(this,r,"projective"),e===null&&t===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new $c(e,16),this.y=new $c(t,16),this.z=i?new $c(i,16):this.curve.one,this.t=n&&new $c(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}H7(or,_w.BasePoint);qa.prototype.pointFromJSON=function(e){return or.fromJSON(this,e)};qa.prototype.point=function(e,t,i,n){return new or(this,e,t,i,n)};or.fromJSON=function(e,t){return new or(e,t[0],t[1],t[2])};or.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};or.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};or.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),a=o.redSub(i),c=n.redSub(t),u=s.redMul(a),l=o.redMul(c),d=s.redMul(c),h=a.redMul(o);return this.curve.point(u,l,h,d)};or.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),t=this.x.redSqr(),i=this.y.redSqr(),n,s,o,a,c,u;if(this.curve.twisted){a=this.curve._mulA(t);var l=a.redAdd(i);this.zOne?(n=e.redSub(t).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(a.redSub(i)),o=l.redSqr().redSub(l).redSub(l)):(c=this.z.redSqr(),u=l.redSub(c).redISub(c),n=e.redSub(t).redISub(i).redMul(u),s=l.redMul(a.redSub(i)),o=l.redMul(u))}else a=t.redAdd(i),c=this.curve._mulC(this.z).redSqr(),u=a.redSub(c).redSub(c),n=this.curve._mulC(e.redISub(a)).redMul(u),s=this.curve._mulC(a).redMul(t.redISub(i)),o=a.redMul(u);return this.curve.point(n,s,o)};or.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};or.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(t),a=s.redSub(n),c=s.redAdd(n),u=i.redAdd(t),l=o.redMul(a),d=c.redMul(u),h=o.redMul(u),p=a.redMul(c);return this.curve.point(l,d,p,h)};or.prototype._projAdd=function(e){var t=this.z.redMul(e.z),i=t.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(s),a=i.redSub(o),c=i.redAdd(o),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=t.redMul(a).redMul(u),d,h;return this.curve.twisted?(d=t.redMul(c).redMul(s.redSub(this.curve._mulA(n))),h=a.redMul(c)):(d=t.redMul(c).redMul(s.redSub(n)),h=this.curve._mulC(a).redMul(c)),this.curve.point(l,d,h)};or.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};or.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};or.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)};or.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)};or.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};or.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};or.prototype.getX=function(){return this.normalize(),this.x.fromRed()};or.prototype.getY=function(){return this.normalize(),this.y.fromRed()};or.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};or.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(t)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),this.x.cmp(t)===0)return!0}};or.prototype.toP=or.prototype.normalize;or.prototype.mixedAdd=or.prototype.add});var FA=y(W7=>{f();"use strict";var Ew=W7;Ew.base=Cg();Ew.short=K7();Ew.mont=z7();Ew.edwards=G7()});var qo=y(Jt=>{f();"use strict";var cOe=Xu(),uOe=Gi();Jt.inherits=uOe;function lOe(r,e){return(r.charCodeAt(e)&64512)!=55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)==56320}function fOe(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!=0&&(r="0"+r),n=0;n<r.length;n+=2)t.push(parseInt(r[n]+r[n+1],16))}else for(var i=0,n=0;n<r.length;n++){var s=r.charCodeAt(n);s<128?t[i++]=s:s<2048?(t[i++]=s>>6|192,t[i++]=s&63|128):lOe(r,n)?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[i++]=s>>18|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128,t[i++]=s&63|128):(t[i++]=s>>12|224,t[i++]=s>>6&63|128,t[i++]=s&63|128)}else for(n=0;n<r.length;n++)t[n]=r[n]|0;return t}Jt.toArray=fOe;function dOe(r){for(var e="",t=0;t<r.length;t++)e+=X7(r[t].toString(16));return e}Jt.toHex=dOe;function Y7(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}Jt.htonl=Y7;function hOe(r,e){for(var t="",i=0;i<r.length;i++){var n=r[i];e==="little"&&(n=Y7(n)),t+=Q7(n.toString(16))}return t}Jt.toHex32=hOe;function X7(r){return r.length===1?"0"+r:r}Jt.zero2=X7;function Q7(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}Jt.zero8=Q7;function pOe(r,e,t,i){var n=t-e;cOe(n%4==0);for(var s=new Array(n/4),o=0,a=e;o<s.length;o++,a+=4){var c;i==="big"?c=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3]:c=r[a+3]<<24|r[a+2]<<16|r[a+1]<<8|r[a],s[o]=c>>>0}return s}Jt.join32=pOe;function yOe(r,e){for(var t=new Array(r.length*4),i=0,n=0;i<r.length;i++,n+=4){var s=r[i];e==="big"?(t[n]=s>>>24,t[n+1]=s>>>16&255,t[n+2]=s>>>8&255,t[n+3]=s&255):(t[n+3]=s>>>24,t[n+2]=s>>>16&255,t[n+1]=s>>>8&255,t[n]=s&255)}return t}Jt.split32=yOe;function gOe(r,e){return r>>>e|r<<32-e}Jt.rotr32=gOe;function mOe(r,e){return r<<e|r>>>32-e}Jt.rotl32=mOe;function bOe(r,e){return r+e>>>0}Jt.sum32=bOe;function vOe(r,e,t){return r+e+t>>>0}Jt.sum32_3=vOe;function wOe(r,e,t,i){return r+e+t+i>>>0}Jt.sum32_4=wOe;function _Oe(r,e,t,i,n){return r+e+t+i+n>>>0}Jt.sum32_5=_Oe;function EOe(r,e,t,i){var n=r[e],s=r[e+1],o=i+s>>>0,a=(o<i?1:0)+t+n;r[e]=a>>>0,r[e+1]=o}Jt.sum64=EOe;function SOe(r,e,t,i){var n=e+i>>>0,s=(n<e?1:0)+r+t;return s>>>0}Jt.sum64_hi=SOe;function xOe(r,e,t,i){var n=e+i;return n>>>0}Jt.sum64_lo=xOe;function AOe(r,e,t,i,n,s,o,a){var c=0,u=e;u=u+i>>>0,c+=u<e?1:0,u=u+s>>>0,c+=u<s?1:0,u=u+a>>>0,c+=u<a?1:0;var l=r+t+n+o+c;return l>>>0}Jt.sum64_4_hi=AOe;function IOe(r,e,t,i,n,s,o,a){var c=e+i+s+a;return c>>>0}Jt.sum64_4_lo=IOe;function TOe(r,e,t,i,n,s,o,a,c,u){var l=0,d=e;d=d+i>>>0,l+=d<e?1:0,d=d+s>>>0,l+=d<s?1:0,d=d+a>>>0,l+=d<a?1:0,d=d+u>>>0,l+=d<u?1:0;var h=r+t+n+o+c+l;return h>>>0}Jt.sum64_5_hi=TOe;function ROe(r,e,t,i,n,s,o,a,c,u){var l=e+i+s+a+u;return l>>>0}Jt.sum64_5_lo=ROe;function COe(r,e,t){var i=e<<32-t|r>>>t;return i>>>0}Jt.rotr64_hi=COe;function POe(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Jt.rotr64_lo=POe;function OOe(r,e,t){return r>>>t}Jt.shr64_hi=OOe;function kOe(r,e,t){var i=r<<32-t|e>>>t;return i>>>0}Jt.shr64_lo=kOe});var Lh=y(J7=>{f();"use strict";var Z7=qo(),qOe=Xu();function Sw(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}J7.BlockHash=Sw;Sw.prototype.update=function(e,t){if(e=Z7.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var i=e.length%this._delta8;this.pending=e.slice(e.length-i,e.length),this.pending.length===0&&(this.pending=null),e=Z7.join32(e,0,e.length-i,this.endian);for(var n=0;n<e.length;n+=this._delta32)this._update(e,n,n+this._delta32)}return this};Sw.prototype.digest=function(e){return this.update(this._pad()),qOe(this.pending===null),this._digest(e)};Sw.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(e<<=3,this.endian==="big"){for(var o=8;o<this.padLength;o++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=e>>>24&255,n[s++]=e>>>16&255,n[s++]=e>>>8&255,n[s++]=e&255}else for(n[s++]=e&255,n[s++]=e>>>8&255,n[s++]=e>>>16&255,n[s++]=e>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,o=8;o<this.padLength;o++)n[s++]=0;return n}});var KA=y(Gc=>{f();"use strict";var NOe=qo(),Na=NOe.rotr32;function DOe(r,e,t,i){if(r===0)return eL(e,t,i);if(r===1||r===3)return rL(e,t,i);if(r===2)return tL(e,t,i)}Gc.ft_1=DOe;function eL(r,e,t){return r&e^~r&t}Gc.ch32=eL;function tL(r,e,t){return r&e^r&t^e&t}Gc.maj32=tL;function rL(r,e,t){return r^e^t}Gc.p32=rL;function BOe(r){return Na(r,2)^Na(r,13)^Na(r,22)}Gc.s0_256=BOe;function MOe(r){return Na(r,6)^Na(r,11)^Na(r,25)}Gc.s1_256=MOe;function LOe(r){return Na(r,7)^Na(r,18)^r>>>3}Gc.g0_256=LOe;function UOe(r){return Na(r,17)^Na(r,19)^r>>>10}Gc.g1_256=UOe});var sL=y((d4t,nL)=>{f();"use strict";var Uh=qo(),FOe=Lh(),KOe=KA(),jA=Uh.rotl32,Pg=Uh.sum32,jOe=Uh.sum32_5,VOe=KOe.ft_1,iL=FOe.BlockHash,zOe=[1518500249,1859775393,2400959708,3395469782];function Da(){if(!(this instanceof Da))return new Da;iL.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Uh.inherits(Da,iL);nL.exports=Da;Da.blockSize=512;Da.outSize=160;Da.hmacStrength=80;Da.padLength=64;Da.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=jA(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4];for(n=0;n<i.length;n++){var l=~~(n/20),d=jOe(jA(s,5),VOe(l,o,a,c),u,i[n],zOe[l]);u=c,c=a,a=jA(o,30),o=s,s=d}this.h[0]=Pg(this.h[0],s),this.h[1]=Pg(this.h[1],o),this.h[2]=Pg(this.h[2],a),this.h[3]=Pg(this.h[3],c),this.h[4]=Pg(this.h[4],u)};Da.prototype._digest=function(e){return e==="hex"?Uh.toHex32(this.h,"big"):Uh.split32(this.h,"big")}});var VA=y((h4t,aL)=>{f();"use strict";var Fh=qo(),HOe=Lh(),Kh=KA(),$Oe=Xu(),No=Fh.sum32,GOe=Fh.sum32_4,WOe=Fh.sum32_5,YOe=Kh.ch32,XOe=Kh.maj32,QOe=Kh.s0_256,ZOe=Kh.s1_256,JOe=Kh.g0_256,eke=Kh.g1_256,oL=HOe.BlockHash,tke=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ba(){if(!(this instanceof Ba))return new Ba;oL.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=tke,this.W=new Array(64)}Fh.inherits(Ba,oL);aL.exports=Ba;Ba.blockSize=512;Ba.outSize=256;Ba.hmacStrength=192;Ba.padLength=64;Ba.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=GOe(eke(i[n-2]),i[n-7],JOe(i[n-15]),i[n-16]);var s=this.h[0],o=this.h[1],a=this.h[2],c=this.h[3],u=this.h[4],l=this.h[5],d=this.h[6],h=this.h[7];for($Oe(this.k.length===i.length),n=0;n<i.length;n++){var p=WOe(h,ZOe(u),YOe(u,l,d),this.k[n],i[n]),g=No(QOe(s),XOe(s,o,a));h=d,d=l,l=u,u=No(c,p),c=a,a=o,o=s,s=No(p,g)}this.h[0]=No(this.h[0],s),this.h[1]=No(this.h[1],o),this.h[2]=No(this.h[2],a),this.h[3]=No(this.h[3],c),this.h[4]=No(this.h[4],u),this.h[5]=No(this.h[5],l),this.h[6]=No(this.h[6],d),this.h[7]=No(this.h[7],h)};Ba.prototype._digest=function(e){return e==="hex"?Fh.toHex32(this.h,"big"):Fh.split32(this.h,"big")}});var lL=y((p4t,uL)=>{f();"use strict";var zA=qo(),cL=VA();function Wc(){if(!(this instanceof Wc))return new Wc;cL.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}zA.inherits(Wc,cL);uL.exports=Wc;Wc.blockSize=512;Wc.outSize=224;Wc.hmacStrength=192;Wc.padLength=64;Wc.prototype._digest=function(e){return e==="hex"?zA.toHex32(this.h.slice(0,7),"big"):zA.split32(this.h.slice(0,7),"big")}});var GA=y((y4t,pL)=>{f();"use strict";var Zn=qo(),rke=Lh(),ike=Xu(),Ma=Zn.rotr64_hi,La=Zn.rotr64_lo,fL=Zn.shr64_hi,dL=Zn.shr64_lo,Ju=Zn.sum64,HA=Zn.sum64_hi,$A=Zn.sum64_lo,nke=Zn.sum64_4_hi,ske=Zn.sum64_4_lo,oke=Zn.sum64_5_hi,ake=Zn.sum64_5_lo,hL=rke.BlockHash,cke=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Do(){if(!(this instanceof Do))return new Do;hL.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=cke,this.W=new Array(160)}Zn.inherits(Do,hL);pL.exports=Do;Do.blockSize=1024;Do.outSize=512;Do.hmacStrength=192;Do.padLength=128;Do.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var s=vke(i[n-4],i[n-3]),o=wke(i[n-4],i[n-3]),a=i[n-14],c=i[n-13],u=mke(i[n-30],i[n-29]),l=bke(i[n-30],i[n-29]),d=i[n-32],h=i[n-31];i[n]=nke(s,o,a,c,u,l,d,h),i[n+1]=ske(s,o,a,c,u,l,d,h)}};Do.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],s=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],l=this.h[6],d=this.h[7],h=this.h[8],p=this.h[9],g=this.h[10],b=this.h[11],E=this.h[12],v=this.h[13],A=this.h[14],R=this.h[15];ike(this.k.length===i.length);for(var F=0;F<i.length;F+=2){var q=A,N=R,z=yke(h,p),G=gke(h,p),Y=uke(h,p,g,b,E,v),C=lke(h,p,g,b,E,v),m=this.k[F],w=this.k[F+1],S=i[F],P=i[F+1],B=oke(q,N,z,G,Y,C,m,w,S,P),W=ake(q,N,z,G,Y,C,m,w,S,P);q=hke(n,s),N=pke(n,s),z=fke(n,s,o,a,c,u),G=dke(n,s,o,a,c,u);var j=HA(q,N,z,G),M=$A(q,N,z,G);A=E,R=v,E=g,v=b,g=h,b=p,h=HA(l,d,B,W),p=$A(d,d,B,W),l=c,d=u,c=o,u=a,o=n,a=s,n=HA(B,W,j,M),s=$A(B,W,j,M)}Ju(this.h,0,n,s),Ju(this.h,2,o,a),Ju(this.h,4,c,u),Ju(this.h,6,l,d),Ju(this.h,8,h,p),Ju(this.h,10,g,b),Ju(this.h,12,E,v),Ju(this.h,14,A,R)};Do.prototype._digest=function(e){return e==="hex"?Zn.toHex32(this.h,"big"):Zn.split32(this.h,"big")};function uke(r,e,t,i,n){var s=r&t^~r&n;return s<0&&(s+=4294967296),s}function lke(r,e,t,i,n,s){var o=e&i^~e&s;return o<0&&(o+=4294967296),o}function fke(r,e,t,i,n){var s=r&t^r&n^t&n;return s<0&&(s+=4294967296),s}function dke(r,e,t,i,n,s){var o=e&i^e&s^i&s;return o<0&&(o+=4294967296),o}function hke(r,e){var t=Ma(r,e,28),i=Ma(e,r,2),n=Ma(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function pke(r,e){var t=La(r,e,28),i=La(e,r,2),n=La(e,r,7),s=t^i^n;return s<0&&(s+=4294967296),s}function yke(r,e){var t=Ma(r,e,14),i=Ma(r,e,18),n=Ma(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function gke(r,e){var t=La(r,e,14),i=La(r,e,18),n=La(e,r,9),s=t^i^n;return s<0&&(s+=4294967296),s}function mke(r,e){var t=Ma(r,e,1),i=Ma(r,e,8),n=fL(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function bke(r,e){var t=La(r,e,1),i=La(r,e,8),n=dL(r,e,7),s=t^i^n;return s<0&&(s+=4294967296),s}function vke(r,e){var t=Ma(r,e,19),i=Ma(e,r,29),n=fL(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}function wke(r,e){var t=La(r,e,19),i=La(e,r,29),n=dL(r,e,6),s=t^i^n;return s<0&&(s+=4294967296),s}});var mL=y((g4t,gL)=>{f();"use strict";var WA=qo(),yL=GA();function Yc(){if(!(this instanceof Yc))return new Yc;yL.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}WA.inherits(Yc,yL);gL.exports=Yc;Yc.blockSize=1024;Yc.outSize=384;Yc.hmacStrength=192;Yc.padLength=128;Yc.prototype._digest=function(e){return e==="hex"?WA.toHex32(this.h.slice(0,12),"big"):WA.split32(this.h.slice(0,12),"big")}});var bL=y(jh=>{f();"use strict";jh.sha1=sL();jh.sha224=lL();jh.sha256=VA();jh.sha384=mL();jh.sha512=GA()});var xL=y(SL=>{f();"use strict";var Rf=qo(),_ke=Lh(),xw=Rf.rotl32,vL=Rf.sum32,Og=Rf.sum32_3,wL=Rf.sum32_4,_L=_ke.BlockHash;function Ua(){if(!(this instanceof Ua))return new Ua;_L.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Rf.inherits(Ua,_L);SL.ripemd160=Ua;Ua.blockSize=512;Ua.outSize=160;Ua.hmacStrength=192;Ua.padLength=64;Ua.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],a=this.h[4],c=i,u=n,l=s,d=o,h=a,p=0;p<80;p++){var g=vL(xw(wL(i,EL(p,n,s,o),e[xke[p]+t],Eke(p)),Ike[p]),a);i=a,a=o,o=xw(s,10),s=n,n=g,g=vL(xw(wL(c,EL(79-p,u,l,d),e[Ake[p]+t],Ske(p)),Tke[p]),h),c=h,h=d,d=xw(l,10),l=u,u=g}g=Og(this.h[1],s,d),this.h[1]=Og(this.h[2],o,h),this.h[2]=Og(this.h[3],a,c),this.h[3]=Og(this.h[4],i,u),this.h[4]=Og(this.h[0],n,l),this.h[0]=g};Ua.prototype._digest=function(e){return e==="hex"?Rf.toHex32(this.h,"little"):Rf.split32(this.h,"little")};function EL(r,e,t,i){return r<=15?e^t^i:r<=31?e&t|~e&i:r<=47?(e|~t)^i:r<=63?e&i|t&~i:e^(t|~i)}function Eke(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function Ske(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var xke=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Ake=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Ike=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Tke=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var IL=y((v4t,AL)=>{f();"use strict";var Rke=qo(),Cke=Xu();function Vh(r,e,t){if(!(this instanceof Vh))return new Vh(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(Rke.toArray(e,t))}AL.exports=Vh;Vh.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),Cke(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};Vh.prototype.update=function(e,t){return this.inner.update(e,t),this};Vh.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var Aw=y(TL=>{f();var Yi=TL;Yi.utils=qo();Yi.common=Lh();Yi.sha=bL();Yi.ripemd=xL();Yi.hmac=IL();Yi.sha1=Yi.sha.sha1;Yi.sha256=Yi.sha.sha256;Yi.sha224=Yi.sha.sha224;Yi.sha384=Yi.sha.sha384;Yi.sha512=Yi.sha.sha512;Yi.ripemd160=Yi.ripemd.ripemd160});var CL=y((_4t,RL)=>{f();RL.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var Iw=y(kL=>{f();"use strict";var YA=kL,el=Aw(),XA=FA(),Pke=ps(),PL=Pke.assert;function OL(r){r.type==="short"?this.curve=new XA.short(r):r.type==="edwards"?this.curve=new XA.edwards(r):this.curve=new XA.mont(r),this.g=this.curve.g,this.n=this.curve.n,this.hash=r.hash,PL(this.g.validate(),"Invalid curve"),PL(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}YA.PresetCurve=OL;function tl(r,e){Object.defineProperty(YA,r,{configurable:!0,enumerable:!0,get:function(){var t=new OL(e);return Object.defineProperty(YA,r,{configurable:!0,enumerable:!0,value:t}),t}})}tl("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:el.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});tl("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:el.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});tl("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:el.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});tl("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:el.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});tl("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:el.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});tl("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:el.sha256,gRed:!1,g:["9"]});tl("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:el.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var QA;try{QA=CL()}catch(r){QA=void 0}tl("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:el.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",QA]})});var DL=y((S4t,NL)=>{f();"use strict";var Oke=Aw(),Cf=qA(),qL=Xu();function rl(r){if(!(this instanceof rl))return new rl(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Cf.toArray(r.entropy,r.entropyEnc||"hex"),t=Cf.toArray(r.nonce,r.nonceEnc||"hex"),i=Cf.toArray(r.pers,r.persEnc||"hex");qL(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,t,i)}NL.exports=rl;rl.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};rl.prototype._hmac=function(){return new Oke.hmac(this.hash,this.K)};rl.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),!!e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};rl.prototype.reseed=function(e,t,i,n){typeof t!="string"&&(n=i,i=t,t=null),e=Cf.toArray(e,t),i=Cf.toArray(i,n),qL(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1};rl.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=i,i=t,t=null),i&&(i=Cf.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(i),this._reseed++,Cf.encode(o,t)}});var ML=y((x4t,BL)=>{f();"use strict";var kke=ka(),qke=ps(),ZA=qke.assert;function ln(r,e){this.ec=r,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}BL.exports=ln;ln.fromPublic=function(e,t,i){return t instanceof ln?t:new ln(e,{pub:t,pubEnc:i})};ln.fromPrivate=function(e,t,i){return t instanceof ln?t:new ln(e,{priv:t,privEnc:i})};ln.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};ln.prototype.getPublic=function(e,t){return typeof e=="string"&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub};ln.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};ln.prototype._importPrivate=function(e,t){this.priv=new kke(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)};ln.prototype._importPublic=function(e,t){if(e.x||e.y){this.ec.curve.type==="mont"?ZA(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&ZA(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)};ln.prototype.derive=function(e){return e.validate()||ZA(e.validate(),"public point not validated"),e.mul(this.priv).getX()};ln.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)};ln.prototype.verify=function(e,t){return this.ec.verify(e,t,this)};ln.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var FL=y((A4t,UL)=>{f();"use strict";var Tw=ka(),JA=ps(),Nke=JA.assert;function Rw(r,e){if(r instanceof Rw)return r;this._importDER(r,e)||(Nke(r.r&&r.s,"Signature without r or s"),this.r=new Tw(r.r,16),this.s=new Tw(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}UL.exports=Rw;function Dke(){this.place=0}function eI(r,e){var t=r[e.place++];if(!(t&128))return t;var i=t&15;if(i===0||i>4)return!1;for(var n=0,s=0,o=e.place;s<i;s++,o++)n<<=8,n|=r[o],n>>>=0;return n<=127?!1:(e.place=o,n)}function LL(r){for(var e=0,t=r.length-1;!r[e]&&!(r[e+1]&128)&&e<t;)e++;return e===0?r:r.slice(e)}Rw.prototype._importDER=function(e,t){e=JA.toArray(e,t);var i=new Dke;if(e[i.place++]!==48)return!1;var n=eI(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=eI(e,i);if(s===!1)return!1;var o=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var a=eI(e,i);if(a===!1||e.length!==a+i.place)return!1;var c=e.slice(i.place,a+i.place);if(o[0]===0)if(o[1]&128)o=o.slice(1);else return!1;if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;return this.r=new Tw(o),this.s=new Tw(c),this.recoveryParam=null,!0};function tI(r,e){if(e<128){r.push(e);return}var t=1+(Math.log(e)/Math.LN2>>>3);for(r.push(t|128);--t;)r.push(e>>>(t<<3)&255);r.push(e)}Rw.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),i[0]&128&&(i=[0].concat(i)),t=LL(t),i=LL(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];tI(n,t.length),n=n.concat(t),n.push(2),tI(n,i.length);var s=n.concat(i),o=[48];return tI(o,s.length),o=o.concat(s),JA.encode(o,e)}});var zL=y((I4t,VL)=>{f();"use strict";var Pf=ka(),KL=DL(),Bke=ps(),rI=Iw(),Mke=MA(),jL=Bke.assert,iI=ML(),Cw=FL();function Vs(r){if(!(this instanceof Vs))return new Vs(r);typeof r=="string"&&(jL(Object.prototype.hasOwnProperty.call(rI,r),"Unknown curve "+r),r=rI[r]),r instanceof rI.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}VL.exports=Vs;Vs.prototype.keyPair=function(e){return new iI(this,e)};Vs.prototype.keyFromPrivate=function(e,t){return iI.fromPrivate(this,e,t)};Vs.prototype.keyFromPublic=function(e,t){return iI.fromPublic(this,e,t)};Vs.prototype.genKeyPair=function(e){e||(e={});for(var t=new KL({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Mke(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Pf(2));;){var s=new Pf(t.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Vs.prototype._truncateToN=function(e,t){var i=e.byteLength()*8-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e};Vs.prototype.sign=function(e,t,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new Pf(e,16));for(var s=this.n.byteLength(),o=t.getPrivate().toArray("be",s),a=e.toArray("be",s),c=new KL({hash:this.hash,entropy:o,nonce:a,pers:n.pers,persEnc:n.persEnc||"utf8"}),u=this.n.sub(new Pf(1)),l=0;;l++){var d=n.k?n.k(l):new Pf(c.generate(this.n.byteLength()));if(d=this._truncateToN(d,!0),!(d.cmpn(1)<=0||d.cmp(u)>=0)){var h=this.g.mul(d);if(!h.isInfinity()){var p=h.getX(),g=p.umod(this.n);if(g.cmpn(0)!==0){var b=d.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(b=b.umod(this.n),b.cmpn(0)!==0){var E=(h.getY().isOdd()?1:0)|(p.cmp(g)!==0?2:0);return n.canonical&&b.cmp(this.nh)>0&&(b=this.n.sub(b),E^=1),new Cw({r:g,s:b,recoveryParam:E})}}}}}};Vs.prototype.verify=function(e,t,i,n){e=this._truncateToN(new Pf(e,16)),i=this.keyFromPublic(i,n),t=new Cw(t,"hex");var s=t.r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),c=a.mul(e).umod(this.n),u=a.mul(s).umod(this.n),l;return this.curve._maxwellTrick?(l=this.g.jmulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.eqXToP(s)):(l=this.g.mulAdd(c,i.getPublic(),u),l.isInfinity()?!1:l.getX().umod(this.n).cmp(s)===0)};Vs.prototype.recoverPubKey=function(r,e,t,i){jL((3&t)===t,"The recovery param is more than two bits"),e=new Cw(e,i);var n=this.n,s=new Pf(r),o=e.r,a=e.s,c=t&1,u=t>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?o=this.curve.pointFromX(o.add(this.curve.n),c):o=this.curve.pointFromX(o,c);var l=e.r.invm(n),d=n.sub(s).mul(l).umod(n),h=a.mul(l).umod(n);return this.g.mulAdd(d,o,h)};Vs.prototype.getKeyRecoveryParam=function(r,e,t,i){if(e=new Cw(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(r,e,n)}catch(o){continue}if(s.eq(t))return n}throw new Error("Unable to find valid recovery factor")}});var WL=y((T4t,GL)=>{f();"use strict";var kg=ps(),HL=kg.assert,$L=kg.parseBytes,zh=kg.cachedProperty;function Ui(r,e){this.eddsa=r,this._secret=$L(e.secret),r.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=$L(e.pub)}Ui.fromPublic=function(e,t){return t instanceof Ui?t:new Ui(e,{pub:t})};Ui.fromSecret=function(e,t){return t instanceof Ui?t:new Ui(e,{secret:t})};Ui.prototype.secret=function(){return this._secret};zh(Ui,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});zh(Ui,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});zh(Ui,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});zh(Ui,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});zh(Ui,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});zh(Ui,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});Ui.prototype.sign=function(e){return HL(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};Ui.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)};Ui.prototype.getSecret=function(e){return HL(this._secret,"KeyPair is public only"),kg.encode(this.secret(),e)};Ui.prototype.getPublic=function(e){return kg.encode(this.pubBytes(),e)};GL.exports=Ui});var XL=y((R4t,YL)=>{f();"use strict";var Lke=ka(),Pw=ps(),Uke=Pw.assert,Ow=Pw.cachedProperty,Fke=Pw.parseBytes;function Of(r,e){this.eddsa=r,typeof e!="object"&&(e=Fke(e)),Array.isArray(e)&&(e={R:e.slice(0,r.encodingLength),S:e.slice(r.encodingLength)}),Uke(e.R&&e.S,"Signature without R or S"),r.isPoint(e.R)&&(this._R=e.R),e.S instanceof Lke&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}Ow(Of,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});Ow(Of,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});Ow(Of,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});Ow(Of,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Of.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Of.prototype.toHex=function(){return Pw.encode(this.toBytes(),"hex").toUpperCase()};YL.exports=Of});var t9=y((C4t,e9)=>{f();"use strict";var Kke=Aw(),jke=Iw(),Hh=ps(),Vke=Hh.assert,QL=Hh.parseBytes,ZL=WL(),JL=XL();function Jn(r){if(Vke(r==="ed25519","only tested with ed25519 so far"),!(this instanceof Jn))return new Jn(r);r=jke[r].curve,this.curve=r,this.g=r.g,this.g.precompute(r.n.bitLength()+1),this.pointClass=r.point().constructor,this.encodingLength=Math.ceil(r.n.bitLength()/8),this.hash=Kke.sha512}e9.exports=Jn;Jn.prototype.sign=function(e,t){e=QL(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),o=this.encodePoint(s),a=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:o})};Jn.prototype.verify=function(e,t,i){e=QL(e),t=this.makeSignature(t);var n=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S()),a=t.R().add(n.pub().mul(s));return a.eq(o)};Jn.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return Hh.intFromLE(e.digest()).umod(this.curve.n)};Jn.prototype.keyFromPublic=function(e){return ZL.fromPublic(this,e)};Jn.prototype.keyFromSecret=function(e){return ZL.fromSecret(this,e)};Jn.prototype.makeSignature=function(e){return e instanceof JL?e:new JL(this,e)};Jn.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t};Jn.prototype.decodePoint=function(e){e=Hh.parseBytes(e);var t=e.length-1,i=e.slice(0,t).concat(e[t]&~128),n=(e[t]&128)!=0,s=Hh.intFromLE(i);return this.curve.pointFromY(s,n)};Jn.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};Jn.prototype.decodeInt=function(e){return Hh.intFromLE(e)};Jn.prototype.isPoint=function(e){return e instanceof this.pointClass}});var i9=y(r9=>{f();"use strict";var kf=r9;kf.version=P7().version;kf.utils=ps();kf.rand=MA();kf.curve=FA();kf.curves=Iw();kf.ec=zL();kf.eddsa=t9()});var s9=y((O4t,n9)=>{f();var zke=i9().ec,Fa=new zke("secp256k1"),It=Fa.curve,er=It.n.constructor;function Hke(r,e){let t=new er(e);if(t.cmp(It.p)>=0)return null;t=t.toRed(It.red);let i=t.redSqr().redIMul(t).redIAdd(It.b).redSqrt();return r===3!==i.isOdd()&&(i=i.redNeg()),Fa.keyPair({pub:{x:t,y:i}})}function $ke(r,e,t){let i=new er(e),n=new er(t);if(i.cmp(It.p)>=0||n.cmp(It.p)>=0||(i=i.toRed(It.red),n=n.toRed(It.red),(r===6||r===7)&&n.isOdd()!==(r===7)))return null;let s=i.redSqr().redIMul(i);return n.redSqr().redISub(s.redIAdd(It.b)).isZero()?Fa.keyPair({pub:{x:i,y:n}}):null}function il(r){let e=r[0];switch(e){case 2:case 3:return r.length!==33?null:Hke(e,r.subarray(1,33));case 4:case 6:case 7:return r.length!==65?null:$ke(e,r.subarray(1,33),r.subarray(33,65));default:return null}}function qf(r,e){let t=e.encode(null,r.length===33);for(let i=0;i<r.length;++i)r[i]=t[i]}n9.exports={contextRandomize(){return 0},privateKeyVerify(r){let e=new er(r);return e.cmp(It.n)<0&&!e.isZero()?0:1},privateKeyNegate(r){let e=new er(r),t=It.n.sub(e).umod(It.n).toArrayLike(Uint8Array,"be",32);return r.set(t),0},privateKeyTweakAdd(r,e){let t=new er(e);if(t.cmp(It.n)>=0||(t.iadd(new er(r)),t.cmp(It.n)>=0&&t.isub(It.n),t.isZero()))return 1;let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},privateKeyTweakMul(r,e){let t=new er(e);if(t.cmp(It.n)>=0||t.isZero())return 1;t.imul(new er(r)),t.cmp(It.n)>=0&&(t=t.umod(It.n));let i=t.toArrayLike(Uint8Array,"be",32);return r.set(i),0},publicKeyVerify(r){return il(r)===null?1:0},publicKeyCreate(r,e){let t=new er(e);if(t.cmp(It.n)>=0||t.isZero())return 1;let i=Fa.keyFromPrivate(e).getPublic();return qf(r,i),0},publicKeyConvert(r,e){let t=il(e);if(t===null)return 1;let i=t.getPublic();return qf(r,i),0},publicKeyNegate(r,e){let t=il(e);if(t===null)return 1;let i=t.getPublic();return i.y=i.y.redNeg(),qf(r,i),0},publicKeyCombine(r,e){let t=new Array(e.length);for(let n=0;n<e.length;++n)if(t[n]=il(e[n]),t[n]===null)return 1;let i=t[0].getPublic();for(let n=1;n<t.length;++n)i=i.add(t[n].pub);return i.isInfinity()?2:(qf(r,i),0)},publicKeyTweakAdd(r,e,t){let i=il(e);if(i===null)return 1;if(t=new er(t),t.cmp(It.n)>=0)return 2;let n=i.getPublic().add(It.g.mul(t));return n.isInfinity()?2:(qf(r,n),0)},publicKeyTweakMul(r,e,t){let i=il(e);if(i===null)return 1;if(t=new er(t),t.cmp(It.n)>=0||t.isZero())return 2;let n=i.getPublic().mul(t);return qf(r,n),0},signatureNormalize(r){let e=new er(r.subarray(0,32)),t=new er(r.subarray(32,64));return e.cmp(It.n)>=0||t.cmp(It.n)>=0?1:(t.cmp(Fa.nh)===1&&r.set(It.n.sub(t).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(r,e){let t=e.subarray(0,32),i=e.subarray(32,64);if(new er(t).cmp(It.n)>=0||new er(i).cmp(It.n)>=0)return 1;let{output:n}=r,s=n.subarray(4,4+33);s[0]=0,s.set(t,1);let o=33,a=0;for(;o>1&&s[a]===0&&!(s[a+1]&128);--o,++a);if(s=s.subarray(a),s[0]&128||o>1&&s[0]===0&&!(s[1]&128))return 1;let c=n.subarray(6+33,6+33+33);c[0]=0,c.set(i,1);let u=33,l=0;for(;u>1&&c[l]===0&&!(c[l+1]&128);--u,++l);return c=c.subarray(l),c[0]&128||u>1&&c[0]===0&&!(c[1]&128)?1:(r.outputlen=6+o+u,n[0]=48,n[1]=r.outputlen-2,n[2]=2,n[3]=s.length,n.set(s,4),n[4+o]=2,n[5+o]=c.length,n.set(c,6+o),0)},signatureImport(r,e){if(e.length<8||e.length>72||e[0]!==48||e[1]!==e.length-2||e[2]!==2)return 1;let t=e[3];if(t===0||5+t>=e.length||e[4+t]!==2)return 1;let i=e[5+t];if(i===0||6+t+i!==e.length||e[4]&128||t>1&&e[4]===0&&!(e[5]&128)||e[t+6]&128||i>1&&e[t+6]===0&&!(e[t+7]&128))return 1;let n=e.subarray(4,4+t);if(n.length===33&&n[0]===0&&(n=n.subarray(1)),n.length>32)return 1;let s=e.subarray(6+t);if(s.length===33&&s[0]===0&&(s=s.slice(1)),s.length>32)throw new Error("S length is too long");let o=new er(n);o.cmp(It.n)>=0&&(o=new er(0));let a=new er(e.subarray(6+t));return a.cmp(It.n)>=0&&(a=new er(0)),r.set(o.toArrayLike(Uint8Array,"be",32),0),r.set(a.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(r,e,t,i,n){if(n){let a=n;n=c=>{let u=a(e,t,null,i,c);if(!(u instanceof Uint8Array&&u.length===32))throw new Error("This is the way");return new er(u)}}let s=new er(t);if(s.cmp(It.n)>=0||s.isZero())return 1;let o;try{o=Fa.sign(e,t,{canonical:!0,k:n,pers:i})}catch(a){return 1}return r.signature.set(o.r.toArrayLike(Uint8Array,"be",32),0),r.signature.set(o.s.toArrayLike(Uint8Array,"be",32),32),r.recid=o.recoveryParam,0},ecdsaVerify(r,e,t){let i={r:r.subarray(0,32),s:r.subarray(32,64)},n=new er(i.r),s=new er(i.s);if(n.cmp(It.n)>=0||s.cmp(It.n)>=0)return 1;if(s.cmp(Fa.nh)===1||n.isZero()||s.isZero())return 3;let o=il(t);if(o===null)return 2;let a=o.getPublic();return Fa.verify(e,i,a)?0:3},ecdsaRecover(r,e,t,i){let n={r:e.slice(0,32),s:e.slice(32,64)},s=new er(n.r),o=new er(n.s);if(s.cmp(It.n)>=0||o.cmp(It.n)>=0)return 1;if(s.isZero()||o.isZero())return 2;let a;try{a=Fa.recoverPubKey(i,n,t)}catch(c){return 2}return qf(r,a),0},ecdh(r,e,t,i,n,s,o){let a=il(e);if(a===null)return 1;let c=new er(t);if(c.cmp(It.n)>=0||c.isZero())return 2;let u=a.getPublic().mul(c);if(n===void 0){let l=u.encode(null,!0),d=Fa.hash().update(l).digest();for(let h=0;h<32;++h)r[h]=d[h]}else{s||(s=new Uint8Array(32));let l=u.getX().toArray("be",32);for(let g=0;g<32;++g)s[g]=l[g];o||(o=new Uint8Array(32));let d=u.getY().toArray("be",32);for(let g=0;g<32;++g)o[g]=d[g];let h=n(s,o,i);if(!(h instanceof Uint8Array&&h.length===r.length))return 2;r.set(h)}return 0}}});var a9=y((k4t,o9)=>{f();o9.exports=C7()(s9())});var l9=y((q4t,u9)=>{f();"use strict";var Bo=a9(),{sha256:c9}=(ri(),li);u9.exports=r=>{let e=32;function t(){let l;do l=r(32);while(!Bo.privateKeyVerify(l));return l}async function i(l,d){let{digest:h}=await c9.digest(d),p=Bo.ecdsaSign(h,l);return Bo.signatureExport(p.signature)}async function n(l,d,h){let{digest:p}=await c9.digest(h);return d=Bo.signatureImport(d),Bo.ecdsaVerify(d,p,l)}function s(l){if(!Bo.publicKeyVerify(l))throw new Error("Invalid public key");return Bo.publicKeyConvert(l,!0)}function o(l){return Bo.publicKeyConvert(l,!1)}function a(l){if(!Bo.privateKeyVerify(l))throw new Error("Invalid private key")}function c(l){if(!Bo.publicKeyVerify(l))throw new Error("Invalid public key")}function u(l){return a(l),Bo.publicKeyCreate(l)}return{generateKey:t,privateKeyLength:e,hashAndSign:i,hashAndVerify:n,compressPublicKey:s,decompressPublicKey:o,validatePrivateKey:a,validatePublicKey:c,computePublicKey:u}}});var p9=y((N4t,h9)=>{f();"use strict";var{sha256:f9}=(ri(),li),Gke=ae(),{equals:d9}=(di(),fi),{toString:Wke}=(tt(),et),Yke=lw();h9.exports=(r,e,t)=>{t=t||l9()(e);class i{constructor(u){t.validatePublicKey(u),this._key=u}verify(u,l){return t.hashAndVerify(this._key,l,u)}marshal(){return t.compressPublicKey(this._key)}get bytes(){return r.PublicKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return d9(this.bytes,u.bytes)}async hash(){let{bytes:u}=await f9.digest(this.bytes);return u}}class n{constructor(u,l){this._key=u,this._publicKey=l||t.computePublicKey(u),t.validatePrivateKey(this._key),t.validatePublicKey(this._publicKey)}sign(u){return t.hashAndSign(this._key,u)}get public(){return new i(this._publicKey)}marshal(){return this._key}get bytes(){return r.PrivateKey.encode({Type:r.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(u){return d9(this.bytes,u.bytes)}async hash(){let{bytes:u}=await f9.digest(this.bytes);return u}async id(){let u=await this.public.hash();return Wke(u,"base58btc")}async export(u,l="libp2p-key"){if(l==="libp2p-key")return Yke.export(this.bytes,u);throw Gke(new Error(`export format '${l}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function s(c){return new n(c)}function o(c){return new i(c)}async function a(){let c=await t.generateKey();return new n(c)}return{Secp256k1PublicKey:i,Secp256k1PrivateKey:n,unmarshalSecp256k1PrivateKey:s,unmarshalSecp256k1PublicKey:o,generateKeyPair:a}}});var g9=y((D4t,y9)=>{f();"use strict";y9.exports={SHA1:20,SHA256:32,SHA512:64}});var nI=y(b9=>{f();"use strict";var m9=_g(),Xke=g9(),Qke={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Zke=async(r,e)=>{let t=await m9.get().subtle.sign({name:"HMAC"},r,e);return new Uint8Array(t,t.byteOffset,t.byteLength)};b9.create=async function(r,e){let t=Qke[r],i=await m9.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:t}},!1,["sign"]);return{async digest(n){return Zke(i,n)},length:Xke[r]}}});var S9=y((M4t,E9)=>{f();"use strict";var v9=ae(),{concat:w9}=(cn(),an),{fromString:Jke}=(ft(),ht),eqe=nI(),_9={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};E9.exports=async(r,e,t)=>{let i=_9[r];if(!i){let A=Object.keys(_9).join(" / ");throw v9(new Error(`unknown cipher type '${r}'. Must be ${A}`),"ERR_INVALID_CIPHER_TYPE")}if(!e)throw v9(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let n=i.keySize,s=i.ivSize,o=20,a=Jke("key expansion"),c=2*(s+n+o),u=await eqe.create(e,t),l=await u.digest(a),d=[],h=0;for(;h<c;){let A=await u.digest(w9([l,a])),R=A.length;h+R>c&&(R=c-h),d.push(A),h+=R,l=await u.digest(l)}let p=c/2,g=w9(d),b=g.slice(0,p),E=g.slice(p,c),v=A=>({iv:A.slice(0,s),cipherKey:A.slice(s,s+n),macKey:A.slice(s+n)});return{k1:v(b),k2:v(E)}}});var A9=y((L4t,x9)=>{f();"use strict";var tqe=ae();x9.exports=function(r,e){if(!r.includes(e)){let t=r.join(" / ");throw tqe(new Error(`Unknown curve: ${e}. Must be ${t}`),"ERR_INVALID_CURVE")}}});var O9=y(P9=>{f();"use strict";var rqe=ae(),qg=_g(),{base64urlToBuffer:I9}=uw(),iqe=A9(),{toString:sI}=(tt(),et),{concat:nqe}=(cn(),an),{equals:sqe}=(di(),fi),T9={"P-256":256,"P-384":384,"P-521":521};P9.generateEphmeralKeyPair=async function(r){iqe(Object.keys(T9),r);let e=await qg.get().subtle.generateKey({name:"ECDH",namedCurve:r},!0,["deriveBits"]),t=async(n,s)=>{let o;s?o=await qg.get().subtle.importKey("jwk",aqe(r,s),{name:"ECDH",namedCurve:r},!1,["deriveBits"]):o=e.privateKey;let a=[await qg.get().subtle.importKey("jwk",C9(r,n),{name:"ECDH",namedCurve:r},!1,[]),o],c=await qg.get().subtle.deriveBits({name:"ECDH",namedCurve:r,public:a[0]},a[1],T9[r]);return new Uint8Array(c,c.byteOffset,c.byteLength)},i=await qg.get().subtle.exportKey("jwk",e.publicKey);return{key:oqe(i),genSharedKey:t}};var R9={"P-256":32,"P-384":48,"P-521":66};function oqe(r){let e=R9[r.crv];return nqe([Uint8Array.from([4]),I9(r.x,e),I9(r.y,e)],1+e*2)}function C9(r,e){let t=R9[r];if(sqe(!e.slice(0,1),Uint8Array.from([4])))throw rqe(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:r,x:sI(e.slice(1,t+1),"base64url"),y:sI(e.slice(1+t),"base64url"),ext:!0}}var aqe=(r,e)=>({...C9(r,e.public),d:sI(e.private,"base64url")})});var q9=y((F4t,k9)=>{f();"use strict";var cqe=O9();k9.exports=async r=>cqe.generateEphmeralKeyPair(r)});var qw=y((K4t,D9)=>{f();"use strict";var Ka=Mv();Nc();aA();var oI=dt(),Ng=ae(),{fromString:uqe}=(ft(),ht),lqe=MM(),zs={rsa:_7(),ed25519:T7(),secp256k1:p9()(Ka,xg())},kw={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function $h(r){let e=zs[r.toLowerCase()];if(!e){let t=Object.keys(zs).join(" / ");throw Ng(new Error(`invalid or unsupported key type ${r}. Must be ${t}`),"ERR_UNSUPPORTED_KEY_TYPE")}return e}var fqe=async(r,e)=>$h(r).generateKeyPair(e),dqe=async(r,e,t)=>{let i=$h(r);if(r.toLowerCase()!=="ed25519")throw Ng(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return i.generateKeyPairFromSeed(e,t)},hqe=r=>{let e=Ka.PublicKey.decode(r),t=e.Data;switch(e.Type){case Ka.KeyType.RSA:return zs.rsa.unmarshalRsaPublicKey(t);case Ka.KeyType.Ed25519:return zs.ed25519.unmarshalEd25519PublicKey(t);case Ka.KeyType.Secp256k1:if(zs.secp256k1)return zs.secp256k1.unmarshalSecp256k1PublicKey(t);throw Ng(new Error(kw.message),kw.code);default:$h(e.Type)}},pqe=(r,e)=>(e=(e||"rsa").toLowerCase(),$h(e),r.bytes),N9=async r=>{let e=Ka.PrivateKey.decode(r),t=e.Data;switch(e.Type){case Ka.KeyType.RSA:return zs.rsa.unmarshalRsaPrivateKey(t);case Ka.KeyType.Ed25519:return zs.ed25519.unmarshalEd25519PrivateKey(t);case Ka.KeyType.Secp256k1:if(zs.secp256k1)return zs.secp256k1.unmarshalSecp256k1PrivateKey(t);throw Ng(new Error(kw.message),kw.code);default:$h(e.Type)}},yqe=(r,e)=>(e=(e||"rsa").toLowerCase(),$h(e),r.bytes),gqe=async(r,e)=>{try{let n=await lqe.import(r,e);return N9(n)}catch(n){}let t=oI.pki.decryptRsaPrivateKey(r,e);if(t===null)throw Ng(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let i=oI.asn1.toDer(oI.pki.privateKeyToAsn1(t));return i=uqe(i.getBytes(),"ascii"),zs.rsa.unmarshalRsaPrivateKey(i)};D9.exports={supportedKeys:zs,keysPBM:Ka,keyStretcher:S9(),generateEphemeralKeyPair:q9(),generateKeyPair:fqe,generateKeyPairFromSeed:dqe,unmarshalPublicKey:hqe,marshalPublicKey:pqe,unmarshalPrivateKey:N9,marshalPrivateKey:yqe,import:gqe}});var Nw=y((j4t,aI)=>{f();"use strict";function mqe(r,{className:e,symbolName:t}){let i=Symbol.for(t),n={[e]:class extends r{constructor(...s){super(...s);Object.defineProperty(this,i,{value:!0})}get[Symbol.toStringTag](){return e}}}[e];return n[`is${e}`]=s=>!!(s&&s[i]),n}function bqe(r,{className:e,symbolName:t,withoutNew:i}){let n=Symbol.for(t),s={[e]:function(...o){if(i&&!(this instanceof s))return new s(...o);let a=r.call(this,...o)||this;return a&&!a[n]&&Object.defineProperty(a,n,{value:!0}),a}}[e];return s.prototype=Object.create(r.prototype),s.prototype.constructor=s,Object.defineProperty(s.prototype,Symbol.toStringTag,{get(){return e}}),s[`is${e}`]=o=>!!(o&&o[n]),s}aI.exports=mqe;aI.exports.proto=bqe});var L9=y((V4t,M9)=>{f();"use strict";var Gh=ki(),B9=Gh.Reader,vqe=Gh.Writer,vi=Gh.util,Dg=Gh.roots["libp2p-peer-id"]||(Gh.roots["libp2p-peer-id"]={});Dg.PeerIdProto=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.id=vi.newBuffer([]),r.prototype.pubKey=vi.newBuffer([]),r.prototype.privKey=vi.newBuffer([]),r.encode=function(t,i){return i||(i=vqe.create()),i.uint32(10).bytes(t.id),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(18).bytes(t.pubKey),t.privKey!=null&&Object.hasOwnProperty.call(t,"privKey")&&i.uint32(26).bytes(t.privKey),i},r.decode=function(t,i){t instanceof B9||(t=B9.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Dg.PeerIdProto;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.id=t.bytes();break;case 2:s.pubKey=t.bytes();break;case 3:s.privKey=t.bytes();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("id"))throw vi.ProtocolError("missing required 'id'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Dg.PeerIdProto)return t;var i=new Dg.PeerIdProto;return t.id!=null&&(typeof t.id=="string"?vi.base64.decode(t.id,i.id=vi.newBuffer(vi.base64.length(t.id)),0):t.id.length&&(i.id=t.id)),t.pubKey!=null&&(typeof t.pubKey=="string"?vi.base64.decode(t.pubKey,i.pubKey=vi.newBuffer(vi.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.privKey!=null&&(typeof t.privKey=="string"?vi.base64.decode(t.privKey,i.privKey=vi.newBuffer(vi.base64.length(t.privKey)),0):t.privKey.length&&(i.privKey=t.privKey)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.id="":(n.id=[],i.bytes!==Array&&(n.id=vi.newBuffer(n.id))),i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=vi.newBuffer(n.pubKey))),i.bytes===String?n.privKey="":(n.privKey=[],i.bytes!==Array&&(n.privKey=vi.newBuffer(n.privKey)))),t.id!=null&&t.hasOwnProperty("id")&&(n.id=i.bytes===String?vi.base64.encode(t.id,0,t.id.length):i.bytes===Array?Array.prototype.slice.call(t.id):t.id),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?vi.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.privKey!=null&&t.hasOwnProperty("privKey")&&(n.privKey=i.bytes===String?vi.base64.encode(t.privKey,0,t.privKey.length):i.bytes===Array?Array.prototype.slice.call(t.privKey):t.privKey),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Gh.util.toJSONOptions)},r}();M9.exports=Dg});var rt=y((fn,$9)=>{f();"use strict";var{CID:cI}=(Ie(),De),wqe=(sn(),nn),_qe=(x6(),Pv),Eqe=(ei(),Jr),Sqe=(ug(),bh),{base58btc:uI}=(ei(),Jr),{base32:xqe}=(sn(),nn),{base16:U9}=(A6(),Ov),Bg=(Cn(),Wn),ja=qw(),Aqe=Nw(),{PeerIdProto:F9}=L9(),{equals:Nf}=(di(),fi),{fromString:Mg}=(ft(),ht),{toString:Iqe}=(tt(),et),{identity:Dw}=(Fc(),Uc),K9={...wqe,..._qe,...Eqe,...Sqe},Tqe=Object.keys(K9).reduce((r,e)=>r.or(K9[e]),xqe.decoder),Rqe=112,j9=114,V9=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("invalid id provided");if(t&&i&&!Nf(t.public.bytes,i.bytes))throw new Error("inconsistent arguments");this._id=e,this._idB58String=uI.encode(this.id).substring(1),this._privKey=t,this._pubKey=i}get id(){return this._id}set id(e){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey(e){this._privKey=e}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{let e=Bg.decode(this.id);e.code===Dw.code&&(this._pubKey=ja.unmarshalPublicKey(e.digest))}catch(e){}return this._pubKey}set pubKey(e){this._pubKey=e}marshalPubKey(){if(this.pubKey)return ja.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return ja.marshalPrivateKey(this.privKey)}marshal(e){return F9.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:e?null:this.marshalPrivKey()}).finish()}toPrint(){let e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));let t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}toJSON(){return{id:this.toB58String(),privKey:H9(this.marshalPrivKey()),pubKey:H9(this.marshalPubKey())}}toHexString(){return U9.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){let e=cI.createV1(j9,Bg.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:e.toString(),enumerable:!1})}return this._idCIDString}equals(e){if(e instanceof Uint8Array)return Nf(this.id,e);if(e.id)return Nf(this.id,e.id);throw new Error("not valid Id")}isEqual(e){return this.equals(e)}isValid(){return Boolean(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&Nf(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(Bg.decode(this.id).code===Dw.code)return!0}catch(e){}return!1}},Va=Aqe(V9,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});fn=$9.exports=Va;var Lg=r=>r.bytes.length<=42?Bg.create(Dw.code,r.bytes).bytes:r.hash(),lI=async(r,e)=>{let t=await Lg(e);return new Va(t,r,e)};fn.create=async r=>{r=r||{},r.bits=r.bits||2048,r.keyType=r.keyType||"RSA";let e=await ja.generateKeyPair(r.keyType,r.bits);return lI(e,e.public)};fn.createFromHexString=r=>new Va(U9.decode("f"+r));fn.createFromBytes=r=>{try{let e=cI.decode(r);if(!z9(e))throw new Error("Supplied PeerID CID is invalid");return fn.createFromCID(e)}catch{if(Bg.decode(r).code!==Dw.code)throw new Error("Supplied PeerID CID is invalid");return new Va(r)}};fn.createFromB58String=r=>fn.createFromBytes(uI.decode("z"+r));var z9=r=>r.code===j9||r.code===Rqe;fn.createFromCID=r=>{if(r=cI.asCID(r),!r||!z9(r))throw new Error("Supplied PeerID CID is invalid");return new Va(r.multihash.bytes)};fn.createFromPubKey=async r=>{let e=r;if(typeof e=="string"&&(e=Mg(r,"base64pad")),!(e instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let t=await ja.unmarshalPublicKey(e);return lI(void 0,t)};fn.createFromPrivKey=async r=>{if(typeof r=="string"&&(r=Mg(r,"base64pad")),!(r instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");let e=await ja.unmarshalPrivateKey(r);return lI(e,e.public)};fn.createFromJSON=async r=>{let e=uI.decode("z"+r.id),t=r.privKey&&Mg(r.privKey,"base64pad"),i=r.pubKey&&Mg(r.pubKey,"base64pad"),n=i&&await ja.unmarshalPublicKey(i);if(!t)return new Va(e,void 0,n);let s=await ja.unmarshalPrivateKey(t),o=await Lg(s.public),a;if(n&&(a=await Lg(n)),n&&!Nf(o,a))throw new Error("Public and private key do not match");if(e&&!Nf(o,e))throw new Error("Id and private key do not match");return new Va(e,s,n)};fn.createFromProtobuf=async r=>{typeof r=="string"&&(r=Mg(r,"base16"));let{id:e,privKey:t,pubKey:i}=F9.decode(r);t=t?await ja.unmarshalPrivateKey(t):!1,i=i?await ja.unmarshalPublicKey(i):!1;let n,s;if(t&&(s=await Lg(t.public)),i&&(n=await Lg(i)),t){if(i&&!Nf(s,n))throw new Error("Public and private key do not match");return new Va(s,t,t.public)}if(i)return new Va(n,void 0,i);if(e)return new Va(e);throw new Error("Protobuf did not contain any usable key material")};fn.parse=r=>((r.charAt(0)==="1"||r.charAt(0)==="Q")&&(r=`z${r}`),fn.createFromBytes(Tqe.decode(r)));fn.isPeerId=r=>Boolean(typeof r=="object"&&r._id&&r._idB58String);function H9(r){if(r)return Iqe(r,"base64pad")}});var Y9=y((z4t,W9)=>{f();"use strict";Sh();var Bw=dt(),{toString:Wh}=(tt(),et),{fromString:G9}=(ft(),ht);W9.exports={createCipheriv:(r,e,t)=>{let i=Bw.cipher.createCipher("AES-CTR",Wh(e,"ascii"));return i.start({iv:Wh(t,"ascii")}),{update:n=>(i.update(Bw.util.createBuffer(Wh(n,"ascii"))),G9(i.output.getBytes(),"ascii"))}},createDecipheriv:(r,e,t)=>{let i=Bw.cipher.createDecipher("AES-CTR",Wh(e,"ascii"));return i.start({iv:Wh(t,"ascii")}),{update:n=>(i.update(Bw.util.createBuffer(Wh(n,"ascii"))),G9(i.output.getBytes(),"ascii"))}}}});var Z9=y((H4t,Q9)=>{f();"use strict";var Cqe=ae(),X9={16:"aes-128-ctr",32:"aes-256-ctr"};Q9.exports=function(r){let e=X9[r.length];if(!e){let t=Object.entries(X9).map(([i,n])=>`${i} (${n})`).join(" / ");throw Cqe(new Error(`Invalid key length ${r.length} bytes. Must be ${t}`),"ERR_INVALID_KEY_LENGTH")}return e}});var tU=y(eU=>{f();"use strict";var J9=Y9(),Pqe=Z9();eU.create=async function(r,e){let t=Pqe(r),i=J9.createCipheriv(t,r,e),n=J9.createDecipheriv(t,r,e);return{async encrypt(o){return i.update(o)},async decrypt(o){return n.update(o)}}}});var nU=y((G4t,iU)=>{f();"use strict";var Oqe=Q6(),kqe=Qt(),qqe=ae(),rU={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Nqe(r,e,t,i,n){let s=rU[n];if(!s){let a=Object.keys(rU).join(" / ");throw qqe(new Error(`Hash '${n}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=Oqe(r,e,t,i,s);return kqe.encode64(o)}iU.exports=Nqe});var za=y(Yh=>{f();"use strict";var Dqe=nI(),Bqe=tU(),Mqe=qw();Yh.aes=Bqe;Yh.hmac=Dqe;Yh.keys=Mqe;Yh.randomBytes=xg();Yh.pbkdf2=nU()});var dI=y((Y4t,oU)=>{f();"use strict";var sU="[a-fA-F\\d:]",nl=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${sU})|(?<=${sU})(?=\\s|$))`:"",Mo="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",hi="[a-fA-F\\d]{1,4}",Mw=`
(?:
(?:${hi}:){7}(?:${hi}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${hi}:){6}(?:${Mo}|:${hi}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${hi}:){5}(?::${Mo}|(?::${hi}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${hi}:){4}(?:(?::${hi}){0,1}:${Mo}|(?::${hi}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${hi}:){3}(?:(?::${hi}){0,2}:${Mo}|(?::${hi}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${hi}:){2}(?:(?::${hi}){0,3}:${Mo}|(?::${hi}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${hi}:){1}(?:(?::${hi}){0,4}:${Mo}|(?::${hi}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${hi}){0,5}:${Mo}|(?::${hi}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Lqe=new RegExp(`(?:^${Mo}$)|(?:^${Mw}$)`),Uqe=new RegExp(`^${Mo}$`),Fqe=new RegExp(`^${Mw}$`),fI=r=>r&&r.exact?Lqe:new RegExp(`(?:${nl(r)}${Mo}${nl(r)})|(?:${nl(r)}${Mw}${nl(r)})`,"g");fI.v4=r=>r&&r.exact?Uqe:new RegExp(`${nl(r)}${Mo}${nl(r)}`,"g");fI.v6=r=>r&&r.exact?Fqe:new RegExp(`${nl(r)}${Mw}${nl(r)}`,"g");oU.exports=fI});var cU=y((X4t,aU)=>{f();"use strict";var hI=dI(),Xh=r=>hI({exact:!0}).test(r);Xh.v4=r=>hI.v4({exact:!0}).test(r);Xh.v6=r=>hI.v6({exact:!0}).test(r);Xh.version=r=>Xh(r)?Xh.v4(r)?4:6:void 0;aU.exports=Xh});var hU=y((Q4t,dU)=>{f();"use strict";var pI=cU(),{toString:uU}=(tt(),et),Kqe=pI,yI=pI.v4,lU=pI.v6,fU=function(r,e,t){t=~~t;let i;if(yI(r))i=e||new Uint8Array(t+4),r.split(/\./g).map(function(n){i[t++]=parseInt(n,10)&255});else if(lU(r)){let n=r.split(":",8),s;for(s=0;s<n.length;s++){let o=yI(n[s]),a;o&&(a=fU(n[s]),n[s]=uU(a.slice(0,2),"base16")),a&&++s<8&&n.splice(s,0,uU(a.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(s=0;s<n.length&&n[s]!=="";s++);let o=[s,"1"];for(s=9-n.length;s>0;s--)o.push("0");n.splice.apply(n,o)}for(i=e||new Uint8Array(t+16),s=0;s<n.length;s++){let o=parseInt(n[s],16);i[t++]=o>>8&255,i[t++]=o&255}}if(!i)throw Error("Invalid ip address: "+r);return i},jqe=function(r,e,t){e=~~e,t=t||r.length-e;let i=[],n,s=new DataView(r.buffer);if(t===4){for(let o=0;o<t;o++)i.push(r[e+o]);n=i.join(".")}else if(t===16){for(let o=0;o<t;o+=2)i.push(s.getUint16(e+o).toString(16));n=i.join(":"),n=n.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),n=n.replace(/:{3,4}/,"::")}return n};dU.exports={isIP:Kqe,isV4:yI,isV6:lU,toBytes:fU,toString:jqe}});var Ug=y((Z4t,yU)=>{f();"use strict";function es(r){if(typeof r=="number"){if(es.codes[r])return es.codes[r];throw new Error("no protocol with code: "+r)}else if(typeof r=="string"){if(es.names[r])return es.names[r];throw new Error("no protocol with name: "+r)}throw new Error("invalid protocol id type: "+r)}var Hs=-1;es.lengthPrefixedVarSize=Hs;es.V=Hs;es.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Hs,"ip6zone"],[53,Hs,"dns","resolvable"],[54,Hs,"dns4","resolvable"],[55,Hs,"dns6","resolvable"],[56,Hs,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Hs,"unix",!1,"path"],[421,Hs,"ipfs"],[421,Hs,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Hs,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Hs,"memory"]];es.names={};es.codes={};es.table.map(r=>{let e=pU.apply(null,r);return es.codes[e.code]=e,es.names[e.name]=e,null});es.object=pU;function pU(r,e,t,i,n){return{code:r,size:e,name:t,resolvable:Boolean(i),path:Boolean(n)}}yU.exports=es});var bU=y((J4t,mU)=>{f();mU.exports=gI;var gU=128,Vqe=127,zqe=~Vqe,Hqe=Math.pow(2,31);function gI(r,e,t){if(Number.MAX_SAFE_INTEGER&&r>Number.MAX_SAFE_INTEGER)throw gI.bytes=0,new RangeError("Could not encode varint");e=e||[],t=t||0;for(var i=t;r>=Hqe;)e[t++]=r&255|gU,r/=128;for(;r&zqe;)e[t++]=r&255|gU,r>>>=7;return e[t]=r|0,gI.bytes=t-i+1,e}});var _U=y((eTt,wU)=>{f();wU.exports=mI;var $qe=128,vU=127;function mI(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o||i>49)throw mI.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&vU)<<i:(s&vU)*Math.pow(2,i),i+=7}while(s>=$qe);return mI.bytes=n-e,t}});var SU=y((tTt,EU)=>{f();var Gqe=Math.pow(2,7),Wqe=Math.pow(2,14),Yqe=Math.pow(2,21),Xqe=Math.pow(2,28),Qqe=Math.pow(2,35),Zqe=Math.pow(2,42),Jqe=Math.pow(2,49),eNe=Math.pow(2,56),tNe=Math.pow(2,63);EU.exports=function(r){return r<Gqe?1:r<Wqe?2:r<Yqe?3:r<Xqe?4:r<Qqe?5:r<Zqe?6:r<Jqe?7:r<eNe?8:r<tNe?9:10}});var ys=y((rTt,xU)=>{f();xU.exports={encode:bU(),decode:_U(),encodingLength:SU()}});var kU=y((iTt,OU)=>{f();"use strict";var Lw=hU(),AU=Ug(),{CID:rNe}=(Ie(),De),{base32:IU}=(sn(),nn),{base58btc:iNe}=(ei(),Jr),nNe=(Cn(),Wn),Qh=ys(),{toString:Uw}=(tt(),et),{fromString:TU}=(ft(),ht),{concat:Fw}=(cn(),an);OU.exports=Fg;function Fg(r,e){return e instanceof Uint8Array?Fg.toString(r,e):Fg.toBytes(r,e)}Fg.toString=function(e,t){switch(AU(e).code){case 4:case 41:return sNe(t);case 6:case 273:case 33:case 132:return CU(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return aNe(t);case 421:return uNe(t);case 444:return PU(t);case 445:return PU(t);default:return Uw(t,"base16")}};Fg.toBytes=function(e,t){switch(AU(e).code){case 4:return RU(t);case 41:return RU(t);case 6:case 273:case 33:case 132:return bI(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return oNe(t);case 421:return cNe(t);case 444:return lNe(t);case 445:return fNe(t);default:return TU(t,"base16")}};function RU(r){if(!Lw.isIP(r))throw new Error("invalid ip address");return Lw.toBytes(r)}function sNe(r){let e=Lw.toString(r);if(!e||!Lw.isIP(e))throw new Error("invalid ip address");return e}function bI(r){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,r),new Uint8Array(e)}function CU(r){return new DataView(r.buffer).getUint16(r.byteOffset)}function oNe(r){let e=TU(r),t=Uint8Array.from(Qh.encode(e.length));return Fw([t,e],t.length+e.length)}function aNe(r){let e=Qh.decode(r);if(r=r.slice(Qh.decode.bytes),r.length!==e)throw new Error("inconsistent lengths");return Uw(r)}function cNe(r){let e;r[0]==="Q"||r[0]==="1"?e=nNe.decode(iNe.decode(`z${r}`)).bytes:e=rNe.parse(r).multihash.bytes;let t=Uint8Array.from(Qh.encode(e.length));return Fw([t,e],t.length+e.length)}function uNe(r){let e=Qh.decode(r),t=r.slice(Qh.decode.bytes);if(t.length!==e)throw new Error("inconsistent lengths");return Uw(t,"base58btc")}function lNe(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let t=IU.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=bI(i);return Fw([t,n],t.length+n.length)}function fNe(r){let e=r.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let t=IU.decode("b"+e[0]),i=parseInt(e[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");let n=bI(i);return Fw([t,n],t.length+n.length)}function PU(r){let e=r.slice(0,r.length-2),t=r.slice(r.length-2),i=Uw(e,"base32"),n=CU(t);return i+":"+n}});var zU=y((nTt,VU)=>{f();"use strict";var qU=kU(),vI=Ug(),Kg=ys(),{concat:NU}=(cn(),an),{toString:dNe}=(tt(),et);VU.exports={stringToStringTuples:DU,stringTuplesToString:BU,tuplesToStringTuples:LU,stringTuplesToTuples:MU,bytesToTuples:wI,tuplesToBytes:UU,bytesToString:hNe,stringToBytes:KU,fromString:pNe,fromBytes:jU,validateBytes:_I,isValidBytes:yNe,cleanPath:Kw,ParseError:EI,protoFromTuple:jg,sizeForAddr:FU};function DU(r){let e=[],t=r.split("/").slice(1);if(t.length===1&&t[0]==="")return[];for(let i=0;i<t.length;i++){let n=t[i],s=vI(n);if(s.size===0){e.push([n]);continue}if(i++,i>=t.length)throw EI("invalid address: "+r);if(s.path){e.push([n,Kw(t.slice(i).join("/"))]);break}e.push([n,t[i]])}return e}function BU(r){let e=[];return r.map(t=>{let i=jg(t);return e.push(i.name),t.length>1&&e.push(t[1]),null}),Kw(e.join("/"))}function MU(r){return r.map(e=>{Array.isArray(e)||(e=[e]);let t=jg(e);return e.length>1?[t.code,qU.toBytes(t.code,e[1])]:[t.code]})}function LU(r){return r.map(e=>{let t=jg(e);return e[1]?[t.code,qU.toString(t.code,e[1])]:[t.code]})}function UU(r){return jU(NU(r.map(e=>{let t=jg(e),i=Uint8Array.from(Kg.encode(t.code));return e.length>1&&(i=NU([i,e[1]])),i})))}function FU(r,e){return r.size>0?r.size/8:r.size===0?0:Kg.decode(e)+Kg.decode.bytes}function wI(r){let e=[],t=0;for(;t<r.length;){let i=Kg.decode(r,t),n=Kg.decode.bytes,s=vI(i),o=FU(s,r.slice(t+n));if(o===0){e.push([i]),t+=n;continue}let a=r.slice(t+n,t+n+o);if(t+=o+n,t>r.length)throw EI("Invalid address Uint8Array: "+dNe(r,"base16"));e.push([i,a])}return e}function hNe(r){let e=wI(r),t=LU(e);return BU(t)}function KU(r){r=Kw(r);let e=DU(r),t=MU(e);return UU(t)}function pNe(r){return KU(r)}function jU(r){let e=_I(r);if(e)throw e;return Uint8Array.from(r)}function _I(r){try{wI(r)}catch(e){return e}}function yNe(r){return _I(r)===void 0}function Kw(r){return"/"+r.trim().split("/").filter(e=>e).join("/")}function EI(r){return new Error("Error parsing address: "+r)}function jg(r){return vI(r[0])}});var it=y((sTt,GU)=>{f();"use strict";var Lo=zU(),Zh=Ug(),HU=ys(),{CID:gNe}=(Ie(),De),{base58btc:mNe}=(ei(),Jr),bNe=ae(),vNe=Symbol.for("nodejs.util.inspect.custom"),{toString:jw}=(tt(),et),{equals:wNe}=(di(),fi),SI=new Map,$U=Symbol.for("@multiformats/js-multiaddr/multiaddr"),kn=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,$U,{value:!0}),e instanceof Uint8Array)this.bytes=Lo.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Lo.fromString(e)}else if(kn.isMultiaddr(e))this.bytes=Lo.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Lo.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},t=this.toString().split("/");return e.family=t[1]==="ip4"?4:6,e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},Zh(e)))}protoCodes(){let e=[],t=this.bytes,i=0;for(;i<t.length;){let n=HU.decode(t,i),s=HU.decode.bytes,o=Zh(n);i+=Lo.sizeForAddr(o,t.slice(i+s))+s,e.push(n)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Lo.bytesToTuples(this.bytes)}stringTuples(){let e=Lo.bytesToTuples(this.bytes);return Lo.tuplesToStringTuples(e)}encapsulate(e){return e=new kn(e),new kn(this.toString()+e.toString())}decapsulate(e){let t=e.toString(),i=this.toString(),n=i.lastIndexOf(t);if(n<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new kn(i.slice(0,n))}decapsulateCode(e){let t=this.tuples();for(let i=t.length-1;i>=0;i--)if(t[i][0]===e)return new kn(Lo.tuplesToBytes(t.slice(0,i)));return this}getPeerId(){try{let t=this.stringTuples().filter(i=>i[0]===Zh.names.ipfs.code).pop();if(t&&t[1]){let i=t[1];return i[0]==="Q"||i[0]==="1"?jw(mNe.decode(`z${i}`),"base58btc"):jw(gNe.parse(i).multihash.bytes,"base58btc")}return null}catch(e){return null}}getPath(){let e=null;try{e=this.stringTuples().filter(t=>!!Zh(t[0]).path)[0][1],e||(e=null)}catch(t){e=null}return e}equals(e){return wNe(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(n=>n.resolvable);if(!e)return[this];let t=SI.get(e.name);if(!t)throw bNe(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await t(this)).map(n=>new kn(n))}nodeAddress(){let e=this.protoCodes(),t=this.protoNames(),i=this.toString().split("/").slice(1);if(i.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${t[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(i[2]!=="tcp"&&i[2]!=="udp")throw new Error(`no protocol with name: "'${t[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:i[1],port:parseInt(i[3])}}isThinWaistAddress(e){let t=(e||this).protos();return!(t.length!==2||t[0].code!==4&&t[0].code!==41||t[1].code!==6&&t[1].code!==273)}static fromNodeAddress(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");let i;switch(e.family){case 4:i="ip4";break;case 6:i="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new kn("/"+[i,e.address,t,e.port].join("/"))}static isName(e){return kn.isMultiaddr(e)?e.protos().some(t=>t.resolvable):!1}static isMultiaddr(e){return e instanceof kn||Boolean(e&&e[$U])}[vNe](){return"<Multiaddr "+jw(this.bytes,"base16")+" - "+Lo.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+jw(this.bytes,"base16")+" - "+Lo.bytesToString(this.bytes)+">"}};kn.protocols=Zh;kn.resolvers=SI;function _Ne(r){return new kn(r)}GU.exports={Multiaddr:kn,multiaddr:_Ne,protocols:Zh,resolvers:SI}});var Bf=y((oTt,iF)=>{f();"use strict";var{Multiaddr:xI}=it(),WU=Qe("dns4"),YU=Qe("dns6"),XU=Qe("dnsaddr"),Df=dn(Qe("dns"),XU,WU,YU),Vg=dn(Qe("ip4"),Qe("ip6")),Jh=dn(pt(Vg,Qe("tcp")),pt(Df,Qe("tcp"))),AI=pt(Vg,Qe("udp")),QU=pt(AI,Qe("utp")),ZU=pt(AI,Qe("quic")),ep=dn(pt(Jh,Qe("ws")),pt(Df,Qe("ws"))),tp=dn(pt(Jh,Qe("wss")),pt(Df,Qe("wss"))),Vw=dn(pt(Jh,Qe("http")),pt(Vg,Qe("http")),pt(Df,Qe("http"))),zw=dn(pt(Jh,Qe("https")),pt(Vg,Qe("https")),pt(Df,Qe("https"))),II=dn(pt(ep,Qe("p2p-webrtc-star"),Qe("p2p")),pt(tp,Qe("p2p-webrtc-star"),Qe("p2p")),pt(ep,Qe("p2p-webrtc-star")),pt(tp,Qe("p2p-webrtc-star"))),ENe=dn(pt(ep,Qe("p2p-websocket-star"),Qe("p2p")),pt(tp,Qe("p2p-websocket-star"),Qe("p2p")),pt(ep,Qe("p2p-websocket-star")),pt(tp,Qe("p2p-websocket-star"))),TI=dn(pt(Vw,Qe("p2p-webrtc-direct"),Qe("p2p")),pt(zw,Qe("p2p-webrtc-direct"),Qe("p2p")),pt(Vw,Qe("p2p-webrtc-direct")),pt(zw,Qe("p2p-webrtc-direct"))),rp=dn(ep,tp,Vw,zw,II,TI,Jh,QU,ZU,Df),SNe=dn(pt(rp,Qe("p2p-stardust"),Qe("p2p")),pt(rp,Qe("p2p-stardust"))),sl=dn(pt(rp,Qe("p2p")),II,TI,Qe("p2p")),JU=dn(pt(sl,Qe("p2p-circuit"),sl),pt(sl,Qe("p2p-circuit")),pt(Qe("p2p-circuit"),sl),pt(rp,Qe("p2p-circuit")),pt(Qe("p2p-circuit"),rp),Qe("p2p-circuit")),eF=()=>dn(pt(JU,eF),JU),ip=eF(),tF=dn(pt(ip,sl,ip),pt(sl,ip),pt(ip,sl),ip,sl);iF.exports={DNS:Df,DNS4:WU,DNS6:YU,DNSADDR:XU,IP:Vg,TCP:Jh,UDP:AI,QUIC:ZU,UTP:QU,HTTP:Vw,HTTPS:zw,WebSockets:ep,WebSocketsSecure:tp,WebSocketStar:ENe,WebRTCStar:II,WebRTCDirect:TI,Reliable:rp,Stardust:SNe,Circuit:ip,P2P:tF,IPFS:tF};function rF(r){function e(t){if(!xI.isMultiaddr(t))try{t=new xI(t)}catch(n){return!1}let i=r(t.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function pt(...r){function e(t){if(t.length<r.length)return null;let i=t;return r.some(n=>(i=typeof n=="function"?n().partialMatch(t):n.partialMatch(t),Array.isArray(i)&&(t=i),i===null)),i}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:rF(e),partialMatch:e}}function dn(...r){function e(i){let n=null;return r.some(s=>{let o=typeof s=="function"?s().partialMatch(i):s.partialMatch(i);return o?(n=o,!0):!1}),n}return{toString:function(){return"{ "+r.join(" ")+" }"},input:r,matches:rF(e),partialMatch:e}}function Qe(r){let e=r;function t(n){let s;if(typeof n=="string"||n instanceof Uint8Array)try{s=new xI(n)}catch(a){return!1}else s=n;let o=s.protoNames();return o.length===1&&o[0]===e}function i(n){return n.length===0?null:n[0]===e?n.slice(1):null}return{toString:function(){return e},matches:t,partialMatch:i}}});var sp=y((aTt,gF)=>{f();"use strict";var{base58btc:xNe}=(ei(),Jr),{base32:ANe}=(sn(),nn),INe=(Cn(),Wn),{Multiaddr:nF}=it(),TNe=Bf(),{CID:RI}=(Ie(),De),{URL:RNe}=Ev(),{toString:CNe}=(tt(),et),CI=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,np=/^\/(ip[fn]s)\/([^/?#]+)/,sF=1,oF=2,zg=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,aF=1,cF=2,PNe=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function ONe(r){let e=PI(r);try{INe.decode(xNe.decode("z"+e))}catch{return!1}return!0}function kNe(r){try{ANe.decode(r)}catch{return!1}return!0}function Hg(r){try{return typeof r=="string"?Boolean(RI.parse(r)):r instanceof Uint8Array?Boolean(RI.decode(r)):Boolean(RI.asCID(r))}catch(e){return!1}}function uF(r){if(!r)return!1;if(nF.isMultiaddr(r))return!0;try{return new nF(r),!0}catch(e){return!1}}function qNe(r){return uF(r)&&TNe.P2P.matches(r)}function $g(r,e,t=sF,i=oF){let n=PI(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipfs")return!1;let o=s[i];return o&&e===zg&&(o=o.toLowerCase()),Hg(o)}function Hw(r,e,t=sF,i=oF){let n=PI(r);if(!n)return!1;let s=n.match(e);if(!s||s[t]!=="ipns")return!1;let o=s[i];if(o&&e===zg){if(o=o.toLowerCase(),Hg(o))return!0;try{!o.includes(".")&&o.includes("-")&&(o=o.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new RNe(`http://${o}`);return PNe.test(a)}catch(a){return!1}}return!0}function lF(r){return typeof r=="string"}function PI(r){return r instanceof Uint8Array?CNe(r,"base58btc"):lF(r)?r:!1}var OI=r=>$g(r,zg,cF,aF),kI=r=>Hw(r,zg,cF,aF),fF=r=>OI(r)||kI(r),dF=r=>$g(r,CI)||OI(r),hF=r=>Hw(r,CI)||kI(r),pF=r=>dF(r)||hF(r)||fF(r),yF=r=>$g(r,np)||Hw(r,np);gF.exports={multihash:ONe,multiaddr:uF,peerMultiaddr:qNe,cid:Hg,base32cid:r=>kNe(r)&&Hg(r),ipfsSubdomain:OI,ipnsSubdomain:kI,subdomain:fF,subdomainGatewayPattern:zg,ipfsUrl:dF,ipnsUrl:hF,url:pF,pathGatewayPattern:CI,ipfsPath:r=>$g(r,np),ipnsPath:r=>Hw(r,np),path:yF,pathPattern:np,urlOrPath:r=>pF(r)||yF(r),cidPath:r=>lF(r)&&!Hg(r)&&$g(`/ipfs/${r}`,np)}});var qI=y((cTt,mF)=>{f();var op=1e3,ap=op*60,cp=ap*60,Mf=cp*24,NNe=Mf*7,DNe=Mf*365.25;mF.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return BNe(r);if(t==="number"&&isFinite(r))return e.long?LNe(r):MNe(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function BNe(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(!!e){var t=parseFloat(e[1]),i=(e[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return t*DNe;case"weeks":case"week":case"w":return t*NNe;case"days":case"day":case"d":return t*Mf;case"hours":case"hour":case"hrs":case"hr":case"h":return t*cp;case"minutes":case"minute":case"mins":case"min":case"m":return t*ap;case"seconds":case"second":case"secs":case"sec":case"s":return t*op;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function MNe(r){var e=Math.abs(r);return e>=Mf?Math.round(r/Mf)+"d":e>=cp?Math.round(r/cp)+"h":e>=ap?Math.round(r/ap)+"m":e>=op?Math.round(r/op)+"s":r+"ms"}function LNe(r){var e=Math.abs(r);return e>=Mf?$w(r,e,Mf,"day"):e>=cp?$w(r,e,cp,"hour"):e>=ap?$w(r,e,ap,"minute"):e>=op?$w(r,e,op,"second"):r+" ms"}function $w(r,e,t,i){var n=e>=t*1.5;return Math.round(r/t)+" "+i+(n?"s":"")}});var vF=y((uTt,bF)=>{f();function UNe(r){t.debug=t,t.default=t,t.coerce=c,t.disable=s,t.enable=n,t.enabled=o,t.humanize=qI(),t.destroy=u,Object.keys(r).forEach(l=>{t[l]=r[l]}),t.names=[],t.skips=[],t.formatters={};function e(l){let d=0;for(let h=0;h<l.length;h++)d=(d<<5)-d+l.charCodeAt(h),d|=0;return t.colors[Math.abs(d)%t.colors.length]}t.selectColor=e;function t(l){let d,h=null,p,g;function b(...E){if(!b.enabled)return;let v=b,A=Number(new Date),R=A-(d||A);v.diff=R,v.prev=d,v.curr=A,d=A,E[0]=t.coerce(E[0]),typeof E[0]!="string"&&E.unshift("%O");let F=0;E[0]=E[0].replace(/%([a-zA-Z%])/g,(N,z)=>{if(N==="%%")return"%";F++;let G=t.formatters[z];if(typeof G=="function"){let Y=E[F];N=G.call(v,Y),E.splice(F,1),F--}return N}),t.formatArgs.call(v,E),(v.log||t.log).apply(v,E)}return b.namespace=l,b.useColors=t.useColors(),b.color=t.selectColor(l),b.extend=i,b.destroy=t.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==t.namespaces&&(p=t.namespaces,g=t.enabled(l)),g),set:E=>{h=E}}),typeof t.init=="function"&&t.init(b),b}function i(l,d){let h=t(this.namespace+(typeof d=="undefined"?":":d)+l);return h.log=this.log,h}function n(l){t.save(l),t.namespaces=l,t.names=[],t.skips=[];let d,h=(typeof l=="string"?l:"").split(/[\s,]+/),p=h.length;for(d=0;d<p;d++)!h[d]||(l=h[d].replace(/\*/g,".*?"),l[0]==="-"?t.skips.push(new RegExp("^"+l.substr(1)+"$")):t.names.push(new RegExp("^"+l+"$")))}function s(){let l=[...t.names.map(a),...t.skips.map(a).map(d=>"-"+d)].join(",");return t.enable(""),l}function o(l){if(l[l.length-1]==="*")return!0;let d,h;for(d=0,h=t.skips.length;d<h;d++)if(t.skips[d].test(l))return!1;for(d=0,h=t.names.length;d<h;d++)if(t.names[d].test(l))return!0;return!1}function a(l){return l.toString().substring(2,l.toString().length-2).replace(/\.\*\?$/,"*")}function c(l){return l instanceof Error?l.stack||l.message:l}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}bF.exports=UNe});var be=y((gs,Gw)=>{f();gs.formatArgs=KNe;gs.save=jNe;gs.load=VNe;gs.useColors=FNe;gs.storage=zNe();gs.destroy=(()=>{let r=!1;return()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();gs.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function FNe(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function KNe(r){if(r[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+r[0]+(this.useColors?"%c ":" ")+"+"+Gw.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;r.splice(1,0,e,"color: inherit");let t=0,i=0;r[0].replace(/%[a-zA-Z%]/g,n=>{n!=="%%"&&(t++,n==="%c"&&(i=t))}),r.splice(i,0,e)}gs.log=console.debug||console.log||(()=>{});function jNe(r){try{r?gs.storage.setItem("debug",r):gs.storage.removeItem("debug")}catch(e){}}function VNe(){let r;try{r=gs.storage.getItem("debug")}catch(e){}return!r&&typeof process!="undefined"&&"env"in process&&(r=process.env.DEBUG),r}function zNe(){try{return localStorage}catch(r){}}Gw.exports=vF()(gs);var{formatters:HNe}=Gw.exports;HNe.j=function(r){try{return JSON.stringify(r)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var Xc,up,NI,Ze,Xi,wF,lTt,fTt,_F=xe(()=>{f();Xc=Wt(ki()),up=Xc.default.Reader,NI=Xc.default.Writer,Ze=Xc.default.util,Xi=Xc.default.roots["ipfs-unixfs"]||(Xc.default.roots["ipfs-unixfs"]={}),wF=Xi.Data=(()=>{function r(e){if(this.blocksizes=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Type=0,r.prototype.Data=Ze.newBuffer([]),r.prototype.filesize=Ze.Long?Ze.Long.fromBits(0,0,!0):0,r.prototype.blocksizes=Ze.emptyArray,r.prototype.hashType=Ze.Long?Ze.Long.fromBits(0,0,!0):0,r.prototype.fanout=Ze.Long?Ze.Long.fromBits(0,0,!0):0,r.prototype.mode=0,r.prototype.mtime=null,r.encode=function(t,i){if(i||(i=NI.create()),i.uint32(8).int32(t.Type),t.Data!=null&&Object.hasOwnProperty.call(t,"Data")&&i.uint32(18).bytes(t.Data),t.filesize!=null&&Object.hasOwnProperty.call(t,"filesize")&&i.uint32(24).uint64(t.filesize),t.blocksizes!=null&&t.blocksizes.length)for(var n=0;n<t.blocksizes.length;++n)i.uint32(32).uint64(t.blocksizes[n]);return t.hashType!=null&&Object.hasOwnProperty.call(t,"hashType")&&i.uint32(40).uint64(t.hashType),t.fanout!=null&&Object.hasOwnProperty.call(t,"fanout")&&i.uint32(48).uint64(t.fanout),t.mode!=null&&Object.hasOwnProperty.call(t,"mode")&&i.uint32(56).uint32(t.mode),t.mtime!=null&&Object.hasOwnProperty.call(t,"mtime")&&Xi.UnixTime.encode(t.mtime,i.uint32(66).fork()).ldelim(),i},r.decode=function(t,i){t instanceof up||(t=up.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Xi.Data;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Type=t.int32();break;case 2:s.Data=t.bytes();break;case 3:s.filesize=t.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(o&7)==2)for(var a=t.uint32()+t.pos;t.pos<a;)s.blocksizes.push(t.uint64());else s.blocksizes.push(t.uint64());break;case 5:s.hashType=t.uint64();break;case 6:s.fanout=t.uint64();break;case 7:s.mode=t.uint32();break;case 8:s.mtime=Xi.UnixTime.decode(t,t.uint32());break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Type"))throw Ze.ProtocolError("missing required 'Type'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Xi.Data)return t;var i=new Xi.Data;switch(t.Type){case"Raw":case 0:i.Type=0;break;case"Directory":case 1:i.Type=1;break;case"File":case 2:i.Type=2;break;case"Metadata":case 3:i.Type=3;break;case"Symlink":case 4:i.Type=4;break;case"HAMTShard":case 5:i.Type=5;break}if(t.Data!=null&&(typeof t.Data=="string"?Ze.base64.decode(t.Data,i.Data=Ze.newBuffer(Ze.base64.length(t.Data)),0):t.Data.length&&(i.Data=t.Data)),t.filesize!=null&&(Ze.Long?(i.filesize=Ze.Long.fromValue(t.filesize)).unsigned=!0:typeof t.filesize=="string"?i.filesize=parseInt(t.filesize,10):typeof t.filesize=="number"?i.filesize=t.filesize:typeof t.filesize=="object"&&(i.filesize=new Ze.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0))),t.blocksizes){if(!Array.isArray(t.blocksizes))throw TypeError(".Data.blocksizes: array expected");i.blocksizes=[];for(var n=0;n<t.blocksizes.length;++n)Ze.Long?(i.blocksizes[n]=Ze.Long.fromValue(t.blocksizes[n])).unsigned=!0:typeof t.blocksizes[n]=="string"?i.blocksizes[n]=parseInt(t.blocksizes[n],10):typeof t.blocksizes[n]=="number"?i.blocksizes[n]=t.blocksizes[n]:typeof t.blocksizes[n]=="object"&&(i.blocksizes[n]=new Ze.LongBits(t.blocksizes[n].low>>>0,t.blocksizes[n].high>>>0).toNumber(!0))}if(t.hashType!=null&&(Ze.Long?(i.hashType=Ze.Long.fromValue(t.hashType)).unsigned=!0:typeof t.hashType=="string"?i.hashType=parseInt(t.hashType,10):typeof t.hashType=="number"?i.hashType=t.hashType:typeof t.hashType=="object"&&(i.hashType=new Ze.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0))),t.fanout!=null&&(Ze.Long?(i.fanout=Ze.Long.fromValue(t.fanout)).unsigned=!0:typeof t.fanout=="string"?i.fanout=parseInt(t.fanout,10):typeof t.fanout=="number"?i.fanout=t.fanout:typeof t.fanout=="object"&&(i.fanout=new Ze.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0))),t.mode!=null&&(i.mode=t.mode>>>0),t.mtime!=null){if(typeof t.mtime!="object")throw TypeError(".Data.mtime: object expected");i.mtime=Xi.UnixTime.fromObject(t.mtime)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocksizes=[]),i.defaults){if(n.Type=i.enums===String?"Raw":0,i.bytes===String?n.Data="":(n.Data=[],i.bytes!==Array&&(n.Data=Ze.newBuffer(n.Data))),Ze.Long){var s=new Ze.Long(0,0,!0);n.filesize=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.filesize=i.longs===String?"0":0;if(Ze.Long){var s=new Ze.Long(0,0,!0);n.hashType=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.hashType=i.longs===String?"0":0;if(Ze.Long){var s=new Ze.Long(0,0,!0);n.fanout=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.fanout=i.longs===String?"0":0;n.mode=0,n.mtime=null}if(t.Type!=null&&t.hasOwnProperty("Type")&&(n.Type=i.enums===String?Xi.Data.DataType[t.Type]:t.Type),t.Data!=null&&t.hasOwnProperty("Data")&&(n.Data=i.bytes===String?Ze.base64.encode(t.Data,0,t.Data.length):i.bytes===Array?Array.prototype.slice.call(t.Data):t.Data),t.filesize!=null&&t.hasOwnProperty("filesize")&&(typeof t.filesize=="number"?n.filesize=i.longs===String?String(t.filesize):t.filesize:n.filesize=i.longs===String?Ze.Long.prototype.toString.call(t.filesize):i.longs===Number?new Ze.LongBits(t.filesize.low>>>0,t.filesize.high>>>0).toNumber(!0):t.filesize),t.blocksizes&&t.blocksizes.length){n.blocksizes=[];for(var o=0;o<t.blocksizes.length;++o)typeof t.blocksizes[o]=="number"?n.blocksizes[o]=i.longs===String?String(t.blocksizes[o]):t.blocksizes[o]:n.blocksizes[o]=i.longs===String?Ze.Long.prototype.toString.call(t.blocksizes[o]):i.longs===Number?new Ze.LongBits(t.blocksizes[o].low>>>0,t.blocksizes[o].high>>>0).toNumber(!0):t.blocksizes[o]}return t.hashType!=null&&t.hasOwnProperty("hashType")&&(typeof t.hashType=="number"?n.hashType=i.longs===String?String(t.hashType):t.hashType:n.hashType=i.longs===String?Ze.Long.prototype.toString.call(t.hashType):i.longs===Number?new Ze.LongBits(t.hashType.low>>>0,t.hashType.high>>>0).toNumber(!0):t.hashType),t.fanout!=null&&t.hasOwnProperty("fanout")&&(typeof t.fanout=="number"?n.fanout=i.longs===String?String(t.fanout):t.fanout:n.fanout=i.longs===String?Ze.Long.prototype.toString.call(t.fanout):i.longs===Number?new Ze.LongBits(t.fanout.low>>>0,t.fanout.high>>>0).toNumber(!0):t.fanout),t.mode!=null&&t.hasOwnProperty("mode")&&(n.mode=t.mode),t.mtime!=null&&t.hasOwnProperty("mtime")&&(n.mtime=Xi.UnixTime.toObject(t.mtime,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xc.default.util.toJSONOptions)},r.DataType=function(){let e={},t=Object.create(e);return t[e[0]="Raw"]=0,t[e[1]="Directory"]=1,t[e[2]="File"]=2,t[e[3]="Metadata"]=3,t[e[4]="Symlink"]=4,t[e[5]="HAMTShard"]=5,t}(),r})(),lTt=Xi.UnixTime=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.Seconds=Ze.Long?Ze.Long.fromBits(0,0,!1):0,r.prototype.FractionalNanoseconds=0,r.encode=function(t,i){return i||(i=NI.create()),i.uint32(8).int64(t.Seconds),t.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(t,"FractionalNanoseconds")&&i.uint32(21).fixed32(t.FractionalNanoseconds),i},r.decode=function(t,i){t instanceof up||(t=up.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Xi.UnixTime;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.Seconds=t.int64();break;case 2:s.FractionalNanoseconds=t.fixed32();break;default:t.skipType(o&7);break}}if(!s.hasOwnProperty("Seconds"))throw Ze.ProtocolError("missing required 'Seconds'",{instance:s});return s},r.fromObject=function(t){if(t instanceof Xi.UnixTime)return t;var i=new Xi.UnixTime;return t.Seconds!=null&&(Ze.Long?(i.Seconds=Ze.Long.fromValue(t.Seconds)).unsigned=!1:typeof t.Seconds=="string"?i.Seconds=parseInt(t.Seconds,10):typeof t.Seconds=="number"?i.Seconds=t.Seconds:typeof t.Seconds=="object"&&(i.Seconds=new Ze.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber())),t.FractionalNanoseconds!=null&&(i.FractionalNanoseconds=t.FractionalNanoseconds>>>0),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(Ze.Long){var s=new Ze.Long(0,0,!1);n.Seconds=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.Seconds=i.longs===String?"0":0;n.FractionalNanoseconds=0}return t.Seconds!=null&&t.hasOwnProperty("Seconds")&&(typeof t.Seconds=="number"?n.Seconds=i.longs===String?String(t.Seconds):t.Seconds:n.Seconds=i.longs===String?Ze.Long.prototype.toString.call(t.Seconds):i.longs===Number?new Ze.LongBits(t.Seconds.low>>>0,t.Seconds.high>>>0).toNumber():t.Seconds),t.FractionalNanoseconds!=null&&t.hasOwnProperty("FractionalNanoseconds")&&(n.FractionalNanoseconds=t.FractionalNanoseconds),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xc.default.util.toJSONOptions)},r})(),fTt=Xi.Metadata=(()=>{function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.MimeType="",r.encode=function(t,i){return i||(i=NI.create()),t.MimeType!=null&&Object.hasOwnProperty.call(t,"MimeType")&&i.uint32(10).string(t.MimeType),i},r.decode=function(t,i){t instanceof up||(t=up.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Xi.Metadata;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.MimeType=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Xi.Metadata)return t;var i=new Xi.Metadata;return t.MimeType!=null&&(i.MimeType=String(t.MimeType)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.MimeType=""),t.MimeType!=null&&t.hasOwnProperty("MimeType")&&(n.MimeType=t.MimeType),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Xc.default.util.toJSONOptions)},r})()});var ms={};ut(ms,{UnixFS:()=>wi,parseMode:()=>Yw,parseMtime:()=>DI});function Yw(r){if(r!=null)return typeof r=="number"?r&4095:(r=r.toString(),r.substring(0,1)==="0"?parseInt(r,8)&4095:parseInt(r,10)&4095)}function DI(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,Ww.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var Ww,Qc,EF,$Ne,SF,xF,wi,pi=xe(()=>{f();Ww=Wt(ae());_F();Qc=wF,EF=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],$Ne=["directory","hamt-sharded-directory"],SF=parseInt("0644",8),xF=parseInt("0755",8);wi=class{static unmarshal(e){let t=Qc.decode(e),i=Qc.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}),n=new wi({type:EF[i.Type],data:i.Data,blockSizes:i.blocksizes,mode:i.mode,mtime:i.mtime?{secs:i.mtime.Seconds,nsecs:i.mtime.FractionalNanoseconds}:void 0});return n._originalMode=i.mode||0,n}constructor(e={type:"file"}){let{type:t,data:i,blockSizes:n,hashType:s,fanout:o,mtime:a,mode:c}=e;if(t&&!EF.includes(t))throw(0,Ww.default)(new Error("Type: "+t+" is not valid"),"ERR_INVALID_TYPE");this.type=t||"file",this.data=i,this.hashType=s,this.fanout=o,this.blockSizes=n||[],this._originalMode=0,this.mode=Yw(c),a&&(this.mtime=DI(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?xF:SF;let t=Yw(e);t!==void 0&&(this._mode=t)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&$Ne.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(t=>{e+=t}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=Qc.DataType.Raw;break;case"directory":e=Qc.DataType.Directory;break;case"file":e=Qc.DataType.File;break;case"metadata":e=Qc.DataType.Metadata;break;case"symlink":e=Qc.DataType.Symlink;break;case"hamt-sharded-directory":e=Qc.DataType.HAMTShard;break;default:throw(0,Ww.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let t=this.data;(!this.data||!this.data.length)&&(t=void 0);let i;this.mode!=null&&(i=this._originalMode&4294963200|(Yw(this.mode)||0),i===SF&&!this.isDirectory()&&(i=void 0),i===xF&&this.isDirectory()&&(i=void 0));let n;if(this.mtime!=null){let o=DI(this.mtime);o&&(n={Seconds:o.secs,FractionalNanoseconds:o.nsecs},n.FractionalNanoseconds===0&&delete n.FractionalNanoseconds)}let s={Type:e,Data:t,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:i,mtime:n};return Qc.encode(s).finish()}}});function BI(r,e){let t=0;for(let i=0;;i+=7){if(i>=64)throw new Error("protobuf: varint overflow");if(e>=r.length)throw new Error("protobuf: unexpected end of data");let n=r[e++];if(t+=i<28?(n&127)<<i:(n&127)*2**i,n<128)break}return[t,e]}function Xw(r,e){let t;[t,e]=BI(r,e);let i=e+t;if(t<0||i<0)throw new Error("protobuf: invalid length");if(i>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(e,i),i]}function AF(r,e){let t;return[t,e]=BI(r,e),[t&7,t>>3,e]}function WNe(r){let e={},t=r.length,i=0;for(;i<t;){let n,s;if([n,s,i]=AF(r,i),s===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,i]=Xw(r,i)}else if(s===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(n!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,i]=Xw(r,i),e.Name=GNe.decode(o)}else if(s===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(n!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${n}) for Tsize`);[e.Tsize,i]=BI(r,i)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(i>t)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function IF(r){let e=r.length,t=0,i,n=!1,s;for(;t<e;){let a,c;if([a,c,t]=AF(r,t),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,t]=Xw(r,t),i&&(n=!0)}else if(c===2){if(n)throw new Error("protobuf: (PBNode) duplicate Links section");i||(i=[]);let u;[u,t]=Xw(r,t),i.push(WNe(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(t>e)throw new Error("protobuf: (PBNode) unexpected end of data");let o={};return s&&(o.Data=s),o.Links=i||[],o}var GNe,TF=xe(()=>{f();GNe=new TextDecoder});function XNe(r,e){let t=e.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");t=Gg(e,t,r.Tsize)-1,e[t]=24}if(typeof r.Name=="string"){let i=RF.encode(r.Name);t-=i.length,e.set(i,t),t=Gg(e,t,i.length)-1,e[t]=18}return r.Hash&&(t-=r.Hash.length,e.set(r.Hash,t),t=Gg(e,t,r.Hash.length)-1,e[t]=10),e.length-t}function PF(r){let e=ZNe(r),t=new Uint8Array(e),i=e;if(r.Data&&(i-=r.Data.length,t.set(r.Data,i),i=Gg(t,i,r.Data.length)-1,t[i]=10),r.Links)for(let n=r.Links.length-1;n>=0;n--){let s=XNe(r.Links[n],t.subarray(0,i));i-=s,i=Gg(t,i,s)-1,t[i]=18}return t}function QNe(r){let e=0;if(r.Hash){let t=r.Hash.length;e+=1+t+lp(t)}if(typeof r.Name=="string"){let t=RF.encode(r.Name).length;e+=1+t+lp(t)}return typeof r.Tsize=="number"&&(e+=1+lp(r.Tsize)),e}function ZNe(r){let e=0;if(r.Data){let t=r.Data.length;e+=1+t+lp(t)}if(r.Links)for(let t of r.Links){let i=QNe(t);e+=1+i+lp(i)}return e}function Gg(r,e,t){e-=lp(t);let i=e;for(;t>=YNe;)r[e++]=t&127|128,t/=128;for(;t>=128;)r[e++]=t&127|128,t>>>=7;return r[e]=t,i}function lp(r){return r%2==0&&r++,Math.floor((JNe(r)+6)/7)}function JNe(r){let e=0;return r>=CF&&(r=Math.floor(r/CF),e=32),r>=1<<16&&(r>>>=16,e+=16),r>=1<<8&&(r>>>=8,e+=8),e+eDe[r]}var RF,CF,YNe,eDe,OF=xe(()=>{f();RF=new TextEncoder,CF=2**32,YNe=2**31;eDe=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]});function kF(r,e){if(r===e)return 0;let t=r.Name?MI.encode(r.Name):[],i=e.Name?MI.encode(e.Name):[],n=t.length,s=i.length;for(let o=0,a=Math.min(n,s);o<a;++o)if(t[o]!==i[o]){n=t[o],s=i[o];break}return n<s?-1:s<n?1:0}function qF(r,e){return!Object.keys(r).some(t=>!e.includes(t))}function NF(r){if(typeof r.asCID=="object"){let t=We.asCID(r);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Hash){let t=We.asCID(r.Hash);try{t||(typeof r.Hash=="string"?t=We.parse(r.Hash):r.Hash instanceof Uint8Array&&(t=We.decode(r.Hash)))}catch(i){throw new TypeError(`Invalid DAG-PB form: ${i.message}`)}t&&(e.Hash=t)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(e.Name=r.Name),typeof r.Tsize=="number"&&(e.Tsize=r.Tsize),e}function $s(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let e={};if(r.Data!==void 0)if(typeof r.Data=="string")e.Data=MI.encode(r.Data);else if(r.Data instanceof Uint8Array)e.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))e.Links=r.Links.map(NF),e.Links.sort(kF);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function LI(r){if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");if(!qF(r,tDe))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<r.Links.length;e++){let t=r.Links[e];if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!qF(t,rDe))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!t.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash.asCID!==t.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0&&(typeof t.Tsize!="number"||t.Tsize%1!=0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&kF(t,r.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function DF(r,e=[]){return $s({Data:r,Links:e})}function BF(r,e,t){return NF({Hash:t,Name:r,Tsize:e})}var tDe,rDe,MI,MF=xe(()=>{f();Ie();tDe=["Data","Links"],rDe=["Hash","Name","Tsize"],MI=new TextEncoder});var Mt={};ut(Mt,{code:()=>Wg,createLink:()=>BF,createNode:()=>DF,decode:()=>Zc,encode:()=>Uo,name:()=>iDe,prepare:()=>$s,validate:()=>LI});function Uo(r){LI(r);let e={};return r.Links&&(e.Links=r.Links.map(t=>{let i={};return t.Hash&&(i.Hash=t.Hash.bytes),t.Name!==void 0&&(i.Name=t.Name),t.Tsize!==void 0&&(i.Tsize=t.Tsize),i})),r.Data&&(e.Data=r.Data),PF(e)}function Zc(r){let e=IF(r),t={};return e.Data&&(t.Data=e.Data),e.Links&&(t.Links=e.Links.map(i=>{let n={};try{n.Hash=We.decode(i.Hash)}catch(s){}if(!n.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(n.Name=i.Name),i.Tsize!==void 0&&(n.Tsize=i.Tsize),n})),t}var iDe,Wg,_t=xe(()=>{f();Ie();TF();OF();MF();iDe="dag-pb",Wg=112});function LF(r){if(r===null)return"null";if(r===void 0)return"undefined";if(r===!0||r===!1)return"boolean";let e=typeof r;if(nDe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(r))return"Array";if(oDe(r))return"Buffer";let t=aDe(r);return t||"Object"}function oDe(r){return r&&r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer.call(null,r)}function aDe(r){let e=Object.prototype.toString.call(r).slice(8,-1);if(sDe.includes(e))return e}var nDe,sDe,UF=xe(()=>{f();nDe=["string","number","bigint","symbol"],sDe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var de,Fe,bs=xe(()=>{f();de=class{constructor(e,t,i){this.major=e,this.majorEncoded=e<<5,this.name=t,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};de.uint=new de(0,"uint",!0);de.negint=new de(1,"negint",!0);de.bytes=new de(2,"bytes",!0);de.string=new de(3,"string",!0);de.array=new de(4,"array",!1);de.map=new de(5,"map",!1);de.tag=new de(6,"tag",!1);de.float=new de(7,"float",!0);de.false=new de(7,"false",!0);de.true=new de(7,"true",!0);de.null=new de(7,"null",!0);de.undefined=new de(7,"undefined",!0);de.break=new de(7,"break",!0);Fe=class{constructor(e,t,i){this.type=e,this.value=t,this.encodedLength=i,this.encodedBytes=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function Qw(r){return fp&&globalThis.Buffer.isBuffer(r)}function UI(r){return r instanceof Uint8Array?Qw(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r:Uint8Array.from(r)}function zF(r,e){if(Qw(r)&&Qw(e))return r.compare(e);for(let t=0;t<r.length;t++)if(r[t]!==e[t])return r[t]<e[t]?-1:1;return 0}function HF(r,e=1/0){let t,i=r.length,n=null,s=[];for(let o=0;o<i;++o){if(t=r.charCodeAt(o),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}else if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return s}function $F(r,e,t){let i=[];for(;e<t;){let n=r[e],s=null,o=n>239?4:n>223?3:n>191?2:1;if(e+o<=t){let a,c,u,l;switch(o){case 1:n<128&&(s=n);break;case 2:a=r[e+1],(a&192)==128&&(l=(n&31)<<6|a&63,l>127&&(s=l));break;case 3:a=r[e+1],c=r[e+2],(a&192)==128&&(c&192)==128&&(l=(n&15)<<12|(a&63)<<6|c&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:a=r[e+1],c=r[e+2],u=r[e+3],(a&192)==128&&(c&192)==128&&(u&192)==128&&(l=(n&15)<<18|(a&63)<<12|(c&63)<<6|u&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),e+=o}return lDe(i)}function lDe(r){let e=r.length;if(e<=GF)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=GF));return t}var fp,cDe,uDe,FF,KF,Ha,Zw,jF,VF,GF,dp=xe(()=>{f();fp=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",cDe=new TextDecoder,uDe=new TextEncoder;FF=fp?(r,e,t)=>t-e>64?globalThis.Buffer.from(r.subarray(e,t)).toString("utf8"):$F(r,e,t):(r,e,t)=>t-e>64?cDe.decode(r.subarray(e,t)):$F(r,e,t),KF=fp?r=>r.length>64?globalThis.Buffer.from(r):HF(r):r=>r.length>64?uDe.encode(r):HF(r),Ha=r=>Uint8Array.from(r),Zw=fp?(r,e,t)=>Qw(r)?new Uint8Array(r.subarray(e,t)):r.slice(e,t):(r,e,t)=>r.slice(e,t),jF=fp?(r,e)=>(r=r.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),UI(globalThis.Buffer.concat(r,e))):(r,e)=>{let t=new Uint8Array(e),i=0;for(let n of r)i+n.length>t.length&&(n=n.subarray(0,t.length-i)),t.set(n,i),i+=n.length;return t},VF=fp?r=>globalThis.Buffer.allocUnsafe(r):r=>new Uint8Array(r);GF=4096});var fDe,Jw,WF=xe(()=>{f();dp();fDe=256,Jw=class{constructor(e=fDe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.chunks=[],this.cursor=0,this.maxCursor=-1,this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let t=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let n=t.length-(this.maxCursor-this.cursor)-1;t.set(e,n)}else{if(t){let n=t.length-(this.maxCursor-this.cursor)-1;n<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,n),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(t=VF(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let t;if(this.chunks.length===1){let i=this.chunks[0];e&&this.cursor>i.length/2?(t=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=Zw(i,0,this.cursor)}else t=jF(this.chunks,this.cursor);return e&&this.reset(),t}}});function Jc(r,e,t){if(r.length-e<t)throw new Error(`${ot} not enough data for type`)}var ot,FI,Yg,Fo=xe(()=>{f();ot="CBOR decode error:",FI="CBOR encode error:",Yg=[];Yg[23]=1;Yg[24]=2;Yg[25]=3;Yg[26]=5;Yg[27]=9});function vs(r,e,t){Jc(r,e,1);let i=r[e];if(t.strict===!0&&i<Fi[0])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function ws(r,e,t){Jc(r,e,2);let i=r[e]<<8|r[e+1];if(t.strict===!0&&i<Fi[1])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function _s(r,e,t){Jc(r,e,4);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3];if(t.strict===!0&&i<Fi[2])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);return i}function Es(r,e,t){Jc(r,e,8);let i=r[e]*16777216+(r[e+1]<<16)+(r[e+2]<<8)+r[e+3],n=r[e+4]*16777216+(r[e+5]<<16)+(r[e+6]<<8)+r[e+7],s=(BigInt(i)<<BigInt(32))+BigInt(n);if(t.strict===!0&&s<Fi[3])throw new Error(`${ot} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(t.allowBigInt===!0)return s;throw new Error(`${ot} integers outside of the safe integer range are not supported`)}function YF(r,e,t,i){return new Fe(de.uint,vs(r,e+1,i),2)}function XF(r,e,t,i){return new Fe(de.uint,ws(r,e+1,i),3)}function QF(r,e,t,i){return new Fe(de.uint,_s(r,e+1,i),5)}function ZF(r,e,t,i){return new Fe(de.uint,Es(r,e+1,i),9)}function Gs(r,e){return ts(r,0,e.value)}function ts(r,e,t){if(t<Fi[0]){let i=Number(t);r.push([e|i])}else if(t<Fi[1]){let i=Number(t);r.push([e|24,i])}else if(t<Fi[2]){let i=Number(t);r.push([e|25,i>>>8,i&255])}else if(t<Fi[3]){let i=Number(t);r.push([e|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{let i=BigInt(t);if(i<Fi[4]){let n=[e|27,0,0,0,0,0,0,0],s=Number(i&BigInt(4294967295)),o=Number(i>>BigInt(32)&BigInt(4294967295));n[8]=s&255,s=s>>8,n[7]=s&255,s=s>>8,n[6]=s&255,s=s>>8,n[5]=s&255,n[4]=o&255,o=o>>8,n[3]=o&255,o=o>>8,n[2]=o&255,o=o>>8,n[1]=o&255,r.push(n)}else throw new Error(`${ot} encountered BigInt larger than allowable range`)}}var Fi,$a=xe(()=>{f();bs();Fo();Fi=[24,256,65536,4294967296,BigInt("18446744073709551616")];Gs.encodedSize=function(e){return ts.encodedSize(e.value)};ts.encodedSize=function(e){return e<Fi[0]?1:e<Fi[1]?2:e<Fi[2]?3:e<Fi[3]?5:9};Gs.compareTokens=function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}});function JF(r,e,t,i){return new Fe(de.negint,-1-vs(r,e+1,i),2)}function eK(r,e,t,i){return new Fe(de.negint,-1-ws(r,e+1,i),3)}function tK(r,e,t,i){return new Fe(de.negint,-1-_s(r,e+1,i),5)}function iK(r,e,t,i){let n=Es(r,e+1,i);if(typeof n!="bigint"){let s=-1-n;if(s>=Number.MIN_SAFE_INTEGER)return new Fe(de.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${ot} integers outside of the safe integer range are not supported`);return new Fe(de.negint,KI-BigInt(n),9)}function e_(r,e){let t=e.value,i=typeof t=="bigint"?t*KI-rK:t*-1-1;ts(r,e.type.majorEncoded,i)}var KI,rK,jI=xe(()=>{f();bs();$a();Fo();KI=BigInt(-1),rK=BigInt(1);e_.encodedSize=function(e){let t=e.value,i=typeof t=="bigint"?t*KI-rK:t*-1-1;return i<Fi[0]?1:i<Fi[1]?2:i<Fi[2]?3:i<Fi[3]?5:9};e_.compareTokens=function(e,t){return e.value<t.value?1:e.value>t.value?-1:0}});function Xg(r,e,t,i){Jc(r,e,t+i);let n=Zw(r,e+t,e+t+i);return new Fe(de.bytes,n,t+i)}function nK(r,e,t,i){return Xg(r,e,1,t)}function sK(r,e,t,i){return Xg(r,e,2,vs(r,e+1,i))}function oK(r,e,t,i){return Xg(r,e,3,ws(r,e+1,i))}function aK(r,e,t,i){return Xg(r,e,5,_s(r,e+1,i))}function cK(r,e,t,i){let n=Es(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer bytes lengths not supported`);return Xg(r,e,9,n)}function t_(r){return r.encodedBytes===void 0&&(r.encodedBytes=r.type===de.string?KF(r.value):r.value),r.encodedBytes}function hp(r,e){let t=t_(e);ts(r,e.type.majorEncoded,t.length),r.push(t)}function dDe(r,e){return r.length<e.length?-1:r.length>e.length?1:zF(r,e)}var r_=xe(()=>{f();bs();Fo();$a();dp();hp.encodedSize=function(e){let t=t_(e);return ts.encodedSize(t.length)+t.length};hp.compareTokens=function(e,t){return dDe(t_(e),t_(t))}});function Qg(r,e,t,i){let n=t+i;return Jc(r,e,n),new Fe(de.string,FF(r,e+t,e+n),n)}function uK(r,e,t,i){return Qg(r,e,1,t)}function lK(r,e,t,i){return Qg(r,e,2,vs(r,e+1,i))}function fK(r,e,t,i){return Qg(r,e,3,ws(r,e+1,i))}function dK(r,e,t,i){return Qg(r,e,5,_s(r,e+1,i))}function hK(r,e,t,i){let n=Es(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer string lengths not supported`);return Qg(r,e,9,n)}var pK,VI=xe(()=>{f();bs();Fo();$a();r_();dp();pK=hp});function pp(r,e,t,i){return new Fe(de.array,i,t)}function yK(r,e,t,i){return pp(r,e,1,t)}function gK(r,e,t,i){return pp(r,e,2,vs(r,e+1,i))}function mK(r,e,t,i){return pp(r,e,3,ws(r,e+1,i))}function bK(r,e,t,i){return pp(r,e,5,_s(r,e+1,i))}function vK(r,e,t,i){let n=Es(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer array lengths not supported`);return pp(r,e,9,n)}function wK(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return pp(r,e,1,1/0)}function zI(r,e){ts(r,de.array.majorEncoded,e.value)}var HI=xe(()=>{f();bs();$a();Fo();zI.compareTokens=Gs.compareTokens});function yp(r,e,t,i){return new Fe(de.map,i,t)}function _K(r,e,t,i){return yp(r,e,1,t)}function EK(r,e,t,i){return yp(r,e,2,vs(r,e+1,i))}function SK(r,e,t,i){return yp(r,e,3,ws(r,e+1,i))}function xK(r,e,t,i){return yp(r,e,5,_s(r,e+1,i))}function AK(r,e,t,i){let n=Es(r,e+1,i);if(typeof n=="bigint")throw new Error(`${ot} 64-bit integer map lengths not supported`);return yp(r,e,9,n)}function IK(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return yp(r,e,1,1/0)}function $I(r,e){ts(r,de.map.majorEncoded,e.value)}var GI=xe(()=>{f();bs();$a();Fo();$I.compareTokens=Gs.compareTokens});function TK(r,e,t,i){return new Fe(de.tag,t,1)}function RK(r,e,t,i){return new Fe(de.tag,vs(r,e+1,i),2)}function CK(r,e,t,i){return new Fe(de.tag,ws(r,e+1,i),3)}function PK(r,e,t,i){return new Fe(de.tag,_s(r,e+1,i),5)}function OK(r,e,t,i){return new Fe(de.tag,Es(r,e+1,i),9)}function WI(r,e){ts(r,de.tag.majorEncoded,e.value)}var YI=xe(()=>{f();bs();$a();WI.compareTokens=Gs.compareTokens});function kK(r,e,t,i){if(i.allowUndefined===!1)throw new Error(`${ot} undefined values are not supported`);return new Fe(de.undefined,void 0,1)}function qK(r,e,t,i){if(i.allowIndefinite===!1)throw new Error(`${ot} indefinite length items not allowed`);return new Fe(de.break,void 0,1)}function XI(r,e,t){if(t){if(t.allowNaN===!1&&Number.isNaN(r))throw new Error(`${ot} NaN values are not supported`);if(t.allowInfinity===!1&&(r===1/0||r===-1/0))throw new Error(`${ot} Infinity values are not supported`)}return new Fe(de.float,r,e)}function NK(r,e,t,i){return XI(QI(r,e+1),3,i)}function DK(r,e,t,i){return XI(ZI(r,e+1),5,i)}function BK(r,e,t,i){return XI(FK(r,e+1),9,i)}function i_(r,e,t){let i=e.value;if(i===!1)r.push([de.float.majorEncoded|hDe]);else if(i===!0)r.push([de.float.majorEncoded|pDe]);else if(i===null)r.push([de.float.majorEncoded|yDe]);else if(i===void 0)r.push([de.float.majorEncoded|gDe]);else{let n,s=!1;(!t||t.float64!==!0)&&(LK(i),n=QI(Ko,1),i===n||Number.isNaN(i)?(Ko[0]=249,r.push(Ko.slice(0,3)),s=!0):(UK(i),n=ZI(Ko,1),i===n&&(Ko[0]=250,r.push(Ko.slice(0,5)),s=!0))),s||(mDe(i),n=FK(Ko,1),Ko[0]=251,r.push(Ko.slice(0,9)))}}function LK(r){if(r===1/0)Ws.setUint16(0,31744,!1);else if(r===-1/0)Ws.setUint16(0,64512,!1);else if(Number.isNaN(r))Ws.setUint16(0,32256,!1);else{Ws.setFloat32(0,r);let e=Ws.getUint32(0),t=(e&2139095040)>>23,i=e&8388607;if(t===255)Ws.setUint16(0,31744,!1);else if(t===0)Ws.setUint16(0,(r&2147483648)>>16|i>>13,!1);else{let n=t-127;n<-24?Ws.setUint16(0,0):n<-14?Ws.setUint16(0,(e&2147483648)>>16|1<<24+n,!1):Ws.setUint16(0,(e&2147483648)>>16|n+15<<10|i>>13,!1)}}}function QI(r,e){if(r.length-e<2)throw new Error(`${ot} not enough data for float16`);let t=(r[e]<<8)+r[e+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;let i=t>>10&31,n=t&1023,s;return i===0?s=n*2**-24:i!==31?s=(n+1024)*2**(i-25):s=n===0?1/0:NaN,t&32768?-s:s}function UK(r){Ws.setFloat32(0,r,!1)}function ZI(r,e){if(r.length-e<4)throw new Error(`${ot} not enough data for float32`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,4).getFloat32(0,!1)}function mDe(r){Ws.setFloat64(0,r,!1)}function FK(r,e){if(r.length-e<8)throw new Error(`${ot} not enough data for float64`);let t=(r.byteOffset||0)+e;return new DataView(r.buffer,t,8).getFloat64(0,!1)}var hDe,pDe,yDe,gDe,MK,Ws,Ko,JI=xe(()=>{f();bs();Fo();$a();hDe=20,pDe=21,yDe=22,gDe=23;i_.encodedSize=function(e,t){let i=e.value;if(i===!1||i===!0||i===null||i===void 0)return 1;let n;if(!t||t.float64!==!0){if(LK(i),n=QI(Ko,1),i===n||Number.isNaN(i))return 3;if(UK(i),n=ZI(Ko,1),i===n)return 5}return 9};MK=new ArrayBuffer(9),Ws=new DataView(MK,1),Ko=new Uint8Array(MK,0);i_.compareTokens=Gs.compareTokens});function Lt(r,e,t){throw new Error(`${ot} encountered invalid minor (${t}) for major ${r[e]>>>5}`)}function n_(r){return()=>{throw new Error(`${ot} ${r}`)}}function KK(r){switch(r.type){case de.false:return Ha([244]);case de.true:return Ha([245]);case de.null:return Ha([246]);case de.bytes:return r.value.length?void 0:Ha([64]);case de.string:return r.value===""?Ha([96]):void 0;case de.array:return r.value===0?Ha([128]):void 0;case de.map:return r.value===0?Ha([160]):void 0;case de.uint:return r.value<24?Ha([Number(r.value)]):void 0;case de.negint:if(r.value>=-24)return Ha([31-Number(r.value)])}}var qe,jo,e4=xe(()=>{f();bs();$a();jI();r_();VI();HI();GI();YI();JI();Fo();dp();qe=[];for(let r=0;r<=23;r++)qe[r]=Lt;qe[24]=YF;qe[25]=XF;qe[26]=QF;qe[27]=ZF;qe[28]=Lt;qe[29]=Lt;qe[30]=Lt;qe[31]=Lt;for(let r=32;r<=55;r++)qe[r]=Lt;qe[56]=JF;qe[57]=eK;qe[58]=tK;qe[59]=iK;qe[60]=Lt;qe[61]=Lt;qe[62]=Lt;qe[63]=Lt;for(let r=64;r<=87;r++)qe[r]=nK;qe[88]=sK;qe[89]=oK;qe[90]=aK;qe[91]=cK;qe[92]=Lt;qe[93]=Lt;qe[94]=Lt;qe[95]=n_("indefinite length bytes/strings are not supported");for(let r=96;r<=119;r++)qe[r]=uK;qe[120]=lK;qe[121]=fK;qe[122]=dK;qe[123]=hK;qe[124]=Lt;qe[125]=Lt;qe[126]=Lt;qe[127]=n_("indefinite length bytes/strings are not supported");for(let r=128;r<=151;r++)qe[r]=yK;qe[152]=gK;qe[153]=mK;qe[154]=bK;qe[155]=vK;qe[156]=Lt;qe[157]=Lt;qe[158]=Lt;qe[159]=wK;for(let r=160;r<=183;r++)qe[r]=_K;qe[184]=EK;qe[185]=SK;qe[186]=xK;qe[187]=AK;qe[188]=Lt;qe[189]=Lt;qe[190]=Lt;qe[191]=IK;for(let r=192;r<=215;r++)qe[r]=TK;qe[216]=RK;qe[217]=CK;qe[218]=PK;qe[219]=OK;qe[220]=Lt;qe[221]=Lt;qe[222]=Lt;qe[223]=Lt;for(let r=224;r<=243;r++)qe[r]=n_("simple values are not supported");qe[244]=Lt;qe[245]=Lt;qe[246]=Lt;qe[247]=kK;qe[248]=n_("simple values are not supported");qe[249]=NK;qe[250]=DK;qe[251]=BK;qe[252]=Lt;qe[253]=Lt;qe[254]=Lt;qe[255]=qK;jo=[];for(let r=0;r<24;r++)jo[r]=new Fe(de.uint,r,1);for(let r=-1;r>=-24;r--)jo[31-r]=new Fe(de.negint,r,1);jo[64]=new Fe(de.bytes,new Uint8Array(0),1);jo[96]=new Fe(de.string,"",1);jo[128]=new Fe(de.array,0,1);jo[160]=new Fe(de.map,0,1);jo[244]=new Fe(de.false,!1,1);jo[245]=new Fe(de.true,!0,1);jo[246]=new Fe(de.null,null,1)});function s_(r,e={},t){let i=LF(r),n=e&&e.typeEncoders&&e.typeEncoders[i]||al[i];if(typeof n=="function"){let o=n(r,i,e,t);if(o!=null)return o}let s=al[i];if(!s)throw new Error(`${FI} unsupported type: ${i}`);return s(r,i,e,t)}function vDe(r,e){e.mapSorter&&r.sort(e.mapSorter)}function wDe(r,e){let t=Array.isArray(r[0])?r[0][0]:r[0],i=Array.isArray(e[0])?e[0][0]:e[0];if(t.type!==i.type)return t.type.compare(i.type);let n=t.type.major,s=Ga[n].compareTokens(t,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function VK(r,e,t,i){if(Array.isArray(e))for(let n of e)VK(r,n,t,i);else t[e.type.major](r,e,i)}function _De(r,e,t){let i=s_(r,t);if(!Array.isArray(i)&&t.quickEncodeToken){let n=t.quickEncodeToken(i);if(n)return n;let s=e[i.type.major];if(s.encodedSize){let o=s.encodedSize(i,t),a=new Jw(o);if(s(a,i,t),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return UI(a.chunks[0])}}return VK(jK,i,e,t),jK.toBytes(!0)}function o_(r,e){return e=Object.assign({},bDe,e),_De(r,Ga,e)}var bDe,Ga,jK,Zg,ol,al,zK=xe(()=>{f();UF();bs();WF();Fo();e4();dp();$a();jI();r_();VI();HI();GI();YI();JI();bDe={float64:!1,mapSorter:wDe,quickEncodeToken:KK},Ga=[];Ga[de.uint.major]=Gs;Ga[de.negint.major]=e_;Ga[de.bytes.major]=hp;Ga[de.string.major]=pK;Ga[de.array.major]=zI;Ga[de.map.major]=$I;Ga[de.tag.major]=WI;Ga[de.float.major]=i_;jK=new Jw,Zg=class{constructor(e,t){this.obj=e,this.parent=t}includes(e){let t=this;do if(t.obj===e)return!0;while(t=t.parent);return!1}static createCheck(e,t){if(e&&e.includes(t))throw new Error(`${FI} object contains circular references`);return new Zg(t,e)}},ol={null:new Fe(de.null,null),undefined:new Fe(de.undefined,void 0),true:new Fe(de.true,!0),false:new Fe(de.false,!1),emptyArray:new Fe(de.array,0),emptyMap:new Fe(de.map,0)},al={number(r,e,t,i){return!Number.isInteger(r)||!Number.isSafeInteger(r)?new Fe(de.float,r):r>=0?new Fe(de.uint,r):new Fe(de.negint,r)},bigint(r,e,t,i){return r>=BigInt(0)?new Fe(de.uint,r):new Fe(de.negint,r)},Uint8Array(r,e,t,i){return new Fe(de.bytes,r)},string(r,e,t,i){return new Fe(de.string,r)},boolean(r,e,t,i){return r?ol.true:ol.false},null(r,e,t,i){return ol.null},undefined(r,e,t,i){return ol.undefined},ArrayBuffer(r,e,t,i){return new Fe(de.bytes,new Uint8Array(r))},DataView(r,e,t,i){return new Fe(de.bytes,new Uint8Array(r.buffer,r.byteOffset,r.byteLength))},Array(r,e,t,i){if(!r.length)return t.addBreakTokens===!0?[ol.emptyArray,new Fe(de.break)]:ol.emptyArray;i=Zg.createCheck(i,r);let n=[],s=0;for(let o of r)n[s++]=s_(o,t,i);return t.addBreakTokens?[new Fe(de.array,r.length),n,new Fe(de.break)]:[new Fe(de.array,r.length),n]},Object(r,e,t,i){let n=e!=="Object",s=n?r.keys():Object.keys(r),o=n?r.size:s.length;if(!o)return t.addBreakTokens===!0?[ol.emptyMap,new Fe(de.break)]:ol.emptyMap;i=Zg.createCheck(i,r);let a=[],c=0;for(let u of s)a[c++]=[s_(u,t,i),s_(n?r.get(u):r[u],t,i)];return vDe(a,t),t.addBreakTokens?[new Fe(de.map,o),a,new Fe(de.break)]:[new Fe(de.map,o),a]}};al.Map=al.Object;al.Buffer=al.Uint8Array;for(let r of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))al[`${r}Array`]=al.DataView});function SDe(r,e,t){let i=[];for(let n=0;n<r.value;n++){let s=em(e,t);if(s===a_){if(r.value===1/0)break;throw new Error(`${ot} got unexpected break to lengthed array`)}if(s===Jg)throw new Error(`${ot} found array but not enough entries (got ${n}, expected ${r.value})`);i[n]=s}return i}function xDe(r,e,t){let i=t.useMaps===!0,n=i?void 0:{},s=i?new Map:void 0;for(let o=0;o<r.value;o++){let a=em(e,t);if(a===a_){if(r.value===1/0)break;throw new Error(`${ot} got unexpected break to lengthed map`)}if(a===Jg)throw new Error(`${ot} found map but not enough entries (got ${o} [no key], expected ${r.value})`);if(i!==!0&&typeof a!="string")throw new Error(`${ot} non-string keys not supported (got ${typeof a})`);let c=em(e,t);if(c===Jg)throw new Error(`${ot} found map but not enough entries (got ${o} [no value], expected ${r.value})`);i?s.set(a,c):n[a]=c}return i?s:n}function em(r,e){if(r.done())return Jg;let t=r.next();if(t.type===de.break)return a_;if(t.type.terminal)return t.value;if(t.type===de.array)return SDe(t,r,e);if(t.type===de.map)return xDe(t,r,e);if(t.type===de.tag){if(e.tags&&typeof e.tags[t.value]=="function"){let i=em(r,e);return e.tags[t.value](i)}throw new Error(`${ot} tag not supported (${t.value})`)}throw new Error("unsupported")}function c_(r,e){if(!(r instanceof Uint8Array))throw new Error(`${ot} data to decode must be a Uint8Array`);e=Object.assign({},EDe,e);let t=e.tokenizer||new HK(r,e),i=em(t,e);if(i===Jg)throw new Error(`${ot} did not find any content to decode`);if(i===a_)throw new Error(`${ot} got unexpected break`);if(!t.done())throw new Error(`${ot} too many terminals, data makes no sense`);return i}var EDe,HK,Jg,a_,$K=xe(()=>{f();Fo();bs();e4();EDe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},HK=class{constructor(e,t={}){this.pos=0,this.data=e,this.options=t}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],t=jo[e];if(t===void 0){let i=qe[e];if(!i)throw new Error(`${ot} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let n=e&31;t=i(this.data,this.pos,n,this.options)}return this.pos+=t.encodedLength,t}},Jg=Symbol.for("DONE"),a_=Symbol.for("BREAK")});var u_={};ut(u_,{Token:()=>Fe,Type:()=>de,decode:()=>c_,encode:()=>o_});var tm=xe(()=>{f();zK();$K();bs()});var l_={};ut(l_,{code:()=>rm,decode:()=>Lf,encode:()=>t4,name:()=>PDe});function ADe(r){if(r.asCID!==r)return null;let e=We.asCID(r);if(!e)return null;let t=new Uint8Array(e.bytes.byteLength+1);return t.set(e.bytes,1),[new Fe(de.tag,GK),new Fe(de.bytes,t)]}function IDe(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function TDe(r){if(Number.isNaN(r))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(r===1/0||r===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function CDe(r){if(r[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return We.decode(r.subarray(1))}var GK,RDe,WK,PDe,rm,t4,Lf,eu=xe(()=>{f();tm();Ie();GK=42;RDe={float64:!0,typeEncoders:{Object:ADe,undefined:IDe,number:TDe}};WK={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};WK.tags[GK]=CDe;PDe="dag-cbor",rm=113,t4=r=>o_(r,RDe),Lf=r=>c_(r,WK)});var XK=y((V5t,YK)=>{f();"use strict";YK.exports=()=>{}});var ul=y(cl=>{f();"use strict";var im=class extends Error{constructor(e="not initialized"){super(e);this.name="NotInitializedError",this.code=im.code}};im.code="ERR_NOT_INITIALIZED";cl.NotInitializedError=im;var r4=class extends Error{constructor(e="cannot initialize an initializing node"){super(e);this.name="AlreadyInitializingError",this.code=gp.code}};r4.code="ERR_ALREADY_INITIALIZING";cl.AlreadyInitializingError=r4;var gp=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e);this.name="AlreadyInitializedError",this.code=gp.code}};gp.code="ERR_ALREADY_INITIALIZED";cl.AlreadyInitializedError=gp;var nm=class extends Error{constructor(e="not started"){super(e);this.name="NotStartedError",this.code=nm.code}};nm.code="ERR_NOT_STARTED";cl.NotStartedError=nm;var sm=class extends Error{constructor(e="cannot start, already startin"){super(e);this.name="AlreadyStartingError",this.code=sm.code}};sm.code="ERR_ALREADY_STARTING";cl.AlreadyStartingError=sm;var om=class extends Error{constructor(e="cannot start, already started"){super(e);this.name="AlreadyStartedError",this.code=om.code}};om.code="ERR_ALREADY_STARTED";cl.AlreadyStartedError=om;var am=class extends Error{constructor(e="not enabled"){super(e);this.name="NotEnabledError",this.code=am.code}};am.code="ERR_NOT_ENABLED";cl.NotEnabledError=am});var QK,ZK=xe(()=>{f();QK="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"});var cm={};ut(cm,{customAlphabet:()=>ODe,customRandom:()=>ej,nanoid:()=>kDe,random:()=>JK,urlAlphabet:()=>QK});var JK,ej,ODe,kDe,um=xe(()=>{f();ZK();JK=r=>crypto.getRandomValues(new Uint8Array(r)),ej=(r,e,t)=>{let i=(2<<Math.log(r.length-1)/Math.LN2)-1,n=-~(1.6*i*e/r.length);return()=>{let s="";for(;;){let o=t(n),a=n;for(;a--;)if(s+=r[o[a]&i]||"",s.length===e)return s}}},ODe=(r,e)=>ej(r,e,JK),kDe=(r=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(r));for(;r--;){let i=t[r]&63;i<36?e+=i.toString(36):i<62?e+=(i-26).toString(36).toUpperCase():i<63?e+="_":e+="-"}return e}});var i4=y((G5t,rj)=>{f();"use strict";var{nanoid:qDe}=(um(),cm),{toString:NDe}=(tt(),et),{fromString:DDe}=(ft(),ht),tu="/",tj=new TextEncoder().encode(tu),f_=tj[0],Ys=class{constructor(e,t){if(typeof e=="string")this._buf=DDe(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(t==null&&(t=!0),t&&this.clean(),this._buf.byteLength===0||this._buf[0]!==f_)throw new Error("Invalid key")}toString(e="utf8"){return NDe(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new Ys(e.join(tu))}static random(){return new Ys(qDe().replace(/-/g,""))}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=tj),this._buf[0]!==f_){let e=new Uint8Array(this._buf.byteLength+1);e.fill(f_,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===f_;)this._buf=this._buf.subarray(0,-1)}less(e){let t=this.list(),i=e.list();for(let n=0;n<t.length;n++){if(i.length<n+1)return!1;let s=t[n],o=i[n];if(s<o)return!0;if(s>o)return!1}return t.length<i.length}reverse(){return Ys.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(tu).slice(1)}type(){return BDe(this.baseNamespace())}name(){return MDe(this.baseNamespace())}instance(e){return new Ys(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(tu)||(e+=tu),e+=this.type(),new Ys(e)}parent(){let e=this.list();return e.length===1?new Ys(tu):new Ys(e.slice(0,-1).join(tu))}child(e){return this.toString()===tu?e:e.toString()===tu?this:new Ys(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return Ys.withNamespaces([...this.namespaces(),...LDe(e.map(t=>t.namespaces()))])}};function BDe(r){let e=r.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function MDe(r){let e=r.split(":");return e[e.length-1]}function LDe(r){return[].concat(...r)}rj.exports=Ys});var nj=y((W5t,ij)=>{f();"use strict";var{nanoid:UDe}=(um(),cm),FDe=(r=e=>e)=>r(UDe());ij.exports=FDe});var mp=y((Y5t,sj)=>{f();"use strict";var KDe=async r=>{let e=[];for await(let t of r)e.push(t);return e};sj.exports=KDe});var n4=y((X5t,oj)=>{f();"use strict";var jDe=nj(),VDe=mp(),zDe=(r,e)=>async function*(){yield*(await VDe(r)).sort(e)}(),HDe=(r,e)=>{let t=new RegExp("^"+e);return r.replace(t,"")};oj.exports={sortAll:zDe,tmpdir:jDe,replaceStartWith:HDe}});var Wa=y((Q5t,aj)=>{f();"use strict";var $De=async r=>{for await(let e of r);};aj.exports=$De});var Ya=y((Z5t,cj)=>{f();"use strict";var GDe=async function*(r,e){for await(let t of r)await e(t)&&(yield t)};cj.exports=GDe});var bp=y((J5t,uj)=>{f();"use strict";var WDe=async function*(r,e){let t=0;if(!(e<1)){for await(let i of r)if(yield i,t++,t===e)return}};uj.exports=WDe});var s4=y((eRt,pj)=>{f();"use strict";var{sortAll:lj}=n4(),fj=Wa(),vp=Ya(),dj=bp(),hj=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await fj(this.putMany(e,i)),e=[],await fj(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=vp(i,n=>n.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>vp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>lj(n,s),i)),e.offset!=null){let n=0;i=vp(i,()=>n++>=e.offset)}return e.limit!=null&&(i=dj(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=vp(i,n=>n.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>vp(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>lj(n,s),i)),e.offset!=null){let n=0;i=vp(i,()=>n++>=e.offset)}return e.limit!=null&&(i=dj(i,e.limit)),i}};pj.exports=hj});var o4=y((tRt,yj)=>{f();"use strict";var lm=ae();function YDe(r){return r=r||new Error("Cannot open database"),lm(r,"ERR_DB_OPEN_FAILED")}function XDe(r){return r=r||new Error("Delete failed"),lm(r,"ERR_DB_DELETE_FAILED")}function QDe(r){return r=r||new Error("Write failed"),lm(r,"ERR_DB_WRITE_FAILED")}function ZDe(r){return r=r||new Error("Not Found"),lm(r,"ERR_NOT_FOUND")}function JDe(r){return r=r||new Error("Aborted"),lm(r,"ERR_ABORTED")}yj.exports={dbOpenFailedError:YDe,dbDeleteFailedError:XDe,dbWriteFailedError:QDe,notFoundError:ZDe,abortedError:JDe}});var vj=y((rRt,bj)=>{f();"use strict";var gj=i4(),eBe=s4(),tBe=o4(),mj=class extends eBe{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[e.toString()]=t}async get(e){if(!await this.has(e))throw tBe.notFoundError();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:new gj(e),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new gj(e))}};bj.exports=mj});var Ut=y((iRt,wj)=>{f();"use strict";var rBe=i4(),iBe=vj(),nBe=n4(),sBe=o4(),oBe=s4();wj.exports={Key:rBe,MemoryDatastore:iBe,utils:nBe,Errors:sBe,Adapter:oBe}});var Ej=y((nRt,_j)=>{f();"use strict";_j.exports=function(){return Date.now()}});var xj=y((sRt,Sj)=>{f();"use strict";var a4=Ej();function c4(r,e,t){var i=this;this._started=a4(),this._rescheduled=0,this._scheduled=e,this._args=t,this._timer=setTimeout(n,e);function n(){i._rescheduled>0?(i._scheduled=i._rescheduled-(a4()-i._started),i._timer=setTimeout(n,i._scheduled),i._rescheduled=0):r.apply(null,i._args)}}c4.prototype.reschedule=function(r){var e=a4();return e+r-(this._started+this._scheduled)<0?!1:(this._started=e,this._rescheduled=r,!0)};c4.prototype.clear=function(){clearTimeout(this._timer)};function aBe(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new c4(arguments[0],arguments[1],r)}Sj.exports=aBe});var l4=y((oRt,u4)=>{f();"use strict";var{AbortController:cBe}=typeof self!="undefined"?self:typeof window!="undefined"?window:df(),Aj=xj(),fm=class extends cBe{constructor(e){super();this._ms=e,this._timer=Aj(()=>this.abort(),e),Object.setPrototypeOf(this,fm.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=Aj(()=>this.abort(),this._ms)}};u4.exports=fm;u4.exports.TimeoutController=fm});var dm=y((aRt,f4)=>{f();"use strict";var uBe=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;f4.exports=yt;f4.exports.default=yt;yt.nanosecond=yt.ns=1/1e6;yt.\u00B5s=yt.\u03BCs=yt.us=yt.microsecond=1/1e3;yt.millisecond=yt.ms=yt[""]=1;yt.second=yt.sec=yt.s=yt.ms*1e3;yt.minute=yt.min=yt.m=yt.s*60;yt.hour=yt.hr=yt.h=yt.m*60;yt.day=yt.d=yt.h*24;yt.week=yt.wk=yt.w=yt.d*7;yt.month=yt.b=yt.d*(365.25/12);yt.year=yt.yr=yt.y=yt.d*365.25;function yt(r="",e="ms"){var t=null;return r=(r+"").replace(/(\d)[,_](\d)/g,"$1$2"),r.replace(uBe,function(i,n,s){s=Ij(s),s&&(t=(t||0)+parseFloat(n,10)*s)}),t&&t/(Ij(e)||1)}function Ij(r){return yt[r]||yt[r.toLowerCase().replace(/s$/,"")]}});var Rj=y(Tj=>{f();"use strict";var hm=class extends Error{constructor(e="request timed out"){super(e);this.name="TimeoutError",this.code=hm.code}};hm.code="ERR_TIMEOUT";Tj.TimeoutError=hm});var Oe=y((uRt,Cj)=>{f();"use strict";var lBe=l4(),{anySignal:fBe}=hf(),{default:dBe}=dm(),{TimeoutError:d4}=Rj();function hBe(r,e){return(...t)=>{let i=t[e??t.length-1];if(!i||!i.timeout)return r(...t);let n=typeof i.timeout=="string"?dBe(i.timeout):i.timeout,s=new lBe(n);i.signal=fBe([i.signal,s.signal]);let o=r(...t),a=new Promise((l,d)=>{s.signal.addEventListener("abort",()=>{d(new d4)})}),c=Date.now(),u=()=>{if(s.signal.aborted)throw new d4;if(Date.now()-c>n)throw s.abort(),new d4};return o[Symbol.asyncIterator]?async function*(){let l=o[Symbol.asyncIterator]();try{for(;;){let{value:d,done:h}=await Promise.race([l.next(),a]);if(h)break;u(),yield d}}catch(d){throw u(),d}finally{s.clear(),l.return&&l.return()}}():(async()=>{try{let l=await Promise.race([o,a]);return u(),l}catch(l){throw u(),l}finally{s.clear()}})()}}Cj.exports=hBe});var pm=y((lRt,kj)=>{f();"use strict";var{CID:h4}=(Ie(),De),Pj=ae(),Oj="/ipfs/",pBe=r=>{if(r instanceof Uint8Array)try{r=h4.decode(r)}catch(n){throw Pj(n,"ERR_INVALID_CID")}if(r instanceof h4)return{cid:r,path:void 0};r.startsWith(Oj)&&(r=r.substring(Oj.length));let e=r.split("/"),t,i;try{t=h4.parse(e.shift()||"")}catch(n){throw Pj(n,"ERR_INVALID_CID")}return e.length&&(i=`/${e.join("/")}`),{cid:t,path:i}};kj.exports=pBe});var Ki=y((fRt,Nj)=>{f();"use strict";var yBe=sp(),{CID:wp}=(Ie(),De),gBe=Ut().Key,p4=ae(),mBe=Oe(),bBe=pm(),vBe=(_t(),Mt),wBe="ERR_BAD_PATH",_Be=r=>{if(r instanceof wp)return`/ipfs/${r}`;try{wp.parse(r),r=`/ipfs/${r}`}catch{}if(yBe.path(r))return r;throw p4(new Error(`invalid path: ${r}`),wBe)},EBe=r=>r instanceof Uint8Array?wp.decode(r).toString():r instanceof wp?r.toString():(r.indexOf("/ipfs/")===0&&(r=r.substring("/ipfs/".length)),r.charAt(r.length-1)==="/"&&(r=r.substring(0,r.length-1)),r),SBe=async function(r,e,t,i={}){let{cid:n,path:s}=bBe(t);s&&(i.path=s);let o=n,a=i.path||"";if(a.startsWith("/")&&(a=a.substring(1)),i.path)try{for await(let{value:c,remainderPath:u}of qj(n,i.path,e,r,{signal:i.signal})){if(!(c instanceof wp))break;a=u,o=c}}catch(c){throw c.message.startsWith("Object has no property")&&(c.message=`no link named "${a.split("/")[0]}" under ${o}`,c.code="ERR_NO_LINK"),c}return{cid:o,remainderPath:a||""}},xBe=r=>{if(r.type!=="file"&&r.type!=="directory"&&r.type!=="raw")throw new Error(`Unknown node type '${r.type}'`);let e={cid:r.cid,path:r.path,name:r.name,size:r.size,type:"file"};return r.type==="directory"&&(e.type="dir"),r.type==="file"&&(e.size=r.unixfs.fileSize()),(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,r.unixfs.mtime!==void 0&&(e.mtime=r.unixfs.mtime)),e},ABe=mBe(async(r,e)=>await r),qj=async function*(r,e,t,i,n){let s=async u=>{let l=await t.getCodec(u.code),d=await i.blocks.get(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw p4(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(r.code===vBe.code&&Array.isArray(a.Links)){let l=a.Links.find(d=>d.Name===u);if(l){yield{value:l.Hash,remainderPath:o.join("/")},a=await s(l.Hash),c=l.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw p4(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");a instanceof wp&&(c=a,a=await s(a))}};Nj.exports={normalizePath:_Be,normalizeCidPath:EBe,resolvePath:SBe,mapFile:xBe,withTimeout:ABe,resolve:qj,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new gBe("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174}});var d_=y((dRt,Dj)=>{f();"use strict";var{NotStartedError:IBe,AlreadyStartingError:TBe,AlreadyStartedError:RBe}=ul(),{withTimeout:CBe}=Ki(),Xa=class{static create({start:e,stop:t}){return new Xa(e,t)}static async start(e,t){let{state:i,activate:n}=e;switch(i.status){case"stopped":try{let s=n(t);e.state={status:"starting",ready:s};let o=await s;return e.state={status:"started",value:o},o}catch(s){throw e.state={status:"stopped"},s}case"starting":throw new TBe;case"started":throw new RBe;case"stopping":return await i.ready,await Xa.start(e,t);default:return Xa.panic(e)}}static async stop(e){let{state:t,deactivate:i}=e;switch(t.status){case"stopped":break;case"starting":{try{await t.ready}catch(n){}return await Xa.stop(e)}case"stopping":return await t.ready;case"started":{i&&await i(t.value),e.state={status:"stopped"};break}default:Xa.panic(t)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},t){switch(e.status){case"started":return e.value;case"starting":return await CBe(e.ready,t);default:throw new IBe}}static panic({state:e}){let t=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${t}, should never happen if you see this please report a bug`)}constructor(e,t){this.activate=e,this.deactivate=t,this.state={status:"stopped"}}async use(e){return await Xa.use(this,e)}try(){return Xa.try(this)}};Dj.exports=Xa});var Mj=y((hRt,Bj)=>{f();"use strict";var PBe=d_();Bj.exports=({network:r,preload:e,peerId:t,keychain:i,repo:n,ipns:s,mfsPreload:o,print:a,options:c})=>async()=>{let{libp2p:l}=await PBe.start(r,{peerId:t,repo:n,print:a,options:c});await Promise.all([s.startOnline({keychain:i,libp2p:l,peerId:t,repo:n}),e.start(),o.start()])}});var Uj=y((pRt,Lj)=>{f();"use strict";var OBe=d_();Lj.exports=({network:r,preload:e,ipns:t,repo:i,mfsPreload:n})=>async()=>{await Promise.all([e.stop(),t.stop(),n.stop(),OBe.stop(r),i.close()])}});var ym=y((yRt,Fj)=>{f();Fj.exports=function(r){if(!r)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,t=Object.create(null),i=Object.create(null);function n(s,o){t[s]=o,e++,e>=r&&(e=0,i=t,t=Object.create(null))}return{has:function(s){return t[s]!==void 0||i[s]!==void 0},remove:function(s){t[s]!==void 0&&(t[s]=void 0),i[s]!==void 0&&(i[s]=void 0)},get:function(s){var o=t[s];if(o!==void 0)return o;if((o=i[s])!==void 0)return n(s,o),o},set:function(s,o){t[s]!==void 0?t[s]=o:n(s,o)},clear:function(){t=Object.create(null),i=Object.create(null)}}}});var y4=y((gRt,jj)=>{f();"use strict";var kBe=ym(),Kj=class{constructor(e){this.lru=kBe(e)}get(e){let t=this.lru.get(e);if(t){if(t.expire&&t.expire<Date.now()){this.lru.remove(e);return}return t.value}}set(e,t,i){this.lru.set(e,{value:t,expire:Date.now()+i})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};jj.exports=Kj});var zj=y((mRt,g4)=>{f();"use strict";var qBe=Object.prototype.hasOwnProperty,qn="~";function gm(){}Object.create&&(gm.prototype=Object.create(null),new gm().__proto__||(qn=!1));function NBe(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Vj(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new NBe(t,i||r,n),o=qn?qn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function h_(r,e){--r._eventsCount==0?r._events=new gm:delete r._events[e]}function hn(){this._events=new gm,this._eventsCount=0}hn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)qBe.call(t,i)&&e.push(qn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};hn.prototype.listeners=function(e){var t=qn?qn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};hn.prototype.listenerCount=function(e){var t=qn?qn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};hn.prototype.emit=function(e,t,i,n,s,o){var a=qn?qn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};hn.prototype.on=function(e,t,i){return Vj(this,e,t,i,!1)};hn.prototype.once=function(e,t,i){return Vj(this,e,t,i,!0)};hn.prototype.removeListener=function(e,t,i,n){var s=qn?qn+e:e;if(!this._events[s])return this;if(!t)return h_(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&h_(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:h_(this,s)}return this};hn.prototype.removeAllListeners=function(e){var t;return e?(t=qn?qn+e:e,this._events[t]&&h_(this,t)):(this._events=new gm,this._eventsCount=0),this};hn.prototype.off=hn.prototype.removeListener;hn.prototype.addListener=hn.prototype.on;hn.prefixed=qn;hn.EventEmitter=hn;typeof g4!="undefined"&&(g4.exports=hn)});var Uf=y((bRt,Hj)=>{f();"use strict";Hj.exports=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(i=>{i(e())}).then(()=>t),t=>new Promise(i=>{i(e())}).then(()=>{throw t})))});var Gj=y((vRt,p_)=>{f();"use strict";var DBe=Uf(),m4=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},$j=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new m4(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);DBe(r.then(i,n),()=>{clearTimeout(s)})});p_.exports=$j;p_.exports.default=$j;p_.exports.TimeoutError=m4});var Wj=y(b4=>{f();"use strict";Object.defineProperty(b4,"__esModule",{value:!0});function BBe(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}b4.default=BBe});var Xj=y(v4=>{f();"use strict";Object.defineProperty(v4,"__esModule",{value:!0});var MBe=Wj(),Yj=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=MBe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};v4.default=Yj});var _4=y(w4=>{f();"use strict";Object.defineProperty(w4,"__esModule",{value:!0});var LBe=zj(),Qj=Gj(),UBe=Xj(),y_=()=>{},FBe=new Qj.TimeoutError,Zj=class extends LBe{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=y_,this._resolveIdle=y_,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:UBe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=y_,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=y_,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():Qj.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(FBe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};w4.default=Zj});var tV=y((SRt,eV)=>{f();"use strict";var KBe=y4(),{default:jBe}=_4(),VBe=ng(),E4=new KBe(1e3),zBe=60*1e3,HBe=new jBe({concurrency:4}),Jj=r=>{if(r.Path)return r.Path;throw new Error(r.Message)};eV.exports=async(r,e)=>(async(i,n={})=>{let s=new URLSearchParams(n);s.set("arg",i);let o=s.toString();if(!n.nocache&&E4.has(o)){let c=E4.get(o);return Jj(c)}let a=await HBe.add(async()=>{let c=await VBe.get("https://ipfs.io/api/v0/dns",{searchParams:s}),u=new URL(c.url).search.slice(1),l=await c.json();return E4.set(u,l,zBe),l});return Jj(a)})(r,e)});var iV=y((xRt,rV)=>{f();"use strict";var $Be=tV(),GBe=Oe();function WBe(r){return r.endsWith(".eth")&&(r=r.replace(/.eth$/,".eth.link")),r}rV.exports=()=>GBe(async(e,t={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=WBe(e),$Be(e,t)})});var sV=y((ARt,nV)=>{f();"use strict";nV.exports=({network:r})=>()=>{let e=r.try();return e!=null&&Boolean(e.libp2p.isStarted())}});var cV=y((IRt,aV)=>{f();"use strict";var oV=sp(),{CID:S4}=(Ie(),De),YBe=rt(),XBe=Oe(),{resolve:QBe}=Ki();aV.exports=({repo:r,codecs:e,bases:t,name:i})=>{async function n(s,o={}){if(!oV.path(s))throw new Error("invalid argument "+s);if(oV.ipnsPath(s))for await(let E of i.resolve(s,o))s=E;let[,a,c,...u]=s.split("/"),l=o.cidBase?await t.getBase(o.cidBase):void 0,d=ZBe(c);if(u.length===0){let E=l?l.encoder.encode(d):c;return`/${a}/${E}`}let h=S4.decode(d);s=u.join("/");let p=QBe(h,s,e,r,o),g=h,b=s;for await(let E of p)E.value instanceof S4&&(g=E.value,b=E.remainderPath);return`/ipfs/${g.toString(l&&l.encoder)}${b?"/"+b:""}`}return XBe(n)};function ZBe(r){try{return YBe.parse(r).toBytes()}catch{return S4.parse(r).bytes}}});var rs=y((TRt,uV)=>{f();"use strict";var JBe=async r=>{let e;for await(let t of r)e=t;return e};uV.exports=JBe});var fV=y((RRt,lV)=>{f();"use strict";var eMe=rs(),{CID:tMe}=(Ie(),De);lV.exports=({addAll:r})=>(e,t={})=>{let i;return e instanceof tMe?i=r([{cid:e,...t}],t):i=r([{path:e.toString(),...t}],t),eMe(i)}});var _p=y((CRt,dV)=>{f();"use strict";var mm=ae(),{CID:x4}=(Ie(),De);async function*rMe(r){if(r==null)throw mm(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT");if(r instanceof x4){yield Vo({cid:r});return}if(r instanceof String||typeof r=="string"){yield Vo({path:r});return}if(r.cid!=null||r.path!=null)return yield Vo(r);if(Symbol.iterator in r){let e=r[Symbol.iterator](),t=e.next();if(t.done)return e;if(t.value instanceof x4||t.value instanceof String||typeof t.value=="string"){yield Vo({cid:t.value});for(let i of e)yield Vo({cid:i});return}if(t.value.cid!=null||t.value.path!=null){yield Vo(t.value);for(let i of e)yield Vo(i);return}throw mm(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in r){let e=r[Symbol.asyncIterator](),t=await e.next();if(t.done)return e;if(t.value instanceof x4||t.value instanceof String||typeof t.value=="string"){yield Vo({cid:t.value});for await(let i of e)yield Vo({cid:i});return}if(t.value.cid!=null||t.value.path!=null){yield Vo(t.value);for await(let i of e)yield Vo(i);return}throw mm(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}throw mm(new Error("Unexpected input: "+typeof r),"ERR_UNEXPECTED_INPUT")}function Vo(r){let e=r.cid||`${r.path}`;if(!e)throw mm(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let t={path:e,recursive:r.recursive!==!1};return r.metadata!=null&&(t.metadata=r.metadata),t}dV.exports={normaliseInput:rMe}});var A4=y((PRt,hV)=>{f();hV.exports=iMe;function iMe(r,e,t){if(!r)return t;var i,n;if(Array.isArray(e)&&(i=e.slice(0)),typeof e=="string"&&(i=e.split(".")),typeof e=="symbol"&&(i=[e]),!Array.isArray(i))throw new Error("props arg must be an array, a string or a symbol");for(;i.length;)if(n=i.shift(),!r||(r=r[n],r===void 0))return t;return r}});var I4=y((ORt,pV)=>{f();"use strict";var nMe=async r=>{let e=0;for await(let t of r)e++;return e};pV.exports=nMe});var wV=y((kRt,vV)=>{f();"use strict";var{CID:yV}=(Ie(),De),gV=Ut().Key,sMe=be()("ipfs:repo:migrator:migration-8"),oMe=I4(),{base32:g_}=(sn(),nn),aMe=(Ls(),Po),cMe=(Cn(),Wn);function mV(r){return r.child?mV(r.child):r}function uMe(r){try{let e=g_.decode(`b${r.toString().toLowerCase().slice(1)}`),t=yV.decode(e).multihash.bytes,i=g_.encode(t).slice(1).toUpperCase();return new gV(`/${i}`,!1)}catch(e){return r}}function lMe(r){try{let e=g_.decode(`b${r.toString().toLowerCase().slice(1)}`),t=cMe.decode(e),i=g_.encode(yV.createV1(aMe.code,t).bytes).slice(1);return new gV(`/${i.toUpperCase()}`,!1)}catch{return r}}async function bV(r,e,t){let i=r.blocks;await i.open();let n=mV(i),s=await oMe(n.queryKeys({filters:[o=>t(o).toString()!==o.toString()]}));try{let o=0;for await(let a of n.query({})){let c=t(a.key);c.toString()!==a.key.toString()&&(o+=1,sMe(`Migrating Block from ${a.key} to ${c}`,await n.has(a.key)),await n.delete(a.key),await n.put(c,a.value),e(o/s*100,`Migrated Block from ${a.key} to ${c}`))}}finally{await i.close()}}vV.exports={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(r,e=()=>{})=>bV(r,e,uMe),revert:(r,e=()=>{})=>bV(r,e,lMe)}});var SV=y((NRt,EV)=>{f();"use strict";var Ep=ki(),_V=Ep.Reader,fMe=Ep.Writer,qRt=Ep.util,bm=Ep.roots.default||(Ep.roots.default={});bm.ipfs=function(){var r={};return r.pin=function(){var e={};return e.Set=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.version=0,t.prototype.fanout=0,t.prototype.seed=0,t.encode=function(n,s){return s||(s=fMe.create()),n.version!=null&&Object.hasOwnProperty.call(n,"version")&&s.uint32(8).uint32(n.version),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&s.uint32(16).uint32(n.fanout),n.seed!=null&&Object.hasOwnProperty.call(n,"seed")&&s.uint32(29).fixed32(n.seed),s},t.decode=function(n,s){n instanceof _V||(n=_V.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new bm.ipfs.pin.Set;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.version=n.uint32();break;case 2:a.fanout=n.uint32();break;case 3:a.seed=n.fixed32();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof bm.ipfs.pin.Set)return n;var s=new bm.ipfs.pin.Set;return n.version!=null&&(s.version=n.version>>>0),n.fanout!=null&&(s.fanout=n.fanout>>>0),n.seed!=null&&(s.seed=n.seed>>>0),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(o.version=0,o.fanout=0,o.seed=0),n.version!=null&&n.hasOwnProperty("version")&&(o.version=n.version),n.fanout!=null&&n.hasOwnProperty("fanout")&&(o.fanout=n.fanout),n.seed!=null&&n.hasOwnProperty("seed")&&(o.seed=n.seed),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ep.util.toJSONOptions)},t}(),e}(),r}();EV.exports=bm});var AV=y((DRt,xV)=>{f();T4.BASE=2166136261;function T4(r){for(var e=T4.BASE,t=0,i=r.length;t<i;t++)e^=r.charCodeAt(t),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}xV.exports=T4});var R4=y((BRt,TV)=>{f();"use strict";var{Key:IV}=Ut(),{base32:dMe}=(sn(),nn),{CID:hMe}=(jc(),Rh),pMe=new IV("/local/pins"),yMe=256,gMe=8192,mMe=hMe.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),bMe={direct:"direct",recursive:"recursive"};function vMe(r){return new IV(`/${dMe.encode(r.multihash.bytes).toUpperCase().substring(1)}`)}TV.exports={PIN_DS_KEY:pMe,DEFAULT_FANOUT:yMe,MAX_ITEMS:gMe,EMPTY_KEY:mMe,PinTypes:bMe,cidToKey:vMe}});var RV={};ut(RV,{compare:()=>wMe});function wMe(r,e){for(let t=0;t<r.byteLength;t++){if(r[t]<e[t])return-1;if(r[t]>e[t])return 1}return r.byteLength>e.byteLength?1:r.byteLength<e.byteLength?-1:0}var CV=xe(()=>{f()});var DV=y((MRt,NV)=>{f();"use strict";var{CID:PV}=(Ie(),De),{ipfs:{pin:{Set:C4}}}=SV(),_Me=AV(),P4=ys(),m_=(_t(),Mt),{DEFAULT_FANOUT:O4,MAX_ITEMS:EMe,EMPTY_KEY:OV}=R4(),{concat:k4}=(cn(),an),{compare:SMe}=(CV(),RV),{toString:xMe}=(tt(),et),{fromString:AMe}=(ft(),ht),{sha256:kV}=(ri(),li);function IMe(r){let e=r.Data;if(!e)throw new Error("No data present");let t=P4.decode(e),i=P4.decode.bytes;if(i<=0)throw new Error("Invalid Set header length");if(i+t>e.length)throw new Error("Impossibly large set header length");let n=e.slice(i,t+i),s=C4.toObject(C4.decode(n),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(s.version!==1)throw new Error(`Unsupported Set version: ${s.version}`);if(s.fanout>r.Links.length)throw new Error("Impossibly large fanout");return{header:s,data:e.slice(t+i)}}function TMe(r,e){let t=new Uint8Array(4);new DataView(t.buffer).setUint32(0,r,!0);let n=AMe(e.toString()),s=k4([t,n],t.byteLength+n.byteLength);return _Me(xMe(s))}async function*qV(r,e){let t=IMe(e),i=0;for(let n of e.Links){if(i<t.header.fanout){let s=n.Hash;if(!OV.equals(s)){let o=await r.get(s),a=m_.decode(o);yield*qV(r,a)}}else yield n.Hash;i++}}async function*RMe(r,e,t){let i=e.Links.find(o=>o.Name===t);if(!i)throw new Error("No link found with name "+t);let n=await r.get(i.Hash),s=m_.decode(n);yield*qV(r,s)}function CMe(r,e){return t(e,0);async function t(i,n){let s=C4.encode({version:1,fanout:O4,seed:n}).finish(),o=P4.encode(s.length),a=k4([o,s]),c=[];for(let l=0;l<O4;l++)c.push({Name:"",Tsize:1,Hash:OV});if(i.length<=EMe){let l=i.map(p=>({link:{Name:"",Tsize:1,Hash:p.key},data:p.data||new Uint8Array})).sort((p,g)=>SMe(p.link.Hash.bytes,g.link.Hash.bytes)),d=c.concat(l.map(p=>p.link));return{Data:k4([a,...l.map(p=>p.data)]),Links:d}}else{let l=i.reduce((h,p)=>{let g=TMe(n,p.key)%O4;return h[g]=g in h?h[g].concat([p]):[p],h},[]),d=0;for(let h of l){let p=await t(h,n+1);await u(p,d),d++}return{Data:a,Links:c}}async function u(l,d){let h=m_.encode(l),p=await kV.digest(h),g=PV.createV0(p);await r.put(g,h);let b=l.Links.reduce((E,v)=>E+(v.Tsize||0),0)+h.length;c[d]={Name:"",Tsize:b,Hash:g}}}}async function PMe(r,e,t){let i=await CMe(r,t.map(c=>({key:c}))),n=m_.encode(i),s=await kV.digest(n),o=PV.createV0(s);await r.put(o,n);let a=i.Links.reduce((c,u)=>c+u.Tsize,0)+n.length;return{Name:e,Tsize:a,Hash:o}}NV.exports={loadSet:RMe,storeSet:PMe}});var UV=y((LRt,LV)=>{f();"use strict";var{CID:q4}=(Ie(),De),vm=(_t(),Mt),N4=(tm(),u_),Sp=DV(),{cidToKey:BV,PIN_DS_KEY:b_,PinTypes:xp}=R4(),D4=I4(),{sha256:OMe}=(ri(),li),kMe=(Cn(),Wn),{base32:qMe}=(sn(),nn);async function NMe(r,e,t,i){if(!await e.has(b_))return;let n=await e.get(b_),s=q4.decode(n),o=await r.get(s),a=vm.decode(o),c=0,u=await D4(Sp.loadSet(r,a,xp.recursive))+await D4(Sp.loadSet(r,a,xp.direct));for await(let l of Sp.loadSet(r,a,xp.recursive)){c++;let d={depth:1/0};l.version!==0&&(d.version=l.version),l.code!==vm.code&&(d.codec=l.code),await t.put(BV(l),N4.encode(d)),i(c/u*100,`Migrated recursive pin ${l}`)}for await(let l of Sp.loadSet(r,a,xp.direct)){c++;let d={depth:0};l.version!==0&&(d.version=l.version),l.code!==vm.code&&(d.codec=l.code),await t.put(BV(l),N4.encode(d)),i(c/u*100,`Migrated direct pin ${l}`)}await r.delete(s),await e.delete(b_)}async function DMe(r,e,t,i){let n=[],s=[],o=0,a=await D4(t.queryKeys({}));for await(let{key:h,value:p}of t.query({})){o++;let g=N4.decode(p),b=q4.create(g.version||0,g.codec||vm.code,kMe.decode(qMe.decode("b"+h.toString().toLowerCase().split("/").pop())));g.depth===0?(i(o/a*100,`Reverted direct pin ${b}`),s.push(b)):(i(o/a*100,`Reverted recursive pin ${b}`),n.push(b))}i(100,"Updating pin root");let c={Links:[await Sp.storeSet(r,xp.direct,s),await Sp.storeSet(r,xp.recursive,n)]},u=vm.encode(c),l=await OMe.digest(u),d=q4.createV0(l);await r.put(d,u),await e.put(b_,d.bytes)}async function MV(r,e,t){let i=r.blocks,n=r.datastore,s=r.pins;await i.open(),await n.open(),await s.open();try{await t(i,n,s,e)}finally{await s.close(),await n.close(),await i.close()}}LV.exports={version:9,description:"Migrates pins to datastore",migrate:(r,e=()=>{})=>MV(r,e,NMe),revert:(r,e=()=>{})=>MV(r,e,DMe)}});var Ff=y((URt,zV)=>{f();"use strict";var{Key:FV,Errors:KV}=Ut(),BMe=new FV("/config"),MMe=new FV("/version");function B4(r){let e=r;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function jV(r,e,t){let i=await e(r);if(i)return i;let n=B4(t);return n?new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{s(Boolean(a.result))}}):!1}async function VV(r,e,t,i){if(await t(r))return e(r);let n=B4(i);if(!n)throw KV.notFoundError();return new Promise((s,o)=>{let a=n.store("readonly").get(r.toString());a.transaction.onabort=()=>{o(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return s(a.result);o(KV.notFoundError())}})}function v_(r){let e=r.get.bind(r),t=r.has.bind(r);return r.get=i=>VV(i,e,t,r),r.has=i=>jV(i,t,r),r}function LMe(r){return{...r,root:v_(r.root),datastore:v_(r.datastore),pins:v_(r.pins),keys:v_(r.keys)}}zV.exports={wrapBackends:LMe,hasWithFallback:jV,getWithFallback:VV,findLevelJs:B4,CONFIG_KEY:BMe,VERSION_KEY:MMe}});var XV=y((FRt,YV)=>{f();"use strict";var{findLevelJs:HV}=Ff(),{fromString:UMe}=(ft(),ht),{toString:FMe}=(tt(),et);async function KMe(r,e,t=()=>{}){let i=HV(e);if(!i){t(`${r} did not need an upgrade`);return}t(`Upgrading ${r}`),await WV(i,(s,o)=>[{type:"del",key:s},{type:"put",key:UMe(s),value:o}])}async function jMe(r,e,t=()=>{}){let i=HV(e);if(!i){t(`${r} did not need a downgrade`);return}t(`Downgrading ${r}`),await WV(i,(s,o)=>[{type:"del",key:s},{type:"put",key:FMe(s),value:o}])}function $V(r){return r.child?$V(r.child):r}async function GV(r,e,t){let i=Object.entries(r).map(([o,a])=>({key:o,backend:$V(a)})).filter(({key:o,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:o,backend:a})=>({name:o,store:a}));e(0,`Migrating ${i.length} dbs`);let n=0,s=o=>{e(Math.round(n/i.length*100),o)};for(let{name:o,store:a}of i){await a.open();try{await t(o,a,s)}finally{n++,await a.close()}}e(100,`Migrated ${i.length} dbs`)}YV.exports={version:10,description:"Migrates datastore-level keys to binary",migrate:(r,e=()=>{})=>GV(r,e,KMe),revert:(r,e=()=>{})=>GV(r,e,jMe)};function WV(r,e){function t(i,n){let s=r.store("readwrite"),o=s.transaction,a=0,c;o.onabort=()=>n(c||o.error||new Error("aborted by user")),o.oncomplete=()=>n();function u(){let l=i[a++],d=l.key,h;try{h=l.type==="del"?s.delete(d):s.put(l.value,d)}catch(p){c=p,o.abort();return}a<i.length&&(h.onsuccess=u)}u()}return new Promise((i,n)=>{let s=r.iterator(),o=c=>c;s._deserializeKey=s._deserializeValue=o,a();function a(){let c=(u,l,d)=>{if(u||l===void 0){let h=p=>{if(p){n(p);return}i()};s.end(h);return}t(e(l,d),a)};s.next(c)}})}});var ZV=y((KRt,QV)=>{f();"use strict";var{Key:VMe}=Ut(),Ap=new VMe("/local/filesroot");async function zMe(r,e=()=>{}){e(100,"Migrating MFS root to repo datastore"),await r.root.open(),await r.datastore.open();let t=await r.root.get(Ap);await r.datastore.put(Ap,t),await r.root.delete(Ap),await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo datastore")}async function HMe(r,e=()=>{}){e(100,"Migrating MFS root to repo root datastore"),await r.root.open(),await r.datastore.open();let t=await r.datastore.get(Ap);await r.root.put(Ap,t),await r.datastore.delete(Ap),await r.datastore.close(),await r.root.close(),e(100,"Stored MFS root in repo root datastore")}QV.exports={version:11,description:"Store mfs root in the datastore",migrate:zMe,revert:HMe}});var ez=y((jRt,JV)=>{f();"use strict";var Kf={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};JV.exports=[Object.assign({version:1},Kf),Object.assign({version:2},Kf),Object.assign({version:3},Kf),Object.assign({version:4},Kf),Object.assign({version:5},Kf),Object.assign({version:6},Kf),Object.assign({version:7},Kf),wV(),UV(),XV(),ZV()]});var w_=y((VRt,tz)=>{f();"use strict";var M4=class extends Error{constructor(e){super(e);this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=e}};M4.code="ERR_NON_REVERSIBLE_MIGRATION";var L4=class extends Error{constructor(e){super(e);this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=e}};L4.code="ERR_NOT_INITIALIZED_REPO";var U4=class extends Error{constructor(e){super(e);this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=e}};U4.code="ERR_REQUIRED_PARAMETER";var F4=class extends Error{constructor(e){super(e);this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=e}};F4.code="ERR_INVALID_VALUE";var K4=class extends Error{constructor(e){super(e);this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=e}};K4.code="ERR_MISSING_REPO_OPTIONS";tz.exports={NonReversibleMigrationError:M4,NotInitializedRepoError:L4,RequiredParameterError:U4,InvalidValueError:F4,MissingRepoOptionsError:K4}});var iz=y((zRt,rz)=>{f();"use strict";var j4=be()("ipfs:repo:migrator:repo:init"),{CONFIG_KEY:$Me,VERSION_KEY:GMe}=Ff(),{MissingRepoOptionsError:WMe}=w_();async function YMe(r){if(!r)throw new WMe("Please pass repo options when trying to open a repo");let e=r.root;try{await e.open();let t=await e.has(GMe),i=await e.has($Me);return!t||!i?(j4(`Version entry present: ${t}`),j4(`Config entry present: ${i}`),!1):!0}catch(t){return j4("While checking if repo is initialized error was thrown: "+t.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}rz.exports={isRepoInitialized:YMe}});var oz=y((HRt,sz)=>{f();"use strict";var XMe=iz(),{MissingRepoOptionsError:QMe,NotInitializedRepoError:ZMe}=w_(),{VERSION_KEY:nz}=Ff(),{fromString:JMe}=(ft(),ht),{toString:e7e}=(tt(),et);async function t7e(r){if(!await XMe.isRepoInitialized(r))throw new ZMe("Repo is not initialized!");let e=r.root;await e.open();try{return parseInt(e7e(await e.get(nz)))}finally{await e.close()}}async function r7e(r,e){if(!e)throw new QMe("Please pass repo options when trying to open a repo");let t=e.root;await t.open(),await t.put(nz,JMe(String(r))),await t.close()}sz.exports={getVersion:t7e,setVersion:r7e}});var fz=y(($Rt,lz)=>{f();"use strict";var V4=ez(),jf=oz(),Ss=w_(),{wrapBackends:az}=Ff(),zo=be()("ipfs:repo:migrator");function cz(r){return r=r||V4,!Array.isArray(r)||r.length===0?0:r[r.length-1].version}async function i7e(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||V4,!r)throw new Ss.RequiredParameterError("Path argument is required!");if(!t)throw new Ss.RequiredParameterError("repoOptions argument is required!");if(!i)throw new Ss.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(i)||i<=0)throw new Ss.InvalidValueError("Version has to be positive integer!");e=az(e);let c=await jf.getVersion(e);if(c===i){zo("Nothing to migrate.");return}if(c>i)throw new Ss.InvalidValueError(`Current repo's version (${c}) is higher then toVersion (${i}), you probably wanted to revert it?`);uz(a,c,i);let u;!o&&!n&&(u=await t.repoLock.lock(r));try{for(let l of a){if(i!==void 0&&l.version>i)break;if(!(l.version<=c)){zo(`Migrating version ${l.version}`);try{if(!o){let d=()=>{};s&&(d=(h,p)=>s(l.version,h.toFixed(2),p)),await l.migrate(e,d)}}catch(d){let h=l.version-1;throw zo(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${h}`),await jf.setVersion(h,e),new Error(`During migration to version ${l.version} exception was raised: ${d.stack||d.message||d}`)}zo(`Migrating to version ${l.version} finished`)}}o||await jf.setVersion(i||cz(a),e),zo("Repo successfully migrated",i!==void 0?`to version ${i}!`:"to latest version!")}finally{!o&&!n&&u&&await u.close()}}async function n7e(r,e,t,i,{ignoreLock:n=!1,onProgress:s,isDryRun:o=!1,migrations:a}){if(a=a||V4,!r)throw new Ss.RequiredParameterError("Path argument is required!");if(!t)throw new Ss.RequiredParameterError("repoOptions argument is required!");if(!i)throw new Ss.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(i)||i<=0)throw new Ss.InvalidValueError("Version has to be positive integer!");e=az(e);let c=await jf.getVersion(e);if(c===i){zo("Nothing to revert.");return}if(c<i)throw new Ss.InvalidValueError(`Current repo's version (${c}) is lower then toVersion (${i}), you probably wanted to migrate it?`);uz(a,i,c,!0);let u;!o&&!n&&(u=await t.repoLock.lock(r)),zo(`Reverting from version ${c} to ${i}`);try{let l=a.slice().reverse();for(let d of l){if(d.version<=i)break;if(!(d.version>c)){zo(`Reverting migration version ${d.version}`);try{if(!o){let h=()=>{};s&&(h=(p,g)=>s(d.version,p.toFixed(2),g)),await d.revert(e,h)}}catch(h){let p=d.version;throw zo(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${p}`),await jf.setVersion(p,e),h.message=`During reversion to version ${d.version} exception was raised: ${h.message}`,h}zo(`Reverting to version ${d.version} finished`)}}o||await jf.setVersion(i,e),zo(`All migrations successfully reverted to version ${i}!`)}finally{!o&&!n&&u&&await u.close()}}function uz(r,e,t,i=!1){let n=0;for(let s of r){if(s.version>t)break;if(s.version>e){if(i&&!s.revert)throw new Ss.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${s.version} is not reversible. Cancelling reversion.`);n++}}if(n!==t-e)throw new Ss.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${t}`)}lz.exports={getCurrentRepoVersion:jf.getVersion,getLatestMigrationVersion:cz,errors:Ss,migrate:i7e,revert:n7e}});var pz=y((GRt,__)=>{f();"use strict";__.exports=c7e;__.exports.format=dz;__.exports.parse=hz;var s7e=/\B(?=(\d{3})+(?!\d))/g,o7e=/(?:\.0*|(\.[^0]+)0+)$/,ll={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},a7e=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function c7e(r,e){return typeof r=="string"?hz(r):typeof r=="number"?dz(r,e):null}function dz(r,e){if(!Number.isFinite(r))return null;var t=Math.abs(r),i=e&&e.thousandsSeparator||"",n=e&&e.unitSeparator||"",s=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,o=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!ll[a.toLowerCase()])&&(t>=ll.pb?a="PB":t>=ll.tb?a="TB":t>=ll.gb?a="GB":t>=ll.mb?a="MB":t>=ll.kb?a="KB":a="B");var c=r/ll[a.toLowerCase()],u=c.toFixed(s);return o||(u=u.replace(o7e,"$1")),i&&(u=u.replace(s7e,i)),u+n+a}function hz(r){if(typeof r=="number"&&!isNaN(r))return r;if(typeof r!="string")return null;var e=a7e.exec(r),t,i="b";return e?(t=parseFloat(e[1]),i=e[4].toLowerCase()):(t=parseInt(r,10),i="b"),Math.floor(ll[i]*t)}});var gz=y((WRt,yz)=>{f();"use strict";yz.exports={repoVersion:10}});var bz=y((YRt,mz)=>{f();"use strict";var u7e=Ut().Key,l7e=be(),f7e=l7e("ipfs:repo:version"),{toString:d7e}=(tt(),et),{fromString:h7e}=(ft(),ht),{hasWithFallback:p7e,getWithFallback:y7e}=Ff(),z4=new u7e("version");mz.exports=r=>({async exists(){return p7e(z4,r.has.bind(r),r)},async get(){let e=await y7e(z4,r.get.bind(r),r.has.bind(r),r);return parseInt(d7e(e),10)},set(e){return r.put(z4,h7e(String(e)))},async check(e){let t=await this.get();return f7e("comparing version: %s and %s",t,e),t===e||(t===6&&e===7||e===6&&t===7)}})});var wz=y((XRt,H4)=>{f();"use strict";var g7e=Object.prototype.hasOwnProperty,Nn="~";function wm(){}Object.create&&(wm.prototype=Object.create(null),new wm().__proto__||(Nn=!1));function m7e(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function vz(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new m7e(t,i||r,n),o=Nn?Nn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function E_(r,e){--r._eventsCount==0?r._events=new wm:delete r._events[e]}function pn(){this._events=new wm,this._eventsCount=0}pn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)g7e.call(t,i)&&e.push(Nn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};pn.prototype.listeners=function(e){var t=Nn?Nn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};pn.prototype.listenerCount=function(e){var t=Nn?Nn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};pn.prototype.emit=function(e,t,i,n,s,o){var a=Nn?Nn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};pn.prototype.on=function(e,t,i){return vz(this,e,t,i,!1)};pn.prototype.once=function(e,t,i){return vz(this,e,t,i,!0)};pn.prototype.removeListener=function(e,t,i,n){var s=Nn?Nn+e:e;if(!this._events[s])return this;if(!t)return E_(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&E_(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:E_(this,s)}return this};pn.prototype.removeAllListeners=function(e){var t;return e?(t=Nn?Nn+e:e,this._events[t]&&E_(this,t)):(this._events=new wm,this._eventsCount=0),this};pn.prototype.off=pn.prototype.removeListener;pn.prototype.addListener=pn.prototype.on;pn.prefixed=Nn;pn.EventEmitter=pn;typeof H4!="undefined"&&(H4.exports=pn)});var Ez=y((QRt,S_)=>{f();"use strict";var b7e=Uf(),$4=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},_z=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new $4(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);b7e(r.then(i,n),()=>{clearTimeout(s)})});S_.exports=_z;S_.exports.default=_z;S_.exports.TimeoutError=$4});var Sz=y(G4=>{f();"use strict";Object.defineProperty(G4,"__esModule",{value:!0});function v7e(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}G4.default=v7e});var Az=y(W4=>{f();"use strict";Object.defineProperty(W4,"__esModule",{value:!0});var w7e=Sz(),xz=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=w7e.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};W4.default=xz});var Rz=y(Y4=>{f();"use strict";Object.defineProperty(Y4,"__esModule",{value:!0});var _7e=wz(),Iz=Ez(),E7e=Az(),x_=()=>{},S7e=new Iz.TimeoutError,Tz=class extends _7e{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=x_,this._resolveIdle=x_,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:E7e.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=x_,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=x_,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():Iz.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(S7e)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};Y4.default=Tz});var X4=y((t8t,Pz)=>{f();Pz.exports=x7e;function x7e(r,e,t){typeof e=="string"&&(e=e.split(".")),typeof e=="symbol"&&(e=[e]);var i=e.pop();if(!i)return!1;Cz(i);for(var n;n=e.shift();)if(Cz(n),typeof r[n]=="undefined"&&(r[n]={}),r=r[n],!r||typeof r!="object")return!1;return r[i]=t,!0}function Cz(r){if(r==="__proto__"||r==="constructor"||r==="prototype")throw new Error("setting of prototype values not supported")}});var A_=y(Vf=>{f();"use strict";var _m=class extends Error{constructor(e){super(e);this.name="LockExistsError",this.code=_m.code}};_m.code="ERR_LOCK_EXISTS";Vf.LockExistsError=_m;var Em=class extends Error{constructor(e){super(e);this.name="NotFoundError",this.code=Em.code}};Em.code="ERR_NOT_FOUND";Vf.NotFoundError=Em;var Sm=class extends Error{constructor(e){super(e);this.name="InvalidRepoVersionError",this.code=Sm.code}};Sm.code="ERR_INVALID_REPO_VERSION";Vf.InvalidRepoVersionError=Sm;Vf.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED";Vf.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN";Vf.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED"});var qz=y((i8t,kz)=>{f();"use strict";var{Key:A7e}=Ut(),{default:I7e}=Rz(),T7e=A4(),R7e=X4(),Q4=ae(),Oz=A_(),{toString:C7e}=(tt(),et),{fromString:P7e}=(ft(),ht),{hasWithFallback:O7e,getWithFallback:k7e}=Ff(),Z4=new A7e("config");kz.exports=r=>{let e=new I7e({concurrency:1}),t={async getAll(s={}){let o=await k7e(Z4,r.get.bind(r),r.has.bind(r),r,{signal:s.signal});return JSON.parse(C7e(o))},async get(s,o={}){if(s==null)throw new Oz.NotFoundError(`Key ${s} does not exist in config`);let a=await this.getAll(o),c=T7e(a,s);if(c===void 0)throw new Oz.NotFoundError(`Key ${s} does not exist in config`);return c},set(s,o,a={}){if(typeof s!="string"&&!(s instanceof String))throw Q4(new Error("Invalid key type: "+typeof s),"ERR_INVALID_KEY");if(o===void 0||o instanceof Uint8Array)throw Q4(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>i({key:s,value:o},a.signal))},replace(s,o={}){if(!s||s instanceof Uint8Array)throw Q4(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>i({key:void 0,value:s},o.signal))},async exists(){return O7e(Z4,r.has.bind(r),r)}};return t;async function i(s,o){if(o&&o.aborted)return;let a=s.key,c=s.value;if(a){let u=await t.getAll();return typeof u=="object"&&u!==null&&R7e(u,a,c),n(u)}return n(c)}function n(s){let o=P7e(JSON.stringify(s,null,2));return r.put(Z4,o)}}});var Dz=y((n8t,Nz)=>{f();"use strict";Nz.exports=r=>{if(Object.prototype.toString.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.prototype}});var Mz=y((s8t,Bz)=>{f();"use strict";var J4=Dz();Bz.exports=(r,e={})=>{if(!J4(r)&&!Array.isArray(r))throw new TypeError("Expected a plain object or array");let{deep:t}=e,i=[],n=[],s=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u=[];return i.push(a),n.push(u),u.push(...a.map(l=>Array.isArray(l)?s(l):J4(l)?o(l):l)),u},o=a=>{let c=i.indexOf(a);if(c!==-1)return n[c];let u={},l=Object.keys(a).sort(e.compare);i.push(a),n.push(u);for(let d of l){let h=a[d],p;t&&Array.isArray(h)?p=s(h):p=t&&J4(h)?o(h):h,Object.defineProperty(u,d,{...Object.getOwnPropertyDescriptor(a,d),value:p})}return u};return Array.isArray(r)?t?s(r):r.slice():o(r)}});var Uz=y((o8t,Lz)=>{f();"use strict";var q7e=Ut().Key,N7e=Mz(),{toString:D7e}=(tt(),et),{fromString:B7e}=(ft(),ht),eT=new q7e("datastore_spec");Lz.exports=r=>({exists(){return r.has(eT)},async get(){let e=await r.get(eT);return JSON.parse(D7e(e))},async set(e){return r.put(eT,B7e(JSON.stringify(N7e(e,{deep:!0}))))}})});var Kz=y((a8t,Fz)=>{f();"use strict";var M7e=Ut().Key,{fromString:L7e}=(ft(),ht),tT=new M7e("api");Fz.exports=r=>({async get(){let e=await r.get(tT);return e&&e.toString()},set(e){return r.put(tT,L7e(e.toString()))},delete(){return r.delete(tT)}})});var Vz=y((u8t,jz)=>{f();jz.exports=class{constructor(e){if(!(e>0)||(e-1&e)!=0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}}});var rT=y((f8t,Hz)=>{f();var zz=Vz();Hz.exports=class{constructor(e){this.hwm=e||16,this.head=new zz(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let t=this.head;this.head=t.next=new zz(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}}});var Qa=y((d8t,$z)=>{f();var iT=rT();$z.exports=r=>{r=r||{};let e;typeof r=="function"?(e=r,r={}):e=r.onEnd;let t=new iT,i,n,s,o=()=>{if(!t.isEmpty()){if(r.writev){let b,E=[];for(;!t.isEmpty();){if(b=t.shift(),b.error)throw b.error;E.push(b.value)}return{done:b.done,value:E}}let g=t.shift();if(g.error)throw g.error;return g}return s?{done:!0}:new Promise((g,b)=>{n=E=>(n=null,E.error?b(E.error):r.writev&&!E.done?g({done:E.done,value:[E.value]}):g(E),i)})},a=g=>n?n(g):(t.push(g),i),c=g=>(t=new iT,n?n({error:g}):(t.push({error:g}),i)),u=g=>s?i:a({done:!1,value:g}),l=g=>s?i:(s=!0,g?c(g):a({done:!0})),d=()=>(t=new iT,l(),{done:!0}),h=g=>(l(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:d,throw:h,push:u,end:l},!e)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(g){return p.throw(g),e&&(e(g),e=null),{done:!0}},return(){return p.return(),e&&(e(),e=null),{done:!0}},push:u,end(g){return p.end(g),e&&(e(g),e=null),i}},i}});var Wz=y((h8t,Gz)=>{f();"use strict";var U7e=Ya(),F7e=Qa(),K7e=Wa(),{CID:j7e}=(Ie(),De),V7e=ae(),{identity:z7e}=(Fc(),Uc);Gz.exports=H7e;function H7e(r){return{open(){return r.open()},close(){return r.close()},query(e,t){return r.query(e,t)},queryKeys(e,t){return r.queryKeys(e,t)},async get(e,t){let i=fl(e);return i.isIdentity?Promise.resolve(i.digest):r.get(e,t)},async*getMany(e,t){for await(let i of e)yield this.get(i,t)},async put(e,t,i){let{isIdentity:n}=fl(e);n||await r.put(e,t,i)},async*putMany(e,t){let i=F7e();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await K7e(r.putMany(async function*(){for await(let{key:s,value:o}of e)fl(s).isIdentity||(yield{key:s,value:o}),i.push({key:s,value:o})}())),i.end()}catch(s){i.end(s)}}),yield*i},has(e,t){let{isIdentity:i}=fl(e);return i?Promise.resolve(!0):r.has(e,t)},delete(e,t){let{isIdentity:i}=fl(e);return i?Promise.resolve():r.delete(e,t)},deleteMany(e,t){return r.deleteMany(U7e(e,i=>!fl(i).isIdentity),t)},batch(){let e=r.batch();return{put(t,i){let{isIdentity:n}=fl(t);n||e.put(t,i)},delete(t){let{isIdentity:i}=fl(t);i||e.delete(t)},commit:t=>e.commit(t)}}}}function fl(r){let e=j7e.asCID(r);if(e==null)throw V7e(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==z7e.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}});var I_=y(nT=>{f();"use strict";var $7e=A_(),G7e=be(),Yz=G7e("ipfs:repo:lock:memory"),Xz="repo.lock",xm={};nT.lock=async r=>{let e=r+"/"+Xz;if(Yz("locking %s",e),xm[e]===!0)throw new $7e.LockExistsError(`Lock already being held for file: ${e}`);return xm[e]=!0,{async close(){xm[e]&&delete xm[e]}}};nT.locked=async r=>{let e=r+"/"+Xz;return Yz(`checking lock: ${e}`),Boolean(xm[e])}});var Zz=y((y8t,Qz)=>{f();"use strict";Qz.exports={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:I_()}});var eH=y((g8t,Jz)=>{f();"use strict";Jz.exports={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}}});var zf=y((m8t,tH)=>{f();"use strict";var W7e=async r=>{for await(let e of r)return e};tH.exports=W7e});var R_={};ut(R_,{Block:()=>Am,create:()=>Z7e,createUnsafe:()=>rH,decode:()=>Q7e,encode:()=>X7e});var T_,sT,oT,Y7e,Am,X7e,Q7e,rH,Z7e,C_=xe(()=>{f();jc();T_=({enumerable:r=!0,configurable:e=!1}={})=>({enumerable:r,configurable:e,writable:!1}),sT=function*(r,e){if(r!=null&&!(r instanceof Uint8Array))for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=We.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*sT(o,a))}else{let s=We.asCID(i);s?yield[n.join("/"),s]:yield*sT(i,n)}}},oT=function*(r,e){if(r!=null)for(let[t,i]of Object.entries(r)){let n=[...e,t];if(yield n.join("/"),i!=null&&!(i instanceof Uint8Array)&&typeof i=="object"&&!We.asCID(i))if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s];yield a.join("/"),typeof o=="object"&&!We.asCID(o)&&(yield*oT(o,a))}else yield*oT(i,n)}},Y7e=(r,e)=>{let t=r;for(let[i,n]of e.entries()){if(t=t[n],t==null)throw new Error(`Object has no property at ${e.slice(0,i+1).map(o=>`[${JSON.stringify(o)}]`).join("")}`);let s=We.asCID(t);if(s)return{value:s,remaining:e.slice(i+1).join("/")}}return{value:t}},Am=class{constructor({cid:e,bytes:t,value:i}){if(!e||!t||typeof i=="undefined")throw new Error("Missing required argument");this.cid=e,this.bytes=t,this.value=i,this.asBlock=this,Object.defineProperties(this,{cid:T_(),bytes:T_(),value:T_(),asBlock:T_()})}links(){return sT(this.value,[])}tree(){return oT(this.value,[])}get(e="/"){return Y7e(this.value,e.split("/").filter(Boolean))}},X7e=async({value:r,codec:e,hasher:t})=>{if(typeof r=="undefined")throw new Error('Missing required argument "value"');if(!e||!t)throw new Error("Missing required argument: codec or hasher");let i=e.encode(r),n=await t.digest(i),s=We.create(1,e.code,n);return new Am({value:r,bytes:i,cid:s})},Q7e=async({bytes:r,codec:e,hasher:t})=>{if(!r)throw new Error('Missing required argument "bytes"');if(!e||!t)throw new Error("Missing required argument: codec or hasher");let i=e.decode(r),n=await t.digest(r),s=We.create(1,e.code,n);return new Am({value:i,bytes:r,cid:s})},rH=({bytes:r,cid:e,value:t,codec:i})=>{let n=t!==void 0?t:i&&i.decode(r);if(n===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Am({cid:e,bytes:r,value:n})},Z7e=async({bytes:r,cid:e,hasher:t,codec:i})=>{if(!r)throw new Error('Missing required argument "bytes"');if(!t)throw new Error('Missing required argument "hasher"');let n=i.decode(r),s=await t.digest(r);if(!qc.equals(e.multihash.bytes,s.bytes))throw new Error("CID hash does not match bytes");return rH({bytes:r,cid:e,value:n,codec:i})}});var aT=y((v8t,oH)=>{f();"use strict";var{Key:J7e}=Ut(),{CID:iH}=(jc(),Rh),eLe=(Ls(),Po),tLe=ae(),{base32:nH}=(sn(),nn),rLe=(Cn(),Wn);function iLe(r){let e=iH.asCID(r);if(e==null)throw tLe(new Error("Not a valid cid"),"ERR_INVALID_CID");let t=nH.encode(e.multihash.bytes);return new J7e("/"+t.slice(1).toUpperCase(),!1)}function nLe(r){return iH.createV1(eLe.code,sH(r))}function sH(r){return rLe.decode(nH.decode(`b${r.toString().toLowerCase().substring(1)}`))}oH.exports={cidToKey:iLe,keyToCid:nLe,keyToMultihash:sH}});var cT=y((w8t,cH)=>{f();"use strict";var sLe=be()("ipfs:repo:utils:walk-dag"),oLe=(C_(),R_);async function*aH(r,e,t,i){try{let n=await e.get(r,i),s=await t(r.code),o=oLe.createUnsafe({bytes:n,cid:r,codec:s});for(let[,a]of o.links())yield a,yield*aH(a,e,t,i)}catch(n){throw sLe("Could not walk DAG for CID",r.toString(),n),n}}cH.exports=aH});var uT=y((_8t,pH)=>{f();"use strict";var{CID:uH}=(Ie(),De),aLe=ae(),cLe=be(),lH=zf(),uLe=(C_(),R_),dl=(tm(),u_),P_=(_t(),Mt),{cidToKey:O_,keyToMultihash:fH}=aT(),dH=cT();function lLe(r){let e=`Invalid type '${r}', must be one of {direct, indirect, recursive, all}`;return aLe(new Error(e),"ERR_INVALID_PIN_TYPE")}var Xs={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"},hH=class{constructor({pinstore:e,blockstore:t,loadCodec:i}){this.pinstore=e,this.blockstore=t,this.loadCodec=i,this.log=cLe("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,t={}){await this.blockstore.get(e,t);let i={depth:0};return e.version!==0&&(i.version=e.version),e.code!==P_.code&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),this.pinstore.put(O_(e),dl.encode(i))}unpin(e,t){return this.pinstore.delete(O_(e),t)}async pinRecursively(e,t={}){await this.fetchCompleteDag(e,t);let i={depth:1/0};e.version!==0&&(i.version=e.version),e.code!==P_.code&&(i.codec=e.code),t.metadata&&(i.metadata=t.metadata),await this.pinstore.put(O_(e),dl.encode(i))}async*directKeys(e){for await(let t of this.pinstore.query({filters:[i=>dl.decode(i.value).depth===0]})){let i=dl.decode(t.value),n=i.version||0,s=i.codec!=null?i.codec:P_.code,o=fH(t.key);yield{cid:uH.create(n,s,o),metadata:i.metadata}}}async*recursiveKeys(e){for await(let t of this.pinstore.query({filters:[i=>dl.decode(i.value).depth===1/0]})){let i=dl.decode(t.value),n=i.version||0,s=i.codec!=null?i.codec:P_.code,o=fH(t.key);yield{cid:uH.create(n,s,o),metadata:i.metadata}}}async*indirectKeys(e){for await(let{cid:t}of this.recursiveKeys())for await(let i of dH(t,this.blockstore,this.loadCodec,e)){let n=[Xs.recursive];(await this.isPinnedWithType(i,n)).pinned||(yield i)}}async isPinnedWithType(e,t,i){Array.isArray(t)||(t=[t]);let n=t.includes(Xs.all),s=t.includes(Xs.direct),o=t.includes(Xs.recursive),a=t.includes(Xs.indirect);if(o||s||n){let l=await lH(this.pinstore.query({prefix:O_(e).toString(),filters:[d=>{if(n)return!0;let h=dl.decode(d.value);return t.includes(h.depth===0?Xs.direct:Xs.recursive)}],limit:1}));if(l){let d=dl.decode(l.value);return{cid:e,pinned:!0,reason:d.depth===0?Xs.direct:Xs.recursive,metadata:d.metadata}}}let c=this;async function*u(l,d){for await(let{cid:h}of d)for await(let p of dH(h,c.blockstore,c.loadCodec))if(p.equals(l)){yield h;return}}if(n||a){let l=await lH(u(e,this.recursiveKeys()));if(l)return{cid:e,pinned:!0,reason:Xs.indirect,parent:l}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,t){let i=new Set,n=async(s,o)=>{if(i.has(s.toString()))return;i.add(s.toString());let a=await this.blockstore.get(s,o),c=await this.loadCodec(s.code),u=uLe.createUnsafe({bytes:a,cid:s,codec:c});await Promise.all([...u.links()].map(([,l])=>n(l,o)))};await n(e,t)}static checkPinType(e){if(typeof e!="string"||!Object.keys(Xs).includes(e))throw lLe(e);return!0}};pH.exports={PinManager:hH,PinTypes:Xs}});var Ho=y((E8t,yH)=>{f();"use strict";var fLe=async function*(r,e){for await(let t of r)yield e(t)};yH.exports=fLe});var bH=y((S8t,mH)=>{f();"use strict";var dLe=Ho(),hLe=ae(),{PinTypes:pLe}=uT();mH.exports=yLe;function yLe(r,e){return{open(){return e.open()},close(){return e.close()},query(t,i){return e.query(t,i)},queryKeys(t,i){return e.queryKeys(t,i)},async get(t,i){return e.get(t,i)},async*getMany(t,i){yield*e.getMany(t,i)},async put(t,i,n){await e.put(t,i,n)},async*putMany(t,i){yield*e.putMany(t,i)},has(t,i){return e.has(t,i)},async delete(t,i){return await gH(t,r),e.delete(t,i)},deleteMany(t,i){return e.deleteMany(dLe(t,async n=>(await gH(n,r),n)),i)},batch(){return e.batch()}}}async function gH(r,e){let{pinned:t,reason:i}=await e.isPinnedWithType(r,pLe.all);if(t)throw hLe(new Error(`pinned: ${i}`),"ERR_BLOCK_PINNED")}});var yr=y((x8t,lT)=>{f();"use strict";var Ip=typeof Reflect=="object"?Reflect:null,vH=Ip&&typeof Ip.apply=="function"?Ip.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)},k_;Ip&&typeof Ip.ownKeys=="function"?k_=Ip.ownKeys:Object.getOwnPropertySymbols?k_=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:k_=function(e){return Object.getOwnPropertyNames(e)};function gLe(r){console&&console.warn&&console.warn(r)}var wH=Number.isNaN||function(e){return e!==e};function Xt(){Xt.init.call(this)}lT.exports=Xt;lT.exports.once=wLe;Xt.EventEmitter=Xt;Xt.prototype._events=void 0;Xt.prototype._eventsCount=0;Xt.prototype._maxListeners=void 0;var _H=10;function q_(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(Xt,"defaultMaxListeners",{enumerable:!0,get:function(){return _H},set:function(r){if(typeof r!="number"||r<0||wH(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");_H=r}});Xt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Xt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||wH(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function EH(r){return r._maxListeners===void 0?Xt.defaultMaxListeners:r._maxListeners}Xt.prototype.getMaxListeners=function(){return EH(this)};Xt.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n=e==="error",s=this._events;if(s!==void 0)n=n&&s.error===void 0;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")vH(c,this,t);else for(var u=c.length,l=TH(c,u),i=0;i<u;++i)vH(l[i],this,t);return!0};function SH(r,e,t,i){var n,s,o;if(q_(t),s=r._events,s===void 0?(s=r._events=Object.create(null),r._eventsCount=0):(s.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),s=r._events),o=s[e]),o===void 0)o=s[e]=t,++r._eventsCount;else if(typeof o=="function"?o=s[e]=i?[t,o]:[o,t]:i?o.unshift(t):o.push(t),n=EH(r),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=o.length,gLe(a)}return r}Xt.prototype.addListener=function(e,t){return SH(this,e,t,!1)};Xt.prototype.on=Xt.prototype.addListener;Xt.prototype.prependListener=function(e,t){return SH(this,e,t,!0)};function mLe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function xH(r,e,t){var i={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},n=mLe.bind(i);return n.listener=t,i.wrapFn=n,n}Xt.prototype.once=function(e,t){return q_(t),this.on(e,xH(this,e,t)),this};Xt.prototype.prependOnceListener=function(e,t){return q_(t),this.prependListener(e,xH(this,e,t)),this};Xt.prototype.removeListener=function(e,t){var i,n,s,o,a;if(q_(t),n=this._events,n===void 0)return this;if(i=n[e],i===void 0)return this;if(i===t||i.listener===t)--this._eventsCount==0?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if(typeof i!="function"){for(s=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){a=i[o].listener,s=o;break}if(s<0)return this;s===0?i.shift():bLe(i,s),i.length===1&&(n[e]=i[0]),n.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};Xt.prototype.off=Xt.prototype.removeListener;Xt.prototype.removeAllListeners=function(e){var t,i,n;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),o;for(n=0;n<s.length;++n)o=s[n],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=i[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this};function AH(r,e,t){var i=r._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?t?[n.listener||n]:[n]:t?vLe(n):TH(n,n.length)}Xt.prototype.listeners=function(e){return AH(this,e,!0)};Xt.prototype.rawListeners=function(e){return AH(this,e,!1)};Xt.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):IH.call(r,e)};Xt.prototype.listenerCount=IH;function IH(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Xt.prototype.eventNames=function(){return this._eventsCount>0?k_(this._events):[]};function TH(r,e){for(var t=new Array(e),i=0;i<e;++i)t[i]=r[i];return t}function bLe(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function vLe(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function wLe(r,e){return new Promise(function(t,i){function n(o){r.removeListener(e,s),i(o)}function s(){typeof r.removeListener=="function"&&r.removeListener("error",n),t([].slice.call(arguments))}RH(r,e,s,{once:!0}),e!=="error"&&_Le(r,n,{once:!0})})}function _Le(r,e,t){typeof r.on=="function"&&RH(r,"error",e,t)}function RH(r,e,t,i){if(typeof r.on=="function")i.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function n(s){i.once&&r.removeEventListener(e,n),t(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var fT=y((A8t,CH)=>{f();CH.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var PH=y(()=>{f()});var FH=y((R8t,UH)=>{f();var ELe=yr().EventEmitter,{nanoid:SLe}=(um(),cm),{WORKER_REQUEST_READ_LOCK:OH,WORKER_RELEASE_READ_LOCK:kH,MASTER_GRANT_READ_LOCK:qH,WORKER_REQUEST_WRITE_LOCK:NH,WORKER_RELEASE_WRITE_LOCK:DH,MASTER_GRANT_WRITE_LOCK:BH}=fT(),Im,MH=(r,e,t,i,n)=>(s,o)=>{o&&o.type===t&&r.emit(e,o.name,()=>(s.send({type:n,name:o.name,identifier:o.identifier}),new Promise(a=>{let c=u=>{u&&u.type===i&&u.identifier===o.identifier&&(s.removeListener("message",c),a())};s.on("message",c)})))},LH=(r,e,t,i)=>()=>{let n=SLe();return process.send({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{a&&a.type===t&&a.identifier===n&&(process.removeListener("message",o),s(()=>{process.send({type:i,identifier:n,name:r})}))};process.on("message",o)})};UH.exports=r=>{try{if(Im=PH(),!Object.keys(Im).length)return}catch(e){return}if(Im.isMaster||r.singleProcess){let e=new ELe;return Im.on("message",MH(e,"requestReadLock",OH,kH,qH)),Im.on("message",MH(e,"requestWriteLock",NH,DH,BH)),e}return{isWorker:!0,readLock:e=>LH(e,OH,qH,kH),writeLock:e=>LH(e,NH,BH,DH)}}});var dT=y((C8t,KH)=>{f();var hl={},Tp=r=>{r.addEventListener("message",e=>{Tp.dispatchEvent("message",r,e)}),r.port&&r.port.addEventListener("message",e=>{Tp.dispatchEvent("message",r,e)})};Tp.addEventListener=(r,e)=>{hl[r]||(hl[r]=[]),hl[r].push(e)};Tp.removeEventListener=(r,e)=>{!hl[r]||(hl[r]=hl[r].filter(t=>t===e))};Tp.dispatchEvent=function(){let r=Array.prototype.slice.call(arguments),e=r.shift();!hl[e]||hl[e].forEach(t=>t.apply(null,r))};KH.exports=Tp});var ZH=y((P8t,QH)=>{f();var xLe=yr().EventEmitter,{nanoid:ALe}=(um(),cm),{WORKER_REQUEST_READ_LOCK:jH,WORKER_RELEASE_READ_LOCK:VH,MASTER_GRANT_READ_LOCK:zH,WORKER_REQUEST_WRITE_LOCK:HH,WORKER_RELEASE_WRITE_LOCK:$H,MASTER_GRANT_WRITE_LOCK:GH}=fT(),WH=dT(),YH=(r,e,t,i,n)=>(s,o)=>{if(!o||!o.data||o.data.type!==t)return;let a={type:o.data.type,name:o.data.name,identifier:o.data.identifier};r.emit(e,a.name,()=>(s.postMessage({type:n,name:a.name,identifier:a.identifier}),new Promise(c=>{let u=l=>{if(!l||!l.data)return;let d={type:l.data.type,name:l.data.name,identifier:l.data.identifier};d&&d.type===i&&d.identifier===a.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)})))},XH=(r,e,t,i)=>()=>{let n=ALe();return globalThis.postMessage({type:e,identifier:n,name:r}),new Promise(s=>{let o=a=>{if(!a||!a.data)return;let c={type:a.data.type,identifier:a.data.identifier};c&&c.type===t&&c.identifier===n&&(globalThis.removeEventListener("message",o),s(()=>{globalThis.postMessage({type:i,identifier:n,name:r})}))};globalThis.addEventListener("message",o)})},ILe={singleProcess:!1};QH.exports=r=>{if(r=Object.assign({},ILe,r),!!globalThis.document||r.singleProcess){let t=new xLe;return WH.addEventListener("message",YH(t,"requestReadLock",jH,VH,zH)),WH.addEventListener("message",YH(t,"requestWriteLock",HH,$H,GH)),t}return{isWorker:!0,readLock:t=>XH(t,jH,zH,VH),writeLock:t=>XH(t,HH,GH,$H)}}});var e$=y((O8t,hT)=>{f();"use strict";var TLe=Object.prototype.hasOwnProperty,Dn="~";function Tm(){}Object.create&&(Tm.prototype=Object.create(null),new Tm().__proto__||(Dn=!1));function RLe(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function JH(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new RLe(t,i||r,n),o=Dn?Dn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function N_(r,e){--r._eventsCount==0?r._events=new Tm:delete r._events[e]}function yn(){this._events=new Tm,this._eventsCount=0}yn.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)TLe.call(t,i)&&e.push(Dn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};yn.prototype.listeners=function(e){var t=Dn?Dn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};yn.prototype.listenerCount=function(e){var t=Dn?Dn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};yn.prototype.emit=function(e,t,i,n,s,o){var a=Dn?Dn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};yn.prototype.on=function(e,t,i){return JH(this,e,t,i,!1)};yn.prototype.once=function(e,t,i){return JH(this,e,t,i,!0)};yn.prototype.removeListener=function(e,t,i,n){var s=Dn?Dn+e:e;if(!this._events[s])return this;if(!t)return N_(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&N_(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:N_(this,s)}return this};yn.prototype.removeAllListeners=function(e){var t;return e?(t=Dn?Dn+e:e,this._events[t]&&N_(this,t)):(this._events=new Tm,this._eventsCount=0),this};yn.prototype.off=yn.prototype.removeListener;yn.prototype.addListener=yn.prototype.on;yn.prefixed=Dn;yn.EventEmitter=yn;typeof hT!="undefined"&&(hT.exports=yn)});var r$=y((k8t,D_)=>{f();"use strict";var CLe=Uf(),pT=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},t$=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new pT(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);CLe(r.then(i,n),()=>{clearTimeout(s)})});D_.exports=t$;D_.exports.default=t$;D_.exports.TimeoutError=pT});var i$=y(yT=>{f();"use strict";Object.defineProperty(yT,"__esModule",{value:!0});function PLe(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}yT.default=PLe});var s$=y(gT=>{f();"use strict";Object.defineProperty(gT,"__esModule",{value:!0});var OLe=i$(),n$=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=OLe.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};gT.default=n$});var c$=y(mT=>{f();"use strict";Object.defineProperty(mT,"__esModule",{value:!0});var kLe=e$(),o$=r$(),qLe=s$(),B_=()=>{},NLe=new o$.TimeoutError,a$=class extends kLe{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=B_,this._resolveIdle=B_,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:qLe.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=B_,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=B_,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():o$.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(NLe)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};mT.default=a$});var u$=y((M8t,bT)=>{f();"use strict";var M_,B8t=bT.exports.timeout=function(r,e){var t=new M_,i;return Promise.race([r,new Promise(function(n,s){i=setTimeout(function(){s(t)},e)})]).then(function(n){return clearTimeout(i),n},function(n){throw clearTimeout(i),n})};M_=bT.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};M_.prototype=Object.create(Error.prototype);M_.prototype.name="TimeoutError"});var _T=y((L8t,wT)=>{f();var DLe=FH(),BLe=ZH(),{default:l$}=c$(),{timeout:MLe}=u$(),LLe=dT(),Hf={},pl;function vT(r,e){let t,i=new Promise(n=>{t=n});return r.add(()=>MLe((()=>new Promise(n=>{t(()=>{n()})}))(),e.timeout)),i}var ULe=(r,e)=>{if(pl.isWorker)return{readLock:pl.readLock(r,e),writeLock:pl.writeLock(r,e)};let t=new l$({concurrency:1}),i=null;return{readLock:()=>{if(i)return vT(i,e);i=new l$({concurrency:e.concurrency,autoStart:!1});let n=i,s=vT(i,e);return t.add(()=>(n.start(),n.onIdle().then(()=>{i===n&&(i=null)}))),s},writeLock:()=>(i=null,vT(t,e))}},FLe={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};wT.exports=(r,e)=>(e||(e={}),typeof r=="object"&&(e=r,r="lock"),r||(r="lock"),e=Object.assign({},FLe,e),pl||(pl=DLe(e)||BLe(e),pl.isWorker||(pl.on("requestReadLock",(t,i)=>{!Hf[t]||Hf[t].readLock().then(n=>i().finally(()=>n()))}),pl.on("requestWriteLock",async(t,i)=>{!Hf[t]||Hf[t].writeLock().then(n=>i().finally(()=>n()))}))),Hf[r]||(Hf[r]=ULe(r,e)),Hf[r]);wT.exports.Worker=function(r,e){e=e||globalThis.Worker;let t;try{t=new e(r)}catch(i){i.message.includes("not a constructor")&&(t=e(r))}if(!t)throw new Error("Could not create Worker from",e);return LLe(t),t}});var L_=y((U8t,f$)=>{f();"use strict";async function*KLe(r,e=1){let t=[];e<1&&(e=1);for await(let i of r)for(t.push(i);t.length>=e;)yield t.slice(0,e),t=t.slice(e);for(;t.length;)yield t.slice(0,e),t=t.slice(e)}f$.exports=KLe});var U_=y((F8t,d$)=>{f();"use strict";var jLe=L_();async function*VLe(r,e=1){for await(let t of jLe(r,e)){let i=t.map(n=>n().then(s=>({ok:!0,value:s}),s=>({ok:!1,err:s})));for(let n=0;n<i.length;n++){let s=await i[n];if(s.ok)yield s.value;else throw s.err}}}d$.exports=VLe});var Ar=y((K8t,Rp)=>{f();var h$=(...r)=>{let e;for(;r.length;)e=r.shift()(e);return e},ET=r=>r&&(typeof r[Symbol.asyncIterator]=="function"||typeof r[Symbol.iterator]=="function"||typeof r.next=="function"),F_=r=>r&&typeof r.sink=="function"&&ET(r.source),zLe=r=>e=>(r.sink(e),r.source),p$=(...r)=>{if(F_(r[0])){let e=r[0];r[0]=()=>e.source}else if(ET(r[0])){let e=r[0];r[0]=()=>e}if(r.length>1&&F_(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let e=1;e<r.length-1;e++)F_(r[e])&&(r[e]=zLe(r[e]));return h$(...r)};Rp.exports=p$;Rp.exports.pipe=p$;Rp.exports.rawPipe=h$;Rp.exports.isIterable=ET;Rp.exports.isDuplex=F_});var Cp=y((j8t,y$)=>{f();"use strict";var HLe=Qa(),$Le=async function*(...r){let e=HLe();setTimeout(async()=>{try{await Promise.all(r.map(async t=>{for await(let i of t)e.push(i)})),e.end()}catch(t){e.end(t)}},0),yield*e};y$.exports=$Le});var v$=y((V8t,b$)=>{f();"use strict";var{CID:GLe}=(Ie(),De),Rm=be()("ipfs:repo:gc"),{Errors:WLe}=Ut(),YLe=WLe.notFoundError().code,XLe=U_(),{pipe:QLe}=Ar(),g$=Cp(),ST=Ho(),ZLe=Ya(),{Key:JLe}=Ut(),{base32:m$}=(sn(),nn),e9e=cT(),t9e=256,r9e=new JLe("/local/filesroot");b$.exports=({gcLock:r,pins:e,blockstore:t,root:i,loadCodec:n})=>{async function*s(){let o=Date.now();Rm("Creating set of marked blocks");let a=await r.writeLock();try{let c=await i9e({pins:e,blockstore:t,root:i,loadCodec:n}),u=t.queryKeys({});yield*n9e({blockstore:t},c,u),Rm(`Complete (${Date.now()-o}ms)`)}finally{a()}}return s};async function i9e({pins:r,blockstore:e,loadCodec:t,root:i}){let n=async function*(){let a;try{a=await i.get(r9e)}catch(u){if(u.code===YLe){Rm("No blocks in MFS");return}throw u}let c=GLe.decode(a);yield c,yield*e9e(c,e,t)}(),s=g$(ST(r.recursiveKeys(),({cid:a})=>a),r.indirectKeys(),ST(r.directKeys(),({cid:a})=>a),n),o=new Set;for await(let a of g$(s,n))o.add(m$.encode(a.multihash.bytes));return o}async function*n9e({blockstore:r},e,t){let i=0,n=0;yield*QLe(XLe(ST(t,async o=>async function(){i++;try{let c=m$.encode(o.multihash.bytes);if(e.has(c))return null;try{await r.delete(o),n++}catch(u){return{err:new Error(`Could not delete block with CID ${o}: ${u.message}`)}}return{cid:o}}catch(c){let u=`Could delete block with CID ${o}`;return Rm(u,c),{err:new Error(u+`: ${c.message}`)}}}),t9e),o=>ZLe(o,Boolean)),Rm(`Marked set has ${e.size} unique blocks. Blockstore has ${i} blocks. Deleted ${n} blocks.`)}});var $f=y((z8t,A$)=>{f();"use strict";var w$=A4(),s9e=be(),Pp=ae(),_$=fz(),o9e=pz(),a9e=gr(),K_=gz(),c9e=bz(),u9e=qz(),l9e=Uz(),f9e=Kz(),d9e=Wz(),h9e=Zz(),E$=eH(),ru=A_(),{PinManager:p9e,PinTypes:y9e}=uT(),g9e=bH(),m9e=_T(),b9e=v$(),v9e=I_(),w9e=I_(),is=s9e("ipfs:repo"),_9e=Number.MAX_SAFE_INTEGER,E9e="repoAutoMigrate",S$=class{constructor(e,t,i,n){if(typeof e!="string")throw new Error("missing repo path");if(typeof t!="function")throw new Error("missing codec loader");this.options=a9e(h9e,n),this.closed=!0,this.path=e,this.root=i.root,this.datastore=i.datastore,this.keys=i.keys;let s=i.blocks,o=i.pins;this.pins=new p9e({pinstore:o,blockstore:s,loadCodec:t});let a=g9e(this.pins,s);this.blocks=d9e(a),this.version=c9e(this.root),this.config=u9e(this.root),this.spec=l9e(this.root),this.apiAddr=f9e(this.root),this.gcLock=m9e(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=b9e({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:t})}async init(e){is("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(x9e(e)),await this.spec.set(A9e(e)),await this.version.set(K_.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch(e){return!1}}async open(){if(!this.closed)throw Pp(new Error("repo is already open"),ru.ERR_REPO_ALREADY_OPEN);is("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),is("acquired repo.lock"),!await this.version.check(K_.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(K_.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new ru.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");is("creating datastore"),await this.datastore.open(),is("creating blocks"),this.blocks.open(),is("creating keystore"),await this.keys.open(),is("creating pins"),await this.pins.pinstore.open(),this.closed=!1,is("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(t){is("error removing lock",t)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw Pp(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){is("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(t){throw t.code==="ERR_NOT_FOUND"?Pp(new Error("repo is not initialized yet"),ru.ERR_REPO_NOT_INITIALIZED,{path:this.path}):t}if(!e)throw Pp(new Error("repo is not initialized yet"),ru.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw Pp(new Error("repo is already closed"),ru.ERR_REPO_ALREADY_CLOSED);is("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==ru.ERR_REPO_NOT_INITIALIZED&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),is("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,t,i,n,s]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),x$(this.datastore),x$(this.keys)]),o=t.size+n+s;return{repoPath:this.path,storageMax:e,version:i,numObjects:t.count,repoSize:o}}throw Pp(new Error("repo is not initialized yet"),ru.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(E9e)}catch(t){if(t.code===ru.NotFoundError.code)e=!0;else throw t}return e}async _migrate(e,t){return await this.version.get()>e?(is(`reverting to version ${e}`),_$.revert(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(is(`migrating to version ${e}`),_$.migrate(this.path,t,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt(o9e(e))}catch(e){return BigInt(_9e)}}async _blockStat(){let e=BigInt(0),t=BigInt(0);if(this.blocks)for await(let{key:i,value:n}of this.blocks.query({}))e+=BigInt(1),t+=BigInt(n.byteLength),t+=BigInt(i.bytes.byteLength);return{count:e,size:t}}};async function x$(r){let e=BigInt(0);for await(let t of r.query({}))e+=BigInt(t.value.byteLength),e+=BigInt(t.key.uint8Array().byteLength);return e}function S9e(r,e,t,i){return new S$(r,e,t,i)}A$.exports={createRepo:S9e,repoVersion:K_.repoVersion,errors:ru,utils:{blockstore:aT()},locks:{memory:v9e,fs:w9e},PinTypes:y9e};function x9e(r){return r.Datastore=Object.assign({},E$,w$(r,"datastore")),r}function A9e(r){let e={...E$.Spec,...w$(r,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(t=>({mountpoint:t.mountpoint,type:t.child.type,path:t.child.path,shardFunc:t.child.shardFunc}))}}});var R$=y((H8t,T$)=>{f();"use strict";var{resolvePath:I9e}=Ki(),T9e=Oe(),{normaliseInput:R9e}=_p(),{PinTypes:I$}=$f();T$.exports=({repo:r,codecs:e})=>{async function*t(i,n={}){let s=async function*(){for await(let{path:c,recursive:u,metadata:l}of R9e(i)){let{cid:d}=await I9e(r,e,c),{reason:h}=await r.pins.isPinnedWithType(d,[I$.recursive,I$.direct]);if(h==="recursive"&&!u)throw new Error(`${d} already pinned recursively`);u?await r.pins.pinRecursively(d,{metadata:l}):await r.pins.pinDirectly(d,{metadata:l}),yield d}};if(!Boolean(n.lock)){yield*s();return}let a=await r.gcLock.readLock();try{yield*s()}finally{a()}}return T9e(t)}});var O$=y(($8t,P$)=>{f();"use strict";var{PinTypes:ns}=$f(),{normaliseInput:C9e}=_p(),{resolvePath:P9e}=Ki(),O9e=Oe(),C$=ae();function Cm(r,e,t){let i={type:r,cid:e};return t&&(i.metadata=t),i}P$.exports=({repo:r,codecs:e})=>{async function*t(i={}){let n=ns.all;if(i.type&&(n=i.type,!Object.keys(ns).includes(n)))throw C$(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(i.paths){let s=!1;for await(let{path:o}of C9e(i.paths)){let{cid:a}=await P9e(r,e,o),{reason:c,pinned:u,parent:l,metadata:d}=await r.pins.isPinnedWithType(a,n);if(!u)throw C$(new Error(`path '${o}' is not pinned`),"ERR_NOT_PINNED");switch(c){case ns.direct:case ns.recursive:s=!0,yield Cm(c,a,d);break;default:s=!0,yield Cm(`${ns.indirect} through ${l}`,a,d)}}if(!s)throw new Error("No match found");return}if(n===ns.recursive||n===ns.all)for await(let{cid:s,metadata:o}of r.pins.recursiveKeys())yield Cm(ns.recursive,s,o);if(n===ns.indirect||n===ns.all)for await(let s of r.pins.indirectKeys(i))yield Cm(ns.indirect,s);if(n===ns.direct||n===ns.all)for await(let{cid:s,metadata:o}of r.pins.directKeys())yield Cm(ns.direct,s,o)}return O9e(t)}});var q$=y((G8t,k$)=>{f();"use strict";var k9e=rs();k$.exports=({rmAll:r})=>(e,t={})=>k9e(r([{path:e,...t}],t))});var D$=y((W8t,N$)=>{f();"use strict";var{normaliseInput:q9e}=_p(),{resolvePath:N9e}=Ki(),D9e=Oe(),{PinTypes:xT}=$f();N$.exports=({repo:r,codecs:e})=>{async function*t(i,n={}){let s=await r.gcLock.readLock();try{for await(let{path:o,recursive:a}of q9e(i)){let{cid:c}=await N9e(r,e,o),{pinned:u,reason:l}=await r.pins.isPinnedWithType(c,xT.all);if(!u)throw new Error(`${c} is not pinned`);switch(l){case xT.recursive:if(!a)throw new Error(`${c} is pinned recursively`);await r.pins.unpin(c),yield c;break;case xT.direct:await r.pins.unpin(c),yield c;break;default:throw new Error(`${c} is pinned indirectly under ${l}`)}}}finally{s()}}return D9e(t)}});var L$=y((Y8t,M$)=>{f();"use strict";var B9e=fV(),M9e=R$(),L9e=O$(),U9e=q$(),F9e=D$(),B$=class{constructor({codecs:e,repo:t}){let i=M9e({codecs:e,repo:t});this.addAll=i,this.add=B9e({addAll:i});let n=F9e({codecs:e,repo:t});this.rmAll=n,this.rm=U9e({rmAll:n}),this.ls=L9e({codecs:e,repo:t}),this.remote={add:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:async function*(s,o={}){return Promise.reject(new Error("Not implemented"))},rm:(s,o={})=>Promise.reject(new Error("Not implemented")),rmAll:(s,o={})=>Promise.reject(new Error("Not implemented")),service:{add:(s,o)=>Promise.reject(new Error("Not implemented")),rm:(s,o={})=>Promise.reject(new Error("Not implemented")),ls:(s={})=>Promise.reject(new Error("Not implemented"))}}}};M$.exports=B$});var U$=y((Q8t,AT)=>{f();var X8t=function(){typeof AT!="undefined"&&(AT.exports=v);var r=24*3600,e=3200,t=(365*400+97)*e/400,i=r*t,n=i*1e3,s=1e3*1e4*1e4*r,o=16777216,a=65536*65536,c=1e3*1e3,u=1e3*1e3*1e3,l="000000000",d=Math.trunc||M,h=v.prototype;v.fromDate=Y,v.fromInt64BE=W(0,1,2,3,0,4),v.fromInt64LE=W(3,2,1,0,4,0),v.fromString=G,v.fromTimeT=C,h.year=0,h.time=0,h.nano=0,h.addNano=N,h.getNano=z,h.getTimeT=w,h.getYear=A,h.toDate=F,h.toJSON=S,h.toString=P,h.writeInt64BE=B(0,1,2,3,0,4),h.writeInt64LE=B(3,2,1,0,4,0);var p="%Y-%m-%dT%H:%M:%S.%NZ",g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],E={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return v;function v(X,ne,oe){var he=this;if(!(he instanceof v))return new v(X,ne,oe);he.time=+X||0,he.nano=+ne||0,he.year=+oe||0,R(he)}function A(){var X=this.toDate().getUTCFullYear();return X+this.year}function R(X){var ne=X.year,oe=X.time,he=X.nano,pe,_e;if(he<0||c<=he){var k=Math.floor(he/c);he-=k*c,oe+=k,pe=1}var K=ne%e;if(oe<-s||s<oe||K){_e=d(oe/n),_e&&(ne+=_e*e,oe-=_e*n);var $=q(oe);$.setUTCFullYear(K+$.getUTCFullYear()),ne-=K,oe=+$,_e=d(ne/e);var Z=oe+_e*n;_e&&-s<=Z&&Z<=s&&(ne-=_e*e,oe=Z),pe=1}return pe&&(X.year=ne,X.time=oe,X.nano=he),X}function F(){var X=R(this);return q(X.time)}function q(X){var ne=new Date(0);return ne.setTime(X),ne}function N(X){return this.nano+=+X||0,this}function z(){var X=R(this);return(X.time%1e3*c+ +X.nano+u)%u}function G(X){var ne,oe=new v;X+="";var he=X.replace(/^\s*[+\-]?\d+/,function(pe){var _e=+pe,k=1970+(_e-1970)%400;return oe.year=_e-k,k}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(pe,_e,k){return _e<0&&(k*=-1),ne=(+_e*60+ +k)*6e4,""}).replace(/\.\d+$/,function(pe){return oe.nano=+(pe+l).substr(1,9),""}).split(/\D+/);if(he.length>1?he[1]--:he[1]=0,oe.time=ne=Date.UTC.apply(Date,he)-(ne||0),isNaN(ne))throw new TypeError("Invalid Date");return R(oe)}function Y(X){return new v(+X)}function C(X){return m(X,0)}function m(X,ne){ne|=0,ne*=a,X=+X||0;var oe=d(ne/i)+d(X/i),he=ne%i+X%i,pe=d(he/i);return pe&&(oe+=pe,he-=pe*i),new v(he*1e3,0,oe*e)}function w(){var X=R(this),ne=Math.floor(X.time/1e3),oe=X.year;return oe&&(ne+=oe*t*r/e),ne}function S(){return this.toString().replace(/0{1,6}Z$/,"Z")}function P(X){var ne=this,oe=ne.toDate(),he={H:Z,L:V,M:I,N:D,S:U,Y:_e,a:Q,b:ee,d:K,e:$,m:k};return pe(X||p);function pe(J){return J.replace(/%./g,function(ue){var ge=ue[1],me=E[ge],je=he[ge];return me?pe(me):je?je():ue})}function _e(){var J=ne.getYear();return J>999999?"+"+J:J>9999?"+"+ce(J,6):J>=0?ce(J,4):J>=-999999?"-"+ce(-J,6):J}function k(){return L(oe.getUTCMonth()+1)}function K(){return L(oe.getUTCDate())}function $(){return _(oe.getUTCDate())}function Z(){return L(oe.getUTCHours())}function I(){return L(oe.getUTCMinutes())}function U(){return L(oe.getUTCSeconds())}function V(){return ce(oe.getUTCMilliseconds(),3)}function D(){return ce(ne.getNano(),9)}function Q(){return b[oe.getUTCDay()]}function ee(){return g[oe.getUTCMonth()]}}function B(X,ne,oe,he,pe,_e){return k;function k($,Z){var I=R(this);$||($=new Array(8)),j($,Z|=0);var U=Math.floor(I.time/1e3),V=I.year*(t*r/e),D=d(V/a)+d(U/a),Q=V%a+U%a,ee=Math.floor(Q/a);return ee&&(D+=ee,Q-=ee*a),K($,Z+pe,D),K($,Z+_e,Q),$}function K($,Z,I){$[Z+X]=I>>24&255,$[Z+ne]=I>>16&255,$[Z+oe]=I>>8&255,$[Z+he]=I&255}}function W(X,ne,oe,he,pe,_e){return k;function k($,Z){j($,Z|=0);var I=K($,Z+pe),U=K($,Z+_e);return m(U,I)}function K($,Z){return $[Z+X]*o+($[Z+ne]<<16|$[Z+oe]<<8|$[Z+he])}}function j(X,ne){var oe=X&&X.length;if(oe==null)throw new TypeError("Invalid Buffer");if(oe<ne+8)throw new RangeError("Out of range")}function M(X){var ne=X-X%1;return ne===0&&(X<0||X===0&&1/X!=1/0)?-0:ne}function _(X){return(X>9?"":" ")+(X|0)}function L(X){return(X>9?"":"0")+(X|0)}function ce(X,ne){return(l+(X|0)).substr(-ne)}}()});var X$=y((Z8t,Y$)=>{f();Y$.exports=ar;var Qs=null;try{Qs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(r){}function ar(r,e,t){this.low=r|0,this.high=e|0,this.unsigned=!!t}ar.prototype.__isLong__;Object.defineProperty(ar.prototype,"__isLong__",{value:!0});function ss(r){return(r&&r.__isLong__)===!0}ar.isLong=ss;var F$={},K$={};function Gf(r,e){var t,i,n;return e?(r>>>=0,(n=0<=r&&r<256)&&(i=K$[r],i)?i:(t=cr(r,(r|0)<0?-1:0,!0),n&&(K$[r]=t),t)):(r|=0,(n=-128<=r&&r<128)&&(i=F$[r],i)?i:(t=cr(r,r<0?-1:0,!1),n&&(F$[r]=t),t))}ar.fromInt=Gf;function Zs(r,e){if(isNaN(r))return e?Wf:Js;if(e){if(r<0)return Wf;if(r>=V$)return W$}else{if(r<=-z$)return os;if(r+1>=z$)return G$}return r<0?Zs(-r,e).neg():cr(r%Op|0,r/Op|0,e)}ar.fromNumber=Zs;function cr(r,e,t){return new ar(r,e,t)}ar.fromBits=cr;var j_=Math.pow;function IT(r,e,t){if(r.length===0)throw Error("empty string");if(r==="NaN"||r==="Infinity"||r==="+Infinity"||r==="-Infinity")return Js;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var i;if((i=r.indexOf("-"))>0)throw Error("interior hyphen");if(i===0)return IT(r.substring(1),e,t).neg();for(var n=Zs(j_(t,8)),s=Js,o=0;o<r.length;o+=8){var a=Math.min(8,r.length-o),c=parseInt(r.substring(o,o+a),t);if(a<8){var u=Zs(j_(t,a));s=s.mul(u).add(Zs(c))}else s=s.mul(n),s=s.add(Zs(c))}return s.unsigned=e,s}ar.fromString=IT;function $o(r,e){return typeof r=="number"?Zs(r,e):typeof r=="string"?IT(r,e):cr(r.low,r.high,typeof e=="boolean"?e:r.unsigned)}ar.fromValue=$o;var j$=1<<16,K9e=1<<24,Op=j$*j$,V$=Op*Op,z$=V$/2,H$=Gf(K9e),Js=Gf(0);ar.ZERO=Js;var Wf=Gf(0,!0);ar.UZERO=Wf;var kp=Gf(1);ar.ONE=kp;var $$=Gf(1,!0);ar.UONE=$$;var TT=Gf(-1);ar.NEG_ONE=TT;var G$=cr(4294967295|0,2147483647|0,!1);ar.MAX_VALUE=G$;var W$=cr(4294967295|0,4294967295|0,!0);ar.MAX_UNSIGNED_VALUE=W$;var os=cr(0,2147483648|0,!1);ar.MIN_VALUE=os;var Ce=ar.prototype;Ce.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ce.toNumber=function(){return this.unsigned?(this.high>>>0)*Op+(this.low>>>0):this.high*Op+(this.low>>>0)};Ce.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(os)){var t=Zs(e),i=this.div(t),n=i.mul(t).sub(this);return i.toString(e)+n.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Zs(j_(e,6),this.unsigned),o=this,a="";;){var c=o.div(s),u=o.sub(c.mul(s)).toInt()>>>0,l=u.toString(e);if(o=c,o.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Ce.getHighBits=function(){return this.high};Ce.getHighBitsUnsigned=function(){return this.high>>>0};Ce.getLowBits=function(){return this.low};Ce.getLowBitsUnsigned=function(){return this.low>>>0};Ce.getNumBitsAbs=function(){if(this.isNegative())return this.eq(os)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Ce.isZero=function(){return this.high===0&&this.low===0};Ce.eqz=Ce.isZero;Ce.isNegative=function(){return!this.unsigned&&this.high<0};Ce.isPositive=function(){return this.unsigned||this.high>=0};Ce.isOdd=function(){return(this.low&1)==1};Ce.isEven=function(){return(this.low&1)==0};Ce.equals=function(e){return ss(e)||(e=$o(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low};Ce.eq=Ce.equals;Ce.notEquals=function(e){return!this.eq(e)};Ce.neq=Ce.notEquals;Ce.ne=Ce.notEquals;Ce.lessThan=function(e){return this.comp(e)<0};Ce.lt=Ce.lessThan;Ce.lessThanOrEqual=function(e){return this.comp(e)<=0};Ce.lte=Ce.lessThanOrEqual;Ce.le=Ce.lessThanOrEqual;Ce.greaterThan=function(e){return this.comp(e)>0};Ce.gt=Ce.greaterThan;Ce.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ce.gte=Ce.greaterThanOrEqual;Ce.ge=Ce.greaterThanOrEqual;Ce.compare=function(e){if(ss(e)||(e=$o(e)),this.eq(e))return 0;var t=this.isNegative(),i=e.isNegative();return t&&!i?-1:!t&&i?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ce.comp=Ce.compare;Ce.negate=function(){return!this.unsigned&&this.eq(os)?os:this.not().add(kp)};Ce.neg=Ce.negate;Ce.add=function(e){ss(e)||(e=$o(e));var t=this.high>>>16,i=this.high&65535,n=this.low>>>16,s=this.low&65535,o=e.high>>>16,a=e.high&65535,c=e.low>>>16,u=e.low&65535,l=0,d=0,h=0,p=0;return p+=s+u,h+=p>>>16,p&=65535,h+=n+c,d+=h>>>16,h&=65535,d+=i+a,l+=d>>>16,d&=65535,l+=t+o,l&=65535,cr(h<<16|p,l<<16|d,this.unsigned)};Ce.subtract=function(e){return ss(e)||(e=$o(e)),this.add(e.neg())};Ce.sub=Ce.subtract;Ce.multiply=function(e){if(this.isZero())return Js;if(ss(e)||(e=$o(e)),Qs){var t=Qs.mul(this.low,this.high,e.low,e.high);return cr(t,Qs.get_high(),this.unsigned)}if(e.isZero())return Js;if(this.eq(os))return e.isOdd()?os:Js;if(e.eq(os))return this.isOdd()?os:Js;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(H$)&&e.lt(H$))return Zs(this.toNumber()*e.toNumber(),this.unsigned);var i=this.high>>>16,n=this.high&65535,s=this.low>>>16,o=this.low&65535,a=e.high>>>16,c=e.high&65535,u=e.low>>>16,l=e.low&65535,d=0,h=0,p=0,g=0;return g+=o*l,p+=g>>>16,g&=65535,p+=s*l,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*l,d+=h>>>16,h&=65535,h+=s*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,d+=i*l+n*u+s*c+o*a,d&=65535,cr(p<<16|g,d<<16|h,this.unsigned)};Ce.mul=Ce.multiply;Ce.divide=function(e){if(ss(e)||(e=$o(e)),e.isZero())throw Error("division by zero");if(Qs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?Qs.div_u:Qs.div_s)(this.low,this.high,e.low,e.high);return cr(t,Qs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Wf:Js;var i,n,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Wf;if(e.gt(this.shru(1)))return $$;s=Wf}else{if(this.eq(os)){if(e.eq(kp)||e.eq(TT))return os;if(e.eq(os))return kp;var o=this.shr(1);return i=o.div(e).shl(1),i.eq(Js)?e.isNegative()?kp:TT:(n=this.sub(e.mul(i)),s=i.add(n.div(e)),s)}else if(e.eq(os))return this.unsigned?Wf:Js;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Js}for(n=this;n.gte(e);){i=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(i)/Math.LN2),c=a<=48?1:j_(2,a-48),u=Zs(i),l=u.mul(e);l.isNegative()||l.gt(n);)i-=c,u=Zs(i,this.unsigned),l=u.mul(e);u.isZero()&&(u=kp),s=s.add(u),n=n.sub(l)}return s};Ce.div=Ce.divide;Ce.modulo=function(e){if(ss(e)||(e=$o(e)),Qs){var t=(this.unsigned?Qs.rem_u:Qs.rem_s)(this.low,this.high,e.low,e.high);return cr(t,Qs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ce.mod=Ce.modulo;Ce.rem=Ce.modulo;Ce.not=function(){return cr(~this.low,~this.high,this.unsigned)};Ce.and=function(e){return ss(e)||(e=$o(e)),cr(this.low&e.low,this.high&e.high,this.unsigned)};Ce.or=function(e){return ss(e)||(e=$o(e)),cr(this.low|e.low,this.high|e.high,this.unsigned)};Ce.xor=function(e){return ss(e)||(e=$o(e)),cr(this.low^e.low,this.high^e.high,this.unsigned)};Ce.shiftLeft=function(e){return ss(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cr(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):cr(0,this.low<<e-32,this.unsigned)};Ce.shl=Ce.shiftLeft;Ce.shiftRight=function(e){return ss(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cr(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):cr(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ce.shr=Ce.shiftRight;Ce.shiftRightUnsigned=function(e){if(ss(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var i=this.low;return cr(i>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?cr(t,0,this.unsigned):cr(t>>>e-32,0,this.unsigned)};Ce.shru=Ce.shiftRightUnsigned;Ce.shr_u=Ce.shiftRightUnsigned;Ce.toSigned=function(){return this.unsigned?cr(this.low,this.high,!1):this};Ce.toUnsigned=function(){return this.unsigned?this:cr(this.low,this.high,!0)};Ce.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ce.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ce.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};ar.fromBytes=function(e,t,i){return i?ar.fromBytesLE(e,t):ar.fromBytesBE(e,t)};ar.fromBytesLE=function(e,t){return new ar(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};ar.fromBytesBE=function(e,t){return new ar(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}});var J$=y((J8t,Z$)=>{f();"use strict";var qp=ki(),Q$=qp.Reader,j9e=qp.Writer,Ye=qp.util,Np=qp.roots["ipfs-ipns"]||(qp.roots["ipfs-ipns"]={});Np.IpnsEntry=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.value=Ye.newBuffer([]),r.prototype.signature=Ye.newBuffer([]),r.prototype.validityType=0,r.prototype.validity=Ye.newBuffer([]),r.prototype.sequence=Ye.Long?Ye.Long.fromBits(0,0,!0):0,r.prototype.ttl=Ye.Long?Ye.Long.fromBits(0,0,!0):0,r.prototype.pubKey=Ye.newBuffer([]),r.prototype.signatureV2=Ye.newBuffer([]),r.prototype.data=Ye.newBuffer([]),r.encode=function(t,i){return i||(i=j9e.create()),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(10).bytes(t.value),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(18).bytes(t.signature),t.validityType!=null&&Object.hasOwnProperty.call(t,"validityType")&&i.uint32(24).int32(t.validityType),t.validity!=null&&Object.hasOwnProperty.call(t,"validity")&&i.uint32(34).bytes(t.validity),t.sequence!=null&&Object.hasOwnProperty.call(t,"sequence")&&i.uint32(40).uint64(t.sequence),t.ttl!=null&&Object.hasOwnProperty.call(t,"ttl")&&i.uint32(48).uint64(t.ttl),t.pubKey!=null&&Object.hasOwnProperty.call(t,"pubKey")&&i.uint32(58).bytes(t.pubKey),t.signatureV2!=null&&Object.hasOwnProperty.call(t,"signatureV2")&&i.uint32(66).bytes(t.signatureV2),t.data!=null&&Object.hasOwnProperty.call(t,"data")&&i.uint32(74).bytes(t.data),i},r.decode=function(t,i){t instanceof Q$||(t=Q$.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Np.IpnsEntry;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.value=t.bytes();break;case 2:s.signature=t.bytes();break;case 3:s.validityType=t.int32();break;case 4:s.validity=t.bytes();break;case 5:s.sequence=t.uint64();break;case 6:s.ttl=t.uint64();break;case 7:s.pubKey=t.bytes();break;case 8:s.signatureV2=t.bytes();break;case 9:s.data=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Np.IpnsEntry)return t;var i=new Np.IpnsEntry;switch(t.value!=null&&(typeof t.value=="string"?Ye.base64.decode(t.value,i.value=Ye.newBuffer(Ye.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.signature!=null&&(typeof t.signature=="string"?Ye.base64.decode(t.signature,i.signature=Ye.newBuffer(Ye.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),t.validityType){case"EOL":case 0:i.validityType=0;break}return t.validity!=null&&(typeof t.validity=="string"?Ye.base64.decode(t.validity,i.validity=Ye.newBuffer(Ye.base64.length(t.validity)),0):t.validity.length&&(i.validity=t.validity)),t.sequence!=null&&(Ye.Long?(i.sequence=Ye.Long.fromValue(t.sequence)).unsigned=!0:typeof t.sequence=="string"?i.sequence=parseInt(t.sequence,10):typeof t.sequence=="number"?i.sequence=t.sequence:typeof t.sequence=="object"&&(i.sequence=new Ye.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0))),t.ttl!=null&&(Ye.Long?(i.ttl=Ye.Long.fromValue(t.ttl)).unsigned=!0:typeof t.ttl=="string"?i.ttl=parseInt(t.ttl,10):typeof t.ttl=="number"?i.ttl=t.ttl:typeof t.ttl=="object"&&(i.ttl=new Ye.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0))),t.pubKey!=null&&(typeof t.pubKey=="string"?Ye.base64.decode(t.pubKey,i.pubKey=Ye.newBuffer(Ye.base64.length(t.pubKey)),0):t.pubKey.length&&(i.pubKey=t.pubKey)),t.signatureV2!=null&&(typeof t.signatureV2=="string"?Ye.base64.decode(t.signatureV2,i.signatureV2=Ye.newBuffer(Ye.base64.length(t.signatureV2)),0):t.signatureV2.length&&(i.signatureV2=t.signatureV2)),t.data!=null&&(typeof t.data=="string"?Ye.base64.decode(t.data,i.data=Ye.newBuffer(Ye.base64.length(t.data)),0):t.data.length&&(i.data=t.data)),i},r.toObject=function(t,i){i||(i={});var n={};if(i.defaults){if(i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=Ye.newBuffer(n.value))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=Ye.newBuffer(n.signature))),n.validityType=i.enums===String?"EOL":0,i.bytes===String?n.validity="":(n.validity=[],i.bytes!==Array&&(n.validity=Ye.newBuffer(n.validity))),Ye.Long){var s=new Ye.Long(0,0,!0);n.sequence=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.sequence=i.longs===String?"0":0;if(Ye.Long){var s=new Ye.Long(0,0,!0);n.ttl=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.ttl=i.longs===String?"0":0;i.bytes===String?n.pubKey="":(n.pubKey=[],i.bytes!==Array&&(n.pubKey=Ye.newBuffer(n.pubKey))),i.bytes===String?n.signatureV2="":(n.signatureV2=[],i.bytes!==Array&&(n.signatureV2=Ye.newBuffer(n.signatureV2))),i.bytes===String?n.data="":(n.data=[],i.bytes!==Array&&(n.data=Ye.newBuffer(n.data)))}return t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?Ye.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?Ye.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),t.validityType!=null&&t.hasOwnProperty("validityType")&&(n.validityType=i.enums===String?Np.IpnsEntry.ValidityType[t.validityType]:t.validityType),t.validity!=null&&t.hasOwnProperty("validity")&&(n.validity=i.bytes===String?Ye.base64.encode(t.validity,0,t.validity.length):i.bytes===Array?Array.prototype.slice.call(t.validity):t.validity),t.sequence!=null&&t.hasOwnProperty("sequence")&&(typeof t.sequence=="number"?n.sequence=i.longs===String?String(t.sequence):t.sequence:n.sequence=i.longs===String?Ye.Long.prototype.toString.call(t.sequence):i.longs===Number?new Ye.LongBits(t.sequence.low>>>0,t.sequence.high>>>0).toNumber(!0):t.sequence),t.ttl!=null&&t.hasOwnProperty("ttl")&&(typeof t.ttl=="number"?n.ttl=i.longs===String?String(t.ttl):t.ttl:n.ttl=i.longs===String?Ye.Long.prototype.toString.call(t.ttl):i.longs===Number?new Ye.LongBits(t.ttl.low>>>0,t.ttl.high>>>0).toNumber(!0):t.ttl),t.pubKey!=null&&t.hasOwnProperty("pubKey")&&(n.pubKey=i.bytes===String?Ye.base64.encode(t.pubKey,0,t.pubKey.length):i.bytes===Array?Array.prototype.slice.call(t.pubKey):t.pubKey),t.signatureV2!=null&&t.hasOwnProperty("signatureV2")&&(n.signatureV2=i.bytes===String?Ye.base64.encode(t.signatureV2,0,t.signatureV2.length):i.bytes===Array?Array.prototype.slice.call(t.signatureV2):t.signatureV2),t.data!=null&&t.hasOwnProperty("data")&&(n.data=i.bytes===String?Ye.base64.encode(t.data,0,t.data.length):i.bytes===Array?Array.prototype.slice.call(t.data):t.data),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,qp.util.toJSONOptions)},r.ValidityType=function(){var e={},t=Object.create(e);return t[e[0]="EOL"]=0,t}(),r}();Z$.exports=Np});var eG=y((eCt,RT)=>{f();"use strict";RT.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};RT.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var tG=y(Za=>{f();"use strict";Za.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD";Za.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY";Za.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION";Za.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION";Za.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT";Za.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY";Za.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID";Za.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER";Za.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"});var Lp=y((rCt,pG)=>{f();"use strict";var rG=U$(),{Key:Pm}=Ut(),CT=za(),iG=rt(),V9e=(Cn(),Wn),{identity:z9e}=(Fc(),Uc),gn=ae(),{base32upper:H9e}=(sn(),nn),{fromString:Dp}=(ft(),ht),{toString:$9e}=(tt(),et),{concat:Bp}=(cn(),an),{equals:nG}=(di(),fi),sG=(tm(),u_),oG=X$(),aG=be(),xs=Object.assign(aG("jsipns"),{error:aG("jsipns:error")}),{IpnsEntry:Mp}=J$(),{parseRFC3339:G9e}=eG(),Qi=tG(),W9e=z9e.code,cG="/ipns/",Y9e=Dp("/ipns/"),X9e=(r,e,t,i)=>{let n=new rG(Date.now()+Number(i)),s=Mp.ValidityType.EOL,[o,a]=i.toString().split("."),c=BigInt(o)*100000n+BigInt(a||0);return uG(r,e,t,s,n,c)},Q9e=(r,e,t,i)=>{let n=rG.fromString(i),s=Mp.ValidityType.EOL,o=n.toDate().getTime()-Date.now(),a=BigInt(o)*100000n+BigInt(n.getNano());return uG(r,e,t,s,n,a)},uG=async(r,e,t,i,n,s)=>{t=BigInt(t);let o=Dp(n.toString()),a=await iUe(r,e,i,o),c=Z9e(e,o,i,t,s),u=hG(c),l=await r.sign(u),d={value:e,signature:a,validityType:i,validity:o,sequence:t,ttl:s,signatureV2:l,data:c};return xs(`ipns entry for ${e} created`),d},Z9e=(r,e,t,i,n)=>{let s={Value:r,Validity:e,ValidityType:t,Sequence:i,TTL:n};return sG.encode(s)},lG=async(r,e)=>{let{value:t,validityType:i,validity:n}=e,s,o;e.signatureV2&&e.data?(o=e.signatureV2,s=hG(e.data),J9e(e)):(o=e.signature,s=dG(t,i,n));let a;try{a=await r.verify(s,o)}catch(c){a=!1}if(!a)throw xs.error("record signature verification failed"),gn(new Error("record signature verification failed"),Qi.ERR_SIGNATURE_VERIFICATION);if(i===Mp.ValidityType.EOL){let c;try{c=G9e($9e(n))}catch(u){throw xs.error("unrecognized validity format (not an rfc3339 format)"),gn(new Error("unrecognized validity format (not an rfc3339 format)"),Qi.ERR_UNRECOGNIZED_FORMAT)}if(c.getTime()<Date.now())throw xs.error("record has expired"),gn(new Error("record has expired"),Qi.ERR_IPNS_EXPIRED_RECORD)}else if(i)throw xs.error("unrecognized validity type"),gn(new Error("unrecognized validity type"),Qi.ERR_UNRECOGNIZED_VALIDITY);xs(`ipns entry for ${t} is valid`)},J9e=r=>{if(!r.data)throw gn(new Error("Record data is missing"),Qi.ERR_INVALID_RECORD_DATA);let e=sG.decode(r.data);if(Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),!nG(e.Value,r.value))throw gn(new Error('Field "value" did not match between protobuf and CBOR'),Qi.ERR_SIGNATURE_VERIFICATION);if(!nG(e.Validity,r.validity))throw gn(new Error('Field "validity" did not match between protobuf and CBOR'),Qi.ERR_SIGNATURE_VERIFICATION);if(e.ValidityType!==r.validityType)throw gn(new Error('Field "validityType" did not match between protobuf and CBOR'),Qi.ERR_SIGNATURE_VERIFICATION);if(e.Sequence!==r.sequence)throw gn(new Error('Field "sequence" did not match between protobuf and CBOR'),Qi.ERR_SIGNATURE_VERIFICATION);if(e.TTL!==r.ttl)throw gn(new Error('Field "ttl" did not match between protobuf and CBOR'),Qi.ERR_SIGNATURE_VERIFICATION)},eUe=async(r,e)=>{if(!r||!r.bytes||!e){let n=new Error("one or more of the provided parameters are not defined");throw xs.error(n),gn(n,Qi.ERR_UNDEFINED_PARAMETER)}let t;try{t=await iG.createFromPubKey(r.bytes)}catch(n){throw gn(n,Qi.ERR_PEER_ID_FROM_PUBLIC_KEY)}let i;try{i=sUe(t)}catch(n){throw xs.error(n),gn(n,Qi.ERR_PUBLIC_KEY_FROM_ID)}if(i)return null;try{e.pubKey=CT.keys.marshalPublicKey(r)}catch(n){throw xs.error(n),n}return e},fG=(r,e)=>{if(!e||!r){let t=new Error("one or more of the provided parameters are not defined");throw xs.error(t),gn(t,Qi.ERR_UNDEFINED_PARAMETER)}if(e.pubKey){let t;try{t=CT.keys.unmarshalPublicKey(e.pubKey)}catch(i){throw xs.error(i),i}return t}if(r.pubKey)return r.pubKey;throw Object.assign(new Error("no public key is available"),{code:Qi.ERR_UNDEFINED_PARAMETER})},PT=r=>H9e.encode(r).slice(1),tUe=r=>new Pm(`/ipns/${PT(r)}`),rUe=r=>{let e=Dp("/pk/"),t=Dp("/ipns/");return{routingPubKey:new Pm(Bp([e,r]),!1),pkKey:new Pm(PT(Bp([e,r]))),routingKey:new Pm(Bp([t,r]),!1),ipnsKey:new Pm(PT(Bp([t,r])))}},iUe=(r,e,t,i)=>{try{let n=dG(e,t,i);return r.sign(n)}catch(n){throw xs.error("record signature creation failed"),gn(new Error("record signature creation failed: "+n.message),Qi.ERR_SIGNATURE_CREATION)}},nUe=r=>{if(r.toString()==="0")return"EOL";let e=new Error(`unrecognized validity type ${r.toString()}`);throw xs.error(e),gn(e,Qi.ERR_UNRECOGNIZED_VALIDITY)},dG=(r,e,t)=>{let i=Dp(nUe(e));return Bp([r,t,i])},hG=r=>{let e=Dp("ipns-signature:");return Bp([e,r])},sUe=r=>{let e=V9e.decode(r.id);return e.code!==W9e?null:CT.keys.unmarshalPublicKey(e.digest)},oUe=r=>Mp.encode({...r,sequence:oG.fromString(r.sequence.toString()),ttl:r.ttl==null?void 0:oG.fromString(r.ttl.toString())}).finish(),V_=r=>{let e=Mp.decode(r),t=Mp.toObject(e,{defaults:!1,arrays:!0,objects:!1});return{value:t.value,signature:t.signature,validityType:t.validityType,validity:t.validity,sequence:Object.hasOwnProperty.call(t,"sequence")?BigInt(`${t.sequence}`):0n,pubKey:t.pubKey,ttl:Object.hasOwnProperty.call(t,"ttl")?BigInt(`${t.ttl}`):void 0}},aUe={validate:async(r,e)=>{let t=V_(r),i=e.slice(Y9e.length),n=iG.createFromBytes(i),s=fG(n,t);await lG(s,t)},select:(r,e)=>{let t=V_(r),i=V_(e);return t.sequence>i.sequence?0:1}};pG.exports={create:X9e,createWithExpiration:Q9e,validate:lG,embedPublicKey:eUe,extractPublicKey:fG,getLocalKey:tUe,getIdKeys:rUe,marshal:oUe,unmarshal:V_,validator:aUe,namespace:cG,namespaceLength:cG.length}});var _G=y((vG,wG)=>{f();"use strict";var z_=rt(),{Key:yG,Errors:cUe}=Ut(),Bn=ae(),gG=be(),_i=Object.assign(gG("ipfs:ipns:publisher"),{error:gG("ipfs:ipns:publisher:error")}),{toString:Om}=(tt(),et),{equals:uUe}=(di(),fi),iu=Lp(),mG=cUe.notFoundError().code,bG=60*60*1e3,OT=class{constructor(e,t){this._routing=e,this._datastore=t}async publishWithEOL(e,t,i){if(!e||!e.bytes)throw Bn(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");let n=await z_.createFromPrivKey(e.bytes),s=await this._updateOrCreateRecord(e,t,i,n);return this._putRecordToRouting(s,n)}publish(e,t){return this.publishWithEOL(e,t,bG)}async _putRecordToRouting(e,t){if(!z_.isPeerId(t)){let o="peerId received is not valid";throw _i.error(o),Bn(new Error(o),"ERR_INVALID_PEER_ID")}let i=t._pubKey,n=await iu.embedPublicKey(i,e),s=iu.getIdKeys(t.toBytes());return await this._publishEntry(s.routingKey,n||e),await this._publishPublicKey(s.routingPubKey,i),n||e}async _publishEntry(e,t){if(!(e instanceof yG)){let n="datastore key does not have a valid format";throw _i.error(n),Bn(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let i;try{i=iu.marshal(t)}catch(n){throw _i.error(n),n}try{let n=await this._routing.put(e.uint8Array(),i);return _i(`ipns record for ${Om(e.uint8Array(),"base64")} was stored in the routing`),n}catch(n){let s=`ipns record for ${Om(e.uint8Array(),"base64")} could not be stored in the routing`;throw _i.error(s),_i.error(n),Bn(new Error(s),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(e,t){if(!(e instanceof yG)){let i="datastore key does not have a valid format";throw _i.error(i),Bn(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!t||!t.bytes){let i="one or more of the provided parameters are not defined";throw _i.error(i),Bn(new Error(i),"ERR_UNDEFINED_PARAMETER")}try{let i=await this._routing.put(e.uint8Array(),t.bytes);return _i(`public key for ${Om(e.uint8Array(),"base64")} was stored in the routing`),i}catch(i){let n=`public key for ${Om(e.uint8Array(),"base64")} could not be stored in the routing`;throw _i.error(n),_i.error(i),Bn(new Error(n),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,t={}){if(!z_.isPeerId(e)){let n="peerId received is not valid";throw _i.error(n),Bn(new Error(n),"ERR_INVALID_PEER_ID")}let i=t.checkRouting!==!1;try{let n=await this._datastore.get(iu.getLocalKey(e.id));return this._unmarshalData(n)}catch(n){if(n.code!==mG){let s=`unexpected error getting the ipns record ${e.id} from datastore`;throw _i.error(s),Bn(new Error(s),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!i)throw Bn(n,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let s=iu.getIdKeys(e.toBytes()),o=await this._routing.get(s.routingKey.uint8Array());return this._unmarshalData(o)}catch(s){throw _i.error(s),s}}}_unmarshalData(e){try{return iu.unmarshal(e)}catch(t){throw Bn(t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,t,i,n){if(!z_.isPeerId(n)){let u="peerId received is not valid";throw _i.error(u),Bn(new Error(u),"ERR_INVALID_PEER_ID")}let s={checkRouting:!0},o;try{o=await this._getPublished(n,s)}catch(u){if(u.code!==mG){let l=`unexpected error when determining the last published IPNS record for ${n.id} ${u.stack}`;throw _i.error(l),Bn(new Error(l),"ERR_DETERMINING_PUBLISHED_RECORD")}}let a=0n;o&&o.sequence!==void 0&&(a=uUe(o.value,t)?BigInt(o.sequence):BigInt(o.sequence)+1n);let c;try{c=await iu.create(e,t,a,i)}catch(u){let l=`ipns record for ${t} could not be created`;throw _i.error(u),Bn(new Error(l),"ERR_CREATING_IPNS_RECORD")}try{let u=iu.marshal(c);return await this._datastore.put(iu.getLocalKey(n.id),u),_i(`ipns record for ${Om(t,"base32")} was stored in the datastore`),c}catch(u){let l=`ipns record for ${t} could not be stored in the datastore`;throw _i.error(l),Bn(new Error(l),"ERR_STORING_IN_DATASTORE")}}};OT.defaultRecordLifetime=bG;vG=wG.exports=OT});var PG=y((RG,CG)=>{f();"use strict";var EG=Lp(),lUe=za(),SG=rt(),Yf=ae(),xG=be(),H_=Object.assign(xG("ipfs:ipns:republisher"),{error:xG("ipfs:ipns:republisher:error")}),AG=60*1e3,IG=60*AG,fUe=4*IG,dUe=24*IG,TG=class{constructor(e,t,i,n,s={pass:""}){this._publisher=e,this._datastore=t,this._peerId=i,this._keychain=n,this._options=s,this._republishHandle=null}async start(){if(this._republishHandle)throw Yf(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:s=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(s)}catch(o){H_.error(o)}},s())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{privKey:t}=this._peerId,{pass:i}=this._options,n=!0;e._task=()=>this._republishEntries(t,i),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||AG):this._options.broadcastInterval||fUe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw Yf(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,t){try{await this._republishEntry(e)}catch(i){let n="cannot republish entry for the node's private key";H_.error(n);return}if(t)try{let i=await this._keychain.listKeys();for(let n of i){if(n.name==="self")continue;let s=await this._keychain.exportKey(n.name,t),o=await lUe.keys.import(s,t);await this._republishEntry(o)}}catch(i){H_.error(i)}}async _republishEntry(e){if(!e||!e.bytes)throw Yf(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{let t=await SG.createFromPrivKey(e.bytes),i=await this._getPreviousValue(t);await this._publisher.publishWithEOL(e,i,dUe)}catch(t){if(t.code==="ERR_NO_ENTRY_FOUND")return;throw t}}async _getPreviousValue(e){if(!SG.isPeerId(e))throw Yf(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let t=await this._datastore.get(EG.getLocalKey(e.id));if(!(t instanceof Uint8Array))throw Yf(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return EG.unmarshal(t).value}catch(i){throw H_.error(i),Yf(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(t){throw t&&t.notFound?Yf(new Error(`no previous entry for record with id: ${e.id}`),"ERR_NO_ENTRY_FOUND"):t}}};RG=CG.exports=TG});var BG=y((NG,DG)=>{f();"use strict";var $_=Lp(),hUe=rt(),Up=ae(),OG=be(),G_=Object.assign(OG("ipfs:ipns:resolver"),{error:OG("ipfs:ipns:resolver:error")}),{toString:pUe}=(tt(),et),{Errors:yUe}=Ut(),gUe=yUe.notFoundError().code,kG=32,qG=class{constructor(e){this._routing=e}async resolve(e,t={}){if(typeof e!="string")throw Up(new Error("invalid name"),"ERR_INVALID_NAME");let i=t.recursive&&t.recursive.toString()==="true",n=e.split("/");if(n.length!==3||n[0]!=="")throw Up(new Error("invalid name"),"ERR_INVALID_NAME");let s=n[2],o=1/0;i&&(o=kG);let a=await this.resolver(s,o);return G_(`${e} was locally resolved correctly`),a}async resolver(e,t){if(t===0){let s=`could not resolve name (recursion limit of ${kG} exceeded)`;throw G_.error(s),Up(new Error(s),"ERR_RESOLVE_RECURSION_LIMIT")}let i=await this._resolveName(e),n=i.split("/");return n[1]==="ipfs"||!t?i:this.resolver(n[2],t-1)}async _resolveName(e){let t=hUe.parse(e),{routingKey:i}=$_.getIdKeys(t.toBytes()),n;try{n=await this._routing.get(i.uint8Array())}catch(o){throw G_.error("could not get record from routing",o),o.code===gUe?Up(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):Up(new Error(`unexpected error getting the ipns record ${t.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s;try{s=$_.unmarshal(n)}catch(o){throw G_.error("could not unmarshal record",o),Up(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(t,s)}async _validateRecord(e,t){let i=await $_.extractPublicKey(e,t);return await $_.validate(i,t),pUe(t.value)}};NG=DG.exports=qG});var jG=y((iCt,KG)=>{f();"use strict";var{createFromPrivKey:mUe}=rt(),bUe=ae(),MG=be(),km=Object.assign(MG("ipfs:ipns"),{error:MG("ipfs:ipns:error")}),kT=_G(),vUe=PG(),wUe=BG(),_Ue=y4(),LG=60*1e3,{toString:UG}=(tt(),et),FG=class{constructor(e,t,i,n,s){this.publisher=new kT(e,t),this.republisher=new vUe(this.publisher,t,i,n,s),this.resolver=new wUe(e),this.cache=new _Ue(1e3),this.routing=e}async publish(e,t,i=kT.defaultRecordLifetime){try{let n=await mUe(e.bytes);await this.publisher.publishWithEOL(e,t,i),km(`IPNS value ${UG(t,"base32")} was published correctly`);let s=n.toB58String(),o=parseFloat(i),a=o<LG?o:LG;return this.cache.set(s,t,a),km(`IPNS value ${UG(t,"base32")} was cached correctly`),{name:s,value:t}}catch(n){throw km.error(n),n}}async resolve(e,t={}){if(typeof e!="string")throw bUe(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!t.nocache&&!t.recursive){let i=e.split("/")[2],n=this.cache.get(i);if(n)return n}try{let i=await this.resolver.resolve(e,t);return km(`IPNS record from ${e} was resolved correctly`),i}catch(i){throw km.error(i),i}}async initializeKeyspace(e,t){return this.publish(e,t,kT.defaultRecordLifetime)}};KG.exports=FG});var qm=y((nCt,zG)=>{f();"use strict";var{Adapter:EUe}=Ut(),Xf=Ho(),{pipe:qT}=Ar(),VG=class extends EUe{constructor(e,t){super();this.child=e,this.transform=t}open(){return this.child.open()}put(e,t,i){return this.child.put(this.transform.convert(e),t,i)}get(e,t){return this.child.get(this.transform.convert(e),t)}has(e,t){return this.child.has(this.transform.convert(e),t)}delete(e,t){return this.child.delete(this.transform.convert(e),t)}async*putMany(e,t={}){let i=this.transform,n=this.child;yield*qT(e,async function*(s){yield*Xf(s,({key:o,value:a})=>({key:i.convert(o),value:a}))},async function*(s){yield*n.putMany(s,t)},async function*(s){yield*Xf(s,({key:o,value:a})=>({key:i.invert(o),value:a}))})}async*getMany(e,t={}){let i=this.transform,n=this.child;yield*qT(e,async function*(s){yield*Xf(s,o=>i.convert(o))},async function*(s){yield*n.getMany(s,t)})}async*deleteMany(e,t={}){let i=this.transform,n=this.child;yield*qT(e,async function*(s){yield*Xf(s,o=>i.convert(o))},async function*(s){yield*n.deleteMany(s,t)},async function*(s){yield*Xf(s,o=>i.invert(o))})}batch(){let e=this.child.batch();return{put:(t,i)=>{e.put(this.transform.convert(t),i)},delete:t=>{e.delete(this.transform.convert(t))},commit:t=>e.commit(t)}}query(e,t){return Xf(this.child.query(e,t),({key:i,value:n})=>({key:this.transform.invert(i),value:n}))}queryKeys(e,t){return Xf(this.child.queryKeys(e,t),i=>this.transform.invert(i))}close(){return this.child.close()}};zG.exports=VG});var $G=y((sCt,HG)=>{f();"use strict";HG.exports=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`});var MT=y((oCt,XG)=>{f();"use strict";var{Key:GG}=Ut(),SUe=$G(),W_="/repo/flatfs/shard/",WG="SHARDING",xUe="_README",Y_=class{constructor(e){this.param=e,this.name="base",this._padding=""}fun(e){return"implement me"}toString(){return`${W_}v1/${this.name}/${this.param}`}},NT=class extends Y_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="prefix"}fun(e){return(e+this._padding).slice(0,this.param)}},DT=class extends Y_{constructor(e){super(e);this._padding="".padStart(e,"_"),this.name="suffix"}fun(e){let t=this._padding+e;return t.slice(t.length-this.param)}},BT=class extends Y_{constructor(e){super(e);this._padding="".padStart(e+1,"_"),this.name="next-to-last"}fun(e){let t=this._padding+e,i=t.length-this.param-1;return t.slice(i,i+this.param)}};function YG(r){if(r=r.trim(),r.length===0)throw new Error("empty shard string");if(!r.startsWith(W_))throw new Error(`invalid or no path prefix: ${r}`);let e=r.slice(W_.length).split("/"),t=e[0];if(t!=="v1")throw new Error(`expect 'v1' version, got '${t}'`);let i=e[1];if(!e[2])throw new Error("missing param");let n=parseInt(e[2],10);switch(i){case"prefix":return new NT(n);case"suffix":return new DT(n);case"next-to-last":return new BT(n);default:throw new Error(`unkown sharding function: ${i}`)}}var AUe=async(r,e)=>{let t=new GG(r).child(new GG(WG)),n=await(typeof e.getRaw=="function"?e.getRaw.bind(e):e.get.bind(e))(t);return YG(new TextDecoder().decode(n||"").trim())};XG.exports={readme:SUe,parseShardFun:YG,readShardFun:AUe,Prefix:NT,Suffix:DT,NextToLast:BT,README_FN:xUe,SHARDING_FN:WG,PREFIX:W_}});var ZG=y((aCt,QG)=>{f();"use strict";var{Adapter:IUe,Key:X_,Errors:TUe}=Ut(),Nm=MT(),RUe=qm(),Fp=new X_(Nm.SHARDING_FN),Dm=new X_(Nm.README_FN),Qf=class extends IUe{constructor(e,t){super();this.child=new RUe(e,{convert:this._convertKey.bind(this),invert:this._invertKey.bind(this)}),this.shard=t}async open(){await this.child.open(),this.shard=await Qf.create(this.child,this.shard)}_convertKey(e){let t=e.toString();return t===Fp.toString()||t===Dm.toString()?e:new X_(this.shard.fun(t)).child(e)}_invertKey(e){let t=e.toString();return t===Fp.toString()||t===Dm.toString()?e:X_.withNamespaces(e.list().slice(1))}static async createOrOpen(e,t){try{await Qf.create(e,t)}catch(i){if(i&&i.message!=="datastore exists")throw i}return Qf.open(e)}static async open(e){let t=await Nm.readShardFun("/",e);return new Qf(e,t)}static async create(e,t){let i=await e.has(Fp);if(!i&&!t)throw TUe.dbOpenFailedError(Error("Shard is required when datastore doesn't have a shard key already."));if(!i){let a=typeof e.putRaw=="function"?e.putRaw.bind(e):e.put.bind(e);return await Promise.all([a(Fp,new TextEncoder().encode(t.toString()+`
`)),a(Dm,new TextEncoder().encode(Nm.readme))]),t}let n=await Nm.readShardFun("/",e),s=(n||"").toString(),o=t.toString();if(s!==o)throw new Error(`specified fun ${o} does not match repo shard fun ${s}`);return n}put(e,t,i){return this.child.put(e,t,i)}get(e,t){return this.child.get(e,t)}has(e,t){return this.child.has(e,t)}delete(e,t){return this.child.delete(e,t)}async*putMany(e,t={}){yield*this.child.putMany(e,t)}async*getMany(e,t={}){yield*this.child.getMany(e,t)}async*deleteMany(e,t={}){yield*this.child.deleteMany(e,t)}batch(){return this.child.batch()}query(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.key.toString()!==Fp.toString(),s=>s.key.toString()!==Dm.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s.key).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>({key:c,value:u})=>o({key:this._invertKey(c),value:u}));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s({key:this._invertKey(a.key),value:a.value},{key:this._invertKey(c.key),value:c.value}))),this.child.query(i,t)}queryKeys(e,t){let i={offset:e.offset,limit:e.limit,orders:[],filters:[s=>s.toString()!==Fp.toString(),s=>s.toString()!==Dm.toString()]},{prefix:n}=e;if(n!=null&&i.filters.push(s=>this._invertKey(s).toString().startsWith(n)),e.filters!=null){let s=e.filters.map(o=>c=>o(this._invertKey(c)));i.filters=i.filters.concat(s)}return e.orders!=null&&(i.orders=e.orders.map(s=>(a,c)=>s(this._invertKey(a),this._invertKey(c)))),this.child.queryKeys(i,t)}close(){return this.child.close()}};QG.exports=Qf});var sW=y((cCt,nW)=>{f();"use strict";var{Adapter:CUe,Key:PUe,Errors:LT,utils:{sortAll:JG,replaceStartWith:UT}}=Ut(),Q_=Ya(),eW=bp(),tW=Cp(),rW=qm(),iW=class extends CUe{constructor(e){super();this.mounts=e.slice()}async open(){await Promise.all(this.mounts.map(e=>e.datastore.open()))}_lookup(e){for(let t of this.mounts)if(t.prefix.toString()===e.toString()||t.prefix.isAncestorOf(e)){let i=UT(e.toString(),t.prefix.toString());return{datastore:t.datastore,mountpoint:t.prefix,rest:new PUe(i)}}}put(e,t,i){let n=this._lookup(e);if(n==null)throw LT.dbWriteFailedError(new Error("No datastore mounted for this key"));return n.datastore.put(n.rest,t,i)}get(e,t){let i=this._lookup(e);if(i==null)throw LT.notFoundError(new Error("No datastore mounted for this key"));return i.datastore.get(i.rest,t)}has(e,t){let i=this._lookup(e);return i==null?Promise.resolve(!1):i.datastore.has(i.rest,t)}delete(e,t){let i=this._lookup(e);if(i==null)throw LT.dbDeleteFailedError(new Error("No datastore mounted for this key"));return i.datastore.delete(i.rest,t)}async close(){await Promise.all(this.mounts.map(e=>e.datastore.close()))}batch(){let e={},t=i=>{let n=this._lookup(i);if(n==null)throw new Error("No datastore mounted for this key");let s=n.mountpoint.toString();return e[s]==null&&(e[s]=n.datastore.batch()),{batch:e[s],rest:n.rest}};return{put:(i,n)=>{let s=t(i);s.batch.put(s.rest,n)},delete:i=>{let n=t(i);n.batch.delete(n.rest)},commit:async i=>{await Promise.all(Object.keys(e).map(n=>e[n].commit(i)))}}}query(e,t){let i=this.mounts.map(s=>{let o=new rW(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=UT(e.prefix,s.prefix.toString())),o.query({prefix:a,filters:e.filters},t)}),n=tW(...i);if(e.filters&&e.filters.forEach(s=>{n=Q_(n,s)}),e.orders&&e.orders.forEach(s=>{n=JG(n,s)}),e.offset!=null){let s=0;n=Q_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=eW(n,e.limit)),n}queryKeys(e,t){let i=this.mounts.map(s=>{let o=new rW(s.datastore,{convert:c=>{throw new Error("should never be called")},invert:c=>s.prefix.child(c)}),a;return e.prefix!=null&&(a=UT(e.prefix,s.prefix.toString())),o.queryKeys({prefix:a,filters:e.filters},t)}),n=tW(...i);if(e.filters&&e.filters.forEach(s=>{n=Q_(n,s)}),e.orders&&e.orders.forEach(s=>{n=JG(n,s)}),e.offset!=null){let s=0;n=Q_(n,()=>s++>=e.offset)}return e.limit!=null&&(n=eW(n,e.limit)),n}};nW.exports=iW});var lW=y((uCt,uW)=>{f();"use strict";var{Adapter:OUe,Errors:Z_}=Ut(),kUe=be()("datastore:core:tiered"),oW=Qa(),aW=Wa(),cW=class extends OUe{constructor(e){super();this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch(e){throw Z_.dbOpenFailedError()}}async put(e,t){try{await Promise.all(this.stores.map(i=>i.put(e,t)))}catch(i){throw Z_.dbWriteFailedError()}}async get(e,t){for(let i of this.stores)try{let n=await i.get(e,t);if(n)return n}catch(n){kUe(n)}throw Z_.notFoundError()}async has(e,t){for(let i of this.stores)if(await i.has(e,t))return!0;return!1}async delete(e,t){try{await Promise.all(this.stores.map(i=>i.delete(e,t)))}catch(i){throw Z_.dbDeleteFailedError()}}async*putMany(e,t={}){let i,n=this.stores.map(s=>{let o=oW();return aW(s.putMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async*deleteMany(e,t={}){let i,n=this.stores.map(s=>{let o=oW();return aW(s.deleteMany(o,t)).catch(a=>{i=a}),o});try{for await(let s of e){if(i)throw i;n.forEach(o=>o.push(s)),yield s}}finally{n.forEach(s=>s.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(t=>t.batch());return{put:(t,i)=>{e.forEach(n=>n.put(t,i))},delete:t=>{e.forEach(i=>i.delete(t))},commit:async t=>{for(let i of e)await i.commit(t)}}}query(e,t){return this.stores[this.stores.length-1].query(e,t)}queryKeys(e,t){return this.stores[this.stores.length-1].queryKeys(e,t)}};uW.exports=cW});var hW=y((lCt,dW)=>{f();"use strict";var FT=Ut().Key,qUe=qm(),fW=class extends qUe{constructor(e,t){super(e,{convert(i){return t.child(i)},invert(i){if(t.toString()==="/")return i;if(!t.isAncestorOf(i))throw new Error(`Expected prefix: (${t.toString()}) in key: ${i.toString()}`);return new FT(i.toString().slice(t.toString().length),!1)}});this.prefix=t}query(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.query(Object.assign({},e,{prefix:this.prefix.child(new FT(e.prefix)).toString()})):super.query(e,t)}queryKeys(e,t){return e.prefix&&this.prefix.toString()!=="/"?super.queryKeys(Object.assign({},e,{prefix:this.prefix.child(new FT(e.prefix)).toString()})):super.queryKeys(e,t)}};dW.exports=fW});var yW=y((fCt,pW)=>{f();"use strict";var NUe=qm(),DUe=ZG(),BUe=sW(),MUe=lW(),LUe=hW(),UUe=MT();pW.exports={KeytransformDatastore:NUe,ShardingDatastore:DUe,MountDatastore:BUe,TieredDatastore:MUe,NamespaceDatastore:LUe,shard:UUe}});var Bm=y((KT,jT)=>{f();(function(r,e){typeof KT=="object"&&typeof jT!="undefined"?jT.exports=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}:typeof define=="function"&&define.amd?define(function(){return function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}}):r.dlv=function(t,i,n,s,o){for(i=i.split?i.split("."):i,s=0;s<i.length;s++)t=t?t[i[s]]:o;return t===o?n:t}})(KT)});var vW=y((dCt,bW)=>{f();"use strict";var FUe=ae(),{toString:gW}=(tt(),et),{fromString:mW}=(ft(),ht),J_="/record/";function KUe(r){return gW(r,"base32")}function jUe(r){(typeof r=="string"||r instanceof String)&&(r=mW(r.toString()));let e=gW(r,"base64url");return`${J_}${e}`}function VUe(r){if(r.substring(0,J_.length)!==J_)throw FUe(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=r.substring(J_.length);return mW(e,"base64url")}bW.exports={encodeBase32:KUe,keyToTopic:jUe,topicToKey:VUe}});var AW=y((SW,xW)=>{f();"use strict";var{Key:VT,Adapter:zUe}=Ut(),{encodeBase32:wW,keyToTopic:e2,topicToKey:HUe}=vW(),{equals:$Ue}=(di(),fi),eo=ae(),_W=be(),mn=Object.assign(_W("datastore-pubsub:publisher"),{error:_W("datastore-pubsub:publisher:error")}),EW=class extends zUe{constructor(e,t,i,n,s){super();if(!n)throw eo(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof n.validate!="function")throw eo(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof n.select!="function")throw eo(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw eo(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=t,this._peerId=i,this._validator=n,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this)}async put(e,t){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw mn.error(n),eo(new Error(n),"ERR_INVALID_DATASTORE_KEY")}if(!(t instanceof Uint8Array)){let n="received value is not a Uint8Array";throw mn.error(n),eo(new Error(n),"ERR_INVALID_VALUE_RECEIVED")}let i=e2(e);mn(`publish value for topic ${i}`),await this._pubsub.publish(i,t)}async get(e){if(!(e instanceof Uint8Array)){let n="datastore key does not have a valid format";throw mn.error(n),eo(new Error(n),"ERR_INVALID_DATASTORE_KEY")}let t=e2(e),i=await this._pubsub.getTopics();if(i&&Array.isArray(i)&&i.indexOf(t)>-1)return this._getLocal(e);try{this._pubsub.on(t,this._onMessage),await this._pubsub.subscribe(t)}catch(n){let s=`cannot subscribe topic ${t}`;throw mn.error(s),eo(new Error(s),"ERR_SUBSCRIBING_TOPIC")}return mn(`subscribed values for key ${t}`),this._getLocal(e)}unsubscribe(e){let t=e2(e);return this._pubsub.removeListener(t,this._onMessage),this._pubsub.unsubscribe(t)}async _getLocal(e){let t=new VT("/"+wW(e),!1),i;try{i=await this._datastore.get(t)}catch(n){if(n.code!=="ERR_NOT_FOUND"){let o=`unexpected error getting the ipns record for ${t.toString()}`;throw mn.error(o),eo(new Error(o),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let s=`local record requested was not found for ${t.toString()}`;throw mn.error(s),eo(new Error(s),"ERR_NOT_FOUND")}if(!(i instanceof Uint8Array)){let n="found record that we couldn't convert to a value";throw mn.error(n),eo(new Error(n),"ERR_INVALID_RECORD_RECEIVED")}return i}async _onMessage(e){let{data:t,from:i,topicIDs:n}=e,s;try{s=HUe(n[0])}catch(o){mn.error(o);return}if(mn(`message received for topic ${n[0]}`),i===this._peerId.toB58String()){mn("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let o;try{o=await this._handleSubscriptionKeyFn(s)}catch(a){mn.error("message discarded by the subscriptionKeyFn");return}s=o}try{await this._storeIfSubscriptionIsBetter(s,t)}catch(o){mn.error(o)}}async _storeIfSubscriptionIsBetter(e,t){let i=!1;try{i=await this._isBetter(e,t)}catch(n){if(n.code!=="ERR_NOT_VALID_RECORD")throw n}i&&await this._storeRecord(e,t)}async _validateRecord(e,t){return this._validator.validate(e,t)}async _selectRecord(e,t){return await this._validator.select(e,t)===0}async _isBetter(e,t){try{await this._validateRecord(t,e)}catch(s){let o="record received through pubsub is not valid";throw mn.error(o),eo(new Error(o),"ERR_NOT_VALID_RECORD")}let i=new VT(e),n;try{n=await this._getLocal(i.uint8Array())}catch(s){return!0}return $Ue(n,t)?!1:this._selectRecord(e,[n,t])}async _storeRecord(e,t){let i=new VT("/"+wW(e),!1);await this._datastore.put(i,t),mn(`record for ${e2(e)} was stored in the datastore`)}};SW=xW.exports=EW});var HT=y((hCt,kW)=>{f();"use strict";var yl=Lp(),{base58btc:IW}=(ei(),Jr),GUe=AW(),{fromString:TW}=(ft(),ht),{toString:RW}=(tt(),et),CW=ae(),PW=be(),zT=Object.assign(PW("ipfs:ipns:pubsub"),{error:PW("ipfs:ipns:pubsub:error")}),OW=class{constructor(e,t,i){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new GUe(e,t,i,yl.validator,this._handleSubscriptionKey)}put(e,t){return this._pubsubDs.put(e,t)}async get(e){let t,i;try{t=await this._pubsubDs.get(e)}catch(s){i=s}let n=e.slice(0,yl.namespaceLength);if(RW(n)===yl.namespace){let s=IW.encode(e).substring(1),o=IW.encode(e.slice(yl.namespaceLength)).substring(1);this._subscriptions[s]=o,zT(`subscribed to pubsub topic ${s}, id ${o}`)}if(i)throw i;return t}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=RW(e,"base58btc"));let t=this._subscriptions[e];if(!t)throw CW(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");let i;try{i=yl.getIdKeys(TW(t,"base58btc"))}catch(n){throw zT.error(n),n}return i.routingKey.uint8Array()}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(t=>`${yl.namespace}${t}`)}async cancel(e){if(typeof e!="string")throw CW(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(yl.namespace)&&(e=e.substring(yl.namespaceLength));let t=Object.keys(this._subscriptions).find(n=>this._subscriptions[n]===e);if(!t)return{canceled:!1};let i=TW(t);return this._pubsubDs.unsubscribe(i),delete this._subscriptions[t],zT(`unsubscribed pubsub ${t}: ${e}`),{canceled:!0}}};kW.exports=OW});var DW=y((pCt,NW)=>{f();"use strict";var Kp=ki(),qW=Kp.Reader,WUe=Kp.Writer,to=Kp.util,Mm=Kp.roots["libp2p-record"]||(Kp.roots["libp2p-record"]={});Mm.Record=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.key=to.newBuffer([]),r.prototype.value=to.newBuffer([]),r.prototype.timeReceived="",r.encode=function(t,i){return i||(i=WUe.create()),t.key!=null&&Object.hasOwnProperty.call(t,"key")&&i.uint32(10).bytes(t.key),t.value!=null&&Object.hasOwnProperty.call(t,"value")&&i.uint32(18).bytes(t.value),t.timeReceived!=null&&Object.hasOwnProperty.call(t,"timeReceived")&&i.uint32(42).string(t.timeReceived),i},r.decode=function(t,i){t instanceof qW||(t=qW.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Mm.Record;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.key=t.bytes();break;case 2:s.value=t.bytes();break;case 5:s.timeReceived=t.string();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Mm.Record)return t;var i=new Mm.Record;return t.key!=null&&(typeof t.key=="string"?to.base64.decode(t.key,i.key=to.newBuffer(to.base64.length(t.key)),0):t.key.length&&(i.key=t.key)),t.value!=null&&(typeof t.value=="string"?to.base64.decode(t.value,i.value=to.newBuffer(to.base64.length(t.value)),0):t.value.length&&(i.value=t.value)),t.timeReceived!=null&&(i.timeReceived=String(t.timeReceived)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.key="":(n.key=[],i.bytes!==Array&&(n.key=to.newBuffer(n.key))),i.bytes===String?n.value="":(n.value=[],i.bytes!==Array&&(n.value=to.newBuffer(n.value))),n.timeReceived=""),t.key!=null&&t.hasOwnProperty("key")&&(n.key=i.bytes===String?to.base64.encode(t.key,0,t.key.length):i.bytes===Array?Array.prototype.slice.call(t.key):t.key),t.value!=null&&t.hasOwnProperty("value")&&(n.value=i.bytes===String?to.base64.encode(t.value,0,t.value.length):i.bytes===Array?Array.prototype.slice.call(t.value):t.value),t.timeReceived!=null&&t.hasOwnProperty("timeReceived")&&(n.timeReceived=t.timeReceived),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Kp.util.toJSONOptions)},r}();NW.exports=Mm});var BW=y((yCt,$T)=>{f();"use strict";$T.exports.toRFC3339=r=>{let e=r.getUTCFullYear(),t=String(r.getUTCMonth()+1).padStart(2,"0"),i=String(r.getUTCDate()).padStart(2,"0"),n=String(r.getUTCHours()).padStart(2,"0"),s=String(r.getUTCMinutes()).padStart(2,"0"),o=String(r.getUTCSeconds()).padStart(2,"0"),c=r.getUTCMilliseconds()*1e3*1e3;return`${e}-${t}-${i}T${n}:${s}:${o}.${c}Z`};$T.exports.parseRFC3339=r=>{let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),t=String(r).trim().match(e);if(!t)throw new Error("Invalid format");let i=parseInt(t[1],10),n=parseInt(t[2],10)-1,s=parseInt(t[3],10),o=parseInt(t[4],10),a=parseInt(t[5],10),c=parseInt(t[6],10),u=parseInt(t[7].slice(0,-6),10);return new Date(Date.UTC(i,n,s,o,a,c,u))}});var UW=y((gCt,LW)=>{f();"use strict";var{Record:GT}=DW(),MW=BW(),Lm=class{constructor(e,t,i){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(t instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=t,this.timeReceived=i}serialize(){return GT.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&MW.toRFC3339(this.timeReceived)}}static deserialize(e){let t=GT.decode(e);return Lm.fromDeserialized(GT.toObject(t,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(e){let t;return e.timeReceived&&(t=MW.parseRFC3339(e.timeReceived)),new Lm(e.key,e.value,t)}};LW.exports=Lm});var KW=y((mCt,FW)=>{f();"use strict";var{sha256:YUe}=(ri(),li),t2=ae(),{toString:XUe}=(tt(),et),{equals:QUe}=(di(),fi),ZUe=async(r,e)=>{if(!(r instanceof Uint8Array))throw t2(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(r.byteLength<5)throw t2(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(XUe(r.subarray(0,4))!=="/pk/")throw t2(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let i=r.slice(4),n=await YUe.digest(e);if(!QUe(i,n.bytes))throw t2(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")};FW.exports={func:ZUe,sign:!1}});var VW=y((bCt,jW)=>{f();"use strict";jW.exports={pk:KW()}});var HW=y((vCt,zW)=>{f();"use strict";var JUe=ae(),{toString:eFe}=(tt(),et),tFe=(r,e)=>{let t=e.key,n=eFe(t).split("/");if(n.length<3)return;let s=r[n[1].toString()];if(!s){let o="Invalid record keytype";throw JUe(new Error(o),"ERR_INVALID_RECORD_KEY_TYPE")}return s.func(t,e.value)};zW.exports={verifyRecord:tFe,validators:VW()}});var GW=y((wCt,$W)=>{f();"use strict";var rFe=(r,e)=>0;$W.exports=rFe});var YW=y((_Ct,WW)=>{f();"use strict";WW.exports={pk:GW()}});var QW=y((ECt,XW)=>{f();"use strict";var WT=ae(),{toString:iFe}=(tt(),et),nFe=(r,e,t)=>{if(t.length===0){let o="No records given";throw WT(new Error(o),"ERR_NO_RECORDS_RECEIVED")}let n=iFe(e).split("/");if(n.length<3){let o="Record key does not have a selector function";throw WT(new Error(o),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let s=r[n[1].toString()];if(!s){let o=`Unrecognized key prefix: ${n[1]}`;throw WT(new Error(o),"ERR_UNRECOGNIZED_KEY_PREFIX")}return s(e,t)};XW.exports={bestRecord:nFe,selectors:YW()}});var Zf=y((SCt,ZW)=>{f();"use strict";ZW.exports={Record:UW(),validator:HW(),selection:QW()}});var YT=y((xCt,eY)=>{f();"use strict";var JW=Lp(),{toString:sFe}=(tt(),et);eY.exports={encodeBase32:r=>sFe(r,"base32upper"),validator:{func:(r,e)=>JW.validator.validate(e,r)},selector:(r,e)=>JW.validator.select(e[0],e[1])}});var QT=y((nY,sY)=>{f();"use strict";var{Key:oFe}=Ut(),{Record:tY}=Zf(),{encodeBase32:aFe}=YT(),Um=ae(),rY=be(),XT=Object.assign(rY("ipfs:ipns:offline-datastore"),{error:rY("ipfs:ipns:offline-datastore:error")}),iY=class{constructor(e){this._repo=e,this.stores=[]}async put(e,t){if(!(e instanceof Uint8Array))throw Um(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(t instanceof Uint8Array))throw Um(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let i;try{i=this._routingKey(e)}catch(s){throw XT.error(s),Um(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=new tY(e,t);return this._repo.datastore.put(i,n.serialize())}async get(e){if(!(e instanceof Uint8Array))throw Um(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let t;try{t=this._routingKey(e)}catch(s){throw XT.error(s),Um(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=await this._repo.datastore.get(t),n;try{n=tY.deserialize(i)}catch(s){throw XT.error(s),s}return n.value}_routingKey(e){return new oFe("/"+aFe(e),!1)}};nY=sY.exports=iY});var aY=y((ACt,oY)=>{f();"use strict";var{TieredDatastore:cFe}=yW(),ZT=Bm(),uFe=HT(),lFe=QT();oY.exports=({libp2p:r,repo:e,peerId:t,options:i})=>{let n=[],s;if(ZT(i,"EXPERIMENTAL.ipnsPubsub",!1)){let o=r.pubsub,a=e.datastore;s=new uFe(o,a,t),n.push(s)}if(ZT(i,"offline")||!ZT(i,"libp2p.config.dht.enabled",!1)){let o=new lFe(e);n.push(o)}else n.push(r._dht);return new cFe(n)}});var dY=y((ICt,fY)=>{f();"use strict";var cY=jG(),fFe=aY(),dFe=QT(),{NotInitializedError:hFe,AlreadyInitializedError:uY}=ul(),pFe=be()("ipfs:components:ipns"),lY=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new hFe}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:t,keychain:i}){if(this.offline!=null)throw new uY;pFe("initializing IPNS keyspace");let n=new dFe(e),s=new cY(n,e.datastore,t,i,this.options);this.offline=s}async startOnline({libp2p:e,repo:t,peerId:i,keychain:n}){if(this.online!=null)throw new uY;let s=fFe({libp2p:e,repo:t,peerId:i,options:this.options}),o=new cY(s,t.datastore,i,n,this.options);await o.republisher.start(),this.online=o}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,t,i){return this.getIPNS().publish(e,t,i)}resolve(e,t){return this.getIPNS().resolve(e,t)}initializeKeyspace(e,t){return this.getIPNS().initializeKeyspace(e,t)}};fY.exports=lY});var pY=y(hY=>{f();"use strict";var yFe=sp(),gFe=pm(),mFe=Wa(),{resolve:bFe}=Ki();hY.resolvePath=async({ipns:r,repo:e,codecs:t},i,n)=>{if(yFe.ipnsPath(i))return r.resolve(i);let{cid:s,path:o}=gFe(i);await mFe(bFe(s,o||"",t,e,n))}});var bY=y((RCt,mY)=>{f();"use strict";var yY=be(),{default:vFe}=dm(),wFe=za(),gY=ae(),{fromString:_Fe}=(ft(),ht),{toString:EFe}=(tt(),et),JT=Object.assign(yY("ipfs:name:publish"),{error:yY("ipfs:name:publish:error")}),{OFFLINE_ERROR:SFe,normalizePath:xFe}=Ki(),AFe=Oe(),{resolvePath:IFe}=pY();mY.exports=({ipns:r,repo:e,codecs:t,peerId:i,isOnline:n,keychain:s})=>{let o=async c=>{if(c==="self")return i.privKey;try{let u=await s.exportKey(c,"temp");return await wFe.keys.import(u,"temp")}catch(u){throw JT.error(u),gY(u,"ERR_CANNOT_GET_KEY")}};async function a(c,u={}){let l=u.resolve!==!1,d=u.lifetime||"24h",h=u.key||"self";if(!n())throw gY(new Error(SFe),"OFFLINE_ERROR");try{c=xFe(c)}catch(v){throw JT.error(v),v}let p=0;try{p=vFe(d)||0,p=parseFloat(p.toFixed(6))}catch(v){throw JT.error(v),v}let g=await Promise.all([o(h),l?IFe({ipns:r,repo:e,codecs:t},c):Promise.resolve()]),b=_Fe(c),E=await r.publish(g[0],b,p);return{name:E.name,value:EFe(E.value)}}return AFe(a)}});var wY=y((CCt,vY)=>{f();"use strict";var TFe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;vY.exports=function(e,t){if(t==null&&(t=!1),e.length<2||e.length>255)return!1;var i=e[e.length-1];if(t){if(i!==".")return!1}else if(i===".")return!1;return TFe.test(e)}});var xY=y((PCt,SY)=>{f();"use strict";var _Y=be(),e5=ae(),RFe=gr().bind({ignoreUndefined:!0}),{CID:CFe}=(Ie(),De),PFe=rt(),OFe=wY(),{toString:kFe}=(tt(),et),qFe=Object.assign(_Y("ipfs:name:resolve"),{error:_Y("ipfs:name:resolve:error")}),{OFFLINE_ERROR:NFe}=Ki(),DFe=Oe(),EY=(r,e)=>e.length>0?r+"/"+e.join("/"):r;SY.exports=({dns:r,ipns:e,peerId:t,isOnline:i,options:{offline:n}})=>{async function*s(o,a={}){if(a=RFe({nocache:!1,recursive:!0},a),n&&a&&a.nocache)throw e5(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");o||(o=t.toB58String()),o.startsWith("/ipns/")||(o=`/ipns/${o}`);let[c,u,...l]=o.slice(1).split("/");try{u.substring(0,1)==="1"?PFe.parse(u):CFe.parse(u)}catch(h){if(OFe(u)){yield EY(await r(u,a),l);return}throw qFe.error(h),e5(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}if(!i()&&!n)throw e5(new Error(NFe),"OFFLINE_ERROR");let d=await e.resolve(`/${c}/${u}`,a);yield EY(d instanceof Uint8Array?kFe(d):d,l)}return DFe(s)}});var r2=y(TY=>{f();"use strict";var AY=HT(),IY=ae();TY.getPubsubRouting=(r,e)=>{if(!r||!(e&&e.ipnsPubsub))throw IY(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(r.routing instanceof AY)return r.routing;let t=(r.routing.stores||[]).find(i=>i instanceof AY);if(!t)throw IY(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return t}});var CY=y((kCt,RY)=>{f();"use strict";var{getPubsubRouting:BFe}=r2(),MFe=Oe();RY.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n,s={}){return BFe(r,t).cancel(n,s)}return MFe(i)}});var OY=y((qCt,PY)=>{f();"use strict";var{getPubsubRouting:LFe}=r2(),UFe=Oe();PY.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){try{return{enabled:Boolean(LFe(r,t))}}catch(s){return{enabled:!1}}}return UFe(i)}});var qY=y((NCt,kY)=>{f();"use strict";var{getPubsubRouting:FFe}=r2(),KFe=Oe();kY.exports=({ipns:r,options:e})=>{let t=e.EXPERIMENTAL;async function i(n={}){return FFe(r,t).getSubscriptions(n)}return KFe(i)}});var BY=y((DCt,DY)=>{f();"use strict";var jFe=CY(),VFe=OY(),zFe=qY(),NY=class{constructor({ipns:e,options:t}){this.cancel=jFe({ipns:e,options:t}),this.state=VFe({ipns:e,options:t}),this.subs=zFe({ipns:e,options:t})}};DY.exports=NY});var UY=y((BCt,LY)=>{f();"use strict";var HFe=bY(),$Fe=xY(),GFe=BY(),MY=class{constructor({dns:e,ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a,options:c}){this.publish=HFe({ipns:t,repo:i,codecs:n,peerId:s,isOnline:o,keychain:a}),this.resolve=$Fe({dns:e,ipns:t,peerId:s,isOnline:o,options:c}),this.pubsub=new GFe({ipns:t,options:c})}};LY.exports=MY});var jY=y((MCt,r5)=>{f();"use strict";var WFe=(_t(),Mt),{Errors:YFe}=Ut(),XFe=YFe.notFoundError().code,QFe=Oe(),FY=pm(),{CID:KY}=(Ie(),De),i2={default:"<dst>",edges:"<src> -> <dst>"};r5.exports=function({repo:r,codecs:e,resolve:t,preload:i}){async function*n(s,o={}){if(o.maxDepth===0)return;if(o.edges&&o.format&&o.format!==i2.default)throw new Error("Cannot set edges to true and also specify format");o.format=o.edges?i2.edges:o.format,typeof o.maxDepth!="number"&&(o.maxDepth=o.recursive?1/0:1);let c=(Array.isArray(s)?s:[s]).map(u=>ZFe(i,u,o));for(let u of c)yield*JFe(t,r,e,u,o)}return QFe(n)};r5.exports.Format=i2;function ZFe(r,e,t){let{cid:i,path:n}=FY(e);return t.preload!==!1&&r(i),`/ipfs/${i}${n||""}`}async function*JFe(r,e,t,i,n){let s=await r(i),{cid:o}=FY(s),a=n.maxDepth!=null?n.maxDepth:1/0,c=n.unique||!1;for await(let u of tKe(e,t,o,a,c))!u.parent||u.isDuplicate||(yield{ref:eKe(u.parent.cid,u.node.cid,u.node.name,n.format)})}function eKe(r,e,t="",i=i2.default){let n=i.replace(/<src>/g,r.toString());return n=n.replace(/<dst>/g,e.toString()),n=n.replace(/<linkname>/g,t),n}async function*tKe(r,e,t,i,n){let s=new Set;async function*o(a,c){let u=c+1;if(!(u>i))try{for await(let l of rKe(r,e,a.cid))yield{parent:a,node:l,isDuplicate:n&&s.has(l.cid.toString())},n&&s.add(l.cid.toString()),yield*o(l,u)}catch(l){throw l.code===XFe&&(l.message=`Could not find object with CID: ${a.cid}`),l}}yield*o({cid:t},0)}async function*rKe(r,e,t,i=[]){let n=await r.blocks.get(t),o=(await e.getCodec(t.code)).decode(n),a=t.code===WFe.code;for(let[c,u]of t5(o,i)){if(a){let l=c.match(/^Links\/(\d+)\/Hash$/);if(l){let d=Number(l[1]);if(d<o.Links.length){yield{name:o.Links[d].Name,cid:u};continue}}}yield{name:c,cid:u}}}var t5=function*(r,e){if(r!=null&&!(r instanceof Uint8Array)){for(let[t,i]of Object.entries(r)){let n=[...e,t];if(i!=null&&typeof i=="object")if(Array.isArray(i))for(let[s,o]of i.entries()){let a=[...n,s],c=KY.asCID(o);c?yield[a.join("/"),c]:typeof o=="object"&&(yield*t5(o,a))}else{let s=KY.asCID(i);s?yield[n.join("/"),s]:yield*t5(i,n)}}return[]}}});var zY=y((LCt,VY)=>{f();"use strict";var iKe=Oe();VY.exports=function({repo:r}){async function*e(t={}){for await(let i of r.blocks.queryKeys({},{signal:t.signal}))yield{ref:i.toString()}}return iKe(e)}});var $Y=y((UCt,HY)=>{f();"use strict";var nKe=Oe();HY.exports=({network:r})=>{async function e(t={}){let{bitswap:i}=await r.use(t),n=i.getWantlist();return Array.from(n).map(s=>s[1].cid)}return nKe(e)}});var WY=y((FCt,GY)=>{f();"use strict";var sKe=rt(),oKe=Oe();GY.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i),s=n.wantlistForPeer(sKe.createFromB58String(t));return Array.from(s).map(o=>o[1].cid)}return oKe(e)}});var XY=y((KCt,YY)=>{f();"use strict";var aKe=Oe();YY.exports=({network:r})=>{async function e(t,i={}){let{bitswap:n}=await r.use(i);return Array.isArray(t)||(t=[t]),n.unwant(t)}return aKe(e)}});var i5=y((jCt,QY)=>{f();"use strict";var cKe=Oe();QY.exports=({network:r})=>{async function e(t={}){let i=(await r.use(t)).bitswap,n=i.stat().snapshot;return{provideBufLen:parseInt(n.providesBufferLength.toString()),blocksReceived:BigInt(n.blocksReceived.toString()),wantlist:Array.from(i.getWantlist()).map(s=>s[1].cid),peers:i.peers().map(s=>s.toB58String()),dupBlksReceived:BigInt(n.dupBlksReceived.toString()),dupDataReceived:BigInt(n.dupDataReceived.toString()),dataReceived:BigInt(n.dataReceived.toString()),blocksSent:BigInt(n.blocksSent.toString()),dataSent:BigInt(n.dataSent.toString())}}return cKe(e)}});var eX=y((VCt,JY)=>{f();"use strict";var uKe=$Y(),lKe=WY(),fKe=XY(),dKe=i5(),ZY=class{constructor({network:e}){this.wantlist=uKe({network:e}),this.wantlistForPeer=lKe({network:e}),this.unwant=fKe({network:e}),this.stat=dKe({network:e})}};JY.exports=ZY});var n5=y(tX=>{f();"use strict";var hKe=Bf().IPFS.matches;tX.isValidMultiaddr=r=>{try{return hKe(r)}catch(e){return!1}}});var iX=y((HCt,rX)=>{f();"use strict";var{isValidMultiaddr:pKe}=n5(),yKe=Oe();rX.exports=({repo:r})=>{async function e(t,i={}){if(!pKe(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i),s=n.Bootstrap||[];return s.push(t.toString()),n.Bootstrap=Array.from(new Set(s)).sort((o,a)=>o.localeCompare(a)),await r.config.replace(n),{Peers:[t]}}return yKe(e)}});var sX=y(($Ct,nX)=>{f();"use strict";var gKe=Oe(),{Multiaddr:mKe}=it();nX.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t),n=i.Bootstrap||[];return i.Bootstrap=[],await r.config.replace(i),{Peers:n.map(s=>new mKe(s))}}return gKe(e)}});var aX=y((GCt,oX)=>{f();"use strict";var bKe=Oe(),{Multiaddr:vKe}=it();oX.exports=({repo:r})=>{async function e(t={}){return{Peers:(await r.config.get("Bootstrap",t)||[]).map(n=>new vKe(n))}}return bKe(e)}});var n2=y((WCt,cX)=>{f();"use strict";cX.exports=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}})});var fX=y((YCt,lX)=>{f();"use strict";var uX=n2(),wKe=Oe(),{Multiaddr:_Ke}=it();lX.exports=({repo:r})=>{async function e(t={}){let i=await r.config.getAll(t);return i.Bootstrap=uX().Bootstrap,await r.config.replace(i),{Peers:uX().Bootstrap.map(n=>new _Ke(n))}}return wKe(e)}});var hX=y((XCt,dX)=>{f();"use strict";var{isValidMultiaddr:EKe}=n5(),SKe=Oe();dX.exports=({repo:r})=>{async function e(t,i={}){if(!EKe(t))throw new Error(`${t} is not a valid Multiaddr`);let n=await r.config.getAll(i);return n.Bootstrap=(n.Bootstrap||[]).filter(s=>s.toString()!==t.toString()),await r.config.replace(n),{Peers:[t]}}return SKe(e)}});var gX=y((QCt,yX)=>{f();"use strict";var xKe=iX(),AKe=sX(),IKe=aX(),TKe=fX(),RKe=hX(),pX=class{constructor({repo:e}){this.add=xKe({repo:e}),this.list=IKe({repo:e}),this.rm=RKe({repo:e}),this.clear=AKe({repo:e}),this.reset=TKe({repo:e})}};yX.exports=pX});var bX=y((ZCt,mX)=>{f();"use strict";var CKe=Oe();mX.exports=({preload:r,repo:e})=>{async function t(i,n={}){return n.preload!==!1&&r(i),e.blocks.get(i,n)}return CKe(t)}});var wX=y((JCt,vX)=>{f();"use strict";var{CID:PKe}=(Ie(),De),OKe=Oe();vX.exports=({codecs:r,hashers:e,repo:t,preload:i})=>{async function n(s,o={}){let a=o.pin?await t.gcLock.readLock():null;try{let c=o.version!=null?o.version:0,u=o.format||(c===0?"dag-pb":"raw"),d=await(await e.getHasher(o.mhtype||"sha2-256")).digest(s),h=await r.getCodec(u),p=PKe.create(c,h.code,d);return await t.blocks.put(p,s,{signal:o.signal}),o.preload!==!1&&i(p),o.pin===!0&&await t.pins.pinRecursively(p,{signal:o.signal}),p}finally{a&&a()}}return OKe(n)}});var jp=y((s2,_X)=>{f();(function(r,e){typeof s2=="object"&&typeof _X!="undefined"?e(s2):typeof define=="function"&&define.amd?define(["exports"],e):(r=typeof globalThis!="undefined"?globalThis:r||self,e(r.streamingIterables={}))})(s2,function(r){"use strict";async function*e(I,U){let V=[];for await(let D of U)V.push(D),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function*t(I,U){let V=[];for(let D of U)V.push(D),V.length===I&&(yield V,V=[]);V.length>0&&(yield V)}function i(I,U){return U===void 0?V=>i(I,V):U[Symbol.asyncIterator]?e(I,U):t(I,U)}function n(I){if(typeof I.next=="function")return I;if(typeof I[Symbol.iterator]=="function")return I[Symbol.iterator]();if(typeof I[Symbol.asyncIterator]=="function")return I[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function s(){let I,U;return{promise:new Promise((D,Q)=>{U=D,I=Q}),reject:I,resolve:U}}function o(I,U){let V=n(U),D=[],Q=[],ee=!1,J=!1;function ue(){for(;Q.length>0&&D.length>0;){let Re=Q.shift(),{error:Ve,value:Je}=D.shift();Ve?Re.reject(Ve):Re.resolve({done:!1,value:Je})}for(;Q.length>0&&J;){let{resolve:Re}=Q.shift();Re({done:!0,value:void 0})}}async function ge(){if(!J&&!ee&&!(D.length>=I)){ee=!0;try{let{done:Re,value:Ve}=await V.next();Re?J=!0:D.push({value:Ve})}catch(Re){J=!0,D.push({error:Re})}ue(),ee=!1,ge()}}async function me(){if(D.length>0){let{error:Ve,value:Je}=D.shift();if(Ve)throw Ve;return ge(),{done:!1,value:Je}}if(J)return{done:!0,value:void 0};let Re=s();return Q.push(Re),ge(),Re.promise}let je={next:me,[Symbol.asyncIterator]:()=>je};return je}function*a(I,U){let V=[],D;try{for(let Q of U)V.push(Q),!(V.length<=I)&&(yield V.shift())}catch(Q){D=Q}for(let Q of V)yield Q;if(D)throw D}function c(I,U){return U===void 0?V=>c(I,V):I===0?U:U[Symbol.asyncIterator]?o(I,U):a(I,U)}async function u(I){let U=[];for await(let V of I)U.push(V);return U}function l(I){return I[Symbol.asyncIterator]?u(I):Array.from(I)}async function*d(I){for await(let U of I)yield*U}function*h(I){for(let U of I)yield*U}function p(...I){return I.find(V=>V[Symbol.asyncIterator]!==void 0)?d(I):h(I)}async function g(I){for await(let U of I);}function b(I){if(I[Symbol.asyncIterator])return g(I);for(let U of I);}async function*E(I,U){for await(let V of U)await I(V)&&(yield V)}function v(I,U){return U===void 0?V=>E(I,V):E(I,U)}async function*A(I){for await(let U of I)U&&typeof U!="string"&&(U[Symbol.iterator]||U[Symbol.asyncIterator])?yield*A(U):yield U}async function*R(I,U){for await(let V of U)yield await I(V)}function F(I,U){return U===void 0?V=>R(I,V):R(I,U)}function q(I,U){return U===void 0?V=>q(I,V):v(V=>V!=null,A(F(I,U)))}function N(I,U,V){let D=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,me=null;function je(){for(;ee.length>0&&Q.length>0;){let{resolve:ze}=ee.shift(),gt=Q.shift();ze({done:!1,value:gt})}for(;ee.length>0&&ge===0&&J;){let{resolve:ze,reject:gt}=ee.shift();me?(gt(me),me=null):ze({done:!0,value:void 0})}}async function Re(){if(J){je();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:ze,value:gt}=await D.next();ze?(J=!0,ge--,je()):Ve(gt)}catch(ze){J=!0,ge--,me=ze,je()}ue=!1,Re()}}async function Ve(ze){try{let gt=await U(ze);if(gt&&gt[Symbol.asyncIterator])for await(let Yt of gt)Q.push(Yt);else Q.push(gt)}catch(gt){J=!0,me=gt}ge--,je(),Re()}async function Je(){if(Q.length===0){let gt=s();return ee.push(gt),Re(),gt.promise}let ze=Q.shift();return Re(),{done:!1,value:ze}}let He={next:Je,[Symbol.asyncIterator]:()=>He};return He}function z(I,U,V){return U===void 0?(D,Q)=>Q?z(I,D,Q):z(I,D):V===void 0?D=>z(I,U,D):v(D=>D!=null,A(N(I,U,V)))}async function G(I){return new Promise(U=>{I.once("readable",()=>{U()})})}async function*Y(I){for(;;){let U=I.read();if(U!==null){yield U;continue}if(I._readableState.ended)break;await G(I)}}function C(I){return typeof I[Symbol.asyncIterator]=="function"?I:Y(I)}async function*m(...I){let U=new Set(I.map(n));for(;U.size>0;)for(let V of U){let D=await V.next();D.done?U.delete(V):yield D.value}}function w(I,...U){let V=I();for(let D of U)V=D(V);return V}async function*S(I,U,V){let D=null,Q=ge=>({value:U(ge)}),ee=async function*(ge){for await(let me of ge){if(D)return;yield me}},J=w(()=>V,c(1),ee,F(Q),c(I-1)),ue=n(J);for(;;){let{value:ge,done:me}=await ue.next();if(me)break;try{let je=await ge.value;D||(yield je)}catch(je){D=je}}if(D)throw D}function P(I,U,V){return U===void 0?(D,Q)=>P(I,D,Q):V===void 0?D=>P(I,U,D):I===1?F(U,V):S(I,U,V)}function B(I,U,V){return U===void 0?(D,Q)=>Q?B(I,D,Q):B(I,D):V===void 0?D=>B(I,U,D):v(D=>D!=null,A(P(I,U,V)))}async function*W(...I){let U=I.map(n),V=new Set,D=new Map,Q=null,ee=null,J=null,ue=Re=>{Q=Re,ee&&ee(Re)},ge=Re=>{J&&J(Re)},me=()=>new Promise((Re,Ve)=>{if(Q&&Ve(Q),D.size>0)return Re();J=Re,ee=Ve}),je=Re=>{let Ve=Promise.resolve(Re.next()).then(async({done:Je,value:He})=>{Je||D.set(Re,He),V.delete(Ve)});V.add(Ve),Ve.then(ge,ue)};for(let Re of U)je(Re);for(;;){if(V.size===0&&D.size===0)return;await me();for(let[Re,Ve]of D)D.delete(Re),yield Ve,je(Re)}}async function j(I,U,V){let D=U;for await(let Q of V)D=await I(D,Q);return D}function M(I,U,V){return U===void 0?(D,Q)=>Q?j(I,D,Q):M(I,D):V===void 0?D=>M(I,U,D):j(I,U,V)}async function*_(I,U){let V=0;for await(let D of U)if(yield await D,V++,V>=I)break}function*L(I,U){let V=0;for(let D of U)if(yield D,V++,V>=I)break}function ce(I,U){return U===void 0?V=>ce(I,V):U[Symbol.asyncIterator]?_(I,U):L(I,U)}async function*X(I,U){for await(let V of U)await I(V),yield V}function ne(I,U){return U===void 0?V=>X(I,V):X(I,U)}function oe(I,U){let V=I[0]+U[0],D=I[1]+U[1];if(D>=1e9){let Q=D%1e9;V+=(D-Q)/1e9,D=Q}return[V,D]}async function*he(I,U){let V=U[Symbol.asyncIterator](),D=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=await V.next(),ue=process.hrtime(Q);if(D=oe(D,ue),I.progress&&I.progress(ue,D),J)return I.total&&I.total(D),ee;yield ee}}function*pe(I,U){let V=U[Symbol.iterator](),D=[0,0];for(;;){let Q=process.hrtime(),{value:ee,done:J}=V.next(),ue=process.hrtime(Q);if(D=oe(D,ue),I.progress&&I.progress(ue,D),J)return I.total&&I.total(D),ee;yield ee}}function _e(I={},U){return U===void 0?V=>_e(I,V):U[Symbol.asyncIterator]!==void 0?he(I,U):pe(I,U)}function k(I,U,V){let D=n(V),Q=[],ee=[],J=!1,ue=!1,ge=0,me=null;function je(){for(;ee.length>0&&Q.length>0;){let{resolve:ze}=ee.shift(),gt=Q.shift();ze({done:!1,value:gt})}for(;ee.length>0&&ge===0&&J;){let{resolve:ze,reject:gt}=ee.shift();me?(gt(me),me=null):ze({done:!0,value:void 0})}}async function Re(){if(J){je();return}if(!ue&&!(ge+Q.length>=I)){ue=!0,ge++;try{let{done:ze,value:gt}=await D.next();ze?(J=!0,ge--,je()):Ve(gt)}catch(ze){J=!0,ge--,me=ze,je()}ue=!1,Re()}}async function Ve(ze){try{let gt=await U(ze);Q.push(gt)}catch(gt){J=!0,me=gt}ge--,je(),Re()}async function Je(){if(Q.length===0){let gt=s();return ee.push(gt),Re(),gt.promise}let ze=Q.shift();return Re(),{done:!1,value:ze}}let He={next:Je,[Symbol.asyncIterator]:()=>He};return He}function K(I,U,V){return U===void 0?(D,Q)=>Q?K(I,D,Q):K(I,D):V===void 0?D=>K(I,U,D):k(I,U,V)}async function $(I,U){let V=null,D=null,Q=null,ee=me=>{V=me,D&&D(me)},J=()=>{Q&&Q()},ue=()=>{I.removeListener("error",ee),I.removeListener("drain",J)};I.once("error",ee);let ge=()=>new Promise((me,je)=>{if(V)return je(V);I.once("drain",J),Q=me,D=je});for await(let me of U)if(I.write(me)===!1&&await ge(),V)break;if(ue(),V)throw V}function Z(I,U){return U===void 0?V=>$(I,V):$(I,U)}r.batch=i,r.buffer=c,r.collect=l,r.concat=p,r.consume=b,r.filter=v,r.flatMap=q,r.flatTransform=z,r.flatten=A,r.fromStream=C,r.getIterator=n,r.map=F,r.merge=m,r.parallelFlatMap=B,r.parallelMap=P,r.parallelMerge=W,r.pipeline=w,r.reduce=M,r.take=ce,r.tap=ne,r.time=_e,r.transform=K,r.writeToStream=Z,Object.defineProperty(r,"__esModule",{value:!0})})});var o5=y(EX=>{f();"use strict";var{CID:s5}=(Ie(),De),kKe=ae();EX.cleanCid=r=>{if(r instanceof s5)return r;if(typeof r=="string")return s5.parse(r);if(r instanceof Uint8Array)return s5.decode(r);throw kKe(new Error("Invalid CID"),"ERR_INVALID_CID")}});var xX=y((tPt,SX)=>{f();"use strict";var qKe=ae(),{parallelMap:NKe,filter:DKe}=jp(),{pipe:BKe}=Ar(),{cleanCid:MKe}=o5(),LKe=Oe(),UKe=8;SX.exports=({repo:r})=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.gcLock.writeLock();try{yield*BKe(t,NKe(UKe,async s=>{s=MKe(s);let o={cid:s};try{if(!await r.blocks.has(s))throw qKe(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await r.blocks.delete(s)}catch(a){i.force||(a.message=`cannot remove ${s}: ${a.message}`,o.error=a)}return o}),DKe(()=>!i.quiet))}finally{n()}}return LKe(e)}});var IX=y((rPt,AX)=>{f();"use strict";var{cleanCid:FKe}=o5(),KKe=Oe();AX.exports=({repo:r,preload:e})=>{async function t(i,n={}){i=FKe(i),n.preload!==!1&&e(i);let s=await r.blocks.get(i);return{cid:i,size:s.length}}return KKe(t)}});var CX=y((iPt,RX)=>{f();"use strict";var jKe=bX(),VKe=wX(),zKe=xX(),HKe=IX(),TX=class{constructor({codecs:e,hashers:t,preload:i,repo:n}){this.get=jKe({preload:i,repo:n}),this.put=VKe({codecs:e,hashers:t,preload:i,repo:n}),this.rm=zKe({repo:n}),this.stat=HKe({preload:i,repo:n})}};RX.exports=TX});var OX=y((nPt,PX)=>{f();"use strict";var $Ke=rs();PX.exports=({addAll:r})=>{async function e(t,i={}){let n=await $Ke(r(t,i));if(n==null)throw Error("Failed to add a file, if you see this please report a bug");return n}return e}});var kX,a5,qX=xe(()=>{f();kX=Wt(gr()),a5=kX.default});var NX=y((Fm,o2)=>{f();(function(r,e){"use strict";var t={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function i(p){if(!Array.isArray(p)&&!ArrayBuffer.isView(p))return!1;for(var g=0;g<p.length;g++)if(!Number.isInteger(p[g])||p[g]<0||p[g]>255)return!1;return!0}function n(p,g){return(p&65535)*g+(((p>>>16)*g&65535)<<16)}function s(p,g){return p<<g|p>>>32-g}function o(p){return p^=p>>>16,p=n(p,2246822507),p^=p>>>13,p=n(p,3266489909),p^=p>>>16,p}function a(p,g){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var b=[0,0,0,0];return b[3]+=p[3]+g[3],b[2]+=b[3]>>>16,b[3]&=65535,b[2]+=p[2]+g[2],b[1]+=b[2]>>>16,b[2]&=65535,b[1]+=p[1]+g[1],b[0]+=b[1]>>>16,b[1]&=65535,b[0]+=p[0]+g[0],b[0]&=65535,[b[0]<<16|b[1],b[2]<<16|b[3]]}function c(p,g){p=[p[0]>>>16,p[0]&65535,p[1]>>>16,p[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var b=[0,0,0,0];return b[3]+=p[3]*g[3],b[2]+=b[3]>>>16,b[3]&=65535,b[2]+=p[2]*g[3],b[1]+=b[2]>>>16,b[2]&=65535,b[2]+=p[3]*g[2],b[1]+=b[2]>>>16,b[2]&=65535,b[1]+=p[1]*g[3],b[0]+=b[1]>>>16,b[1]&=65535,b[1]+=p[2]*g[2],b[0]+=b[1]>>>16,b[1]&=65535,b[1]+=p[3]*g[1],b[0]+=b[1]>>>16,b[1]&=65535,b[0]+=p[0]*g[3]+p[1]*g[2]+p[2]*g[1]+p[3]*g[0],b[0]&=65535,[b[0]<<16|b[1],b[2]<<16|b[3]]}function u(p,g){return g%=64,g===32?[p[1],p[0]]:g<32?[p[0]<<g|p[1]>>>32-g,p[1]<<g|p[0]>>>32-g]:(g-=32,[p[1]<<g|p[0]>>>32-g,p[0]<<g|p[1]>>>32-g])}function l(p,g){return g%=64,g===0?p:g<32?[p[0]<<g|p[1]>>>32-g,p[1]<<g]:[p[1]<<g-32,0]}function d(p,g){return[p[0]^g[0],p[1]^g[1]]}function h(p){return p=d(p,[0,p[0]>>>1]),p=c(p,[4283543511,3981806797]),p=d(p,[0,p[0]>>>1]),p=c(p,[3301882366,444984403]),p=d(p,[0,p[0]>>>1]),p}t.x86.hash32=function(p,g){if(t.inputValidation&&!i(p))return e;g=g||0;for(var b=p.length%4,E=p.length-b,v=g,A=0,R=3432918353,F=461845907,q=0;q<E;q=q+4)A=p[q]|p[q+1]<<8|p[q+2]<<16|p[q+3]<<24,A=n(A,R),A=s(A,15),A=n(A,F),v^=A,v=s(v,13),v=n(v,5)+3864292196;switch(A=0,b){case 3:A^=p[q+2]<<16;case 2:A^=p[q+1]<<8;case 1:A^=p[q],A=n(A,R),A=s(A,15),A=n(A,F),v^=A}return v^=p.length,v=o(v),v>>>0},t.x86.hash128=function(p,g){if(t.inputValidation&&!i(p))return e;g=g||0;for(var b=p.length%16,E=p.length-b,v=g,A=g,R=g,F=g,q=0,N=0,z=0,G=0,Y=597399067,C=2869860233,m=951274213,w=2716044179,S=0;S<E;S=S+16)q=p[S]|p[S+1]<<8|p[S+2]<<16|p[S+3]<<24,N=p[S+4]|p[S+5]<<8|p[S+6]<<16|p[S+7]<<24,z=p[S+8]|p[S+9]<<8|p[S+10]<<16|p[S+11]<<24,G=p[S+12]|p[S+13]<<8|p[S+14]<<16|p[S+15]<<24,q=n(q,Y),q=s(q,15),q=n(q,C),v^=q,v=s(v,19),v+=A,v=n(v,5)+1444728091,N=n(N,C),N=s(N,16),N=n(N,m),A^=N,A=s(A,17),A+=R,A=n(A,5)+197830471,z=n(z,m),z=s(z,17),z=n(z,w),R^=z,R=s(R,15),R+=F,R=n(R,5)+2530024501,G=n(G,w),G=s(G,18),G=n(G,Y),F^=G,F=s(F,13),F+=v,F=n(F,5)+850148119;switch(q=0,N=0,z=0,G=0,b){case 15:G^=p[S+14]<<16;case 14:G^=p[S+13]<<8;case 13:G^=p[S+12],G=n(G,w),G=s(G,18),G=n(G,Y),F^=G;case 12:z^=p[S+11]<<24;case 11:z^=p[S+10]<<16;case 10:z^=p[S+9]<<8;case 9:z^=p[S+8],z=n(z,m),z=s(z,17),z=n(z,w),R^=z;case 8:N^=p[S+7]<<24;case 7:N^=p[S+6]<<16;case 6:N^=p[S+5]<<8;case 5:N^=p[S+4],N=n(N,C),N=s(N,16),N=n(N,m),A^=N;case 4:q^=p[S+3]<<24;case 3:q^=p[S+2]<<16;case 2:q^=p[S+1]<<8;case 1:q^=p[S],q=n(q,Y),q=s(q,15),q=n(q,C),v^=q}return v^=p.length,A^=p.length,R^=p.length,F^=p.length,v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,v=o(v),A=o(A),R=o(R),F=o(F),v+=A,v+=R,v+=F,A+=v,R+=v,F+=v,("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(R>>>0).toString(16)).slice(-8)+("00000000"+(F>>>0).toString(16)).slice(-8)},t.x64.hash128=function(p,g){if(t.inputValidation&&!i(p))return e;g=g||0;for(var b=p.length%16,E=p.length-b,v=[0,g],A=[0,g],R=[0,0],F=[0,0],q=[2277735313,289559509],N=[1291169091,658871167],z=0;z<E;z=z+16)R=[p[z+4]|p[z+5]<<8|p[z+6]<<16|p[z+7]<<24,p[z]|p[z+1]<<8|p[z+2]<<16|p[z+3]<<24],F=[p[z+12]|p[z+13]<<8|p[z+14]<<16|p[z+15]<<24,p[z+8]|p[z+9]<<8|p[z+10]<<16|p[z+11]<<24],R=c(R,q),R=u(R,31),R=c(R,N),v=d(v,R),v=u(v,27),v=a(v,A),v=a(c(v,[0,5]),[0,1390208809]),F=c(F,N),F=u(F,33),F=c(F,q),A=d(A,F),A=u(A,31),A=a(A,v),A=a(c(A,[0,5]),[0,944331445]);switch(R=[0,0],F=[0,0],b){case 15:F=d(F,l([0,p[z+14]],48));case 14:F=d(F,l([0,p[z+13]],40));case 13:F=d(F,l([0,p[z+12]],32));case 12:F=d(F,l([0,p[z+11]],24));case 11:F=d(F,l([0,p[z+10]],16));case 10:F=d(F,l([0,p[z+9]],8));case 9:F=d(F,[0,p[z+8]]),F=c(F,N),F=u(F,33),F=c(F,q),A=d(A,F);case 8:R=d(R,l([0,p[z+7]],56));case 7:R=d(R,l([0,p[z+6]],48));case 6:R=d(R,l([0,p[z+5]],40));case 5:R=d(R,l([0,p[z+4]],32));case 4:R=d(R,l([0,p[z+3]],24));case 3:R=d(R,l([0,p[z+2]],16));case 2:R=d(R,l([0,p[z+1]],8));case 1:R=d(R,[0,p[z]]),R=c(R,q),R=u(R,31),R=c(R,N),v=d(v,R)}return v=d(v,[0,p.length]),A=d(A,[0,p.length]),v=a(v,A),A=a(A,v),v=h(v),A=h(A),v=a(v,A),A=a(A,v),("00000000"+(v[0]>>>0).toString(16)).slice(-8)+("00000000"+(v[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},typeof Fm!="undefined"?(typeof o2!="undefined"&&o2.exports&&(Fm=o2.exports=t),Fm.murmurHash3=t):typeof define=="function"&&define.amd?define([],function(){return t}):(t._murmurHash3=r.murmurHash3,t.noConflict=function(){return r.murmurHash3=t._murmurHash3,t._murmurHash3=e,t.noConflict=e,t},r.murmurHash3=t)})(Fm)});var BX=y((oPt,DX)=>{f();DX.exports=NX()});var MX={};ut(MX,{murmur3128:()=>Km,murmur332:()=>WKe});function GKe(r){let e=new Array(4);for(let t=0;t<4;t++)e[t]=r&255,r=r>>8;return new Uint8Array(e)}var c5,WKe,Km,a2=xe(()=>{f();wg();jc();c5=Wt(BX());WKe=Lc({name:"murmur3-32",code:35,encode:r=>GKe(c5.default.x86.hash32(r))}),Km=Lc({name:"murmur3-128",code:34,encode:r=>qc.fromHex(c5.default.x64.hash128(r))})});async function YKe(r){return(await Km.encode(r)).slice(0,8).reverse()}var XKe,LX,UX=xe(()=>{f();qX();ri();a2();a5.bind({ignoreUndefined:!0});XKe={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:Th,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:17437180132763652,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:YKe,hamtHashCode:34,hamtBucketBits:8},LX=(r={})=>a5(XKe,r)});var QKe,Go,Vp=xe(()=>{f();Ie();_t();ri();QKe=async(r,e,t)=>{t.codec||(t.codec=Mt),t.hasher||(t.hasher=Th),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===Mt&&t.hasher!==Th&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=We.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n},Go=QKe});var ZKe,FX,KX=xe(()=>{f();pi();Vp();_t();ZKe=async(r,e,t)=>{let i=new wi({type:"directory",mtime:r.mtime,mode:r.mode}),n=Uo($s({Data:i.marshal()})),s=await Go(n,e,t),o=r.path;return{cid:s,path:o,unixfs:i,size:n.length}},FX=ZKe});async function JKe(r,e){return e(await(0,jX.default)(r))}var jX,VX,zX=xe(()=>{f();jX=Wt(mp());VX=JKe});function eje(r,e,t){return $X(r,e,t)}async function $X(r,e,t){let i=[];for await(let n of(0,HX.default)(r,t.maxChildrenPerNode))i.push(await e(n));return i.length>1?$X(i,e,t):i[0]}var HX,GX,WX=xe(()=>{f();HX=Wt(L_());GX=eje});async function tje(r,e,t){let i=new QX(t.layerRepeat),n=0,s=1,o=i;for await(let a of(0,YX.default)(r,t.maxChildrenPerNode))o.isFull()&&(o!==i&&i.addChild(await o.reduce(e)),n&&n%t.layerRepeat==0&&s++,o=new u5(s,t.layerRepeat,n),n++),o.append(a);return o&&o!==i&&i.addChild(await o.reduce(e)),i.reduce(e)}var YX,XX,u5,QX,ZX=xe(()=>{f();YX=Wt(L_());XX=tje,u5=class{constructor(e,t,i=0){this.maxDepth=e,this.layerRepeat=t,this.currentDepth=1,this.iteration=i,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let t={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(t),this.currentDepth=t.depth,this.node=t}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,t){let i=[];return e.children.length&&(i=await Promise.all(e.children.filter(n=>n.data).map(n=>this._reduce(n,t)))),t((e.data||[]).concat(i))}_findParent(e,t){let i=e.parent;if(!(!i||i.depth===0))return i.children.length===i.maxChildren||!i.maxChildren?this._findParent(i,t):i}},QX=class extends u5{constructor(e){super(0,e);this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}}});var JX={};ut(JX,{default:()=>ije});async function*rje(r,e,t){for await(let i of r.content)yield async()=>{t.progress(i.length,r.path);let n,s={codec:Mt,cidVersion:t.cidVersion,hasher:t.hasher,onlyHash:t.onlyHash};return t.rawLeaves?(s.codec=Po,s.cidVersion=1):(n=new wi({type:t.leafType,data:i,mtime:r.mtime,mode:r.mode}),i=Uo({Data:n.marshal(),Links:[]})),{cid:await Go(i,e,s),unixfs:n,size:i.length}}}var ije,eQ=xe(()=>{f();pi();Vp();_t();Ls();ije=rje});async function*sje(r,e,t){let i=-1,n,s;typeof t.bufferImporter=="function"?s=t.bufferImporter:s=(await Promise.resolve().then(()=>(eQ(),JX))).default;for await(let o of(0,rQ.default)(s(r,e,t),t.blockWriteConcurrency)){if(i++,i===0){n=o;continue}else i===1&&n&&(yield n,n=null);yield o}n&&(n.single=!0,yield n)}function aje(r,e,t){let i=nje[t.strategy];if(!i)throw(0,tQ.default)(new Error(`Unknown importer build strategy name: ${t.strategy}`),"ERR_BAD_STRATEGY");return i(sje(r,e,t),oje(r,e,t),t)}var tQ,rQ,nje,oje,iQ,nQ=xe(()=>{f();tQ=Wt(ae());pi();Vp();_t();rQ=Wt(U_());Ls();_t();zX();WX();ZX();nje={flat:VX,balanced:GX,trickle:XX};oje=(r,e,t)=>{async function i(n){if(n.length===1&&n[0].single&&t.reduceSingleLeafToSelf){let l=n[0];if(l.cid.code===Kc&&(r.mtime!==void 0||r.mode!==void 0)){let d=await e.get(l.cid);l.unixfs=new wi({type:"file",mtime:r.mtime,mode:r.mode,data:d}),d=Uo($s({Data:l.unixfs.marshal()})),l.cid=await Go(d,e,{...t,codec:Mt,hasher:t.hasher,cidVersion:t.cidVersion}),l.size=d.length}return{cid:l.cid,path:r.path,unixfs:l.unixfs,size:l.size}}let s=new wi({type:"file",mtime:r.mtime,mode:r.mode}),o=n.filter(l=>l.cid.code===Kc&&l.size||l.unixfs&&!l.unixfs.data&&l.unixfs.fileSize()?!0:Boolean(l.unixfs&&l.unixfs.data&&l.unixfs.data.length)).map(l=>l.cid.code===Kc?(s.addBlockSize(l.size),{Name:"",Tsize:l.size,Hash:l.cid}):(!l.unixfs||!l.unixfs.data?s.addBlockSize(l.unixfs&&l.unixfs.fileSize()||0):s.addBlockSize(l.unixfs.data.length),{Name:"",Tsize:l.size,Hash:l.cid})),a={Data:s.marshal(),Links:o},c=Uo($s(a));return{cid:await Go(c,e,t),path:r.path,unixfs:s,size:c.length+a.Links.reduce((l,d)=>l+d.Tsize,0)}}return i};iQ=aje});var bn=y((qPt,oQ)=>{f();"use strict";var{Buffer:Wo}=Vt(),sQ=Symbol.for("BufferList");function ur(r){if(!(this instanceof ur))return new ur(r);ur._init.call(this,r)}ur._init=function(e){Object.defineProperty(this,sQ,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};ur.prototype._new=function(e){return new ur(e)};ur.prototype._offset=function(e){if(e===0)return[0,0];let t=0;for(let i=0;i<this._bufs.length;i++){let n=t+this._bufs[i].length;if(e<n||i===this._bufs.length-1)return[i,e-t];t=n}};ur.prototype._reverseOffset=function(r){let e=r[0],t=r[1];for(let i=0;i<e;i++)t+=this._bufs[i].length;return t};ur.prototype.get=function(e){if(e>this.length||e<0)return;let t=this._offset(e);return this._bufs[t[0]][t[1]]};ur.prototype.slice=function(e,t){return typeof e=="number"&&e<0&&(e+=this.length),typeof t=="number"&&t<0&&(t+=this.length),this.copy(null,0,e,t)};ur.prototype.copy=function(e,t,i,n){if((typeof i!="number"||i<0)&&(i=0),(typeof n!="number"||n>this.length)&&(n=this.length),i>=this.length||n<=0)return e||Wo.alloc(0);let s=!!e,o=this._offset(i),a=n-i,c=a,u=s&&t||0,l=o[1];if(i===0&&n===this.length){if(!s)return this._bufs.length===1?this._bufs[0]:Wo.concat(this._bufs,this.length);for(let d=0;d<this._bufs.length;d++)this._bufs[d].copy(e,u),u+=this._bufs[d].length;return e}if(c<=this._bufs[o[0]].length-l)return s?this._bufs[o[0]].copy(e,t,l,l+c):this._bufs[o[0]].slice(l,l+c);s||(e=Wo.allocUnsafe(a));for(let d=o[0];d<this._bufs.length;d++){let h=this._bufs[d].length-l;if(c>h)this._bufs[d].copy(e,u,l),u+=h;else{this._bufs[d].copy(e,u,l,l+c),u+=h;break}c-=h,l&&(l=0)}return e.length>u?e.slice(0,u):e};ur.prototype.shallowSlice=function(e,t){if(e=e||0,t=typeof t!="number"?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();let i=this._offset(e),n=this._offset(t),s=this._bufs.slice(i[0],n[0]+1);return n[1]===0?s.pop():s[s.length-1]=s[s.length-1].slice(0,n[1]),i[1]!==0&&(s[0]=s[0].slice(i[1])),this._new(s)};ur.prototype.toString=function(e,t,i){return this.slice(t,i).toString(e)};ur.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};ur.prototype.duplicate=function(){let e=this._new();for(let t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e};ur.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Wo.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(let t=0;t<e._bufs.length;t++)this.append(e._bufs[t]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Wo.from(e));return this};ur.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};ur.prototype.indexOf=function(r,e,t){if(t===void 0&&typeof e=="string"&&(t=e,e=void 0),typeof r=="function"||Array.isArray(r))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof r=="number"?r=Wo.from([r]):typeof r=="string"?r=Wo.from(r,t):this._isBufferList(r)?r=r.slice():Array.isArray(r.buffer)?r=Wo.from(r.buffer,r.byteOffset,r.byteLength):Wo.isBuffer(r)||(r=Wo.from(r)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),r.length===0)return e>this.length?this.length:e;let i=this._offset(e),n=i[0],s=i[1];for(;n<this._bufs.length;n++){let o=this._bufs[n];for(;s<o.length;)if(o.length-s>=r.length){let c=o.indexOf(r,s);if(c!==-1)return this._reverseOffset([n,c]);s=o.length-r.length+1}else{let c=this._reverseOffset([n,s]);if(this._match(c,r))return c;s++}s=0}return-1};ur.prototype._match=function(r,e){if(this.length-r<e.length)return!1;for(let t=0;t<e.length;t++)if(this.get(r+t)!==e[t])return!1;return!0};(function(){let r={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in r)(function(t){r[t]===null?ur.prototype[t]=function(i,n){return this.slice(i,i+n)[t](0,n)}:ur.prototype[t]=function(i=0){return this.slice(i,i+r[t])[t](0)}})(e)})();ur.prototype._isBufferList=function(e){return e instanceof ur||ur.isBufferList(e)};ur.isBufferList=function(e){return e!=null&&e[sQ]};oQ.exports=ur});var uQ=y((NPt,cQ)=>{f();var aQ=class{constructor(e,t=12,i=8*1024,n=32*1024,s=64,o){this.bits=t,this.min=i,this.max=n,this.asModule=e,this.rabin=new e.Rabin(t,i,n,s,o),this.polynomial=o}fingerprint(e){let{__retain:t,__release:i,__allocArray:n,__getInt32Array:s,Int32Array_ID:o,Uint8Array_ID:a}=this.asModule,c=new Int32Array(Math.ceil(e.length/this.min)),u=t(n(o,c)),l=t(n(a,e)),d=this.rabin.fingerprint(l,u),h=s(d);i(l),i(u);let p=h.indexOf(0);return p>=0?h.subarray(0,p):h}};cQ.exports=aQ});var EQ=y(zm=>{f();"use strict";var l5=-8,c2=-4,cje=0,lQ=1,fQ=1<<0,u2=1<<1,DPt=1<<2,BPt=1<<3,dQ=5,MPt=1<<dQ,hQ=1<<10,pQ=1<<11,LPt=1<<12,uje=1<<13,yQ=14,UPt=1<<yQ,FPt=1<<19,KPt=1<<20,jPt=1<<21,VPt=1<<22,lje=0,f5=4,fje=8,dje=12,gQ=12,hje=16,pje=typeof BigUint64Array!="undefined",jm=Symbol(),Vm=1024;function mQ(r,e){let t=new Uint32Array(r),i=new Uint16Array(r);var n=t[e+c2>>>2]>>>1,s=e>>>1;if(n<=Vm)return String.fromCharCode.apply(String,i.subarray(s,s+n));let o=[];do{let a=i[s+Vm-1],c=a>=55296&&a<56320?Vm-1:Vm;o.push(String.fromCharCode.apply(String,i.subarray(s,s+=c))),n-=c}while(n>Vm);return o.join("")+String.fromCharCode.apply(String,i.subarray(s,s+n))}function d5(r){let e={};function t(n,s){return n?mQ(n.buffer,s):"<yet unknown>"}let i=r.env=r.env||{};return i.abort=i.abort||function(s,o,a,c){let u=e.memory||i.memory;throw Error("abort: "+t(u,s)+" at "+t(u,o)+":"+a+":"+c)},i.trace=i.trace||function(s,o){let a=e.memory||i.memory;console.log("trace: "+t(a,s)+(o?" ":"")+Array.prototype.slice.call(arguments,2,2+o).join(", "))},r.Math=r.Math||Math,r.Date=r.Date||Date,e}function h5(r,e){let t=e.exports,i=t.memory,n=t.table,s=t.__alloc,o=t.__retain,a=t.__rtti_base||~0;function c(N){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((N>>>=0)>=G)throw Error("invalid id: "+N);return z[(a+4>>>2)+N*2]}function u(N){let z=new Uint32Array(i.buffer),G=z[a>>>2];if((N>>>=0)>=G)throw Error("invalid id: "+N);return z[(a+4>>>2)+N*2+1]}function l(N){return 31-Math.clz32(N>>>dQ&31)}function d(N){return 31-Math.clz32(N>>>yQ&31)}function h(N){let z=N.length,G=s(z<<1,lQ),Y=new Uint16Array(i.buffer);for(var C=0,m=G>>>1;C<z;++C)Y[m+C]=N.charCodeAt(C);return G}r.__allocString=h;function p(N){let z=i.buffer;if(new Uint32Array(z)[N+l5>>>2]!==lQ)throw Error("not a string: "+N);return mQ(z,N)}r.__getString=p;function g(N,z,G){let Y=i.buffer;if(G)switch(N){case 2:return new Float32Array(Y);case 3:return new Float64Array(Y)}else switch(N){case 0:return new(z?Int8Array:Uint8Array)(Y);case 1:return new(z?Int16Array:Uint16Array)(Y);case 2:return new(z?Int32Array:Uint32Array)(Y);case 3:return new(z?BigInt64Array:BigUint64Array)(Y)}throw Error("unsupported align: "+N)}function b(N,z){let G=c(N);if(!(G&(fQ|u2)))throw Error("not an array: "+N+" @ "+G);let Y=l(G),C=z.length,m=s(C<<Y,cje),w=s(G&u2?hje:dje,N),S=new Uint32Array(i.buffer);S[w+lje>>>2]=o(m),S[w+f5>>>2]=m,S[w+fje>>>2]=C<<Y,G&u2&&(S[w+gQ>>>2]=C);let P=g(Y,G&hQ,G&pQ);if(G&uje)for(let B=0;B<C;++B)P[(m>>>Y)+B]=o(z[B]);else P.set(z,m>>>Y);return w}r.__allocArray=b;function E(N){let z=new Uint32Array(i.buffer),G=z[N+l5>>>2],Y=c(G);if(!(Y&fQ))throw Error("not an array: "+G);let C=l(Y);var m=z[N+f5>>>2];let w=Y&u2?z[N+gQ>>>2]:z[m+c2>>>2]>>>C;return g(C,Y&hQ,Y&pQ).subarray(m>>>=C,m+w)}r.__getArrayView=E;function v(N){let z=E(N),G=z.length,Y=new Array(G);for(let C=0;C<G;C++)Y[C]=z[C];return Y}r.__getArray=v;function A(N){let z=i.buffer,G=new Uint32Array(z)[N+c2>>>2];return z.slice(N,N+G)}r.__getArrayBuffer=A;function R(N,z,G){return new N(F(N,z,G))}function F(N,z,G){let Y=i.buffer,C=new Uint32Array(Y),m=C[G+f5>>>2];return new N(Y,m,C[m+c2>>>2]>>>z)}r.__getInt8Array=R.bind(null,Int8Array,0),r.__getInt8ArrayView=F.bind(null,Int8Array,0),r.__getUint8Array=R.bind(null,Uint8Array,0),r.__getUint8ArrayView=F.bind(null,Uint8Array,0),r.__getUint8ClampedArray=R.bind(null,Uint8ClampedArray,0),r.__getUint8ClampedArrayView=F.bind(null,Uint8ClampedArray,0),r.__getInt16Array=R.bind(null,Int16Array,1),r.__getInt16ArrayView=F.bind(null,Int16Array,1),r.__getUint16Array=R.bind(null,Uint16Array,1),r.__getUint16ArrayView=F.bind(null,Uint16Array,1),r.__getInt32Array=R.bind(null,Int32Array,2),r.__getInt32ArrayView=F.bind(null,Int32Array,2),r.__getUint32Array=R.bind(null,Uint32Array,2),r.__getUint32ArrayView=F.bind(null,Uint32Array,2),pje&&(r.__getInt64Array=R.bind(null,BigInt64Array,3),r.__getInt64ArrayView=F.bind(null,BigInt64Array,3),r.__getUint64Array=R.bind(null,BigUint64Array,3),r.__getUint64ArrayView=F.bind(null,BigUint64Array,3)),r.__getFloat32Array=R.bind(null,Float32Array,2),r.__getFloat32ArrayView=F.bind(null,Float32Array,2),r.__getFloat64Array=R.bind(null,Float64Array,3),r.__getFloat64ArrayView=F.bind(null,Float64Array,3);function q(N,z){let G=new Uint32Array(i.buffer);var Y=G[N+l5>>>2];if(Y<=G[a>>>2])do if(Y==z)return!0;while(Y=u(Y));return!1}return r.__instanceof=q,r.memory=r.memory||i,r.table=r.table||n,_Q(t,r)}function bQ(r){return typeof Response!="undefined"&&r instanceof Response}async function vQ(r,e){return bQ(r=await r)?wQ(r,e):h5(d5(e||(e={})),await WebAssembly.instantiate(r instanceof WebAssembly.Module?r:await WebAssembly.compile(r),e))}zm.instantiate=vQ;function yje(r,e){return h5(d5(e||(e={})),new WebAssembly.Instance(r instanceof WebAssembly.Module?r:new WebAssembly.Module(r),e))}zm.instantiateSync=yje;async function wQ(r,e){return WebAssembly.instantiateStreaming?h5(d5(e||(e={})),(await WebAssembly.instantiateStreaming(r,e)).instance):vQ(bQ(r=await r)?r.arrayBuffer():r,e)}zm.instantiateStreaming=wQ;function _Q(r,e){var t=e?Object.create(e):{},i=r.__argumentsLength?function(n){r.__argumentsLength.value=n}:r.__setArgumentsLength||r.__setargc||function(){};for(let n in r){if(!Object.prototype.hasOwnProperty.call(r,n))continue;let s=r[n],o=n.split("."),a=t;for(;o.length>1;){let l=o.shift();Object.prototype.hasOwnProperty.call(a,l)||(a[l]={}),a=a[l]}let c=o[0],u=c.indexOf("#");if(u>=0){let l=c.substring(0,u),d=a[l];if(typeof d=="undefined"||!d.prototype){let h=function(...p){return h.wrap(h.prototype.constructor(0,...p))};h.prototype={valueOf:function(){return this[jm]}},h.wrap=function(p){return Object.create(h.prototype,{[jm]:{value:p,writable:!1}})},d&&Object.getOwnPropertyNames(d).forEach(p=>Object.defineProperty(h,p,Object.getOwnPropertyDescriptor(d,p))),a[l]=h}if(c=c.substring(u+1),a=a[l].prototype,/^(get|set):/.test(c)){if(!Object.prototype.hasOwnProperty.call(a,c=c.substring(4))){let h=r[n.replace("set:","get:")],p=r[n.replace("get:","set:")];Object.defineProperty(a,c,{get:function(){return h(this[jm])},set:function(g){p(this[jm],g)},enumerable:!0})}}else c==="constructor"?(a[c]=(...h)=>(i(h.length),s(...h))).original=s:(a[c]=function(...h){return i(h.length),s(this[jm],...h)}).original=s}else/^(get|set):/.test(c)?Object.prototype.hasOwnProperty.call(a,c=c.substring(4))||Object.defineProperty(a,c,{get:r[n.replace("set:","get:")],set:r[n.replace("get:","set:")],enumerable:!0}):typeof s=="function"&&s!==i?(a[c]=(...l)=>(i(l.length),s(...l))).original=s:a[c]=s}return t}zm.demangle=_Q});var xQ=y((HPt,SQ)=>{f();var{instantiate:gje}=EQ();p5.supported=typeof WebAssembly!="undefined";function p5(r={}){if(!p5.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return gje(new Response(new Blob([e],{type:"application/wasm"})),r)}SQ.exports=p5});var TQ=y(($Pt,IQ)=>{f();var AQ=uQ(),mje=xQ(),bje=async(r,e,t,i,n)=>{let s=await mje();return new AQ(s,r,e,t,i,n)};IQ.exports={Rabin:AQ,create:bje}});var PQ={};ut(PQ,{default:()=>wje});async function*vje(r,e){let t,i,n;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)n=e.avgChunkSize,t=e.minChunkSize,i=e.maxChunkSize;else if(e.avgChunkSize)n=e.avgChunkSize,t=n/3,i=n+n/2;else throw(0,y5.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(t<16)throw(0,y5.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");i<t&&(i=t),n<t&&(n=t);let s=Math.floor(Math.log2(n));for await(let o of _je(r,{min:t,max:i,bits:s,window:e.window,polynomial:e.polynomial}))yield o}async function*_je(r,e){let t=await(0,CQ.create)(e.bits,e.min,e.max,e.window),i=new RQ.default;for await(let n of r){i.append(n);let s=t.fingerprint(n);for(let o=0;o<s.length;o++){let a=s[o],c=i.slice(0,a);i.consume(a),yield c}}i.length&&(yield i.slice(0))}var RQ,CQ,y5,wje,OQ=xe(()=>{f();RQ=Wt(bn()),CQ=Wt(TQ()),y5=Wt(ae());wje=vje});var kQ={};ut(kQ,{default:()=>Sje});async function*Eje(r,e){let t=new l2.default,i=0,n=!1,s=e.maxChunkSize;for await(let o of r)for(t.append(o),i+=o.length;i>=s;)if(yield t.slice(0,s),n=!0,s===t.length)t=new l2.default,i=0;else{let a=new l2.default;a.append(t.shallowSlice(s)),t=a,i-=s}(!n||i)&&(yield t.slice(0,i))}var l2,Sje,qQ=xe(()=>{f();l2=Wt(bn());Sje=Eje});var NQ={};ut(NQ,{default:()=>Aje});async function*xje(r){for await(let e of r){if(e.length===void 0)throw(0,g5.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield bA(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,g5.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var g5,Aje,DQ=xe(()=>{f();g5=Wt(ae());ft();Aje=xje});var BQ={};ut(BQ,{default:()=>Pje});function Ije(r){return Symbol.iterator in r}function Tje(r){return Symbol.asyncIterator in r}function Rje(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(Ije(r))return async function*(){yield*r}();if(Tje(r))return r}catch{throw(0,m5.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,m5.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*Cje(r,e,t){for await(let i of r)if(i.path&&(i.path.substring(0,2)==="./"&&(t.wrapWithDirectory=!0),i.path=i.path.split("/").filter(n=>n&&n!==".").join("/")),i.content){let n;typeof t.chunker=="function"?n=t.chunker:t.chunker==="rabin"?n=(await Promise.resolve().then(()=>(OQ(),PQ))).default:n=(await Promise.resolve().then(()=>(qQ(),kQ))).default;let s;typeof t.chunkValidator=="function"?s=t.chunkValidator:s=(await Promise.resolve().then(()=>(DQ(),NQ))).default;let o={path:i.path,mtime:i.mtime,mode:i.mode,content:n(s(Rje(i.content),t),t)};yield()=>iQ(o,e,t)}else if(i.path){let n={path:i.path,mtime:i.mtime,mode:i.mode};yield()=>FX(n,e,t)}else throw new Error("Import candidate must have content or path or both")}var m5,Pje,MQ=xe(()=>{f();KX();nQ();m5=Wt(ae());Pje=Cje});var LQ,gl,f2=xe(()=>{f();LQ=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},gl=LQ});var UQ,Hm,b5=xe(()=>{f();_t();pi();f2();Vp();UQ=class extends gl{constructor(e,t){super(e,t);this._children={}}async put(e,t){this.cid=void 0,this.size=void 0,this._children[e]=t}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let t=0;t<e.length;t++){let i=e[t];yield{key:i,child:this._children[i]}}}async*flush(e){let t=Object.keys(this._children),i=[];for(let u=0;u<t.length;u++){let l=this._children[t[u]];if(l instanceof gl)for await(let d of l.flush(e))l=d,yield l;l.size!=null&&l.cid&&i.push({Name:t[u],Tsize:l.size,Hash:l.cid})}let n=new wi({type:"directory",mtime:this.mtime,mode:this.mode}),s={Data:n.marshal(),Links:i},o=Uo($s(s)),a=await Go(o,e,this.options),c=o.length+s.Links.reduce((u,l)=>u+(l.Tsize==null?0:l.Tsize),0);this.cid=a,this.size=c,yield{cid:a,unixfs:n,path:this.path,size:c}}},Hm=UQ});var jQ=y((iOt,KQ)=>{f();"use strict";var d2=7;KQ.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,t){let i=this._internalPositionFor(e,!1);if(t===void 0)i!==-1&&(this._unsetInternalPos(i),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let n=!1;i===-1?(i=this._data.length,this._setBit(e),this._changedData=!0):n=!0,this._setInternalPos(i,e,t,n),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let t=this._internalPositionFor(e,!0);if(t!==-1)return this._data[t][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let t=0;for(;t<this.length;)e(this.get(t),t,this),t++}map(e){let t=0,i=new Array(this.length);for(;t<this.length;)i[t]=e(this.get(t),t,this),t++;return i}reduce(e,t){let i=0,n=t;for(;i<this.length;){let s=this.get(i);n=e(n,s,i),i++}return n}find(e){let t=0,i,n;for(;t<this.length&&!i;)n=this.get(t),i=e(n),t++;return i?n:void 0}_internalPositionFor(e,t){let i=this._bytePosFor(e,t);if(i>=this._bitArrays.length)return-1;let n=this._bitArrays[i],s=e-i*d2;if(!((n&1<<s)>0))return-1;let a=this._bitArrays.slice(0,i).reduce(Oje,0),c=~(4294967295<<s+1),u=FQ(n&c);return a+u-1}_bytePosFor(e,t){let i=Math.floor(e/d2),n=i+1;for(;!t&&this._bitArrays.length<n;)this._bitArrays.push(0);return i}_setBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]|=1<<e-t*d2}_unsetBit(e){let t=this._bytePosFor(e,!1);this._bitArrays[t]&=~(1<<e-t*d2)}_setInternalPos(e,t,i,n){let s=this._data,o=[t,i];if(n)this._sortData(),s[e]=o;else{if(s.length)if(s[s.length-1][0]>=t)s.push(o);else if(s[0][0]<=t)s.unshift(o);else{let a=Math.round(s.length/2);this._data=s.slice(0,a).concat(o).concat(s.slice(a))}else this._data.push(o);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(kje),this._changedData=!1}bitField(){let e=[],t=8,i=0,n=0,s,o=this._bitArrays.slice();for(;o.length||i;){i===0&&(s=o.shift(),i=7);let c=Math.min(i,t),u=~(255<<c);n|=(s&u)<<8-t,s=s>>>c,i-=c,t-=c,(!t||!i&&!o.length)&&(e.push(n),n=0,t=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(qje)}};function Oje(r,e){return r+FQ(e)}function FQ(r){let e=r;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function kje(r,e){return r[0]-e[0]}function qje(r){return r[1]}});var HQ=y((nOt,zQ)=>{f();"use strict";var Nje=jQ(),{fromString:Dje}=(ft(),ht),Yo=class{constructor(e,t,i=0){this._options=e,this._popCount=0,this._parent=t,this._posAtParent=i,this._children=new Nje,this.key=null}async put(e,t){let i=await this._findNewBucketAndPos(e);await i.bucket._putAt(i,e,t)}async get(e){let t=await this._findChild(e);if(t)return t.value}async del(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);i&&i.key===e&&t.bucket._delAt(t.pos)}leafCount(){return this._children.compactArray().reduce((t,i)=>i instanceof Yo?t+i.leafCount():t+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let t of e)t instanceof Yo?yield*t.eachLeafSeries():yield t;return[]}serialize(e,t){let i=[];return t(this._children.reduce((n,s,o)=>(s&&(s instanceof Yo?n.push(s.serialize(e,t)):n.push(e(s,o))),n),i))}asyncTransform(e,t){return VQ(this,e,t)}toJSON(){return this.serialize(Mje,Lje)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let t=await this._findPlace(e),i=t.bucket._at(t.pos);if(!(i instanceof Yo)&&i&&i.key===e)return i}async _findPlace(e){let t=this._options.hash(typeof e=="string"?Dje(e):e),i=await t.take(this._options.bits),n=this._children.get(i);return n instanceof Yo?n._findPlace(t):{bucket:this,pos:i,hash:t,existingChild:n}}async _findNewBucketAndPos(e){let t=await this._findPlace(e);if(t.existingChild&&t.existingChild.key!==e){let i=new Yo(this._options,t.bucket,t.pos);t.bucket._putObjectAt(t.pos,i);let n=await i._findPlace(t.existingChild.hash);return n.bucket._putAt(n,t.existingChild.key,t.existingChild.value),i._findNewBucketAndPos(t.hash)}return t}_putAt(e,t,i){this._putObjectAt(e.pos,{key:t,value:i,hash:e.hash})}_putObjectAt(e,t){this._children.get(e)||this._popCount++,this._children.set(e,t)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(Bje);if(e&&!(e instanceof Yo)){let t=e.hash;t.untake(this._options.bits);let i={pos:this._posAtParent,hash:t,bucket:this._parent};this._parent._putAt(i,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function Bje(r){return Boolean(r)}function Mje(r,e){return r.key}function Lje(r){return r}async function VQ(r,e,t){let i=[];for(let n of r._children.compactArray())if(n instanceof Yo)await VQ(n,e,t);else{let s=await e(n);i.push({bitField:r._children.bitField(),children:s})}return t(i)}zQ.exports=Yo});var GQ=y((oOt,$Q)=>{f();"use strict";var Uje=[255,254,252,248,240,224,192,128],Fje=[1,3,7,15,31,63,127,255];$Q.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let t=e,i=0;for(;t&&this._haveBits();){let n=this._value[this._currentBytePos],s=this._currentBitPos+1,o=Math.min(s,t),a=Kje(n,s-o,o);i=(i<<o)+a,t-=o,this._currentBitPos-=o,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return i}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function Kje(r,e,t){let i=jje(e,t);return(r&i)>>>e}function jje(r,e){return Uje[r]&Fje[Math.min(e+r-1,7)]}});var WQ=y((aOt,v5)=>{f();"use strict";var Vje=GQ(),{concat:zje}=(cn(),an);function Hje(r){function e(t){return t instanceof h2?t:new h2(t,r)}return e}var h2=class{constructor(e,t){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=t,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let t=e;for(;this._availableBits<t;)await this._produceMoreBits();let i=0;for(;t>0;){let n=this._buffers[this._currentBufferIndex],s=Math.min(n.availableBits(),t),o=n.take(s);i=(i<<s)+o,t-=s,this._availableBits-=s,n.availableBits()===0&&this._currentBufferIndex++}return i}untake(e){let t=e;for(;t>0;){let i=this._buffers[this._currentBufferIndex],n=Math.min(i.totalBits()-i.availableBits(),t);i.untake(n),t-=n,this._availableBits+=n,this._currentBufferIndex>0&&i.totalBits()===i.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?zje([this._value,Uint8Array.from([this._depth])]):this._value,t=await this._hashFn(e),i=new Vje(t);this._buffers.push(i),this._availableBits+=i.availableBits()}};v5.exports=Hje;v5.exports.InfiniteHash=h2});var $m=y((cOt,XQ)=>{f();"use strict";var YQ=HQ(),$je=WQ();function Gje(r){if(!r||!r.hashFn)throw new Error("please define an options.hashFn");let e={bits:r.bits||8,hash:$je(r.hashFn)};return new YQ(e)}XQ.exports={createHAMT:Gje,Bucket:YQ}});async function*JQ(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let g=n.get(p);if(!g)continue;let b=p.toString(16).toUpperCase().padStart(2,"0");if(g instanceof p2.Bucket){let E;for await(let v of await JQ(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:b,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=b+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=b+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),c=new wi({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:i.hamtHashCode,mtime:t&&t.mtime,mode:t&&t.mode}),u={Data:c.marshal(),Links:s},l=Uo($s(u)),d=await Go(l,e,i),h=l.length+o;yield{cid:d,unixfs:c,size:h}}var p2,QQ,ZQ,eZ=xe(()=>{f();_t();pi();f2();Vp();p2=Wt($m()),QQ=class extends gl{constructor(e,t){super(e,t);this._bucket=(0,p2.createHAMT)({hashFn:t.hamtHashFn,bits:t.hamtBucketBits})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){for await(let t of JQ(this._bucket,e,this,this.options))yield{...t,path:this.path}}},ZQ=QQ});async function tZ(r,e,t,i){let n=e;e instanceof Hm&&e.directChildrenCount()>=t&&(n=await Wje(e,i));let s=n.parent;if(s){if(n!==e){if(r&&(r.parent=n),!n.parentKey)throw new Error("No parent key found");await s.put(n.parentKey,n)}return tZ(n,s,t,i)}return n}async function Wje(r,e){let t=new ZQ({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},e);for await(let{key:i,child:n}of r.eachChildSeries())await t.put(i,n);return t}var rZ,iZ=xe(()=>{f();eZ();b5();rZ=tZ});var Yje,nZ,sZ=xe(()=>{f();Yje=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),nZ=Yje});var aZ={};ut(aZ,{default:()=>Zje});async function Xje(r,e,t){let i=nZ(r.path||""),n=i.length-1,s=e,o="";for(let a=0;a<i.length;a++){let c=i[a];o+=`${o?"/":""}${c}`;let u=a===n;if(s.dirty=!0,s.cid=void 0,s.size=void 0,u)await s.put(c,r),e=await rZ(null,s,t.shardSplitThreshold,t);else{let l=await s.get(c);(!l||!(l instanceof gl))&&(l=new Hm({root:!1,dir:!0,parent:s,parentKey:c,path:o,dirty:!0,flat:!0,mtime:l&&l.unixfs&&l.unixfs.mtime,mode:l&&l.unixfs&&l.unixfs.mode},t)),await s.put(c,l),s=l}}return e}async function*oZ(r,e){if(!(r instanceof gl)){r&&r.unixfs&&r.unixfs.isDirectory()&&(yield r);return}yield*r.flush(e)}async function*Qje(r,e,t){let i=new Hm({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t);for await(let n of r)!n||(i=await Xje(n,i,t),(!n.unixfs||!n.unixfs.isDirectory())&&(yield n));if(t.wrapWithDirectory)yield*oZ(i,e);else for await(let n of i.eachChildSeries())!n||(yield*oZ(n.child,e))}var Zje,cZ=xe(()=>{f();b5();iZ();f2();sZ();Zje=Qje});var y2={};ut(y2,{importer:()=>Jje});async function*Jje(r,e,t={}){let i=LX(t),n;typeof t.dagBuilder=="function"?n=t.dagBuilder:n=(await Promise.resolve().then(()=>(MQ(),BQ))).default;let s;typeof t.treeBuilder=="function"?s=t.treeBuilder:s=(await Promise.resolve().then(()=>(cZ(),aZ))).default;let o;Symbol.asyncIterator in r||Symbol.iterator in r?o=r:o=[r];for await(let a of s((0,uZ.default)(n(o,e,i),i.fileImportConcurrency),e,i))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}var uZ,g2=xe(()=>{f();uZ=Wt(U_());UX()});var Gm=y((SOt,lZ)=>{f();"use strict";async function*eVe(r,e={}){let t=r.getReader();try{for(;;){let i=await t.read();if(i.done)return;yield i.value}}finally{e.preventCancel!==!0&&t.cancel(),t.releaseLock()}}lZ.exports=eVe});var hZ=y((xOt,dZ)=>{f();"use strict";var fZ=Gm();function tVe(r){return typeof r.stream=="function"?fZ(r.stream()):fZ(new Response(r).body)}dZ.exports=tVe});var Wm=y((AOt,pZ)=>{f();"use strict";function rVe(r){let[e,t]=r[Symbol.asyncIterator]?[r[Symbol.asyncIterator](),Symbol.asyncIterator]:[r[Symbol.iterator](),Symbol.iterator],i=[];return{peek:()=>e.next(),push:n=>{i.push(n)},next:()=>i.length?{done:!1,value:i.shift()}:e.next(),[t](){return this}}}pZ.exports=rVe});var m2=y((IOt,yZ)=>{f();"use strict";function iVe(r){return ArrayBuffer.isView(r)||r instanceof ArrayBuffer}function nVe(r){return r.constructor&&(r.constructor.name==="Blob"||r.constructor.name==="File")&&typeof r.stream=="function"}function sVe(r){return typeof r=="object"&&(r.path||r.content)}var oVe=r=>r&&typeof r.getReader=="function";yZ.exports={isBytes:iVe,isBlob:nVe,isFileObject:sVe,isReadableStream:oVe}});var bZ=y((TOt,mZ)=>{f();"use strict";var aVe=ae(),{fromString:cVe}=(ft(),ht),uVe=Gm(),lVe=hZ(),fVe=Wm(),dVe=mp(),hVe=Ho(),{isBytes:gZ,isReadableStream:pVe,isBlob:yVe}=m2();async function*gVe(r){if(gZ(r)){yield w5(r);return}if(typeof r=="string"||r instanceof String){yield w5(r.toString());return}if(yVe(r)){yield*lVe(r);return}if(pVe(r)&&(r=uVe(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=fVe(r),{value:t,done:i}=await e.peek();if(i){yield*[];return}if(e.push(t),Number.isInteger(t)){yield Uint8Array.from(await dVe(e));return}if(gZ(t)||typeof t=="string"||t instanceof String){yield*hVe(e,w5);return}}throw aVe(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}function w5(r){return r instanceof Uint8Array?r:ArrayBuffer.isView(r)?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r instanceof ArrayBuffer?new Uint8Array(r):Array.isArray(r)?Uint8Array.from(r):cVe(r.toString())}mZ.exports=gVe});var _5=y((ROt,AZ)=>{f();"use strict";var vZ=ae(),mVe=Gm(),bVe=Wm(),wZ=Ho(),{isBytes:_Z,isBlob:EZ,isReadableStream:SZ,isFileObject:xZ}=m2(),{parseMtime:vVe,parseMode:wVe}=(pi(),ms);AZ.exports=async function*(e,t){if(e==null)throw vZ(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield zp(e.toString(),t);return}if(_Z(e)||EZ(e)){yield zp(e,t);return}if(SZ(e)&&(e=mVe(e)),Symbol.iterator in e||Symbol.asyncIterator in e){let i=bVe(e),{value:n,done:s}=await i.peek();if(s){yield*[];return}if(i.push(n),Number.isInteger(n)||_Z(n)){yield zp(i,t);return}if(xZ(n)||EZ(n)||typeof n=="string"||n instanceof String){yield*wZ(i,o=>zp(o,t));return}if(n[Symbol.iterator]||n[Symbol.asyncIterator]||SZ(n)){yield*wZ(i,o=>zp(o,t));return}}if(xZ(e)){yield zp(e,t);return}throw vZ(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")};async function zp(r,e){let{path:t,mode:i,mtime:n,content:s}=r,o={path:t||"",mode:wVe(i),mtime:vVe(n)};return s?o.content=await e(s):t||(o.content=await e(r)),o}});var TZ=y((COt,IZ)=>{f();"use strict";var _Ve=bZ(),EVe=_5();function SVe(r){return EVe(r,_Ve)}IZ.exports={normaliseInput:SVe}});var PZ=y((POt,CZ)=>{f();"use strict";var xVe=r=>{if(r)if(r.startsWith("size-")){let e=r.split("-")[1],t=parseInt(e);if(isNaN(t))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:t}}else{if(r.startsWith("rabin"))return{chunker:"rabin",...RZ(r)};throw new Error(`Unrecognized chunker option: ${r}`)}else return{chunker:"fixed"}},RZ=r=>{let e={},t=r.split("-");switch(t.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Ym(t[1],"avg");break;case 4:e.minChunkSize=Ym(t[1],"min"),e.avgChunkSize=Ym(t[2],"avg"),e.maxChunkSize=Ym(t[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Ym=(r,e)=>{let t=parseInt(r);if(isNaN(t))throw new Error(`Chunker parameter ${e} must be an integer`);return t};CZ.exports={parseChunkSize:Ym,parseRabinString:RZ,parseChunkerString:xVe}});var kZ=y((OOt,OZ)=>{f();"use strict";var{importer:AVe}=(g2(),y2),{normaliseInput:IVe}=TZ(),{parseChunkerString:TVe}=PZ(),{pipe:RVe}=Ar(),CVe=Oe(),PVe=gr().bind({ignoreUndefined:!0});OZ.exports=({repo:r,preload:e,options:t})=>{let i=t&&t.sharding;async function*n(s,o={}){let a=PVe({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},o,{...TVe(o.chunker)});a.hashAlg&&a.hashAlg!=="sha2-256"&&a.cidVersion!==1&&(a.cidVersion=1),a.trickle&&(a.strategy="trickle"),a.strategy==="trickle"&&(a.leafType="raw",a.reduceSingleLeafToSelf=!1),a.cidVersion>0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),a.hashAlg!==void 0&&a.rawLeaves===void 0&&(a.rawLeaves=!0),delete a.trickle;let c={};if(a.progress){let d=a.progress;a.progress=(h,p)=>{c[p]||(c[p]=0),c[p]+=h,d(c[p],p)}}let u=RVe(IVe(s),d=>AVe(d,r.blocks,{...a,pin:!1}),OVe(a),kVe(e,a),qVe(r,a)),l=await r.gcLock.readLock();try{for await(let d of u)delete c[d.path],yield d}finally{l()}}return CVe(n)};function OVe(r){async function*e(t){for await(let i of t){let n=i.cid;r.cidVersion===1&&(n=n.toV1());let s=i.path?i.path:n.toString();r.wrapWithDirectory&&!i.path&&(s=""),yield{path:s,cid:n,size:i.size,mode:i.unixfs&&i.unixfs.mode,mtime:i.unixfs&&i.unixfs.mtime}}}return e}function kVe(r,e){async function*t(i){for await(let n of i)(!n.path||e.wrapWithDirectory?n.path==="":!n.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&r(n.cid),yield n}return t}function qVe(r,e){async function*t(i){for await(let n of i){let s=!(n.path&&n.path.includes("/"));(e.pin==null?!0:e.pin)&&s&&!e.onlyHash&&await r.pins.pinRecursively(n.cid),yield n}}return t}});var b2,NVe,DVe,qZ,BVe,NZ,DZ,BZ=xe(()=>{f();b2=Wt($m());_t();a2();NVe=async function(r){return(await Km.encode(r)).slice(0,8).reverse()},DVe=(r,e,t)=>Promise.all(r.map(i=>{if(i.Name==null)throw new Error("Unexpected Link without a Name");if(i.Name.length===2){let n=parseInt(i.Name,16);return e._putObjectAt(n,new b2.Bucket({hash:t._options.hash,bits:t._options.bits},e,n))}return t.put(i.Name.substring(2),!0)})),qZ=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),BVe=r=>{let e=r.bucket,t=[];for(;e._parent;)t.push(e),e=e._parent;return t.push(e),t.reverse()},NZ=async(r,e,t,i,n)=>{if(!i){let l=(0,b2.createHAMT)({hashFn:NVe});i={rootBucket:l,hamtDepth:1,lastBucket:l}}await DVe(r.Links,i.lastBucket,i.rootBucket);let s=await i.rootBucket._findNewBucketAndPos(e),o=qZ(s.pos),a=BVe(s);a.length>i.hamtDepth&&(i.lastBucket=a[i.hamtDepth],o=qZ(i.lastBucket._posAtParent));let c=r.Links.find(l=>{if(l.Name==null)return!1;let d=l.Name.substring(0,2),h=l.Name.substring(2);return!(d!==o||h&&h!==e)});if(!c)return null;if(c.Name!=null&&c.Name.substring(2)===e)return c.Hash;i.hamtDepth++;let u=await t.get(c.Hash,n);return r=Zc(u),NZ(r,e,t,i,n)},DZ=NZ});function MVe(r,e,t,i){let n=r.length,s=e+n;return t>=s||i<e?new Uint8Array(0):(i>=e&&i<s&&(r=r.slice(0,i-e)),t>=e&&t<s&&(r=r.slice(t-e)),r)}var Jf,v2=xe(()=>{f();Jf=MVe});var w2,LVe,Hp,_2=xe(()=>{f();w2=Wt(ae()),LVe=(r,e,t)=>{if(e||(e=0),e<0)throw(0,w2.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>r)throw(0,w2.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!t&&t!==0&&(t=r-e),t<0)throw(0,w2.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+t>r&&(t=r-e),{offset:e,length:t}},Hp=LVe});async function*MZ(r,e,t,i,n=0,s){if(e instanceof Uint8Array){let c=Jf(e,n,t,i);return c.length&&(yield c),n+=c.length,n}if(e.Data==null)throw(0,E5.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let o;try{o=wi.unmarshal(e.Data)}catch(c){throw(0,E5.default)(c,"ERR_NOT_UNIXFS")}if(o.data&&o.data.length){let c=Jf(o.data,n,t,i);c.length&&(yield c),n+=o.data.length}let a=n;for(let c=0;c<e.Links.length;c++){let u=e.Links[c],l=n+o.blockSizes[c];if(t>=a&&t<l||i>a&&i<=l||t<a&&i>l){let d=await r.get(u.Hash,{signal:s.signal}),h;switch(u.Hash.code){case Wg:h=await Zc(d);break;case Kc:h=d;break;case rm:h=await Lf(d);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let p of MZ(r,h,t,i,n,s))n+=p.length,yield p}n=l,a=l+1}}var E5,UVe,S5,LZ=xe(()=>{f();v2();_2();pi();E5=Wt(ae());_t();eu();Ls();UVe=(r,e,t,i,n,s,o)=>{function a(c={}){let u=t.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:l,length:d}=Hp(u,c.offset,c.length),h=l,p=l+d;return MZ(o,e,h,p,0,c)}return a},S5=UVe});var FVe,UZ,FZ=xe(()=>{f();FVe=(r,e,t,i,n,s,o)=>{async function*a(c={}){let u=c.offset||0,l=c.length||e.Links.length,d=e.Links.slice(u,l);for(let h of d){let p=await n(h.Hash,h.Name||"",`${i}/${h.Name||""}`,[],s+1,o,c);p.entry&&(yield p.entry)}}return a},UZ=FVe});async function*KZ(r,e,t,i,n,s){let o=r.Links;for(let a of o){let c=a.Name!=null?a.Name.substring(2):null;if(c)yield(await t(a.Hash,c,`${e}/${c}`,[],i+1,n,s)).entry;else{let u=await n.get(a.Hash);r=Zc(u);for await(let l of KZ(r,e,t,i,n,s))yield l}}}var KVe,jZ,VZ=xe(()=>{f();_t();KVe=(r,e,t,i,n,s,o)=>{function a(c={}){return KZ(e,i,n,s,o,c)}return a};jZ=KVe});var E2,jVe,VVe,zVe,zZ,HZ=xe(()=>{f();E2=Wt(ae());pi();BZ();_t();LZ();FZ();VZ();jVe=(r,e)=>{let t=r.Links.find(i=>i.Name===e);return t&&t.Hash},VVe={raw:S5,file:S5,directory:UZ,"hamt-sharded-directory":jZ,metadata:(r,e,t,i,n,s,o)=>()=>[],symlink:(r,e,t,i,n,s,o)=>()=>[]},zVe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r,a),u=Zc(c),l,d;if(e||(e=r.toString()),u.Data==null)throw(0,E2.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{l=wi.unmarshal(u.Data)}catch(h){throw(0,E2.default)(h,"ERR_NOT_UNIXFS")}if(t||(t=e),i.length){let h;if(l&&l.type==="hamt-sharded-directory"?h=await DZ(u,i[0],o):h=jVe(u,i[0]),!h)throw(0,E2.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let p=i.shift(),g=`${t}/${p}`;d={cid:h,toResolve:i,name:p||"",path:g}}return{entry:{type:l.isDirectory()?"directory":"file",name:e,path:t,cid:r,content:VVe[l.type](r,u,l,t,n,s,o),unixfs:l,depth:s,node:u,size:l.fileSize()},next:d}},zZ=zVe});var $Z,HVe,$Ve,GZ,WZ=xe(()=>{f();$Z=Wt(ae());v2();_2();HVe=r=>{async function*e(t={}){let{offset:i,length:n}=Hp(r.length,t.offset,t.length);yield Jf(r,0,i,i+n)}return e},$Ve=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,$Z.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await o.get(r,a);return{entry:{type:"raw",name:e,path:t,cid:r,content:HVe(c),depth:s,size:c.length,node:c}}},GZ=$Ve});var YZ,GVe,XZ,QZ=xe(()=>{f();Ie();YZ=Wt(ae());eu();GVe=async(r,e,t,i,n,s,o,a)=>{let c=await o.get(r),u=Lf(c),l=u,d=t;for(;i.length;){let h=i[0];if(h in l){i.shift(),d=`${d}/${h}`;let p=We.asCID(l[h]);if(p)return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}},next:{cid:p,name:h,path:d,toResolve:i}};l=l[h]}else throw(0,YZ.default)(new Error(`No property named ${h} found in cbor node ${r}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:t,cid:r,node:c,depth:s,size:c.length,content:async function*(){yield u}}}},XZ=GVe});var ZZ,WVe,YVe,JZ,eJ=xe(()=>{f();ZZ=Wt(ae());v2();_2();Cn();WVe=r=>{async function*e(t={}){let{offset:i,length:n}=Hp(r.length,t.offset,t.length);yield Jf(r,0,i,i+n)}return e},YVe=async(r,e,t,i,n,s,o,a)=>{if(i.length)throw(0,ZZ.default)(new Error(`No link named ${t} found in raw node ${r}`),"ERR_NOT_FOUND");let c=await Mu(r.multihash.bytes);return{entry:{type:"identity",name:e,path:t,cid:r,content:WVe(c.digest),depth:s,size:c.digest.length,node:c.digest}}},JZ=YVe});function rJ(r,e,t,i,n,s,o){let a=XVe[r.code];if(!a)throw(0,tJ.default)(new Error(`No resolver for code ${r.code}`),"ERR_NO_RESOLVER");return a(r,e,t,i,rJ,n,s,o)}var tJ,XVe,iJ,nJ=xe(()=>{f();tJ=Wt(ae());_t();eu();Ls();Fc();HZ();WZ();QZ();eJ();XVe={[Wg]:zZ,[Kc]:GZ,[rm]:XZ,[hA.code]:JZ};iJ=rJ});var Xo={};ut(Xo,{exporter:()=>aJ,recursive:()=>JVe,walkPath:()=>oJ});async function*oJ(r,e,t={}){let{cid:i,toResolve:n}=ZVe(r),s=i.toString(),o=s,a=n.length;for(;;){let c=await iJ(i,s,o,n,a,e,t);if(!c.entry&&!c.next)throw(0,S2.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");if(c.entry&&(yield c.entry),!c.next)return;n=c.next.toResolve,i=c.next.cid,s=c.next.name,o=c.next.path}}async function aJ(r,e,t={}){let i=await(0,sJ.default)(oJ(r,e,t));if(!i)throw(0,S2.default)(new Error(`Could not resolve ${r}`),"ERR_NOT_FOUND");return i}async function*JVe(r,e,t={}){let i=await aJ(r,e,t);if(!i)return;if(yield i,i.type==="directory")for await(let s of n(i,t))yield s;async function*n(s,o){for await(let a of s.content(o))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*n(a,o))}}var S2,sJ,QVe,ZVe,Qo=xe(()=>{f();S2=Wt(ae());Ie();nJ();sJ=Wt(rs()),QVe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),ZVe=r=>{if(r instanceof Uint8Array)return{cid:We.decode(r),toResolve:[]};let e=We.asCID(r);if(e)return{cid:e,toResolve:[]};if(typeof r=="string"){r.indexOf("/ipfs/")===0&&(r=r.substring(6));let t=QVe(r);return{cid:We.parse(t[0]),toResolve:t.slice(1)}}throw(0,S2.default)(new Error(`Unknown path type ${r}`),"ERR_BAD_PATH")}});var uJ=y((_kt,cJ)=>{f();"use strict";var{exporter:eze}=(Qo(),Xo),{normalizeCidPath:tze}=Ki(),rze=Oe(),{CID:ize}=(Ie(),De);cJ.exports=function({repo:r,preload:e}){async function*t(i,n={}){if(i=tze(i),n.preload!==!1){let o=i.split("/");e(ize.parse(o[0]))}let s=await eze(i,r.blocks,n);if(s.type==="directory")throw new Error("this dag node is a directory");if(!s.content)throw new Error("this dag node has no content");yield*s.content(n)}return rze(t)}});var ml=y((Ekt,lJ)=>{f();"use strict";var nze=()=>{let r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),r};lJ.exports=nze});var hJ=y(A2=>{f();var{Buffer:x5}=Vt(),$p=bn(),sze="0".charCodeAt(0),oze=x5.from("ustar\0","binary"),aze=x5.from("ustar ","binary"),cze=x5.from(" \0","binary"),x2=257,fJ=263,uze=function(r,e,t){return typeof r!="number"?t:(r=~~r,r>=e?e:r>=0||(r+=e,r>=0)?r:0)},lze=function(r){switch(r){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null},dJ=function(r,e,t,i){for(;t<i;t++)if(r.get(t)===e)return t;return i},fze=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r.get(t);for(let t=156;t<512;t++)e+=r.get(t);return e};function dze(r){let e;if(r.get(0)===128)e=!0;else if(r.get(0)===255)e=!1;else return null;let t=!1,i=[];for(let o=r.length-1;o>0;o--){let a=r.get(o);e?i.push(a):t&&a===0?i.push(0):t?(t=!1,i.push(256-a)):i.push(255-a)}let n=0,s=i.length;for(let o=0;o<s;o++)n+=i[o]*Math.pow(256,o);return e?n:-1*n}var bl=function(r,e,t){if(r=r.shallowSlice(e,e+t),e=0,r.get(e)&128)return dze(r);{for(;e<r.length&&r.get(e)===32;)e++;let i=uze(dJ(r,32,e,r.length),r.length,r.length);for(;e<i&&r.get(e)===0;)e++;return i===e?0:parseInt(r.shallowSlice(e,i).toString(),8)}},Gp=function(r,e,t,i){return r.shallowSlice(e,dJ(r,0,e,e+t)).toString(i)};A2.decodeLongPath=function(r,e){return r=$p.isBufferList(r)?r:new $p(r),Gp(r,0,r.length,e)};A2.decodePax=function(r){r=$p.isBufferList(r)?r:new $p(r);let e={};for(;r.length;){let t=0;for(;t<r.length&&r.get(t)!==32;)t++;let i=parseInt(r.shallowSlice(0,t).toString(),10);if(!i)return e;let n=r.shallowSlice(t+1,i-1).toString(),s=n.indexOf("=");if(s===-1)return e;e[n.slice(0,s)]=n.slice(s+1),r=r.shallowSlice(i)}return e};A2.decode=function(r,e){r=$p.isBufferList(r)?r:new $p(r);let t=r.get(156)===0?0:r.get(156)-sze,i=Gp(r,0,100,e),n=bl(r,100,8),s=bl(r,108,8),o=bl(r,116,8),a=bl(r,124,12),c=bl(r,136,12),u=lze(t),l=r.get(157)===0?null:Gp(r,157,100,e),d=Gp(r,265,32),h=Gp(r,297,32),p=bl(r,329,8),g=bl(r,337,8),b=fze(r);if(b===8*32)return null;if(b!==bl(r,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(oze.compare(r.slice(x2,x2+6))===0)r.get(345)&&(i=Gp(r,345,155,e)+"/"+i);else if(!(aze.compare(r.slice(x2,x2+6))===0&&cze.compare(r.slice(fJ,fJ+2))===0))throw new Error("Invalid tar header: unknown format.");return t===0&&i&&i[i.length-1]==="/"&&(t=5),{name:i,mode:n,uid:s,gid:o,size:a,mtime:new Date(1e3*c),type:u,linkname:l,uname:d,gname:h,devmajor:p,devminor:g}}});var I2=y((xkt,pJ)=>{f();var A5=bn();pJ.exports=r=>{let e=async function*(){let t=yield,i=new A5;for await(let n of r){if(!t){t=yield i.append(n),i=new A5;continue}for(i.append(n);i.length>=t;){let s=i.shallowSlice(0,t);if(i.consume(t),t=yield s,!t){i.length&&(t=yield i,i=new A5);break}}}if(t)throw Object.assign(new Error(`stream ended before ${t} bytes became available`),{code:"ERR_UNDER_READ",buffer:i})}();return e.next(),e}});var gJ=y((Akt,yJ)=>{f();var I5=bn(),hze=I2();yJ.exports=function(e){let t=hze(e),i,n={[Symbol.asyncIterator]:()=>n,async next(s){if(i){let o;if(s==null||i.length===s)o=i,i=null;else if(i.length>s)o=i.shallowSlice(0,s),i=i.shallowSlice(s);else if(i.length<s){let{value:a,done:c}=await t.next(s-i.length);if(c)throw Object.assign(new Error(`stream ended before ${s-i.length} bytes became available`),{code:"ERR_UNDER_READ"});o=new I5([i,a]),i=null}return{value:o}}return t.next(s)},async nextLte(s){let{done:o,value:a}=await n.next();return o?{done:o}:a.length<=s?{value:a}:(a=I5.isBufferList(a)?a:new I5(a),i?i.append(a.shallowSlice(s)):i=a.shallowSlice(s),{value:a.shallowSlice(0,s)})},return(){return t.return()}};return n}});var bJ=y((Ikt,mJ)=>{f();var pze=ml(),Xm=hJ(),yze=gJ();function gze(r){return r&=511,r&&512-r}async function Qm(r,e){let t=gze(e);t&&await r.next(t)}mJ.exports=r=>(r=r||{},r.highWaterMark=r.highWaterMark||1024*16,e=>async function*(){let t=yze(e),i,n,s,o;try{for(;;){let a;try{let{done:p,value:g}=await t.next(512);if(p)return;a=g}catch(p){if(p.code==="ERR_UNDER_READ")return;throw p}let c=Xm.decode(a,r.filenameEncoding);if(!c)continue;if(c.type==="gnu-long-path"){let{done:p,value:g}=await t.next(c.size);if(p)return;i=Xm.decodeLongPath(g,r.filenameEncoding),await Qm(t,c.size);continue}if(c.type==="gnu-long-link-path"){let{done:p,value:g}=await t.next(c.size);if(p)return;n=Xm.decodeLongPath(g,r.filenameEncoding),await Qm(t,c.size);continue}if(c.type==="pax-global-header"){let{done:p,value:g}=await t.next(c.size);if(p)return;s=Xm.decodePax(g,r.filenameEncoding),await Qm(t,c.size);continue}if(c.type==="pax-header"){let{done:p,value:g}=await t.next(c.size);if(p)return;o=Xm.decodePax(g,r.filenameEncoding),s&&(o={...s,...o}),await Qm(t,c.size);continue}if(i&&(c.name=i,i=null),n&&(c.linkname=n,n=null),o&&(o.path&&(c.name=o.path),o.linkpath&&(c.linkname=o.linkpath),o.size&&(c.size=parseInt(o.size,10)),c.pax=o,o=null),!c.size||c.type==="directory"){yield{header:c,body:async function*(){}()};continue}let u=c.size,l=pze(),d=await t.nextLte(Math.min(u,r.highWaterMark));u-=d.value.length,u||l.resolve();let h=async function*(){try{for(yield d.value;u;){let{done:p,value:g}=await t.nextLte(u);if(p){u=0;return}u-=g.length,yield g}}finally{l.resolve()}}();if(yield{header:c,body:h},await l.promise,u)for await(let p of h);await Qm(t,c.size)}}finally{await t.return()}}())});var wJ=y((Tkt,vJ)=>{f();"use strict";vJ.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:8,RTLD_LOCAL:4,E2BIG:7,EACCES:13,EADDRINUSE:48,EADDRNOTAVAIL:49,EAFNOSUPPORT:47,EAGAIN:35,EALREADY:37,EBADF:9,EBADMSG:94,EBUSY:16,ECANCELED:89,ECHILD:10,ECONNABORTED:53,ECONNREFUSED:61,ECONNRESET:54,EDEADLK:11,EDESTADDRREQ:39,EDOM:33,EDQUOT:69,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:65,EIDRM:90,EILSEQ:92,EINPROGRESS:36,EINTR:4,EINVAL:22,EIO:5,EISCONN:56,EISDIR:21,ELOOP:62,EMFILE:24,EMLINK:31,EMSGSIZE:40,EMULTIHOP:95,ENAMETOOLONG:63,ENETDOWN:50,ENETRESET:52,ENETUNREACH:51,ENFILE:23,ENOBUFS:55,ENODATA:96,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:77,ENOLINK:97,ENOMEM:12,ENOMSG:91,ENOPROTOOPT:42,ENOSPC:28,ENOSR:98,ENOSTR:99,ENOSYS:78,ENOTCONN:57,ENOTDIR:20,ENOTEMPTY:66,ENOTSOCK:38,ENOTSUP:45,ENOTTY:25,ENXIO:6,EOPNOTSUPP:102,EOVERFLOW:84,EPERM:1,EPIPE:32,EPROTO:100,EPROTONOSUPPORT:43,EPROTOTYPE:41,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:70,ETIME:101,ETIMEDOUT:60,ETXTBSY:26,EWOULDBLOCK:35,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:10,SIGFPE:8,SIGKILL:9,SIGUSR1:30,SIGSEGV:11,SIGUSR2:31,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:20,SIGCONT:19,SIGSTOP:17,SIGTSTP:18,SIGTTIN:21,SIGTTOU:22,SIGURG:16,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:23,SIGINFO:29,SIGSYS:12,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:512,O_EXCL:2048,UV_FS_O_FILEMAP:0,O_NOCTTY:131072,O_TRUNC:1024,O_APPEND:8,O_DIRECTORY:1048576,O_NOFOLLOW:256,O_SYNC:128,O_DSYNC:4194304,O_SYMLINK:2097152,O_NONBLOCK:4,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488319,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var EJ=y((Rkt,_J)=>{f();var mze=bn(),T5={string:()=>"",buffer:()=>mze()};_J.exports=async(r,e)=>{if(e=e||{},e.type&&!T5[e.type])throw new Error(`invalid type "${e.type}"`);let t,i;for await(let n of r)t||(i=e.type||(typeof n=="string"?"string":"buffer"),t=T5[i]()),i==="string"?t+=n:t.append(n);return t||T5[e.type||"buffer"]()}});var SJ=y(C5=>{f();var{Buffer:Ja}=Vt(),bze=Ja.alloc,vze="0000000000000000000",wze="7777777777777777777",_ze="0".charCodeAt(0),Eze=Ja.from("ustar\0","binary"),Sze=Ja.from("00","binary"),xze=parseInt("7777",8),Aze=257,Ize=263,Tze=function(r){switch(r){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0},Rze=function(r){let e=8*32;for(let t=0;t<148;t++)e+=r[t];for(let t=156;t<512;t++)e+=r[t];return e},vl=function(r,e){return r=r.toString(8),r.length>e?wze.slice(0,e)+" ":vze.slice(0,e-r.length)+r+" "},R5=function(r){let e=Ja.byteLength(r),t=Math.floor(Math.log(e)/Math.log(10))+1;return e+t>=Math.pow(10,t)&&t++,e+t+r};C5.encodePax=function(r){let e="";r.name&&(e+=R5(" path="+r.name+`
`)),r.linkname&&(e+=R5(" linkpath="+r.linkname+`
`));let t=r.pax;if(t)for(let i in t)e+=R5(" "+i+"="+t[i]+`
`);return Ja.from(e)};C5.encode=function(r){let e=bze(512),t=r.name,i="";if(r.typeflag===5&&t[t.length-1]!=="/"&&(t+="/"),Ja.byteLength(t)!==t.length)return null;for(;Ja.byteLength(t)>100;){let n=t.indexOf("/");if(n===-1)return null;i+=i?"/"+t.slice(0,n):t.slice(0,n),t=t.slice(n+1)}return Ja.byteLength(t)>100||Ja.byteLength(i)>155||r.linkname&&Ja.byteLength(r.linkname)>100?null:(e.write(t),e.write(vl(r.mode&xze,6),100),e.write(vl(r.uid,6),108),e.write(vl(r.gid,6),116),e.write(vl(r.size,11),124),e.write(vl(r.mtime.getTime()/1e3|0,11),136),e[156]=_ze+Tze(r.type),r.linkname&&e.write(r.linkname,157),Eze.copy(e,Aze),Sze.copy(e,Ize),r.uname&&e.write(r.uname,265),r.gname&&e.write(r.gname,297),e.write(vl(r.devmajor||0,6),329),e.write(vl(r.devminor||0,6),337),i&&e.write(i,345),e.write(vl(Rze(e),6),148),e)}});var IJ=y((Pkt,AJ)=>{f();var{Buffer:P5}=Vt(),ed=bn(),{S_IFMT:Cze,S_IFBLK:Pze,S_IFCHR:Oze,S_IFDIR:kze,S_IFIFO:qze,S_IFLNK:Nze}=wJ(),Dze=EJ(),T2=SJ(),Bze=parseInt("755",8),Mze=parseInt("644",8),xJ=P5.alloc(1024);function Lze(r){switch(r&Cze){case Pze:return"block-device";case Oze:return"character-device";case kze:return"directory";case qze:return"fifo";case Nze:return"symlink"}return"file"}function O5(r){if(r&=511,r)return new ed(xJ.slice(0,512-r))}function k5(r){if(!r.pax){let e=T2.encode(r);if(e)return e}return Uze(r)}function Uze(r){let e=T2.encodePax({name:r.name,linkname:r.linkname,pax:r.pax}),t={name:"PaxHeader",mode:r.mode,uid:r.uid,gid:r.gid,size:e.length,mtime:r.mtime,type:"pax-header",linkname:r.linkname&&"PaxHeader",uname:r.uname,gname:r.gname,devmajor:r.devmajor,devminor:r.devminor};return new ed([T2.encode(t),e,O5(e.length),T2.encode({...t,size:r.size,type:r.type})])}AJ.exports=()=>async function*(r){for await(let{header:e,body:t}of r){if((!e.size||e.type==="symlink")&&(e.size=0),e.type||(e.type=Lze(e.mode)),e.mode||(e.mode=e.type==="directory"?Bze:Mze),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),typeof t=="string"&&(t=P5.from(t)),P5.isBuffer(t)||ed.isBufferList(t)){e.size=t.length,yield new ed([k5(e),t,O5(e.size)]);continue}if(e.type==="symlink"&&!e.linkname){e.linkname=(await Dze(t)).toString(),yield k5(e);continue}if(yield k5(e),e.type!=="file"&&e.type!=="contiguous-file")continue;let i=0;for await(let s of t)i+=s.length,yield ed.isBufferList(s)?s:new ed(s);if(i!==e.size)throw new Error("size mismatch");let n=O5(e.size);n&&(yield n)}yield new ed(xJ)}});var TJ=y(q5=>{f();q5.extract=bJ();q5.pack=IJ()});var nu=y(Mn=>{f();"use strict";var Fze=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function Kze(r,e){return Object.prototype.hasOwnProperty.call(r,e)}Mn.assign=function(r){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var t=e.shift();if(!!t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var i in t)Kze(t,i)&&(r[i]=t[i])}}return r};Mn.shrinkBuf=function(r,e){return r.length===e?r:r.subarray?r.subarray(0,e):(r.length=e,r)};var jze={arraySet:function(r,e,t,i,n){if(e.subarray&&r.subarray){r.set(e.subarray(t,t+i),n);return}for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){var e,t,i,n,s,o;for(i=0,e=0,t=r.length;e<t;e++)i+=r[e].length;for(o=new Uint8Array(i),n=0,e=0,t=r.length;e<t;e++)s=r[e],o.set(s,n),n+=s.length;return o}},Vze={arraySet:function(r,e,t,i,n){for(var s=0;s<i;s++)r[n+s]=e[t+s]},flattenChunks:function(r){return[].concat.apply([],r)}};Mn.setTyped=function(r){r?(Mn.Buf8=Uint8Array,Mn.Buf16=Uint16Array,Mn.Buf32=Int32Array,Mn.assign(Mn,jze)):(Mn.Buf8=Array,Mn.Buf16=Array,Mn.Buf32=Array,Mn.assign(Mn,Vze))};Mn.setTyped(Fze)});var XJ=y(Xp=>{f();"use strict";var zze=nu(),Hze=4,RJ=0,CJ=1,$ze=2;function Wp(r){for(var e=r.length;--e>=0;)r[e]=0}var Gze=0,PJ=1,Wze=2,Yze=3,Xze=258,N5=29,Zm=256,Jm=Zm+1+N5,Yp=30,D5=19,OJ=2*Jm+1,td=15,B5=16,Qze=7,M5=256,kJ=16,qJ=17,NJ=18,L5=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R2=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Zze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],DJ=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Jze=512,su=new Array((Jm+2)*2);Wp(su);var eb=new Array(Yp*2);Wp(eb);var tb=new Array(Jze);Wp(tb);var rb=new Array(Xze-Yze+1);Wp(rb);var U5=new Array(N5);Wp(U5);var C2=new Array(Yp);Wp(C2);function F5(r,e,t,i,n){this.static_tree=r,this.extra_bits=e,this.extra_base=t,this.elems=i,this.max_length=n,this.has_stree=r&&r.length}var BJ,MJ,LJ;function K5(r,e){this.dyn_tree=r,this.max_code=0,this.stat_desc=e}function UJ(r){return r<256?tb[r]:tb[256+(r>>>7)]}function ib(r,e){r.pending_buf[r.pending++]=e&255,r.pending_buf[r.pending++]=e>>>8&255}function as(r,e,t){r.bi_valid>B5-t?(r.bi_buf|=e<<r.bi_valid&65535,ib(r,r.bi_buf),r.bi_buf=e>>B5-r.bi_valid,r.bi_valid+=t-B5):(r.bi_buf|=e<<r.bi_valid&65535,r.bi_valid+=t)}function ec(r,e,t){as(r,t[e*2],t[e*2+1])}function FJ(r,e){var t=0;do t|=r&1,r>>>=1,t<<=1;while(--e>0);return t>>>1}function eHe(r){r.bi_valid===16?(ib(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)}function tHe(r,e){var t=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,c=e.stat_desc.max_length,u,l,d,h,p,g,b=0;for(h=0;h<=td;h++)r.bl_count[h]=0;for(t[r.heap[r.heap_max]*2+1]=0,u=r.heap_max+1;u<OJ;u++)l=r.heap[u],h=t[t[l*2+1]*2+1]+1,h>c&&(h=c,b++),t[l*2+1]=h,!(l>i)&&(r.bl_count[h]++,p=0,l>=a&&(p=o[l-a]),g=t[l*2],r.opt_len+=g*(h+p),s&&(r.static_len+=g*(n[l*2+1]+p)));if(b!==0){do{for(h=c-1;r.bl_count[h]===0;)h--;r.bl_count[h]--,r.bl_count[h+1]+=2,r.bl_count[c]--,b-=2}while(b>0);for(h=c;h!==0;h--)for(l=r.bl_count[h];l!==0;)d=r.heap[--u],!(d>i)&&(t[d*2+1]!==h&&(r.opt_len+=(h-t[d*2+1])*t[d*2],t[d*2+1]=h),l--)}}function KJ(r,e,t){var i=new Array(td+1),n=0,s,o;for(s=1;s<=td;s++)i[s]=n=n+t[s-1]<<1;for(o=0;o<=e;o++){var a=r[o*2+1];a!==0&&(r[o*2]=FJ(i[a]++,a))}}function rHe(){var r,e,t,i,n,s=new Array(td+1);for(t=0,i=0;i<N5-1;i++)for(U5[i]=t,r=0;r<1<<L5[i];r++)rb[t++]=i;for(rb[t-1]=i,n=0,i=0;i<16;i++)for(C2[i]=n,r=0;r<1<<R2[i];r++)tb[n++]=i;for(n>>=7;i<Yp;i++)for(C2[i]=n<<7,r=0;r<1<<R2[i]-7;r++)tb[256+n++]=i;for(e=0;e<=td;e++)s[e]=0;for(r=0;r<=143;)su[r*2+1]=8,r++,s[8]++;for(;r<=255;)su[r*2+1]=9,r++,s[9]++;for(;r<=279;)su[r*2+1]=7,r++,s[7]++;for(;r<=287;)su[r*2+1]=8,r++,s[8]++;for(KJ(su,Jm+1,s),r=0;r<Yp;r++)eb[r*2+1]=5,eb[r*2]=FJ(r,5);BJ=new F5(su,L5,Zm+1,Jm,td),MJ=new F5(eb,R2,0,Yp,td),LJ=new F5(new Array(0),Zze,0,D5,Qze)}function jJ(r){var e;for(e=0;e<Jm;e++)r.dyn_ltree[e*2]=0;for(e=0;e<Yp;e++)r.dyn_dtree[e*2]=0;for(e=0;e<D5;e++)r.bl_tree[e*2]=0;r.dyn_ltree[M5*2]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function VJ(r){r.bi_valid>8?ib(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function iHe(r,e,t,i){VJ(r),i&&(ib(r,t),ib(r,~t)),zze.arraySet(r.pending_buf,r.window,e,t,r.pending),r.pending+=t}function zJ(r,e,t,i){var n=e*2,s=t*2;return r[n]<r[s]||r[n]===r[s]&&i[e]<=i[t]}function j5(r,e,t){for(var i=r.heap[t],n=t<<1;n<=r.heap_len&&(n<r.heap_len&&zJ(e,r.heap[n+1],r.heap[n],r.depth)&&n++,!zJ(e,i,r.heap[n],r.depth));)r.heap[t]=r.heap[n],t=n,n<<=1;r.heap[t]=i}function HJ(r,e,t){var i,n,s=0,o,a;if(r.last_lit!==0)do i=r.pending_buf[r.d_buf+s*2]<<8|r.pending_buf[r.d_buf+s*2+1],n=r.pending_buf[r.l_buf+s],s++,i===0?ec(r,n,e):(o=rb[n],ec(r,o+Zm+1,e),a=L5[o],a!==0&&(n-=U5[o],as(r,n,a)),i--,o=UJ(i),ec(r,o,t),a=R2[o],a!==0&&(i-=C2[o],as(r,i,a)));while(s<r.last_lit);ec(r,M5,e)}function V5(r,e){var t=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems,o,a,c=-1,u;for(r.heap_len=0,r.heap_max=OJ,o=0;o<s;o++)t[o*2]!==0?(r.heap[++r.heap_len]=c=o,r.depth[o]=0):t[o*2+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=c<2?++c:0,t[u*2]=1,r.depth[u]=0,r.opt_len--,n&&(r.static_len-=i[u*2+1]);for(e.max_code=c,o=r.heap_len>>1;o>=1;o--)j5(r,t,o);u=s;do o=r.heap[1],r.heap[1]=r.heap[r.heap_len--],j5(r,t,1),a=r.heap[1],r.heap[--r.heap_max]=o,r.heap[--r.heap_max]=a,t[u*2]=t[o*2]+t[a*2],r.depth[u]=(r.depth[o]>=r.depth[a]?r.depth[o]:r.depth[a])+1,t[o*2+1]=t[a*2+1]=u,r.heap[1]=u++,j5(r,t,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],tHe(r,e),KJ(t,c,r.bl_count)}function $J(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),e[(t+1)*2+1]=65535,i=0;i<=t;i++)s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)&&(a<u?r.bl_tree[s*2]+=a:s!==0?(s!==n&&r.bl_tree[s*2]++,r.bl_tree[kJ*2]++):a<=10?r.bl_tree[qJ*2]++:r.bl_tree[NJ*2]++,a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4))}function GJ(r,e,t){var i,n=-1,s,o=e[0*2+1],a=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=t;i++)if(s=o,o=e[(i+1)*2+1],!(++a<c&&s===o)){if(a<u)do ec(r,s,r.bl_tree);while(--a!=0);else s!==0?(s!==n&&(ec(r,s,r.bl_tree),a--),ec(r,kJ,r.bl_tree),as(r,a-3,2)):a<=10?(ec(r,qJ,r.bl_tree),as(r,a-3,3)):(ec(r,NJ,r.bl_tree),as(r,a-11,7));a=0,n=s,o===0?(c=138,u=3):s===o?(c=6,u=3):(c=7,u=4)}}function nHe(r){var e;for($J(r,r.dyn_ltree,r.l_desc.max_code),$J(r,r.dyn_dtree,r.d_desc.max_code),V5(r,r.bl_desc),e=D5-1;e>=3&&r.bl_tree[DJ[e]*2+1]===0;e--);return r.opt_len+=3*(e+1)+5+5+4,e}function sHe(r,e,t,i){var n;for(as(r,e-257,5),as(r,t-1,5),as(r,i-4,4),n=0;n<i;n++)as(r,r.bl_tree[DJ[n]*2+1],3);GJ(r,r.dyn_ltree,e-1),GJ(r,r.dyn_dtree,t-1)}function oHe(r){var e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&r.dyn_ltree[t*2]!==0)return RJ;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return CJ;for(t=32;t<Zm;t++)if(r.dyn_ltree[t*2]!==0)return CJ;return RJ}var WJ=!1;function aHe(r){WJ||(rHe(),WJ=!0),r.l_desc=new K5(r.dyn_ltree,BJ),r.d_desc=new K5(r.dyn_dtree,MJ),r.bl_desc=new K5(r.bl_tree,LJ),r.bi_buf=0,r.bi_valid=0,jJ(r)}function YJ(r,e,t,i){as(r,(Gze<<1)+(i?1:0),3),iHe(r,e,t,!0)}function cHe(r){as(r,PJ<<1,3),ec(r,M5,su),eHe(r)}function uHe(r,e,t,i){var n,s,o=0;r.level>0?(r.strm.data_type===$ze&&(r.strm.data_type=oHe(r)),V5(r,r.l_desc),V5(r,r.d_desc),o=nHe(r),n=r.opt_len+3+7>>>3,s=r.static_len+3+7>>>3,s<=n&&(n=s)):n=s=t+5,t+4<=n&&e!==-1?YJ(r,e,t,i):r.strategy===Hze||s===n?(as(r,(PJ<<1)+(i?1:0),3),HJ(r,su,eb)):(as(r,(Wze<<1)+(i?1:0),3),sHe(r,r.l_desc.max_code+1,r.d_desc.max_code+1,o+1),HJ(r,r.dyn_ltree,r.dyn_dtree)),jJ(r),i&&VJ(r)}function lHe(r,e,t){return r.pending_buf[r.d_buf+r.last_lit*2]=e>>>8&255,r.pending_buf[r.d_buf+r.last_lit*2+1]=e&255,r.pending_buf[r.l_buf+r.last_lit]=t&255,r.last_lit++,e===0?r.dyn_ltree[t*2]++:(r.matches++,e--,r.dyn_ltree[(rb[t]+Zm+1)*2]++,r.dyn_dtree[UJ(e)*2]++),r.last_lit===r.lit_bufsize-1}Xp._tr_init=aHe;Xp._tr_stored_block=YJ;Xp._tr_flush_block=uHe;Xp._tr_tally=lHe;Xp._tr_align=cHe});var z5=y((Nkt,QJ)=>{f();"use strict";function fHe(r,e,t,i){for(var n=r&65535|0,s=r>>>16&65535|0,o=0;t!==0;){o=t>2e3?2e3:t,t-=o;do n=n+e[i++]|0,s=s+n|0;while(--o);n%=65521,s%=65521}return n|s<<16|0}QJ.exports=fHe});var H5=y((Dkt,ZJ)=>{f();"use strict";function dHe(){for(var r,e=[],t=0;t<256;t++){r=t;for(var i=0;i<8;i++)r=r&1?3988292384^r>>>1:r>>>1;e[t]=r}return e}var hHe=dHe();function pHe(r,e,t,i){var n=hHe,s=i+t;r^=-1;for(var o=i;o<s;o++)r=r>>>8^n[(r^e[o])&255];return r^-1}ZJ.exports=pHe});var P2=y((Bkt,JJ)=>{f();"use strict";JJ.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var cee=y(ic=>{f();"use strict";var Ln=nu(),ro=XJ(),eee=z5(),wl=H5(),yHe=P2(),rd=0,gHe=1,mHe=3,_l=4,tee=5,tc=0,ree=1,io=-2,bHe=-3,$5=-5,vHe=-1,wHe=1,O2=2,_He=3,EHe=4,SHe=0,xHe=2,k2=8,AHe=9,IHe=15,THe=8,RHe=29,CHe=256,G5=CHe+1+RHe,PHe=30,OHe=19,kHe=2*G5+1,qHe=15,Tt=3,El=258,Zo=El+Tt+1,NHe=32,q2=42,W5=69,N2=73,D2=91,B2=103,id=113,nb=666,Ei=1,sb=2,nd=3,Qp=4,DHe=3;function Sl(r,e){return r.msg=yHe[e],e}function iee(r){return(r<<1)-(r>4?9:0)}function xl(r){for(var e=r.length;--e>=0;)r[e]=0}function Al(r){var e=r.state,t=e.pending;t>r.avail_out&&(t=r.avail_out),t!==0&&(Ln.arraySet(r.output,e.pending_buf,e.pending_out,t,r.next_out),r.next_out+=t,e.pending_out+=t,r.total_out+=t,r.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))}function Zi(r,e){ro._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,e),r.block_start=r.strstart,Al(r.strm)}function Ft(r,e){r.pending_buf[r.pending++]=e}function ob(r,e){r.pending_buf[r.pending++]=e>>>8&255,r.pending_buf[r.pending++]=e&255}function BHe(r,e,t,i){var n=r.avail_in;return n>i&&(n=i),n===0?0:(r.avail_in-=n,Ln.arraySet(e,r.input,r.next_in,n,t),r.state.wrap===1?r.adler=eee(r.adler,e,n,t):r.state.wrap===2&&(r.adler=wl(r.adler,e,n,t)),r.next_in+=n,r.total_in+=n,n)}function nee(r,e){var t=r.max_chain_length,i=r.strstart,n,s,o=r.prev_length,a=r.nice_match,c=r.strstart>r.w_size-Zo?r.strstart-(r.w_size-Zo):0,u=r.window,l=r.w_mask,d=r.prev,h=r.strstart+El,p=u[i+o-1],g=u[i+o];r.prev_length>=r.good_match&&(t>>=2),a>r.lookahead&&(a=r.lookahead);do if(n=e,!(u[n+o]!==g||u[n+o-1]!==p||u[n]!==u[i]||u[++n]!==u[i+1])){i+=2,n++;do;while(u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&u[++i]===u[++n]&&i<h);if(s=El-(h-i),i=h-El,s>o){if(r.match_start=e,o=s,s>=a)break;p=u[i+o-1],g=u[i+o]}}while((e=d[e&l])>c&&--t!=0);return o<=r.lookahead?o:r.lookahead}function sd(r){var e=r.w_size,t,i,n,s,o;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=e+(e-Zo)){Ln.arraySet(r.window,r.window,e,e,0),r.match_start-=e,r.strstart-=e,r.block_start-=e,i=r.hash_size,t=i;do n=r.head[--t],r.head[t]=n>=e?n-e:0;while(--i);i=e,t=i;do n=r.prev[--t],r.prev[t]=n>=e?n-e:0;while(--i);s+=e}if(r.strm.avail_in===0)break;if(i=BHe(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=i,r.lookahead+r.insert>=Tt)for(o=r.strstart-r.insert,r.ins_h=r.window[o],r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[o+Tt-1])&r.hash_mask,r.prev[o&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=o,o++,r.insert--,!(r.lookahead+r.insert<Tt)););}while(r.lookahead<Zo&&r.strm.avail_in!==0)}function MHe(r,e){var t=65535;for(t>r.pending_buf_size-5&&(t=r.pending_buf_size-5);;){if(r.lookahead<=1){if(sd(r),r.lookahead===0&&e===rd)return Ei;if(r.lookahead===0)break}r.strstart+=r.lookahead,r.lookahead=0;var i=r.block_start+t;if((r.strstart===0||r.strstart>=i)&&(r.lookahead=r.strstart-i,r.strstart=i,Zi(r,!1),r.strm.avail_out===0)||r.strstart-r.block_start>=r.w_size-Zo&&(Zi(r,!1),r.strm.avail_out===0))return Ei}return r.insert=0,e===_l?(Zi(r,!0),r.strm.avail_out===0?nd:Qp):(r.strstart>r.block_start&&(Zi(r,!1),r.strm.avail_out===0),Ei)}function Y5(r,e){for(var t,i;;){if(r.lookahead<Zo){if(sd(r),r.lookahead<Zo&&e===rd)return Ei;if(r.lookahead===0)break}if(t=0,r.lookahead>=Tt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Tt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),t!==0&&r.strstart-t<=r.w_size-Zo&&(r.match_length=nee(r,t)),r.match_length>=Tt)if(i=ro._tr_tally(r,r.strstart-r.match_start,r.match_length-Tt),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Tt){r.match_length--;do r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Tt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else i=ro._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(i&&(Zi(r,!1),r.strm.avail_out===0))return Ei}return r.insert=r.strstart<Tt-1?r.strstart:Tt-1,e===_l?(Zi(r,!0),r.strm.avail_out===0?nd:Qp):r.last_lit&&(Zi(r,!1),r.strm.avail_out===0)?Ei:sb}function Zp(r,e){for(var t,i,n;;){if(r.lookahead<Zo){if(sd(r),r.lookahead<Zo&&e===rd)return Ei;if(r.lookahead===0)break}if(t=0,r.lookahead>=Tt&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Tt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Tt-1,t!==0&&r.prev_length<r.max_lazy_match&&r.strstart-t<=r.w_size-Zo&&(r.match_length=nee(r,t),r.match_length<=5&&(r.strategy===wHe||r.match_length===Tt&&r.strstart-r.match_start>4096)&&(r.match_length=Tt-1)),r.prev_length>=Tt&&r.match_length<=r.prev_length){n=r.strstart+r.lookahead-Tt,i=ro._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-Tt),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=n&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+Tt-1])&r.hash_mask,t=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=Tt-1,r.strstart++,i&&(Zi(r,!1),r.strm.avail_out===0))return Ei}else if(r.match_available){if(i=ro._tr_tally(r,0,r.window[r.strstart-1]),i&&Zi(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return Ei}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(i=ro._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Tt-1?r.strstart:Tt-1,e===_l?(Zi(r,!0),r.strm.avail_out===0?nd:Qp):r.last_lit&&(Zi(r,!1),r.strm.avail_out===0)?Ei:sb}function LHe(r,e){for(var t,i,n,s,o=r.window;;){if(r.lookahead<=El){if(sd(r),r.lookahead<=El&&e===rd)return Ei;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=Tt&&r.strstart>0&&(n=r.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=r.strstart+El;do;while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);r.match_length=El-(s-n),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=Tt?(t=ro._tr_tally(r,1,r.match_length-Tt),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(t=ro._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),t&&(Zi(r,!1),r.strm.avail_out===0))return Ei}return r.insert=0,e===_l?(Zi(r,!0),r.strm.avail_out===0?nd:Qp):r.last_lit&&(Zi(r,!1),r.strm.avail_out===0)?Ei:sb}function UHe(r,e){for(var t;;){if(r.lookahead===0&&(sd(r),r.lookahead===0)){if(e===rd)return Ei;break}if(r.match_length=0,t=ro._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,t&&(Zi(r,!1),r.strm.avail_out===0))return Ei}return r.insert=0,e===_l?(Zi(r,!0),r.strm.avail_out===0?nd:Qp):r.last_lit&&(Zi(r,!1),r.strm.avail_out===0)?Ei:sb}function rc(r,e,t,i,n){this.good_length=r,this.max_lazy=e,this.nice_length=t,this.max_chain=i,this.func=n}var Jp;Jp=[new rc(0,0,0,0,MHe),new rc(4,4,8,4,Y5),new rc(4,5,16,8,Y5),new rc(4,6,32,32,Y5),new rc(4,4,16,16,Zp),new rc(8,16,32,32,Zp),new rc(8,16,128,128,Zp),new rc(8,32,128,256,Zp),new rc(32,128,258,1024,Zp),new rc(32,258,258,4096,Zp)];function FHe(r){r.window_size=2*r.w_size,xl(r.head),r.max_lazy_match=Jp[r.level].max_lazy,r.good_match=Jp[r.level].good_length,r.nice_match=Jp[r.level].nice_length,r.max_chain_length=Jp[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=Tt-1,r.match_available=0,r.ins_h=0}function KHe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Ln.Buf16(kHe*2),this.dyn_dtree=new Ln.Buf16((2*PHe+1)*2),this.bl_tree=new Ln.Buf16((2*OHe+1)*2),xl(this.dyn_ltree),xl(this.dyn_dtree),xl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Ln.Buf16(qHe+1),this.heap=new Ln.Buf16(2*G5+1),xl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Ln.Buf16(2*G5+1),xl(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function see(r){var e;return!r||!r.state?Sl(r,io):(r.total_in=r.total_out=0,r.data_type=xHe,e=r.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?q2:id,r.adler=e.wrap===2?0:1,e.last_flush=rd,ro._tr_init(e),tc)}function oee(r){var e=see(r);return e===tc&&FHe(r.state),e}function jHe(r,e){return!r||!r.state||r.state.wrap!==2?io:(r.state.gzhead=e,tc)}function aee(r,e,t,i,n,s){if(!r)return io;var o=1;if(e===vHe&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>AHe||t!==k2||i<8||i>15||e<0||e>9||s<0||s>EHe)return Sl(r,io);i===8&&(i=9);var a=new KHe;return r.state=a,a.strm=r,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Tt-1)/Tt),a.window=new Ln.Buf8(a.w_size*2),a.head=new Ln.Buf16(a.hash_size),a.prev=new Ln.Buf16(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Ln.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=s,a.method=t,oee(r)}function VHe(r,e){return aee(r,e,k2,IHe,THe,SHe)}function zHe(r,e){var t,i,n,s;if(!r||!r.state||e>tee||e<0)return r?Sl(r,io):io;if(i=r.state,!r.output||!r.input&&r.avail_in!==0||i.status===nb&&e!==_l)return Sl(r,r.avail_out===0?$5:io);if(i.strm=r,t=i.last_flush,i.last_flush=e,i.status===q2)if(i.wrap===2)r.adler=0,Ft(i,31),Ft(i,139),Ft(i,8),i.gzhead?(Ft(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Ft(i,i.gzhead.time&255),Ft(i,i.gzhead.time>>8&255),Ft(i,i.gzhead.time>>16&255),Ft(i,i.gzhead.time>>24&255),Ft(i,i.level===9?2:i.strategy>=O2||i.level<2?4:0),Ft(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Ft(i,i.gzhead.extra.length&255),Ft(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(r.adler=wl(r.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=W5):(Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,0),Ft(i,i.level===9?2:i.strategy>=O2||i.level<2?4:0),Ft(i,DHe),i.status=id);else{var o=k2+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=O2||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=NHe),o+=31-o%31,i.status=id,ob(i,o),i.strstart!==0&&(ob(i,r.adler>>>16),ob(i,r.adler&65535)),r.adler=1}if(i.status===W5)if(i.gzhead.extra){for(n=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),Al(r),n=i.pending,i.pending===i.pending_buf_size));)Ft(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=N2)}else i.status=N2;if(i.status===N2)if(i.gzhead.name){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),Al(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.name.length?s=i.gzhead.name.charCodeAt(i.gzindex++)&255:s=0,Ft(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.gzindex=0,i.status=D2)}else i.status=D2;if(i.status===D2)if(i.gzhead.comment){n=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),Al(r),n=i.pending,i.pending===i.pending_buf_size)){s=1;break}i.gzindex<i.gzhead.comment.length?s=i.gzhead.comment.charCodeAt(i.gzindex++)&255:s=0,Ft(i,s)}while(s!==0);i.gzhead.hcrc&&i.pending>n&&(r.adler=wl(r.adler,i.pending_buf,i.pending-n,n)),s===0&&(i.status=B2)}else i.status=B2;if(i.status===B2&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&Al(r),i.pending+2<=i.pending_buf_size&&(Ft(i,r.adler&255),Ft(i,r.adler>>8&255),r.adler=0,i.status=id)):i.status=id),i.pending!==0){if(Al(r),r.avail_out===0)return i.last_flush=-1,tc}else if(r.avail_in===0&&iee(e)<=iee(t)&&e!==_l)return Sl(r,$5);if(i.status===nb&&r.avail_in!==0)return Sl(r,$5);if(r.avail_in!==0||i.lookahead!==0||e!==rd&&i.status!==nb){var c=i.strategy===O2?UHe(i,e):i.strategy===_He?LHe(i,e):Jp[i.level].func(i,e);if((c===nd||c===Qp)&&(i.status=nb),c===Ei||c===nd)return r.avail_out===0&&(i.last_flush=-1),tc;if(c===sb&&(e===gHe?ro._tr_align(i):e!==tee&&(ro._tr_stored_block(i,0,0,!1),e===mHe&&(xl(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Al(r),r.avail_out===0))return i.last_flush=-1,tc}return e!==_l?tc:i.wrap<=0?ree:(i.wrap===2?(Ft(i,r.adler&255),Ft(i,r.adler>>8&255),Ft(i,r.adler>>16&255),Ft(i,r.adler>>24&255),Ft(i,r.total_in&255),Ft(i,r.total_in>>8&255),Ft(i,r.total_in>>16&255),Ft(i,r.total_in>>24&255)):(ob(i,r.adler>>>16),ob(i,r.adler&65535)),Al(r),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?tc:ree)}function HHe(r){var e;return!r||!r.state?io:(e=r.state.status,e!==q2&&e!==W5&&e!==N2&&e!==D2&&e!==B2&&e!==id&&e!==nb?Sl(r,io):(r.state=null,e===id?Sl(r,bHe):tc))}function $He(r,e){var t=e.length,i,n,s,o,a,c,u,l;if(!r||!r.state||(i=r.state,o=i.wrap,o===2||o===1&&i.status!==q2||i.lookahead))return io;for(o===1&&(r.adler=eee(r.adler,e,t,0)),i.wrap=0,t>=i.w_size&&(o===0&&(xl(i.head),i.strstart=0,i.block_start=0,i.insert=0),l=new Ln.Buf8(i.w_size),Ln.arraySet(l,e,t-i.w_size,i.w_size,0),e=l,t=i.w_size),a=r.avail_in,c=r.next_in,u=r.input,r.avail_in=t,r.next_in=0,r.input=e,sd(i);i.lookahead>=Tt;){n=i.strstart,s=i.lookahead-(Tt-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+Tt-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++;while(--s);i.strstart=n,i.lookahead=Tt-1,sd(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Tt-1,i.match_available=0,r.next_in=c,r.input=u,r.avail_in=a,i.wrap=o,tc}ic.deflateInit=VHe;ic.deflateInit2=aee;ic.deflateReset=oee;ic.deflateResetKeep=see;ic.deflateSetHeader=jHe;ic.deflate=zHe;ic.deflateEnd=HHe;ic.deflateSetDictionary=$He;ic.deflateInfo="pako deflate (from Nodeca project)"});var X5=y(e0=>{f();"use strict";var M2=nu(),uee=!0,lee=!0;try{String.fromCharCode.apply(null,[0])}catch(r){uee=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){lee=!1}var ab=new M2.Buf8(256);for(ou=0;ou<256;ou++)ab[ou]=ou>=252?6:ou>=248?5:ou>=240?4:ou>=224?3:ou>=192?2:1;var ou;ab[254]=ab[254]=1;e0.string2buf=function(r){var e,t,i,n,s,o=r.length,a=0;for(n=0;n<o;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new M2.Buf8(a),s=0,n=0;s<a;n++)t=r.charCodeAt(n),(t&64512)==55296&&n+1<o&&(i=r.charCodeAt(n+1),(i&64512)==56320&&(t=65536+(t-55296<<10)+(i-56320),n++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};function fee(r,e){if(e<65534&&(r.subarray&&lee||!r.subarray&&uee))return String.fromCharCode.apply(null,M2.shrinkBuf(r,e));for(var t="",i=0;i<e;i++)t+=String.fromCharCode(r[i]);return t}e0.buf2binstring=function(r){return fee(r,r.length)};e0.binstring2buf=function(r){for(var e=new M2.Buf8(r.length),t=0,i=e.length;t<i;t++)e[t]=r.charCodeAt(t);return e};e0.buf2string=function(r,e){var t,i,n,s,o=e||r.length,a=new Array(o*2);for(i=0,t=0;t<o;){if(n=r[t++],n<128){a[i++]=n;continue}if(s=ab[n],s>4){a[i++]=65533,t+=s-1;continue}for(n&=s===2?31:s===3?15:7;s>1&&t<o;)n=n<<6|r[t++]&63,s--;if(s>1){a[i++]=65533;continue}n<65536?a[i++]=n:(n-=65536,a[i++]=55296|n>>10&1023,a[i++]=56320|n&1023)}return fee(a,i)};e0.utf8border=function(r,e){var t;for(e=e||r.length,e>r.length&&(e=r.length),t=e-1;t>=0&&(r[t]&192)==128;)t--;return t<0||t===0?e:t+ab[r[t]]>e?t:e}});var Q5=y((Ukt,dee)=>{f();"use strict";function GHe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}dee.exports=GHe});var gee=y(lb=>{f();"use strict";var cb=cee(),ub=nu(),Z5=X5(),J5=P2(),WHe=Q5(),hee=Object.prototype.toString,YHe=0,eR=4,t0=0,pee=1,yee=2,XHe=-1,QHe=0,ZHe=8;function od(r){if(!(this instanceof od))return new od(r);this.options=ub.assign({level:XHe,method:ZHe,chunkSize:16384,windowBits:15,memLevel:8,strategy:QHe,to:""},r||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WHe,this.strm.avail_out=0;var t=cb.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==t0)throw new Error(J5[t]);if(e.header&&cb.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(typeof e.dictionary=="string"?i=Z5.string2buf(e.dictionary):hee.call(e.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(e.dictionary):i=e.dictionary,t=cb.deflateSetDictionary(this.strm,i),t!==t0)throw new Error(J5[t]);this._dict_set=!0}}od.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n,s;if(this.ended)return!1;s=e===~~e?e:e===!0?eR:YHe,typeof r=="string"?t.input=Z5.string2buf(r):hee.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new ub.Buf8(i),t.next_out=0,t.avail_out=i),n=cb.deflate(t,s),n!==pee&&n!==t0)return this.onEnd(n),this.ended=!0,!1;(t.avail_out===0||t.avail_in===0&&(s===eR||s===yee))&&(this.options.to==="string"?this.onData(Z5.buf2binstring(ub.shrinkBuf(t.output,t.next_out))):this.onData(ub.shrinkBuf(t.output,t.next_out)))}while((t.avail_in>0||t.avail_out===0)&&n!==pee);return s===eR?(n=cb.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===t0):(s===yee&&(this.onEnd(t0),t.avail_out=0),!0)};od.prototype.onData=function(r){this.chunks.push(r)};od.prototype.onEnd=function(r){r===t0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=ub.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function tR(r,e){var t=new od(e);if(t.push(r,!0),t.err)throw t.msg||J5[t.err];return t.result}function JHe(r,e){return e=e||{},e.raw=!0,tR(r,e)}function e$e(r,e){return e=e||{},e.gzip=!0,tR(r,e)}lb.Deflate=od;lb.deflate=tR;lb.deflateRaw=JHe;lb.gzip=e$e});var bee=y((Kkt,mee)=>{f();"use strict";var L2=30,t$e=12;mee.exports=function(e,t){var i,n,s,o,a,c,u,l,d,h,p,g,b,E,v,A,R,F,q,N,z,G,Y,C,m;i=e.state,n=e.next_in,C=e.input,s=n+(e.avail_in-5),o=e.next_out,m=e.output,a=o-(t-e.avail_out),c=o+(e.avail_out-257),u=i.dmax,l=i.wsize,d=i.whave,h=i.wnext,p=i.window,g=i.hold,b=i.bits,E=i.lencode,v=i.distcode,A=(1<<i.lenbits)-1,R=(1<<i.distbits)-1;e:do{b<15&&(g+=C[n++]<<b,b+=8,g+=C[n++]<<b,b+=8),F=E[g&A];t:for(;;){if(q=F>>>24,g>>>=q,b-=q,q=F>>>16&255,q===0)m[o++]=F&65535;else if(q&16){N=F&65535,q&=15,q&&(b<q&&(g+=C[n++]<<b,b+=8),N+=g&(1<<q)-1,g>>>=q,b-=q),b<15&&(g+=C[n++]<<b,b+=8,g+=C[n++]<<b,b+=8),F=v[g&R];r:for(;;){if(q=F>>>24,g>>>=q,b-=q,q=F>>>16&255,q&16){if(z=F&65535,q&=15,b<q&&(g+=C[n++]<<b,b+=8,b<q&&(g+=C[n++]<<b,b+=8)),z+=g&(1<<q)-1,z>u){e.msg="invalid distance too far back",i.mode=L2;break e}if(g>>>=q,b-=q,q=o-a,z>q){if(q=z-q,q>d&&i.sane){e.msg="invalid distance too far back",i.mode=L2;break e}if(G=0,Y=p,h===0){if(G+=l-q,q<N){N-=q;do m[o++]=p[G++];while(--q);G=o-z,Y=m}}else if(h<q){if(G+=l+h-q,q-=h,q<N){N-=q;do m[o++]=p[G++];while(--q);if(G=0,h<N){q=h,N-=q;do m[o++]=p[G++];while(--q);G=o-z,Y=m}}}else if(G+=h-q,q<N){N-=q;do m[o++]=p[G++];while(--q);G=o-z,Y=m}for(;N>2;)m[o++]=Y[G++],m[o++]=Y[G++],m[o++]=Y[G++],N-=3;N&&(m[o++]=Y[G++],N>1&&(m[o++]=Y[G++]))}else{G=o-z;do m[o++]=m[G++],m[o++]=m[G++],m[o++]=m[G++],N-=3;while(N>2);N&&(m[o++]=m[G++],N>1&&(m[o++]=m[G++]))}}else if((q&64)==0){F=v[(F&65535)+(g&(1<<q)-1)];continue r}else{e.msg="invalid distance code",i.mode=L2;break e}break}}else if((q&64)==0){F=E[(F&65535)+(g&(1<<q)-1)];continue t}else if(q&32){i.mode=t$e;break e}else{e.msg="invalid literal/length code",i.mode=L2;break e}break}}while(n<s&&o<c);N=b>>3,n-=N,b-=N<<3,g&=(1<<b)-1,e.next_in=n,e.next_out=o,e.avail_in=n<s?5+(s-n):5-(n-s),e.avail_out=o<c?257+(c-o):257-(o-c),i.hold=g,i.bits=b}});var Aee=y((jkt,xee)=>{f();"use strict";var vee=nu(),r0=15,wee=852,_ee=592,Eee=0,rR=1,See=2,r$e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i$e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],n$e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s$e=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];xee.exports=function(e,t,i,n,s,o,a,c){var u=c.bits,l=0,d=0,h=0,p=0,g=0,b=0,E=0,v=0,A=0,R=0,F,q,N,z,G,Y=null,C=0,m,w=new vee.Buf16(r0+1),S=new vee.Buf16(r0+1),P=null,B=0,W,j,M;for(l=0;l<=r0;l++)w[l]=0;for(d=0;d<n;d++)w[t[i+d]]++;for(g=u,p=r0;p>=1&&w[p]===0;p--);if(g>p&&(g=p),p===0)return s[o++]=1<<24|64<<16|0,s[o++]=1<<24|64<<16|0,c.bits=1,0;for(h=1;h<p&&w[h]===0;h++);for(g<h&&(g=h),v=1,l=1;l<=r0;l++)if(v<<=1,v-=w[l],v<0)return-1;if(v>0&&(e===Eee||p!==1))return-1;for(S[1]=0,l=1;l<r0;l++)S[l+1]=S[l]+w[l];for(d=0;d<n;d++)t[i+d]!==0&&(a[S[t[i+d]]++]=d);if(e===Eee?(Y=P=a,m=19):e===rR?(Y=r$e,C-=257,P=i$e,B-=257,m=256):(Y=n$e,P=s$e,m=-1),R=0,d=0,l=h,G=o,b=g,E=0,N=-1,A=1<<g,z=A-1,e===rR&&A>wee||e===See&&A>_ee)return 1;for(;;){W=l-E,a[d]<m?(j=0,M=a[d]):a[d]>m?(j=P[B+a[d]],M=Y[C+a[d]]):(j=32+64,M=0),F=1<<l-E,q=1<<b,h=q;do q-=F,s[G+(R>>E)+q]=W<<24|j<<16|M|0;while(q!==0);for(F=1<<l-1;R&F;)F>>=1;if(F!==0?(R&=F-1,R+=F):R=0,d++,--w[l]==0){if(l===p)break;l=t[i+a[d]]}if(l>g&&(R&z)!==N){for(E===0&&(E=g),G+=h,b=l-E,v=1<<b;b+E<p&&(v-=w[b+E],!(v<=0));)b++,v<<=1;if(A+=1<<b,e===rR&&A>wee||e===See&&A>_ee)return 1;N=R&z,s[N]=g<<24|b<<16|G-o|0}}return R!==0&&(s[G+R]=l-E<<24|64<<16|0),c.bits=g,0}});var ote=y(Jo=>{f();"use strict";var As=nu(),iR=z5(),nc=H5(),o$e=bee(),fb=Aee(),a$e=0,Iee=1,Tee=2,Ree=4,c$e=5,U2=6,ad=0,u$e=1,l$e=2,no=-2,Cee=-3,nR=-4,f$e=-5,Pee=8,Oee=1,kee=2,qee=3,Nee=4,Dee=5,Bee=6,Mee=7,Lee=8,Uee=9,Fee=10,F2=11,au=12,sR=13,Kee=14,oR=15,jee=16,Vee=17,zee=18,Hee=19,K2=20,j2=21,$ee=22,Gee=23,Wee=24,Yee=25,Xee=26,aR=27,Qee=28,Zee=29,vr=30,cR=31,d$e=32,h$e=852,p$e=592,y$e=15,g$e=y$e;function Jee(r){return(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24)}function m$e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new As.Buf16(320),this.work=new As.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ete(r){var e;return!r||!r.state?no:(e=r.state,r.total_in=r.total_out=e.total=0,r.msg="",e.wrap&&(r.adler=e.wrap&1),e.mode=Oee,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new As.Buf32(h$e),e.distcode=e.distdyn=new As.Buf32(p$e),e.sane=1,e.back=-1,ad)}function tte(r){var e;return!r||!r.state?no:(e=r.state,e.wsize=0,e.whave=0,e.wnext=0,ete(r))}function rte(r,e){var t,i;return!r||!r.state||(i=r.state,e<0?(t=0,e=-e):(t=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?no:(i.window!==null&&i.wbits!==e&&(i.window=null),i.wrap=t,i.wbits=e,tte(r))}function ite(r,e){var t,i;return r?(i=new m$e,r.state=i,i.window=null,t=rte(r,e),t!==ad&&(r.state=null),t):no}function b$e(r){return ite(r,g$e)}var nte=!0,uR,lR;function v$e(r){if(nte){var e;for(uR=new As.Buf32(512),lR=new As.Buf32(32),e=0;e<144;)r.lens[e++]=8;for(;e<256;)r.lens[e++]=9;for(;e<280;)r.lens[e++]=7;for(;e<288;)r.lens[e++]=8;for(fb(Iee,r.lens,0,288,uR,0,r.work,{bits:9}),e=0;e<32;)r.lens[e++]=5;fb(Tee,r.lens,0,32,lR,0,r.work,{bits:5}),nte=!1}r.lencode=uR,r.lenbits=9,r.distcode=lR,r.distbits=5}function ste(r,e,t,i){var n,s=r.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new As.Buf8(s.wsize)),i>=s.wsize?(As.arraySet(s.window,e,t-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),As.arraySet(s.window,e,t-i,n,s.wnext),i-=n,i?(As.arraySet(s.window,e,t-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0}function w$e(r,e){var t,i,n,s,o,a,c,u,l,d,h,p,g,b,E=0,v,A,R,F,q,N,z,G,Y=new As.Buf8(4),C,m,w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&r.avail_in!==0)return no;t=r.state,t.mode===au&&(t.mode=sR),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,l=t.bits,d=a,h=c,G=ad;e:for(;;)switch(t.mode){case Oee:if(t.wrap===0){t.mode=sR;break}for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.wrap&2&&u===35615){t.check=0,Y[0]=u&255,Y[1]=u>>>8&255,t.check=nc(t.check,Y,2,0),u=0,l=0,t.mode=kee;break}if(t.flags=0,t.head&&(t.head.done=!1),!(t.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",t.mode=vr;break}if((u&15)!==Pee){r.msg="unknown compression method",t.mode=vr;break}if(u>>>=4,l-=4,z=(u&15)+8,t.wbits===0)t.wbits=z;else if(z>t.wbits){r.msg="invalid window size",t.mode=vr;break}t.dmax=1<<z,r.adler=t.check=1,t.mode=u&512?Fee:au,u=0,l=0;break;case kee:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.flags=u,(t.flags&255)!==Pee){r.msg="unknown compression method",t.mode=vr;break}if(t.flags&57344){r.msg="unknown header flags set",t.mode=vr;break}t.head&&(t.head.text=u>>8&1),t.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,t.check=nc(t.check,Y,2,0)),u=0,l=0,t.mode=qee;case qee:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.head&&(t.head.time=u),t.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,Y[2]=u>>>16&255,Y[3]=u>>>24&255,t.check=nc(t.check,Y,4,0)),u=0,l=0,t.mode=Nee;case Nee:for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.head&&(t.head.xflags=u&255,t.head.os=u>>8),t.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,t.check=nc(t.check,Y,2,0)),u=0,l=0,t.mode=Dee;case Dee:if(t.flags&1024){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.length=u,t.head&&(t.head.extra_len=u),t.flags&512&&(Y[0]=u&255,Y[1]=u>>>8&255,t.check=nc(t.check,Y,2,0)),u=0,l=0}else t.head&&(t.head.extra=null);t.mode=Bee;case Bee:if(t.flags&1024&&(p=t.length,p>a&&(p=a),p&&(t.head&&(z=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Array(t.head.extra_len)),As.arraySet(t.head.extra,i,s,p,z)),t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,t.length-=p),t.length))break e;t.length=0,t.mode=Mee;case Mee:if(t.flags&2048){if(a===0)break e;p=0;do z=i[s+p++],t.head&&z&&t.length<65536&&(t.head.name+=String.fromCharCode(z));while(z&&p<a);if(t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,z)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=Lee;case Lee:if(t.flags&4096){if(a===0)break e;p=0;do z=i[s+p++],t.head&&z&&t.length<65536&&(t.head.comment+=String.fromCharCode(z));while(z&&p<a);if(t.flags&512&&(t.check=nc(t.check,i,p,s)),a-=p,s+=p,z)break e}else t.head&&(t.head.comment=null);t.mode=Uee;case Uee:if(t.flags&512){for(;l<16;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(t.check&65535)){r.msg="header crc mismatch",t.mode=vr;break}u=0,l=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),r.adler=t.check=0,t.mode=au;break;case Fee:for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}r.adler=t.check=Jee(u),u=0,l=0,t.mode=F2;case F2:if(t.havedict===0)return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,l$e;r.adler=t.check=1,t.mode=au;case au:if(e===c$e||e===U2)break e;case sR:if(t.last){u>>>=l&7,l-=l&7,t.mode=aR;break}for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}switch(t.last=u&1,u>>>=1,l-=1,u&3){case 0:t.mode=Kee;break;case 1:if(v$e(t),t.mode=K2,e===U2){u>>>=2,l-=2;break e}break;case 2:t.mode=Vee;break;case 3:r.msg="invalid block type",t.mode=vr}u>>>=2,l-=2;break;case Kee:for(u>>>=l&7,l-=l&7;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((u&65535)!=(u>>>16^65535)){r.msg="invalid stored block lengths",t.mode=vr;break}if(t.length=u&65535,u=0,l=0,t.mode=oR,e===U2)break e;case oR:t.mode=jee;case jee:if(p=t.length,p){if(p>a&&(p=a),p>c&&(p=c),p===0)break e;As.arraySet(n,i,s,p,o),a-=p,s+=p,c-=p,o+=p,t.length-=p;break}t.mode=au;break;case Vee:for(;l<14;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(t.nlen=(u&31)+257,u>>>=5,l-=5,t.ndist=(u&31)+1,u>>>=5,l-=5,t.ncode=(u&15)+4,u>>>=4,l-=4,t.nlen>286||t.ndist>30){r.msg="too many length or distance symbols",t.mode=vr;break}t.have=0,t.mode=zee;case zee:for(;t.have<t.ncode;){for(;l<3;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.lens[w[t.have++]]=u&7,u>>>=3,l-=3}for(;t.have<19;)t.lens[w[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,C={bits:t.lenbits},G=fb(a$e,t.lens,0,19,t.lencode,0,t.work,C),t.lenbits=C.bits,G){r.msg="invalid code lengths set",t.mode=vr;break}t.have=0,t.mode=Hee;case Hee:for(;t.have<t.nlen+t.ndist;){for(;E=t.lencode[u&(1<<t.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(R<16)u>>>=v,l-=v,t.lens[t.have++]=R;else{if(R===16){for(m=v+2;l<m;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u>>>=v,l-=v,t.have===0){r.msg="invalid bit length repeat",t.mode=vr;break}z=t.lens[t.have-1],p=3+(u&3),u>>>=2,l-=2}else if(R===17){for(m=v+3;l<m;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,p=3+(u&7),u>>>=3,l-=3}else{for(m=v+7;l<m;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=v,l-=v,z=0,p=11+(u&127),u>>>=7,l-=7}if(t.have+p>t.nlen+t.ndist){r.msg="invalid bit length repeat",t.mode=vr;break}for(;p--;)t.lens[t.have++]=z}}if(t.mode===vr)break;if(t.lens[256]===0){r.msg="invalid code -- missing end-of-block",t.mode=vr;break}if(t.lenbits=9,C={bits:t.lenbits},G=fb(Iee,t.lens,0,t.nlen,t.lencode,0,t.work,C),t.lenbits=C.bits,G){r.msg="invalid literal/lengths set",t.mode=vr;break}if(t.distbits=6,t.distcode=t.distdyn,C={bits:t.distbits},G=fb(Tee,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,C),t.distbits=C.bits,G){r.msg="invalid distances set",t.mode=vr;break}if(t.mode=K2,e===U2)break e;case K2:t.mode=j2;case j2:if(a>=6&&c>=258){r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,o$e(r,h),o=r.next_out,n=r.output,c=r.avail_out,s=r.next_in,i=r.input,a=r.avail_in,u=t.hold,l=t.bits,t.mode===au&&(t.back=-1);break}for(t.back=0;E=t.lencode[u&(1<<t.lenbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(A&&(A&240)==0){for(F=v,q=A,N=R;E=t.lencode[N+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,t.back+=F}if(u>>>=v,l-=v,t.back+=v,t.length=R,A===0){t.mode=Xee;break}if(A&32){t.back=-1,t.mode=au;break}if(A&64){r.msg="invalid literal/length code",t.mode=vr;break}t.extra=A&15,t.mode=$ee;case $ee:if(t.extra){for(m=t.extra;l<m;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.length+=u&(1<<t.extra)-1,u>>>=t.extra,l-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=Gee;case Gee:for(;E=t.distcode[u&(1<<t.distbits)-1],v=E>>>24,A=E>>>16&255,R=E&65535,!(v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if((A&240)==0){for(F=v,q=A,N=R;E=t.distcode[N+((u&(1<<F+q)-1)>>F)],v=E>>>24,A=E>>>16&255,R=E&65535,!(F+v<=l);){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}u>>>=F,l-=F,t.back+=F}if(u>>>=v,l-=v,t.back+=v,A&64){r.msg="invalid distance code",t.mode=vr;break}t.offset=R,t.extra=A&15,t.mode=Wee;case Wee:if(t.extra){for(m=t.extra;l<m;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}t.offset+=u&(1<<t.extra)-1,u>>>=t.extra,l-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){r.msg="invalid distance too far back",t.mode=vr;break}t.mode=Yee;case Yee:if(c===0)break e;if(p=h-c,t.offset>p){if(p=t.offset-p,p>t.whave&&t.sane){r.msg="invalid distance too far back",t.mode=vr;break}p>t.wnext?(p-=t.wnext,g=t.wsize-p):g=t.wnext-p,p>t.length&&(p=t.length),b=t.window}else b=n,g=o-t.offset,p=t.length;p>c&&(p=c),c-=p,t.length-=p;do n[o++]=b[g++];while(--p);t.length===0&&(t.mode=j2);break;case Xee:if(c===0)break e;n[o++]=t.length,c--,t.mode=j2;break;case aR:if(t.wrap){for(;l<32;){if(a===0)break e;a--,u|=i[s++]<<l,l+=8}if(h-=c,r.total_out+=h,t.total+=h,h&&(r.adler=t.check=t.flags?nc(t.check,n,h,o-h):iR(t.check,n,h,o-h)),h=c,(t.flags?u:Jee(u))!==t.check){r.msg="incorrect data check",t.mode=vr;break}u=0,l=0}t.mode=Qee;case Qee:if(t.wrap&&t.flags){for(;l<32;){if(a===0)break e;a--,u+=i[s++]<<l,l+=8}if(u!==(t.total&4294967295)){r.msg="incorrect length check",t.mode=vr;break}u=0,l=0}t.mode=Zee;case Zee:G=u$e;break e;case vr:G=Cee;break e;case cR:return nR;case d$e:default:return no}return r.next_out=o,r.avail_out=c,r.next_in=s,r.avail_in=a,t.hold=u,t.bits=l,(t.wsize||h!==r.avail_out&&t.mode<vr&&(t.mode<aR||e!==Ree))&&ste(r,r.output,r.next_out,h-r.avail_out)?(t.mode=cR,nR):(d-=r.avail_in,h-=r.avail_out,r.total_in+=d,r.total_out+=h,t.total+=h,t.wrap&&h&&(r.adler=t.check=t.flags?nc(t.check,n,h,r.next_out-h):iR(t.check,n,h,r.next_out-h)),r.data_type=t.bits+(t.last?64:0)+(t.mode===au?128:0)+(t.mode===K2||t.mode===oR?256:0),(d===0&&h===0||e===Ree)&&G===ad&&(G=f$e),G)}function _$e(r){if(!r||!r.state)return no;var e=r.state;return e.window&&(e.window=null),r.state=null,ad}function E$e(r,e){var t;return!r||!r.state||(t=r.state,(t.wrap&2)==0)?no:(t.head=e,e.done=!1,ad)}function S$e(r,e){var t=e.length,i,n,s;return!r||!r.state||(i=r.state,i.wrap!==0&&i.mode!==F2)?no:i.mode===F2&&(n=1,n=iR(n,e,t,0),n!==i.check)?Cee:(s=ste(r,e,t,t),s?(i.mode=cR,nR):(i.havedict=1,ad))}Jo.inflateReset=tte;Jo.inflateReset2=rte;Jo.inflateResetKeep=ete;Jo.inflateInit=b$e;Jo.inflateInit2=ite;Jo.inflate=w$e;Jo.inflateEnd=_$e;Jo.inflateGetHeader=E$e;Jo.inflateSetDictionary=S$e;Jo.inflateInfo="pako inflate (from Nodeca project)"});var fR=y((zkt,ate)=>{f();"use strict";ate.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var ute=y((Hkt,cte)=>{f();"use strict";function x$e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}cte.exports=x$e});var fte=y(hb=>{f();"use strict";var i0=ote(),db=nu(),V2=X5(),ii=fR(),dR=P2(),A$e=Q5(),I$e=ute(),lte=Object.prototype.toString;function cd(r){if(!(this instanceof cd))return new cd(r);this.options=db.assign({chunkSize:16384,windowBits:0,to:""},r||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(r&&r.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)==0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new A$e,this.strm.avail_out=0;var t=i0.inflateInit2(this.strm,e.windowBits);if(t!==ii.Z_OK)throw new Error(dR[t]);if(this.header=new I$e,i0.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=V2.string2buf(e.dictionary):lte.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=i0.inflateSetDictionary(this.strm,e.dictionary),t!==ii.Z_OK)))throw new Error(dR[t])}cd.prototype.push=function(r,e){var t=this.strm,i=this.options.chunkSize,n=this.options.dictionary,s,o,a,c,u,l=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?ii.Z_FINISH:ii.Z_NO_FLUSH,typeof r=="string"?t.input=V2.binstring2buf(r):lte.call(r)==="[object ArrayBuffer]"?t.input=new Uint8Array(r):t.input=r,t.next_in=0,t.avail_in=t.input.length;do{if(t.avail_out===0&&(t.output=new db.Buf8(i),t.next_out=0,t.avail_out=i),s=i0.inflate(t,ii.Z_NO_FLUSH),s===ii.Z_NEED_DICT&&n&&(s=i0.inflateSetDictionary(this.strm,n)),s===ii.Z_BUF_ERROR&&l===!0&&(s=ii.Z_OK,l=!1),s!==ii.Z_STREAM_END&&s!==ii.Z_OK)return this.onEnd(s),this.ended=!0,!1;t.next_out&&(t.avail_out===0||s===ii.Z_STREAM_END||t.avail_in===0&&(o===ii.Z_FINISH||o===ii.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=V2.utf8border(t.output,t.next_out),c=t.next_out-a,u=V2.buf2string(t.output,a),t.next_out=c,t.avail_out=i-c,c&&db.arraySet(t.output,t.output,a,c,0),this.onData(u)):this.onData(db.shrinkBuf(t.output,t.next_out))),t.avail_in===0&&t.avail_out===0&&(l=!0)}while((t.avail_in>0||t.avail_out===0)&&s!==ii.Z_STREAM_END);return s===ii.Z_STREAM_END&&(o=ii.Z_FINISH),o===ii.Z_FINISH?(s=i0.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===ii.Z_OK):(o===ii.Z_SYNC_FLUSH&&(this.onEnd(ii.Z_OK),t.avail_out=0),!0)};cd.prototype.onData=function(r){this.chunks.push(r)};cd.prototype.onEnd=function(r){r===ii.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=db.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function hR(r,e){var t=new cd(e);if(t.push(r,!0),t.err)throw t.msg||dR[t.err];return t.result}function T$e(r,e){return e=e||{},e.raw=!0,hR(r,e)}hb.Inflate=cd;hb.inflate=hR;hb.inflateRaw=T$e;hb.ungzip=hR});var pte=y((Gkt,hte)=>{f();"use strict";var R$e=nu().assign,C$e=gee(),P$e=fte(),O$e=fR(),dte={};R$e(dte,C$e,P$e,O$e);hte.exports=dte});var gte=y((Wkt,yte)=>{f();"use strict";var{concat:k$e}=(cn(),an);async function q$e(r){let e=new Uint8Array(0);for await(let t of r)e=k$e([e,t],e.length+t.length);return e}yte.exports=q$e});var Ate=y((Ykt,xte)=>{f();"use strict";var{exporter:N$e,recursive:D$e}=(Qo(),Xo),pb=ae(),{normalizeCidPath:B$e}=Ki(),M$e=Oe(),{CID:mte}=(Ie(),De),{pack:bte}=TJ(),{pipe:vte}=Ar(),{gzip:wte}=pte(),_te=Ho(),Ete=gte(),Ste=6;xte.exports=function({repo:r,preload:e}){async function*t(i,n={}){if(n.compressionLevel<0||n.compressionLevel>9)throw pb(new Error("Compression level must be between 1 and 9"),"ERR_INVALID_PARAMS");if(n.preload!==!1){let a;try{a=B$e(i).split("/")}catch(c){throw pb(c,"ERR_INVALID_PATH")}e(mte.parse(a[0]))}let s=mte.asCID(i)||i,o=await N$e(s,r.blocks,n);if(o.type==="file"||o.type==="raw"){let a=[];!n.compress||n.archive===!0?a.push([{header:{name:o.path,mode:o.type==="file"&&o.unixfs.mode,mtime:o.type==="file"&&o.unixfs.mtime?new Date(o.unixfs.mtime.secs*1e3):void 0,size:o.size,type:"file"},body:o.content()}],bte(),c=>_te(c,u=>u.slice())):a.push(o.content),n.compress&&a.push(async function*(c){let u=await Ete(c);yield wte(u,{level:n.compressionLevel||Ste})}),yield*vte(...a);return}if(o.type==="directory"){let a=[D$e(s,r.blocks,n),async function*(c){for await(let u of c){let l={header:{name:u.path,size:u.size}};if(u.type==="file")l.header.type="file",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,l.body=u.content();else if(u.type==="raw")l.header.type="file",l.body=u.content();else if(u.type==="directory")l.header.type="directory",l.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,l.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw pb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield l}},bte(),c=>_te(c,u=>u.slice())];if(n.compress){if(!n.archive)throw pb(new Error("file is not regular"),"ERR_INVALID_PATH");n.compress&&a.push(async function*(c){let u=await Ete(c);yield wte(u,{level:n.compressionLevel||Ste})})}yield*vte(...a);return}throw pb(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return M$e(t)}});var Cte=y((Xkt,Rte)=>{f();"use strict";var{exporter:L$e}=(Qo(),Xo),U$e=ae(),{normalizeCidPath:F$e,mapFile:Ite}=Ki(),K$e=Oe(),{CID:Tte}=(Ie(),De);Rte.exports=function({repo:r,preload:e}){async function*t(i,n={}){let s=F$e(i),o=s.split("/");n.preload!==!1&&e(Tte.parse(o[0]));let a=Tte.asCID(s)||s,c=await L$e(a,r.blocks,n);if(c.type==="file"){yield Ite(c);return}if(c.type==="directory"){for await(let u of c.content())yield Ite(u);return}throw U$e(new Error(`Unknown UnixFS type ${c.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return K$e(t)}});var kte=y((Qkt,Ote)=>{f();"use strict";var j$e=OX(),V$e=kZ(),z$e=uJ(),H$e=Ate(),$$e=Cte(),Pte=class{constructor({preload:e,repo:t,options:i}){let n=V$e({preload:e,repo:t,options:i});this.addAll=n,this.add=j$e({addAll:n}),this.cat=z$e({repo:t,preload:e}),this.get=H$e({repo:t,preload:e}),this.ls=$$e({repo:t,preload:e})}};Ote.exports=Pte});var z2=y((Zkt,G$e)=>{G$e.exports={name:"ipfs-core",version:"0.10.3",description:"JavaScript implementation of the IPFS specification",keywords:["IPFS"],homepage:"https://github.com/ipfs/js-ipfs/tree/master/packages/ipfs-core#readme",bugs:"https://github.com/ipfs/js-ipfs/issues",license:"(Apache-2.0 OR MIT)",leadMaintainer:"Alex Potsides <alex@achingbrain.net>",main:"src/index.js",types:"dist/src/index.d.ts",files:["src","dist","!dist/*.tsbuildinfo"],browser:{"./src/runtime/init-assets-nodejs.js":"./src/runtime/init-assets-browser.js","./src/runtime/config-nodejs.js":"./src/runtime/config-browser.js","./src/runtime/dns-nodejs.js":"./src/runtime/dns-browser.js","./src/runtime/libp2p-nodejs.js":"./src/runtime/libp2p-browser.js","./src/runtime/libp2p-pubsub-routers-nodejs.js":"./src/runtime/libp2p-pubsub-routers-browser.js","./src/runtime/preload-nodejs.js":"./src/runtime/preload-browser.js","./src/runtime/repo-nodejs.js":"./src/runtime/repo-browser.js","ipfs-utils/src/files/glob-source":!1},typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"],"src/":["dist/src/index"]}},repository:{type:"git",url:"git+https://github.com/ipfs/js-ipfs.git"},scripts:{build:"aegir build",lint:"aegir ts -p check && aegir lint",test:"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","test:electron-main":"aegir test -t electron-main","test:electron-renderer":"aegir test -t electron-renderer","test:bootstrapers":"IPFS_TEST=bootstrapers aegir test -t browser -f test/bootstrapers.js",coverage:"nyc --reporter=text --reporter=lcov npm run test:node",clean:"rimraf ./dist","dep-check":"aegir dep-check -i interface-ipfs-core -i ipfs-core-types -i abort-controller"},dependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@ipld/car":"^3.1.0","@ipld/dag-cbor":"^6.0.5","@ipld/dag-pb":"^2.1.3","@multiformats/murmur3":"^1.0.1","abort-controller":"^3.0.0","array-shuffle":"^2.0.0","blockstore-datastore-adapter":"^1.0.0","datastore-core":"^5.0.1","datastore-fs":"^5.0.2","datastore-level":"^6.0.2","datastore-pubsub":"^0.7.0",debug:"^4.1.1",dlv:"^1.1.3","err-code":"^3.0.1","hamt-sharding":"^2.0.0",hashlru:"^2.3.0","interface-blockstore":"^1.0.0","interface-datastore":"^5.0.0","ipfs-bitswap":"^6.0.0","ipfs-core-types":"^0.7.0","ipfs-core-utils":"^0.10.1","ipfs-http-client":"^52.0.1","ipfs-repo":"^12.0.0","ipfs-unixfs":"^6.0.3","ipfs-unixfs-exporter":"^7.0.3","ipfs-unixfs-importer":"^9.0.3","ipfs-utils":"^8.1.4",ipns:"^0.13.3","is-domain-name":"^1.0.1","is-ipfs":"^6.0.1","it-all":"^1.0.4","it-drain":"^1.0.3","it-filter":"^1.0.2","it-first":"^1.0.4","it-last":"^1.0.4","it-map":"^1.0.4","it-merge":"^1.0.2","it-peekable":"^1.0.2","it-pipe":"^1.1.0","it-pushable":"^1.4.2","it-tar":"^4.0.0","it-to-buffer":"^2.0.0","just-safe-set":"^2.2.1",libp2p:"^0.32.0","libp2p-bootstrap":"^0.13.0","libp2p-crypto":"^0.19.7","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.1","libp2p-kad-dht":"^0.23.1","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.2","libp2p-record":"^0.10.3","libp2p-tcp":"^0.17.1","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.1",mafmt:"^10.0.0","merge-options":"^3.0.4",mortice:"^2.0.0",multiaddr:"^10.0.0","multiaddr-to-uri":"^8.0.0",multiformats:"^9.4.1","native-abort-controller":"^1.0.3","p-queue":"^6.6.1",pako:"^1.0.2","parse-duration":"^1.0.0","peer-id":"^0.15.1","streaming-iterables":"^6.0.0",uint8arrays:"^3.0.0"},devDependencies:{"@types/dlv":"^1.1.2","@types/pako":"^1.0.2","@types/rimraf":"^3.0.1",aegir:"^34.0.2",delay:"^5.0.0","go-ipfs":"0.9.1","interface-blockstore-tests":"^1.0.0","interface-ipfs-core":"^0.150.0","ipfsd-ctl":"^10.0.3","iso-url":"^1.0.0",nanoid:"^3.1.12","p-defer":"^3.0.0",rimraf:"^3.0.2",sinon:"^11.1.1"}}});var Nte=y((Jkt,qte)=>{f();"use strict";var pR=z2(),W$e=Oe();qte.exports=({repo:r})=>{async function e(t={}){let i=await r.version.get();return{version:pR.version,repo:`${i}`,commit:pR.gitHead||"","interface-ipfs-core":pR.devDependencies["interface-ipfs-core"]}}return W$e(e)}});var Bte=y((eqt,Dte)=>{f();"use strict";var Y$e=z2().version,{Multiaddr:X$e}=it(),Q$e=Oe(),{toString:H2}=(tt(),et),Z$e=rt(),{NotStartedError:J$e}=ul();Dte.exports=({peerId:r,network:e})=>{async function t(i={}){i.peerId===r.toB58String()&&delete i.peerId;let n=e.try();if(!n){if(i.peerId)throw new J$e;return{id:r.toB58String(),publicKey:H2(r.pubKey.bytes,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Y$e}`,protocolVersion:"9000",protocols:[]}}let s=i.peerId?Z$e.createFromB58String(i.peerId.toString()):r,{libp2p:o}=n,a=i.peerId?o.peerStore.keyBook.get(s):s.pubKey,c=i.peerId?o.peerStore.addressBook.getMultiaddrsForPeer(s):o.multiaddrs,u=i.peerId?o.peerStore.protoBook.get(s):Array.from(o.upgrader.protocols.keys()),l=H2(o.peerStore.metadataBook.getValue(s,"AgentVersion")||new Uint8Array),d=H2(o.peerStore.metadataBook.getValue(s,"ProtocolVersion")||new Uint8Array),h=s.toB58String();return{id:h,publicKey:H2(a.bytes,"base64pad"),addresses:(c||[]).map(p=>{let g=p.toString();return g.endsWith(`/p2p/${h}`)?g:`${g}/p2p/${h}`}).sort().map(p=>new X$e(p)),agentVersion:l,protocolVersion:d,protocols:(u||[]).sort()}}return Q$e(t)}});var mR=y((tqt,gR)=>{f();"use strict";var ni=X4(),yR=n2(),n0=Oe(),eGe=be()("ipfs:core:config");gR.exports=({repo:r})=>{return{getAll:n0(e),get:n0(t),set:n0(i),replace:n0(n),profiles:{apply:n0(s),list:n0(tGe)}};async function e(o={}){return r.config.getAll(o)}async function t(o,a){return o?r.config.get(o,a):Promise.reject(new Error("key argument is required"))}async function i(o,a,c){return r.config.set(o,a,c)}async function n(o,a){return r.config.replace(o,a)}async function s(o,a={dryRun:!1}){let{dryRun:c}=a,u=$2[o];if(!u)throw new Error(`No profile with name '${o}' exists`);try{let l=await r.config.getAll(a),d=JSON.parse(JSON.stringify(l));return d=u.transform(d),c||await r.config.replace(d,a),delete l.Identity.PrivKey,delete d.Identity.PrivKey,{original:l,updated:d}}catch(l){throw eGe(l),new Error(`Could not apply profile '${o}' to config: ${l.message}`)}}};async function tGe(r){return Object.keys($2).map(e=>({name:e,description:$2[e].description}))}var $2={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:r=>(ni(r,"Discovery.MDNS.Enabled",!1),ni(r,"Discovery.webRTCStar.Enabled",!1),r.Swarm={...r.Swarm||{},DisableNatPortMap:!0},r)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:r=>(ni(r,"Discovery.MDNS.Enabled",!0),ni(r,"Discovery.webRTCStar.Enabled",!0),ni(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:r=>{let e=yR();return ni(r,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),ni(r,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),ni(r,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),ni(r,"Addresses.Delegates",[]),ni(r,"Bootstrap",[]),ni(r,"Discovery.MDNS.Enabled",!1),ni(r,"Discovery.webRTCStar.Enabled",!1),ni(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!0}),r}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:r=>{let e=yR();return ni(r,"Addresses.API",e.Addresses.API),ni(r,"Addresses.Gateway",e.Addresses.Gateway),ni(r,"Addresses.Swarm",e.Addresses.Swarm),ni(r,"Addresses.Delegates",e.Addresses.Delegates),ni(r,"Bootstrap",e.Bootstrap),ni(r,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),ni(r,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),ni(r,"Swarm",{...r.Swarm||{},DisableNatPortMap:!1}),r}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:r=>{let e=r.Swarm||{},t=e.ConnMgr||{};return t.LowWater=20,t.HighWater=40,e.ConnMgr=t,r.Swarm=e,r}},"default-power":{description:'Inverse of "lowpower" profile.',transform:r=>{let e=yR();return r.Swarm=e.Swarm,r}}};gR.exports.profiles=$2});function vR(r){let e=t4({version:1,roots:r}),t=bR.default.encode(e.length),i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i}function Mte(r){return{async setRoots(e){let t=vR(e);await r.write(t)},async writeBlock(e){let{cid:t,bytes:i}=e;await r.write(new Uint8Array(bR.default.encode(t.bytes.length+i.length))),await r.write(t.bytes),i.length&&await r.write(i)},async close(){return r.end()}}}var bR,Lte=xe(()=>{f();bR=Wt(ys());eu()});function G2(){}function Ute(){let r=[],e=null,t=G2,i=!1,n=null,s=G2,o=()=>(e||(e=new Promise(u=>{t=()=>{e=null,t=G2,u()}})),e),a={write(u){r.push(u);let l=o();return s(),l},async end(){i=!0;let u=o();return s(),u}},c={async next(){let u=r.shift();return u?(r.length===0&&t(),{done:!1,value:u}):i?(t(),{done:!0,value:void 0}):(n||(n=new Promise(l=>{s=()=>(n=null,s=G2,l(c.next()))})),n)}};return{writer:a,iterator:c}}var Fte=xe(()=>{f()});async function W2(r){let e=await r.upTo(8),t=Il.default.decode(e);return r.seek(Il.default.decode.bytes),t}async function _R(r){let e=await W2(r);if(e===0)throw new Error("Invalid CAR header (zero length)");let t=await r.exactly(e);r.seek(e);let i=Lf(t);if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("Invalid CAR header format");if(i.version!==1)throw typeof i.version=="string"?new Error(`Invalid CAR version: "${i.version}"`):new Error(`Invalid CAR version: ${i.version}`);if(!Array.isArray(i.roots))throw new Error("Invalid CAR header format");if(Object.keys(i).filter(n=>n!=="roots"&&n!=="version").length)throw new Error("Invalid CAR header format");return i}async function rGe(r){let e=await r.upTo(8);Il.default.decode(e);let t=Il.default.decode.bytes,i=Il.default.decode(e.subarray(Il.default.decode.bytes)),n=Il.default.decode.bytes,s=t+n+i,o=await r.exactly(s);return r.seek(s),o}async function iGe(r){let e=await r.exactly(2);if(e[0]===wR.SHA2_256&&e[1]===wR.LENGTH){let o=await r.exactly(34);r.seek(34);let a=Mu(o);return We.create(0,wR.DAG_PB,a)}let t=await W2(r);if(t!==1)throw new Error(`Unexpected CID version (${t})`);let i=await W2(r),n=await rGe(r),s=Mu(n);return We.create(t,i,s)}async function Kte(r){let e=r.pos,t=await W2(r);if(t===0)throw new Error("Invalid CAR section (zero length)");t+=r.pos-e;let i=await iGe(r),n=t-(r.pos-e);return{cid:i,length:t,blockLength:n}}async function nGe(r){let{cid:e,blockLength:t}=await Kte(r),i=await r.exactly(t);return r.seek(t),{bytes:i,cid:e}}async function sGe(r){let e=r.pos,{cid:t,length:i,blockLength:n}=await Kte(r),s={cid:t,length:i,blockLength:n,offset:e,blockOffset:r.pos};return r.seek(s.blockLength),s}function jte(r){let e=_R(r);return{header:()=>e,async*blocks(){for(await e;(await r.upTo(8)).length>0;)yield await nGe(r)},async*blocksIndex(){for(await e;(await r.upTo(8)).length>0;)yield await sGe(r)}}}function Y2(r){let e=0;return{async upTo(t){return r.subarray(e,e+Math.min(t,r.length-e))},async exactly(t){if(t>r.length-e)throw new Error("Unexpected end of data");return r.subarray(e,e+t)},seek(t){e+=t},get pos(){return e}}}function oGe(r){let e=0,t=0,i=0,n=new Uint8Array(0),s=async o=>{t=n.length-i;let a=[n.subarray(i)];for(;t<o;){let u=await r();if(u==null)break;t<0?u.length>t&&a.push(u.subarray(-t)):a.push(u),t+=u.length}n=new Uint8Array(a.reduce((u,l)=>u+l.length,0));let c=0;for(let u of a)n.set(u,c),c+=u.length;i=0};return{async upTo(o){return n.length-i<o&&await s(o),n.subarray(i,i+Math.min(n.length-i,o))},async exactly(o){if(n.length-i<o&&await s(o),n.length-i<o)throw new Error("Unexpected end of data");return n.subarray(i,i+o)},seek(o){e+=o,i+=o},get pos(){return e}}}function Vte(r){let e=r[Symbol.asyncIterator]();async function t(){let i=await e.next();return i.done?null:i.value}return oGe(t)}var Il,wR,ER=xe(()=>{f();Il=Wt(ys());Ie();Cn();eu();wR={SHA2_256:18,LENGTH:32,DAG_PB:112}});var Hte={};ut(Hte,{CarWriter:()=>yb,CarWriterOut:()=>X2,__browser:()=>cGe});function zte(){let r=Ute(),{writer:e,iterator:t}=r;return{encoder:Mte(e),iterator:t}}function aGe(r){if(r===void 0)return[];if(!Array.isArray(r)){let t=We.asCID(r);if(!t)throw new TypeError("roots must be a single CID or an array of CIDs");return[t]}let e=[];for(let t of r){let i=We.asCID(t);if(!i)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(i)}return e}var yb,X2,cGe,$te=xe(()=>{f();Ie();Lte();Fte();ER();yb=class{constructor(e,t){this._encoder=t,this._mutex=t.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let t=We.asCID(e.cid);if(!t)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:t,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=aGe(e);let{encoder:t,iterator:i}=zte(),n=new yb(e,t),s=new X2(i);return{writer:n,out:s}}static createAppender(){let{encoder:e,iterator:t}=zte();e.setRoots=()=>Promise.resolve();let i=new yb([],e),n=new X2(t);return{writer:i,out:n}}static async updateRootsInBytes(e,t){let i=Y2(e);await _R(i);let n=vR(t);if(i.pos!==n.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${i.pos} bytes, new header is ${n.length} bytes)`);return e.set(n,0),e}},X2=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};cGe=!0});var Xte=y((hqt,Yte)=>{f();"use strict";var{CID:uGe}=(Ie(),De),lGe=(C_(),R_),{base58btc:fGe}=(ei(),Jr),{CarWriter:dGe}=($te(),Hte),hGe=Oe(),Gte=be()("ipfs:components:dag:import"),pGe=(Ls(),Po),yGe=(pA(),tw),gGe=[pGe.code,yGe.code];Yte.exports=({repo:r,preload:e,codecs:t})=>{async function*i(n,s={}){s.preload!==!1&&e(n);let o=uGe.asCID(n);if(!o)throw new Error(`Unexpected error converting CID type: ${n}`);Gte(`Exporting ${o} as car`);let{writer:a,out:c}=await dGe.create([o]),u=null;(async()=>{try{await Wte(r,{signal:s.signal,timeout:s.timeout},o,a,t),a.close()}catch(l){u=l}})();for await(let l of c){if(u)break;yield l}if(u)throw u}return hGe(i)};async function Wte(r,e,t,i,n,s=new Set){let o=t.toString(fGe);if(s.has(o))return;let a=await mGe(r,e,t,n);Gte(`Adding block ${t} to car`),await i.put(a),s.add(o);for(let c of a.links)await Wte(r,e,c,i,n,s)}async function mGe(r,e,t,i){let n=await r.blocks.get(t,e),s=[],o=await i.getCodec(t.code);if(o)s=[...lGe.createUnsafe({bytes:n,cid:t,codec:o}).links()].map(c=>c[1]);else if(!gGe.includes(t.code))throw new Error(`Can't decode links in block with codec 0x${t.code.toString(16)} to form complete DAG`);return{cid:t,bytes:n,links:s}}});var Jte=y((pqt,Zte)=>{f();"use strict";var bGe=Oe(),vGe=zf(),wGe=rs(),{resolve:Qte}=Ki(),_Ge=ae();Zte.exports=({codecs:r,repo:e,preload:t})=>bGe(async function(s,o={}){if(o.preload!==!1&&t(s),o.path){let d=o.localResolve?await vGe(Qte(s,o.path,r,e,o)):await wGe(Qte(s,o.path,r,e,o));if(!d)throw _Ge(new Error("Not found"),"ERR_NOT_FOUND");return d}let a=await r.getCodec(s.code),c=await e.blocks.get(s,o);return{value:a.decode(c),remainderPath:""}})});var ire={};ut(ire,{CarBlockIterator:()=>gb,CarCIDIterator:()=>mb,CarIteratorBase:()=>Q2});async function ere(r){if(!(r instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return rre(Y2(r))}async function tre(r){if(!r||typeof r[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return rre(Vte(r))}async function rre(r){let e=jte(r),{version:t,roots:i}=await e.header();return{version:t,roots:i,iterator:e.blocks()}}var Q2,gb,mb,nre=xe(()=>{f();ER();Q2=class{constructor(e,t,i){this._version=e,this._roots=t,this._iterable=i,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},gb=class extends Q2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await ere(e);return new gb(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await tre(e);return new gb(t,i,n)}},mb=class extends Q2{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let t=await e.next();return t.done?t:{done:!1,value:t.value.cid}}}}static async fromBytes(e){let{version:t,roots:i,iterator:n}=await ere(e);return new mb(t,i,n)}static async fromIterable(e){let{version:t,roots:i,iterator:n}=await tre(e);return new mb(t,i,n)}}});var are=y((gqt,ore)=>{f();"use strict";var{CarBlockIterator:EGe}=(nre(),ire),SGe=Oe(),xGe=Wm(),AGe=Wa(),IGe=Ho(),sre=be()("ipfs:components:dag:import");ore.exports=({repo:r})=>{async function*e(t,i={}){let n=await r.gcLock.readLock();try{let s={signal:i.signal,timeout:i.timeout},o=xGe(t),{value:a,done:c}=await o.peek();if(c)return;a&&o.push(a);let u;a instanceof Uint8Array?u=[o]:u=o;for await(let l of u){let d=await TGe(r,s,l);if(i.pinRoots!==!1)for(let h of d){let p="";try{await r.blocks.has(h)?(sre(`Pinning root ${h}`),await r.pins.pinRecursively(h)):p="blockstore: block not found"}catch(g){p=g.message}yield{root:{cid:h,pinErrorMsg:p}}}}}finally{n()}}return SGe(e)};async function TGe(r,e,t){let i=await EGe.fromIterable(t),n=await i.getRoots();return await AGe(r.blocks.putMany(IGe(i,({cid:s,bytes:o})=>(sre(`Import block ${s}`),{key:s,value:o})),{signal:e.signal})),n}});var ure=y((mqt,cre)=>{f();"use strict";var{CID:RGe}=(Ie(),De),CGe=Oe();cre.exports=({repo:r,codecs:e,hashers:t,preload:i})=>{async function n(s,o={}){let a=o.pin?await r.gcLock.readLock():null;try{let c=o.format||"dag-cbor",u=o.version!=null?o.version:c==="dag-pb"?0:1,l=await e.getCodec(c);if(!l)throw new Error(`Unknown codec ${o.format}, please configure additional BlockCodecs for this IPFS instance`);let d=await t.getHasher(o.hashAlg||"sha2-256");if(!d)throw new Error(`Unknown hash algorithm ${o.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let h=l.encode(s),p=await d.digest(h),g=RGe.create(u,l.code,p);return await r.blocks.put(g,h,{signal:o.signal}),o.pin&&await r.pins.pinRecursively(g),o.preload!==!1&&i(g),g}finally{a&&a()}}return CGe(n)}});var fre=y((bqt,lre)=>{f();"use strict";var PGe=Oe(),OGe=pm(),{resolvePath:kGe}=Ki();lre.exports=({repo:r,codecs:e,preload:t})=>{async function i(n,s={}){let{cid:o}=OGe(n);return s.preload!==!1&&t(o),kGe(r,e,n,s)}return PGe(i)}});var pre=y((vqt,hre)=>{f();"use strict";var qGe=Xte(),NGe=Jte(),DGe=are(),BGe=ure(),MGe=fre(),dre=class{constructor({repo:e,codecs:t,hashers:i,preload:n}){this.export=qGe({repo:e,preload:n,codecs:t}),this.get=NGe({codecs:t,repo:e,preload:n}),this.import=DGe({repo:e}),this.resolve=MGe({repo:e,codecs:t,preload:n}),this.put=BGe({repo:e,codecs:t,hashers:i,preload:n})}};hre.exports=dre});var J2=y((wqt,yre)=>{f();var{Multiaddr:LGe}=it(),Z2=(r,e)=>e,UGe=(r,e,t,i)=>{if(i&&i.assumeHttp===!1)return`tcp://${r}:${e}`;let n="tcp",s=`:${e}`;return t[t.length-1].protocol==="tcp"&&(n=e==="443"?"https":"http",s=e==="443"||e==="80"?"":s),`${n}://${r}${s}`},FGe={ip4:Z2,ip6:(r,e,t,i)=>i.length===1&&i[0].protocol==="ip6"?e:`[${e}]`,tcp:(r,e,t,i,n)=>i.some(s=>["http","https","ws","wss"].includes(s.protocol))?`${r}:${e}`:UGe(r,e,i,n),udp:(r,e)=>`udp://${r}:${e}`,dnsaddr:Z2,dns4:Z2,dns6:Z2,ipfs:(r,e)=>`${r}/ipfs/${e}`,p2p:(r,e)=>`${r}/p2p/${e}`,http:r=>`http://${r}`,https:r=>`https://${r}`,ws:r=>`ws://${r}`,wss:r=>`wss://${r}`,"p2p-websocket-star":r=>`${r}/p2p-websocket-star`,"p2p-webrtc-star":r=>`${r}/p2p-webrtc-star`,"p2p-webrtc-direct":r=>`${r}/p2p-webrtc-direct`};yre.exports=(r,e)=>{let t=new LGe(r),i=r.toString().split("/").slice(1);return t.tuples().map(n=>({protocol:i.shift(),content:n[1]?i.shift():null})).reduce((n,s,o,a)=>{let c=FGe[s.protocol];if(!c)throw new Error(`Unsupported protocol ${s.protocol}`);return c(n,s.content,o,a,e)},"")}});var mre=y((_qt,gre)=>{f();"use strict";gre.exports=r=>{if(!Array.isArray(r))throw new TypeError(`Expected an array, got ${typeof r}`);r=[...r];for(let e=r.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[r[e],r[t]]=[r[t],r[e]]}return r}});var wre=y((Eqt,vre)=>{f();"use strict";var{default:KGe}=_4(),jGe=ng(),bre=be(),VGe=Object.assign(bre("ipfs:preload"),{error:bre("ipfs:preload:error")}),zGe=new KGe({concurrency:4});vre.exports=function(e,t={}){return VGe(e),zGe.add(async()=>{let n=(await jGe.post(e,{signal:t.signal})).body.getReader();try{for(;;){let{done:s}=await n.read();if(s)return}}finally{n.releaseLock()}})}});var Sre=y((Sqt,Ere)=>{f();"use strict";var HGe=J2(),_re=be(),$Ge=mre(),{AbortController:GGe}=rn(),WGe=wre(),YGe=ym(),bb=Object.assign(_re("ipfs:preload"),{error:_re("ipfs:preload:error")}),XGe=(r={})=>{if(r.enabled=Boolean(r.enabled),r.addresses=r.addresses||[],r.cache=r.cache||1e3,!r.enabled||!r.addresses.length)return bb("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,t=[],i=r.addresses.map(HGe),n=YGe(r.cache),s=async o=>{try{if(e)throw new Error(`preload ${o} but preloader is not started`);let a=o.toString();if(n.has(a))return;n.set(a,!0);let c=$Ge(i),u=!1,l=Date.now();for(let d of c){if(e)throw new Error(`preload aborted for ${a}`);let h;try{h=new GGe,t=t.concat(h),await WGe(`${d}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:h.signal}),u=!0}catch(p){p.type!=="aborted"&&bb.error(p)}finally{t=t.filter(p=>p!==h)}if(u)break}bb(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-l}ms`)}catch(a){bb.error(a)}};return s.start=()=>{e=!1},s.stop=()=>{e=!0,bb(`aborting ${t.length} pending preload request(s)`),t.forEach(o=>o.abort()),t=[]},s};Ere.exports=XGe});var Ire=y((xqt,Are)=>{f();"use strict";var xre=be(),eE=Object.assign(xre("ipfs:mfs-preload"),{error:xre("ipfs:mfs-preload:error")});Are.exports=({preload:r,files:e,options:t={}})=>{if(t.interval=t.interval||30*1e3,!t.enabled){eE("MFS preload disabled");let o=async()=>{};return{start:o,stop:o}}let i="",n,s=async()=>{try{let o=await e.stat("/"),a=o.cid.toString();i!==a&&(eE(`preloading updated MFS root ${i} -> ${o.cid}`),await r(o.cid),i=a)}catch(o){eE.error("failed to preload MFS root",o)}finally{n=setTimeout(s,t.interval)}};return{async start(){let o=await e.stat("/");i=o.cid.toString(),eE(`monitoring MFS root ${o.cid}`),n=setTimeout(s,t.interval)},stop(){clearTimeout(n)}}}});var SR=y((Aqt,Tre)=>{f();"use strict";var QGe=_T(),tE;Tre.exports=(r=!1)=>{if(tE)return tE;let e=QGe({singleProcess:r});return tE={readLock:t=>async(...i)=>{let n=await e.readLock();try{return await t.apply(null,i)}finally{n()}},writeLock:t=>async(...i)=>{let n=await e.writeLock();try{return await t.apply(null,i)}finally{n()}}},tE}});var rE=y((Iqt,kre)=>{f();"use strict";var{CID:Rre}=(Ie(),De),{UnixFS:ZGe}=(pi(),ms),JGe=(_t(),Mt),{sha256:eWe}=(ri(),li),Cre=be()("ipfs:mfs:utils:with-mfs-root"),Pre=ae(),{MFS_ROOT_KEY:Ore}=Ki(),tWe=async(r,e)=>{if(e&&e.signal&&e.signal.aborted)throw Pre(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.open();let t;try{let i=await r.repo.datastore.get(Ore);t=Rre.decode(i)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i;Cre("Creating new MFS root");let n=JGe.encode({Data:new ZGe({type:"directory"}).marshal(),Links:[]}),s=await eWe.digest(n);if(t=Rre.createV0(s),await r.repo.blocks.put(t,n),e&&e.signal&&e.signal.aborted)throw Pre(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await r.repo.datastore.put(Ore,t.bytes)}return Cre(`Loaded MFS root /ipfs/${t}`),t};kre.exports=tWe});var iE=y((Tqt,qre)=>{f();"use strict";var rWe=(r="")=>(r.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean);qre.exports=rWe});var cu=y((Rqt,Dre)=>{f();"use strict";var iWe=rE(),nWe=iE(),{exporter:sWe}=(Qo(),Xo),Nre=ae(),{CID:oWe}=(Ie(),De),xR="ipfs",aWe=async(r,e,t)=>{let i=await iWe(r,t),n={entryType:"file"},s="";if(e instanceof oWe?s=`/ipfs/${e}`:s=e,s=s.trim(),s=s.replace(/(\/\/+)/g,"/"),s.endsWith("/")&&s.length>1&&(s=s.substring(0,s.length-1)),!s)throw Nre(new Error("paths must not be empty"),"ERR_NO_PATH");if(s.substring(0,1)!=="/")throw Nre(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");s.substring(s.length-1)==="/"&&(s=s.substring(0,s.length-1));let o=nWe(s);if(o[0]===xR){let c;o.length===2?c=`/${o.join("/")}`:c=`/${o.slice(0,o.length-1).join("/")}`,n={type:"ipfs",depth:o.length-2,entryType:"file",mfsPath:`/${o.join("/")}`,mfsDirectory:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}else{let c=`/${xR}/${i}${o.length?"/"+o.join("/"):""}`,u=`/${xR}/${i}/${o.slice(0,o.length-1).join("/")}`;n={type:"mfs",depth:o.length,entryType:"file",mfsDirectory:u,mfsPath:c,parts:o,path:`/${o.join("/")}`,name:o[o.length-1]}}let a=n.type==="mfs"?n.mfsPath:n.path;try{let c=await sWe(a,r.repo.blocks,t);n.cid=c.cid,n.mfsPath=`/ipfs/${c.path}`,n.entryType=c.type,n.content=c.content,(n.entryType==="file"||n.entryType==="directory")&&(c.type==="file"||c.type==="directory")&&(n.unixfs=c.unixfs)}catch(c){if(c.code!=="ERR_NOT_FOUND")throw c}return n.exists=Boolean(n.cid),n};Dre.exports=aWe});var vb=y((Cqt,Lre)=>{f();"use strict";var cWe=gr().bind({ignoreUndefined:!0}),uWe=cu(),{exporter:lWe}=(Qo(),Xo),fWe=be()("ipfs:mfs:stat"),dWe=ae(),hWe=Oe(),Bre=(_t(),Mt),pWe={withLocal:!1};Lre.exports=r=>{async function e(t,i={}){i=cWe(pWe,i),fWe(`Fetching stats for ${t}`);let{type:n,cid:s,mfsPath:o}=await uWe(r,t,i),a=n==="ipfs"&&s?s:o,c;try{c=await lWe(a,r.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?dWe(new Error(`${t} does not exist`),"ERR_NOT_FOUND"):u}if(!Mre[c.type])throw new Error(`Cannot stat codec ${c.cid.code}`);return Mre[c.type](c)}return hWe(e)};var Mre={raw:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:r=>{let e={cid:r.cid,type:"file",size:r.unixfs.fileSize(),cumulativeSize:Bre.encode(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},directory:r=>{let e={cid:r.cid,type:"directory",size:0,cumulativeSize:Bre.encode(r.node).length+(r.node.Links||[]).reduce((t,i)=>t+(i.Tsize||0),0),blocks:r.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:r.unixfs.mode};return r.unixfs.mtime&&(e.mtime=r.unixfs.mtime),e},object:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:r=>({cid:r.cid,size:r.node.length,cumulativeSize:r.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})}});var s0=y((Pqt,Ure)=>{f();"use strict";var{walkPath:yWe}=(Qo(),Xo),gWe=be()("ipfs:mfs:utils:to-trail"),mWe=async(r,e)=>{gWe(`Creating trail for path ${e}`);let t=[];for await(let i of yWe(e,r.repo.blocks))t.push({name:i.name,cid:i.cid,size:i.size,type:i.type});return t};Ure.exports=mWe});var AR=y((Oqt,jre)=>{f();"use strict";var{CID:bWe}=(Ie(),De),Fre=(_t(),Mt),{sha256:Kre}=(ri(),li),vWe=async(r,e,t)=>{t.codec||(t.codec=Fre),t.hasher||(t.hasher=Kre),t.cidVersion===void 0&&(t.cidVersion=1),t.codec===Fre&&t.hasher!==Kre&&(t.cidVersion=1);let i=await t.hasher.digest(r),n=bWe.create(t.cidVersion,t.codec.code,i);return t.onlyHash||await e.put(n,r,{signal:t.signal}),n};jre.exports=vWe});var IR=y((kqt,zre)=>{f();"use strict";var{murmur3128:Vre}=(a2(),MX);zre.exports={hamtHashCode:Vre.code,hamtBucketBits:8,async hamtHashFn(r){return(await Vre.encode(r)).slice(0,8).reverse()}}});var TR=y((qqt,Wre)=>{f();"use strict";var{encode:wWe,prepare:_We}=(_t(),Mt),{UnixFS:EWe}=(pi(),ms),SWe=AR(),{createHAMT:xWe,Bucket:AWe}=$m(),{hamtHashCode:IWe,hamtHashFn:TWe,hamtBucketBits:RWe}=IR(),Hre=class{constructor(e,t){this.options=t||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,t){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},$re=class extends Hre{constructor(e,t){super(e,t);this._bucket=xWe({hashFn:TWe,bits:RWe})}async put(e,t){await this._bucket.put(e,t)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:t}of this._bucket.eachLeafSeries())yield{key:e,child:t}}async*flush(e){yield*Gre(this._bucket,e,this,this.options)}};Wre.exports=$re;async function*Gre(r,e,t,i){let n=r._children,s=[],o=0;for(let p=0;p<n.length;p++){let g=n.get(p);if(!g)continue;let b=p.toString(16).toUpperCase().padStart(2,"0");if(g instanceof AWe){let E;for await(let v of await Gre(g,e,null,i))E=v;if(!E)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:b,Tsize:E.size,Hash:E.cid}),o+=E.size}else if(typeof g.value.flush=="function"){let E=g.value,v;for await(let R of E.flush(e))v=R,yield v;let A=b+g.key;s.push({Name:A,Tsize:v.size,Hash:v.cid}),o+=v.size}else{let E=g.value;if(!E.cid)continue;let v=b+g.key,A=E.size;s.push({Name:v,Tsize:A,Hash:E.cid}),o+=A}}let a=Uint8Array.from(n.bitField().reverse()),u={Data:new EWe({type:"hamt-sharded-directory",data:a,fanout:r.tableSize(),hashType:IWe,mtime:t&&t.mtime,mode:t&&t.mode}).marshal(),Links:s},l=wWe(_We(u)),d=await SWe(l,e,i),h=l.length+o;yield{cid:d,node:u,size:h}}});var CR=y((Nqt,Jre)=>{f();"use strict";var RR=(_t(),Mt),{Bucket:Yre,createHAMT:CWe}=$m(),PWe=TR(),nE=be()("ipfs:mfs:core:utils:hamt-utils"),{UnixFS:Xre}=(pi(),ms),OWe=rs(),{CID:kWe}=(Ie(),De),{hamtHashCode:qWe,hamtHashFn:NWe,hamtBucketBits:DWe}=IR(),BWe=async(r,e,t,i)=>{if(!i.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let n=Uint8Array.from(t._children.bitField().reverse()),s=Xre.unmarshal(i.parent.Data),o=new Xre({type:"hamt-sharded-directory",data:n,fanout:t.tableSize(),hashType:qWe,mode:s.mode,mtime:s.mtime}),a=await r.hashers.getHasher(i.hashAlg),c={Data:o.marshal(),Links:e.sort((h,p)=>(h.Name||"").localeCompare(p.Name||""))},u=RR.encode(c),l=await a.digest(u),d=kWe.create(i.cidVersion,RR.code,l);return i.flush&&await r.repo.blocks.put(d,u),{node:c,cid:d,size:e.reduce((h,p)=>h+(p.Tsize||0),u.length)}},Qre=async(r,e,t,i)=>{let n=new Yre({hash:e._options.hash,bits:e._options.bits},t,i);return t._putObjectAt(i,n),await sE(r,n,e),n},Zre=async r=>{let e=CWe({hashFn:NWe,bits:DWe});return await sE(r,e,e),e},sE=async(r,e,t)=>{await Promise.all(r.map(i=>{let n=i.Name||"";if(n.length===2){let s=parseInt(n,16);return e._putObjectAt(s,new Yre({hash:t._options.hash,bits:t._options.bits},e,s)),Promise.resolve()}return t.put(n.substring(2),{size:i.Tsize,cid:i.Hash})}))},oE=r=>r.toString(16).toUpperCase().padStart(2,"0").substring(0,2),MWe=async(r,e,t)=>{let i=await Zre(t.Links),n=await i._findNewBucketAndPos(e),s=[{bucket:n.bucket,prefix:oE(n.pos)}],o=n.bucket;for(;o!==i;)s.push({bucket:o,prefix:oE(o._posAtParent)}),o=o._parent;s.reverse(),s[0].node=t;for(let a=0;a<s.length;a++){let c=s[a];if(!c.node)throw new Error("Could not generate HAMT path");let u=c.node.Links.filter(p=>(p.Name||"").substring(0,2)===c.prefix).pop();if(!u){nE(`Link ${c.prefix}${e} will be added`);continue}if(u.Name===`${c.prefix}${e}`){nE(`Link ${c.prefix}${e} will be replaced`);continue}nE(`Found subshard ${c.prefix}`);let l=await r.repo.blocks.get(u.Hash),d=RR.decode(l);if(!s[a+1]){nE(`Loaded new subshard ${c.prefix}`),await Qre(d.Links,i,c.bucket,parseInt(c.prefix,16));let p=await i._findNewBucketAndPos(e);s.push({bucket:p.bucket,prefix:oE(p.pos),node:d});continue}let h=s[a+1];await sE(d.Links,h.bucket,i),h.node=d}return await i.put(e,!0),s.reverse(),{rootBucket:i,path:s}},LWe=async(r,e,t={})=>{let i=new PWe({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:t.mtime,mode:t.mode},t);for(let s=0;s<e.length;s++)await i._bucket.put(e[s].name,{size:e[s].size,cid:e[s].cid});let n=await OWe(i.flush(r.repo.blocks));if(!n)throw new Error("Flushing shard yielded no result");return n};Jre.exports={generatePath:MWe,updateHamtDirectory:BWe,recreateHamtLevel:Qre,recreateInitialHamtLevel:Zre,addLinksToHamtBucket:sE,toPrefix:oE,createShard:LWe}});var ld=y((Dqt,tie)=>{f();"use strict";var ud=(_t(),Mt),{CID:eie}=(Ie(),De),sc=be()("ipfs:mfs:core:utils:add-link"),{UnixFS:PR}=(pi(),ms),UWe=TR(),{updateHamtDirectory:FWe,recreateHamtLevel:KWe,recreateInitialHamtLevel:jWe,createShard:VWe,toPrefix:OR,addLinksToHamtBucket:zWe}=CR(),uu=ae(),HWe=rs(),$We=async(r,e)=>{let t=e.parent;if(e.parentCid){let n=eie.asCID(e.parentCid);if(n===null)throw uu(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(n.code!==ud.code)throw uu(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");sc(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=ud.decode(s)}if(!t)throw uu(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw uu(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw uu(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw uu(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!t.Data)throw uu(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let i=PR.unmarshal(t.Data);return i.type==="hamt-sharded-directory"?(sc("Adding link to sharded directory"),YWe(r,{...e,parent:t})):t.Links.length>=e.shardSplitThreshold?(sc("Converting directory to sharded directory"),GWe(r,{...e,parent:t,mtime:i.mtime,mode:i.mode})):(sc(`Adding ${e.name} (${e.cid}) to regular directory`),WWe(r,{...e,parent:t}))},GWe=async(r,e)=>{let t=await VWe(r,e.parent.Links.map(i=>({name:i.Name||"",size:i.Tsize||0,cid:i.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return sc(`Converted directory to sharded directory ${t.cid}`),t},WWe=async(r,e)=>{let t=e.parent.Links.filter(u=>u.Name!==e.name);if(t.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw uu(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let i=PR.unmarshal(e.parent.Data),n;if(i.mtime){let u=Date.now(),l=Math.floor(u/1e3);i.mtime={secs:l,nsecs:(u-l*1e3)*1e3},n=i.marshal()}else n=e.parent.Data;e.parent=ud.prepare({Data:n,Links:t});let s=await r.hashers.getHasher(e.hashAlg),o=ud.encode(e.parent),a=await s.digest(o),c=eie.create(e.cidVersion,ud.code,a);return e.flush&&await r.repo.blocks.put(c,o),{node:e.parent,cid:c,size:o.length}},YWe=async(r,e)=>{let{shard:t,path:i}=await XWe(r,e),n=await HWe(t.flush(r.repo.blocks));if(!n)throw new Error("No result from flushing shard");let s=await r.repo.blocks.get(n.cid),o=ud.decode(s),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==i[0].prefix),c=o.Links.find(u=>(u.Name||"").substring(0,2)===i[0].prefix);if(!c)throw new Error(`No link found with prefix ${i[0].prefix}`);return a.push(c),FWe(r,a,i[0].bucket,e)},XWe=async(r,e)=>{let t={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw uu(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let i=await jWe(e.parent.Links),n=PR.unmarshal(e.parent.Data),s=new UWe({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:n.mode},e);s._bucket=i,n.mtime&&(s.mtime={secs:Math.round(Date.now()/1e3)});let o=await i._findNewBucketAndPos(t.name),a=QWe(o);a[0].node=e.parent;let c=0;for(;c<a.length;){let u=a[c];c++;let l=u.node;if(!l)throw new Error("Segment had no node");let d=l.Links.find(b=>(b.Name||"").substring(0,2)===u.prefix);if(!d){sc(`Link ${u.prefix}${t.name} will be added`),c=a.length;break}if(d.Name===`${u.prefix}${t.name}`){sc(`Link ${u.prefix}${t.name} will be replaced`),c=a.length;break}if((d.Name||"").length>2){sc(`Link ${d.Name} ${d.Hash} will be replaced with a subshard`),c=a.length;break}sc(`Found subshard ${u.prefix}`);let h=await r.repo.blocks.get(d.Hash),p=ud.decode(h);if(!a[c]){sc(`Loaded new subshard ${u.prefix}`),await KWe(p.Links,i,u.bucket,parseInt(u.prefix,16));let b=await i._findNewBucketAndPos(t.name);a.push({bucket:b.bucket,prefix:OR(b.pos),node:p});break}let g=a[c];await zWe(p.Links,g.bucket,i),g.node=p}return await s._bucket.put(t.name,{size:t.size,cid:t.cid}),{shard:s,path:a}},QWe=r=>{let e=[{bucket:r.bucket,prefix:OR(r.pos)}],t=r.bucket._parent,i=r.bucket._posAtParent;for(;t;)e.push({bucket:t,prefix:OR(i)}),i=t._posAtParent,t=t._parent;return e.reverse(),e};tie.exports=$We});var fd=y((Bqt,iie)=>{f();"use strict";var rie=be()("ipfs:mfs:utils:update-tree"),ZWe=ld(),{decode:JWe}=(_t(),Mt),eYe={shardSplitThreshold:1e3},tYe=async(r,e,t)=>{t=Object.assign({},eYe,t),rie("Trail",e),e=e.slice().reverse();let i=0,n;for await(let o of r.repo.blocks.getMany(e.map(a=>a.cid))){let a=JWe(o),c=e[i].cid,u=e[i].name;if(i++,!n){n={cid:c,name:u,size:o.length};continue}let l=await ZWe(r,{parent:a,name:n.name,cid:n.cid,size:n.size,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold,hashAlg:t.hashAlg,cidVersion:t.cidVersion});n={cid:l.cid,name:u,size:l.size}}let{cid:s}=n;return rie(`Final CID ${s}`),s};iie.exports=tYe});var dd=y((Mqt,nie)=>{f();"use strict";var rYe=be()("ipfs:mfs:utils:update-mfs-root"),{MFS_ROOT_KEY:iYe}=Ki(),nYe=ae(),sYe=async(r,e,t)=>{if(t&&t.signal&&t.signal.aborted)throw nYe(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return rYe(`New MFS root will be ${e}`),await r.repo.datastore.put(iYe,e.bytes),e};nie.exports=sYe});var aie=y((Lqt,oie)=>{f();"use strict";var{UnixFS:oYe}=(pi(),ms),sie=(_t(),Mt),{CID:aYe}=(Ie(),De),cYe=async(r,e,t)=>{let i=new oYe({type:e,mode:t.mode,mtime:t.mtime}),n=await r.hashers.getHasher(t.hashAlg),s={Data:i.marshal(),Links:[]},o=sie.encode(s),a=await n.digest(o),c=aYe.create(t.cidVersion,sie.code,a);return t.flush&&await r.repo.blocks.put(c,o),{cid:c,node:s}};oie.exports=cYe});var aE=y((Uqt,uie)=>{f();"use strict";var o0=ae(),cie=be()("ipfs:mfs:mkdir"),{exporter:uYe}=(Qo(),Xo),lYe=aie(),fYe=iE(),dYe=dd(),hYe=fd(),pYe=ld(),yYe=rE(),gYe=gr().bind({ignoreUndefined:!0}),mYe=Oe(),bYe={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};uie.exports=r=>{async function e(t,i={}){let n=gYe(bYe,i);if(!t)throw new Error("no path given to Mkdir");if(t=t.trim(),t==="/"){if(n.parents)return;throw o0(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(t.substring(0,1)!=="/")throw o0(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");cie(`Creating ${t}`);let s=fYe(t);if(s[0]==="ipfs")throw o0(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let o=await yYe(r,n),a,c=[],u=await lYe(r,"directory",n);for(let d=0;d<=s.length;d++){let h=s.slice(0,d),p=`/ipfs/${o}/${h.join("/")}`;try{if(a=await uYe(p,r.repo.blocks),a.type!=="file"&&a.type!=="directory")throw o0(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(d===s.length){if(n.parents)return;throw o0(new Error("file already exists"),"ERR_ALREADY_EXISTS")}c.push({name:a.name,cid:a.cid})}catch(g){if(g.code==="ERR_NOT_FOUND"){if(d<s.length&&!n.parents)throw o0(new Error(`Intermediate directory path ${p} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await vYe(r,h[h.length-1],u,c[c.length-1],c,n)}else throw g}}let l=await hYe(r,c,n);await dYe(r,l,n)}return mYe(e)};var vYe=async(r,e,t,i,n,s)=>{cie(`Adding empty dir called ${e} to ${i.cid}`);let o=await pYe(r,{parent:i.node,parentCid:i.cid,size:0,cid:t.cid,name:e,hashAlg:s.hashAlg,cidVersion:s.cidVersion,flush:s.flush,shardSplitThreshold:s.shardSplitThreshold});n[n.length-1].cid=o.cid,n.push({name:e,cid:t.cid})}});var lE=y((Fqt,yie)=>{f();"use strict";var lie=aE(),wYe=vb(),cE=be()("ipfs:mfs:cp"),hd=ae(),fie=fd(),die=dd(),_Ye=ld(),uE=cu(),EYe=gr().bind({ignoreUndefined:!0}),SYe=s0(),xYe=Oe(),AYe={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};yie.exports=r=>{async function e(t,i,n={}){let s=EYe(AYe,n);Array.isArray(t)||(t=[t]);let o=await Promise.all(t.map(h=>uE(r,h,s))),a=await uE(r,i,s);if(!o.length||!a)throw hd(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let c=o.find(h=>!h.exists);if(c)throw hd(new Error(`${c.path} does not exist`),"ERR_INVALID_PARAMS");let u=hie(a);if(a.exists){if(cE("Destination exists"),o.length===1&&!u)throw hd(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(cE("Destination does not exist"),o.length>1){if(!s.parents)throw hd(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await lie(r)(a.path,s),a=await uE(r,a.path,s)}else if(a.parts.length>1){let h=`/${a.parts.slice(0,-1).join("/")}`;try{await wYe(r)(h,s)}catch(p){if(p.code!=="ERR_NOT_FOUND")throw p;if(!s.parents)throw hd(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await lie(r)(h,s),a=await uE(r,a.path,s)}}let l=hie(a)?a.mfsPath:a.mfsDirectory,d=await SYe(r,l);if(o.length===1){let h=o.pop();if(!h)throw hd(new Error("could not find source"),"ERR_INVALID_PARAMS");let p=u?h.name:a.name;return cE(`Only one source, copying to destination ${u?"directory":"file"} ${p}`),IYe(r,h,p,d,s)}return cE("Multiple sources, wrapping in a directory"),TYe(r,o,a,d,s)}return xYe(e)};var hie=r=>r.unixfs&&r.unixfs.type&&r.unixfs.type.includes("directory"),IYe=async(r,e,t,i,n)=>{let s=i.pop();if(!s)throw hd(new Error("destination had no parent"),"ERR_INVALID_PARAMS");s=await pie(r,e,t,s,n),i.push(s);let o=await fie(r,i,n);await die(r,o,n)},TYe=async(r,e,t,i,n)=>{for(let o=0;o<e.length;o++){let a=e[o];t=await pie(r,a,a.name,t,n)}i[i.length-1]=t;let s=await fie(r,i,n);await die(r,s,n)},pie=async(r,e,t,i,n)=>{let s=await r.repo.blocks.get(e.cid),{node:o,cid:a,size:c}=await _Ye(r,{parentCid:i.cid,size:s.length,cid:e.cid,name:t,hashAlg:n.hashAlg,cidVersion:n.cidVersion,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold});return i.node=o,i.cid=a,i.size=c,i}});var vie=y((Kqt,bie)=>{f();"use strict";var kR=(_t(),Mt),{CID:gie}=(Ie(),De),Tl=be()("ipfs:mfs:core:utils:remove-link"),{UnixFS:RYe}=(pi(),ms),{generatePath:CYe,updateHamtDirectory:qR}=CR(),pd=ae(),PYe=async(r,e)=>{let t=e.parent;if(e.parentCid){let n=gie.asCID(e.parentCid);if(n===null)throw pd(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Tl(`Loading parent node ${n}`);let s=await r.repo.blocks.get(n);t=kR.decode(s)}if(!t)throw pd(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw pd(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!t.Data)throw pd(new Error("Parent node had no data"),"ERR_INVALID_NODE");return RYe.unmarshal(t.Data).type==="hamt-sharded-directory"?(Tl(`Removing ${e.name} from sharded directory`),kYe(r,{...e,parent:t})):(Tl(`Removing link ${e.name} regular directory`),OYe(r,{...e,parent:t}))},OYe=async(r,e)=>{e.parent.Links=e.parent.Links.filter(o=>o.Name!==e.name);let t=await kR.encode(e.parent),n=await(await r.hashers.getHasher(e.hashAlg)).digest(t),s=gie.create(e.cidVersion,kR.code,n);return await r.repo.blocks.put(s,t),Tl(`Updated regular directory ${s}`),{node:e.parent,cid:s}},kYe=async(r,e)=>{let{rootBucket:t,path:i}=await CYe(r,e.name,e.parent);await t.del(e.name);let{node:n}=await mie(r,i,e.name,e);return qR(r,n.Links,t,e)},mie=async(r,e,t,i)=>{let n=e.pop();if(!n)throw pd(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:s,prefix:o,node:a}=n;if(!a)throw pd(new Error("Could not find parent"),"EINVALIDPARENT");let c=a.Links.find(p=>(p.Name||"").substring(0,2)===o);if(!c)throw pd(new Error(`No link found with prefix ${o} for file ${t}`),"ERR_NOT_FOUND");if(c.Name===`${o}${t}`){Tl(`Removing existing link ${c.Name}`);let p=a.Links.filter(g=>g.Name!==c.Name);return await s.del(t),qR(r,p,s,i)}Tl(`Descending into sub-shard ${c.Name} for ${o}${t}`);let u=await mie(r,e,t,i),l=u.cid,d=u.size,h=o;if(u.node.Links.length===1){Tl(`Removing subshard for ${o}`);let p=u.node.Links[0];h=`${o}${(p.Name||"").substring(2)}`,l=p.Hash,d=p.Tsize||0}return Tl(`Updating shard ${o} with name ${h}`),qYe(r,s,a,o,h,d,l,i)},qYe=(r,e,t,i,n,s,o,a)=>{let c=t.Links.filter(u=>u.Name!==i);return c.push({Name:n,Tsize:s,Hash:o}),qR(r,c,e,a)};bie.exports=PYe});var dE=y((jqt,_ie)=>{f();"use strict";var fE=ae(),NYe=fd(),DYe=dd(),BYe=vie(),wie=cu(),MYe=s0(),LYe=Oe(),UYe=gr().bind({ignoreUndefined:!0}),FYe={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};_ie.exports=r=>{async function e(t,i={}){let n=UYe(FYe,i);Array.isArray(t)||(t=[t]);let s=await Promise.all(t.map(o=>wie(r,o,n)));if(!s.length)throw fE(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");s.forEach(o=>{if(o.path==="/")throw fE(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let o of s)await KYe(r,o.path,n)}return LYe(e)};var KYe=async(r,e,t)=>{let i=await wie(r,e,t),n=await MYe(r,i.mfsPath),s=n[n.length-1];n.pop();let o=n[n.length-1];if(!o)throw fE(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(s.type==="directory"&&!t.recursive)throw fE(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await BYe(r,{parentCid:o.cid,name:s.name,hashAlg:t.hashAlg,cidVersion:t.cidVersion,flush:t.flush,shardSplitThreshold:t.shardSplitThreshold});o.cid=a;let c=await NYe(r,n,t);await DYe(r,c,t)}});var Tie=y((Vqt,Iie)=>{f();"use strict";var jYe=gr().bind({ignoreUndefined:!0}),VYe=cu(),zYe=be()("ipfs:mfs:touch"),wb=ae(),{UnixFS:Eie}=(pi(),ms),HYe=s0(),$Ye=ld(),GYe=fd(),WYe=dd(),yd=(_t(),Mt),{CID:Sie}=(Ie(),De),{pipe:YYe}=Ar(),{importer:XYe}=(g2(),y2),{recursive:QYe}=(Qo(),Xo),ZYe=rs(),JYe=lE(),eXe=dE(),tXe=AR(),rXe=Oe(),xie={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function iXe(r,e,t){let i=0;return(r.includes("x")||r.includes("X")&&(t||e&1||e&8||e&64))&&(i+=1),r.includes("w")&&(i+=2),r.includes("r")&&(i+=4),i}function nXe(r,e){let t=0;return r.includes("u")&&(t+=e<<6),r.includes("g")&&(t+=e<<3),r.includes("o")&&(t+=e),t}function sXe(r,e,t){return e.includes("t")&&(t+=parseInt("1000",8)),e.includes("s")&&(r.includes("u")&&(t+=parseInt("4000",8)),r.includes("g")&&(t+=parseInt("2000",8))),t}function oXe(r,e,t){e||(e=0);let i=r.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!i)throw new Error(`Invalid file mode: ${r}`);let[,n,s,o]=i;(n==="a"||!n)&&(n="ugo");let a=iXe(o,e,t);return a=nXe(n,a),a=sXe(n,o,a),s==="="?(n.includes("u")&&(e=e&parseInt("7077",8),e=e|a),n.includes("g")&&(e=e&parseInt("7707",8),e=e|a),n.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):s==="+"?a|e:s==="-"?a^e:e}function Aie(r,e){if(r instanceof String||typeof r=="string"){let t=`${r}`;t.match(/^\d+$/g)?r=parseInt(t,8):r=0+t.split(",").reduce((i,n)=>oXe(n,i,e.isDirectory()),e.mode||0)}return r}Iie.exports=r=>{async function e(t,i,n={}){let s=jYe(xie,n);zYe(`Fetching stats for ${t}`);let{cid:o,mfsDirectory:a,name:c}=await VYe(r,t,s);if(o.code!==yd.code)throw wb(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(s.recursive){let G=await YYe(async function*(){for await(let Y of QYe(o,r.repo.blocks)){if(Y.type!=="file"&&Y.type!=="directory")throw wb(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");Y.unixfs.mode=Aie(i,Y.unixfs);let C=yd.prepare({Data:Y.unixfs.marshal(),Links:Y.node.Links});yield{path:Y.path,content:C}}},Y=>XYe(Y,r.repo.blocks,{...s,pin:!1,dagBuilder:async function*(C,m,w){for await(let S of C)yield async function(){let P=S.content,B=yd.encode(P),W=await tXe(B,m,w);if(!P.Data)throw wb(new Error(`${W} had no data`),"ERR_INVALID_NODE");let j=Eie.unmarshal(P.Data);return{cid:W,size:B.length,path:S.path,unixfs:j}}}}),Y=>ZYe(Y));if(!G)throw wb(new Error(`Could not chmod ${t}`),"ERR_COULD_NOT_CHMOD");await eXe(r)(t,s),await JYe(r)(`/ipfs/${G.cid}`,t,s);return}let u=await r.repo.blocks.get(o),l=yd.decode(u);if(!l.Data)throw wb(new Error(`${o} had no data`),"ERR_INVALID_NODE");let d=Eie.unmarshal(l.Data);d.mode=Aie(i,d);let h=yd.encode({Data:d.marshal(),Links:l.Links}),p=s.hashAlg||xie.hashAlg,b=await(await r.hashers.getHasher(p)).digest(h),E=Sie.create(s.cidVersion,yd.code,b);s.flush&&await r.repo.blocks.put(E,h);let v=await HYe(r,a),A=v[v.length-1],R=Sie.decode(A.cid.bytes),F=await r.repo.blocks.get(R),q=yd.decode(F),N=await $Ye(r,{parent:q,name:c,cid:E,size:h.length,flush:s.flush,hashAlg:p,cidVersion:o.version,shardSplitThreshold:1/0});A.cid=N.cid;let z=await GYe(r,v,s);await WYe(r,z,s)}return rXe(e)}});var Cie=y((zqt,Rie)=>{f();"use strict";var aXe=vb(),cXe=Oe(),uXe=gr().bind({ignoreUndefined:!0}),lXe={};Rie.exports=r=>{async function e(t,i={}){i=uXe(lXe,i);let{cid:n}=await aXe(r)(t,i);return n}return cXe(e)}});var Oie=y((Hqt,Pie)=>{f();"use strict";var fXe=lE(),dXe=dE(),hXe=gr().bind({ignoreUndefined:!0}),pXe=Oe(),yXe={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};Pie.exports=r=>{async function e(t,i,n={}){let s=hXe(yXe,n);await fXe(r)(t,i,s),await dXe(r)(t,{...s,recursive:!0})}return pXe(e)}});var Mie=y(($qt,Bie)=>{f();"use strict";var gXe=gr().bind({ignoreUndefined:!0}),mXe=cu(),bXe=be()("ipfs:mfs:touch"),kie=ae(),{UnixFS:qie}=(pi(),ms),vXe=s0(),wXe=ld(),_Xe=fd(),EXe=dd(),gd=(_t(),Mt),{CID:Nie}=(Ie(),De),SXe=Oe(),Die={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};Bie.exports=r=>{async function e(t,i={}){let n=gXe(Die,i);n.mtime=n.mtime||new Date,bXe(`Touching ${t} mtime: ${n.mtime}`);let{cid:s,mfsDirectory:o,name:a,exists:c}=await mXe(r,t,n),u=i.hashAlg||Die.hashAlg,l=await r.hashers.getHasher(u),d,h,p=n.cidVersion;if(c){if(s.code!==gd.code)throw kie(new Error(`${t} was not a UnixFS node`),"ERR_NOT_UNIXFS");p=s.version;let q=await r.repo.blocks.get(s),N=gd.decode(q);if(!N.Data)throw kie(new Error(`${t} had no data`),"ERR_INVALID_NODE");let z=qie.unmarshal(N.Data);z.mtime=n.mtime,d=gd.encode({Data:z.marshal(),Links:N.Links});let G=await l.digest(d);h=Nie.create(n.cidVersion,gd.code,G),n.flush&&await r.repo.blocks.put(h,d)}else{let q=new qie({type:"file",mtime:n.mtime});d=gd.encode({Data:q.marshal(),Links:[]});let N=await l.digest(d);h=Nie.create(n.cidVersion,gd.code,N),n.flush&&await r.repo.blocks.put(h,d)}let g=await vXe(r,o),b=g[g.length-1],E=b.cid,v=await r.repo.blocks.get(E),A=gd.decode(v),R=await wXe(r,{parent:A,name:a,cid:h,size:d.length,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:p});b.cid=R.cid;let F=await _Xe(r,g,n);await EXe(r,F,n)}return SXe(e)}});var Kie=y((Gqt,Fie)=>{f();"use strict";var Lie=ae(),_b=be()("ipfs:mfs:utils:to-async-iterator"),{MFS_MAX_CHUNK_SIZE:Uie}=Ki(),{fromString:xXe}=(ft(),ht),AXe=r=>{if(!r)throw Lie(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof r=="string"||r instanceof String)&&(_b("Content was a string"),r=xXe(r.toString())),r.length)return _b("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield r}};if(r[Symbol.asyncIterator])return _b("Content was an async iterator"),r;if(r[Symbol.iterator])return _b("Content was an iterator"),r;if(globalThis.Blob&&r instanceof globalThis.Blob){_b("Content was an HTML5 Blob");let e=0,t={next:()=>e>r.size?{done:!0}:new Promise((i,n)=>{let s=r.slice(e,Uie);e+=Uie;let o=new globalThis.FileReader,a=c=>{if(o.removeEventListener("loadend",a,!1),c.error)return n(c.error);i({done:!1,value:new Uint8Array(o.result)})};o.addEventListener("loadend",a),o.readAsArrayBuffer(s)})};return{[Symbol.asyncIterator]:()=>t}}throw Lie(new Error(`Don't know how to convert ${r} into an async iterator`),"ERR_INVALID_PARAMS")};Fie.exports=AXe});var $ie=y((Wqt,Hie)=>{f();"use strict";var oc=be()("ipfs:mfs:write"),{importer:IXe}=(g2(),y2),{decode:TXe}=(_t(),Mt),{sha256:RXe,sha512:CXe}=(ri(),li),PXe=vb(),OXe=aE(),kXe=ld(),qXe=gr().bind({ignoreUndefined:!0}),jie=SR(),NXe=Kie(),NR=cu(),DXe=iE(),BXe=s0(),MXe=fd(),LXe=dd(),lu=ae(),{MFS_MAX_CHUNK_SIZE:UXe}=Ki(),FXe=rs(),KXe=Oe(),{parseMode:jXe,parseMtime:VXe}=(pi(),ms),zXe={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(r,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};Hie.exports=r=>{async function e(t,i,n={}){let s=qXe(zXe,n),o,a,c;if(oc("Reading source, destination and parent"),await jie().readLock(async()=>{o=await NXe(i),a=await NR(r,t,s),c=await NR(r,a.mfsDirectory,s)})(),oc("Read source, destination and parent"),!s.parents&&!c.exists)throw lu(new Error("directory does not exist"),"ERR_NO_EXIST");if(o==null)throw lu(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw lu(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!s.create&&!a.exists)throw lu(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw lu(new Error("not a file"),"ERR_NOT_A_FILE");return HXe(r,t,o,a,s)}return KXe(e)};var HXe=async(r,e,t,i,n)=>{let s=await $Xe(r,t,i,n);await jie().writeLock(async()=>{let o=DXe(e),a=o.pop();if(a==null)throw lu(new Error("source does not exist"),"ERR_NO_EXIST");let c=!1;try{await PXe(r)(`/${o.join("/")}`,n),c=!0}catch(E){if(E.code!=="ERR_NOT_FOUND")throw E}c||await OXe(r)(`/${o.join("/")}`,n);let u=await NR(r,e,n),l=await BXe(r,u.mfsDirectory),d=l[l.length-1];if(!d)throw lu(new Error("directory does not exist"),"ERR_NO_EXIST");if(!d.type||!d.type.includes("directory"))throw lu(new Error(`cannot write to ${d.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let h=await r.repo.blocks.get(d.cid),p=TXe(h),g=await kXe(r,{parent:p,name:a,cid:s.cid,size:s.size,flush:n.flush,shardSplitThreshold:n.shardSplitThreshold,hashAlg:n.hashAlg,cidVersion:n.cidVersion});d.cid=g.cid;let b=await MXe(r,l,n);await LXe(r,b,n)})()},$Xe=async(r,e,t,i)=>{t.exists?oc(`Overwriting file ${t.cid} offset ${i.offset} length ${i.length}`):oc(`Writing file offset ${i.offset} length ${i.length}`);let n=[];if(i.offset>0)if(t.unixfs){if(oc(`Writing first ${i.offset} bytes of original file`),n.push(()=>t.content({offset:0,length:i.offset})),t.unixfs.fileSize()<i.offset){let l=i.offset-t.unixfs.fileSize();oc(`Writing zeros for extra ${l} bytes`),n.push(zie(l))}}else oc(`Writing zeros for first ${i.offset} bytes`),n.push(zie(i.offset));n.push(Vie(e,i.length));let s=WXe(GXe(n),l=>{if(t.unixfs&&!i.truncate){let d=t.unixfs.fileSize();if(d>l)return oc(`Writing last ${d-l} of ${d} bytes from original file starting at offset ${l}`),t.content({offset:l});oc("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),o;i.mode!==void 0&&i.mode!==null?o=jXe(i.mode):t&&t.unixfs&&(o=t.unixfs.mode);let a;i.mtime!=null?a=VXe(i.mtime):t&&t.unixfs&&(a=t.unixfs.mtime);let c;switch(i.hashAlg){case"sha2-256":c=RXe;break;case"sha2-512":c=CXe;break;default:throw new Error(`TODO vmx 2021-03-31: Proper error message for unsupported hash algorithms like ${i.hashAlg}`)}let u=await FXe(IXe([{content:s,mode:o,mtime:a}],r.repo.blocks,{progress:i.progress,hasher:c,cidVersion:i.cidVersion,strategy:i.strategy,rawLeaves:i.rawLeaves,reduceSingleLeafToSelf:i.reduceSingleLeafToSelf,leafType:i.leafType}));if(!u)throw lu(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return oc(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},Vie=(r,e)=>async function*(){let i=0;for await(let n of r){if(i+=n.length,i>e){yield n.slice(0,e-i);return}yield n}},zie=(r,e=UXe)=>{let t=new Uint8Array(e);async function*i(){for(;;)yield t.slice()}return Vie(i(),r)},GXe=async function*(r){for(let e=0;e<r.length;e++)yield*r[e]()},WXe=async function*(r,e){let t=0;for await(let i of r)t+=i.length,yield i;for await(let i of e(t))t+=i.length,yield i}});var Yie=y((Yqt,Wie)=>{f();"use strict";var{exporter:YXe}=(Qo(),Xo),XXe=gr().bind({ignoreUndefined:!0}),QXe=cu(),Gie=ae(),ZXe=Oe(),JXe={offset:0,length:1/0};Wie.exports=r=>{function e(t,i={}){return i=XXe(JXe,i),{[Symbol.asyncIterator]:async function*(){let s=await QXe(r,t,i),o=await YXe(s.mfsPath,r.repo.blocks);if(o.type!=="file")throw Gie(new Error(`${t} was not a file`),"ERR_NOT_FILE");if(!o.content)throw Gie(new Error(`Could not load content stream from ${t}`),"ERR_NO_CONTENT");for await(let a of o.content({offset:i.offset,length:i.length}))yield a}}}return ZXe(e)}});var Zie=y((Xqt,Qie)=>{f();"use strict";var{exporter:eQe}=(Qo(),Xo),tQe=cu(),rQe=Oe(),iQe=Ho(),Xie=r=>{let e={cid:r.cid,name:r.name,type:r.type==="directory"?"directory":"file",size:r.size};return(r.type==="file"||r.type==="directory")&&(e.mode=r.unixfs.mode,e.mtime=r.unixfs.mtime),e};Qie.exports=r=>{async function*e(t,i={}){let n=await tQe(r,t,i),s=await eQe(n.mfsPath,r.repo.blocks);if(s.type==="directory"){yield*iQe(s.content(i),Xie);return}yield Xie(s)}return rQe(e)}});var ine=y((Qqt,rne)=>{f();"use strict";var nQe=SR(),Jie=sp(),sQe={stat:vb()},oQe={chmod:Tie(),cp:lE(),flush:Cie(),mkdir:aE(),mv:Oie(),rm:dE(),touch:Mie()},ene={write:$ie(),read:Yie(),ls:Zie()},tne=({options:r,mfs:e,operations:t,lock:i})=>{Object.keys(t).forEach(n=>{e[n]=i(t[n](r))})},aQe={repoOwner:!0,repo:null};function cQe(r){let{repoOwner:e}=Object.assign({},aQe||{},r),t=nQe(e),i=o=>t.readLock(o),n=o=>t.writeLock(o),s={};return tne({options:r,mfs:s,operations:sQe,lock:i}),tne({options:r,mfs:s,operations:oQe,lock:n}),Object.keys(ene).forEach(o=>{s[o]=ene[o](r)}),s}rne.exports=({repo:r,preload:e,hashers:t,options:i})=>{let n=cQe({repo:r,repoOwner:Boolean(i.repoOwner),hashers:t}),s=o=>(...c)=>{let u=c.filter(l=>Jie.ipfsPath(l)||Jie.cid(l));if(u.length){let l=c[c.length-1];l&&l.preload!==!1&&u.forEach(d=>e(d))}return o(...c)};return{...n,chmod:n.chmod,cp:s(n.cp),mkdir:n.mkdir,stat:s(n.stat),rm:n.rm,read:s(n.read),touch:n.touch,write:n.write,mv:s(n.mv),flush:n.flush,ls:s(async function*(...o){for await(let a of n.ls(...o))yield{...a,size:a.size||0}})}}});var sne=y((Zqt,nne)=>{f();"use strict";var uQe=Oe();nne.exports=({keychain:r})=>uQe((t,i)=>r.exportKey(t,i))});var une=y((Jqt,cne)=>{f();"use strict";var lQe=Oe(),one="ed25519",ane=2048;cne.exports=({keychain:r})=>lQe((t,i={type:one,size:ane})=>r.createKey(t,i.type||one,i.size||ane))});var fne=y((eNt,lne)=>{f();"use strict";var fQe=Oe();lne.exports=({keychain:r})=>fQe((t,i,n)=>r.importKey(t,i,n))});var hne=y((tNt,dne)=>{f();"use strict";var dQe=Oe();dne.exports=({keychain:r})=>dQe(t=>r.findKeyByName(t))});var yne=y((rNt,pne)=>{f();"use strict";var hQe=Oe();pne.exports=({keychain:r})=>hQe(()=>r.listKeys())});var mne=y((iNt,gne)=>{f();"use strict";var pQe=Oe();gne.exports=({keychain:r})=>pQe(async(t,i)=>{let n=await r.renameKey(t,i);return{was:t,now:n.name,id:n.id,overwrite:!1}})});var vne=y((nNt,bne)=>{f();"use strict";var yQe=Oe();bne.exports=({keychain:r})=>yQe(t=>r.removeKey(t))});var Ene=y((sNt,_ne)=>{f();"use strict";var gQe=sne(),mQe=une(),bQe=fne(),vQe=hne(),wQe=yne(),_Qe=mne(),EQe=vne(),wne=class{constructor({keychain:e}){this.gen=mQe({keychain:e}),this.list=wQe({keychain:e}),this.rm=EQe({keychain:e}),this.rename=_Qe({keychain:e}),this.export=gQe({keychain:e}),this.import=bQe({keychain:e}),this.info=vQe({keychain:e})}};_ne.exports=wne});var Rl=y((oNt,Sne)=>{f();"use strict";var SQe=(_t(),Mt),xQe=Oe();Sne.exports=({repo:r,preload:e})=>{async function t(i,n={}){n.preload!==!1&&e(i);let s=await r.blocks.get(i,n);return SQe.decode(s)}return xQe(t)}});var Ane=y((aNt,xne)=>{f();"use strict";var AQe=Oe();xne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e});async function i(n,s={}){return(await t(n,s)).Data||new Uint8Array(0)}return AQe(i)}});var Rne=y((cNt,Tne)=>{f();"use strict";var IQe=(_t(),Mt),TQe=(eu(),l_),RQe=(Ls(),Po),{CID:Ine}=(Ie(),De),CQe=Oe();function DR(r,e=[]){for(let t in r){let i=r[t];if(t==="/"&&Object.keys(r).length===1)try{e.push({Name:"",Tsize:0,Hash:Ine.parse(i)});continue}catch(n){}if(i instanceof Ine){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(i)&&DR(i,e),i&&typeof i=="object"&&DR(i,e)}return e}Tne.exports=({repo:r,codecs:e})=>{async function t(i,n={}){let s=await e.getCodec(i.code),o=await r.blocks.get(i,n),a=s.decode(o);if(i.code===RQe.code)return[];if(i.code===IQe.code)return a.Links;if(i.code===TQe.code)return DR(a);throw new Error(`Cannot resolve links from codec ${i.code}`)}return CQe(t)}});var Pne=y((uNt,Cne)=>{f();"use strict";var PQe=(_t(),Mt),{sha256:OQe}=(ri(),li),{UnixFS:kQe}=(pi(),ms),qQe=Oe(),{CID:NQe}=(Ie(),De);Cne.exports=({repo:r,preload:e})=>{async function t(i={}){let n;if(i.template)if(i.template==="unixfs-dir")n=new kQe({type:"directory"}).marshal();else throw new Error("unknown template");let s=PQe.encode({Data:n,Links:[]}),o=await OQe.digest(s),a=NQe.createV0(o);return await r.blocks.put(a,s,{signal:i.signal}),i.preload!==!1&&e(a),a}return qQe(t)}});var a0=y((lNt,One)=>{f();"use strict";var DQe=(_t(),Mt),{CID:BQe}=(Ie(),De),{sha256:MQe}=(ri(),li),LQe=Oe();One.exports=({repo:r,preload:e})=>{async function t(i,n={}){let s=await r.gcLock.readLock();try{let o=DQe.encode(i),a=await MQe.digest(o),c=BQe.createV0(a);return await r.blocks.put(c,o,{signal:n.signal}),n.preload!==!1&&e(c),n.pin&&await r.pins.pinRecursively(c,{signal:n.signal}),c}finally{s()}}return LQe(t)}});var qne=y((fNt,kne)=>{f();"use strict";var UQe=(_t(),Mt),FQe=Oe();kne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e});async function i(n,s={}){let o=await t(n,s),c=UQe.encode(o).length,u=o.Links.reduce((l,d)=>l+(d.Tsize||0),0);return{Hash:n,NumLinks:o.Links.length,BlockSize:c,LinksSize:c-(o.Data||[]).length,DataSize:(o.Data||[]).length,CumulativeSize:c+u}}return FQe(i)}});var Dne=y((dNt,Nne)=>{f();"use strict";var KQe=Oe();Nne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e}),i=a0()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Links:c.Links.concat([o])},a)}return KQe(n)}});var Mne=y((hNt,Bne)=>{f();"use strict";var jQe=Oe(),{concat:VQe}=(cn(),an);Bne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e}),i=a0()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=VQe([c.Data||[],o]);return i({...c,Data:u},a)}return jQe(n)}});var Une=y((pNt,Lne)=>{f();"use strict";var zQe=Oe();Lne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e}),i=a0()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a),u=(typeof o=="string"?o:o.Name)||"";return c.Links=c.Links.filter(l=>l.Name!==u),i(c,a)}return zQe(n)}});var Kne=y((yNt,Fne)=>{f();"use strict";var HQe=Oe();Fne.exports=({repo:r,preload:e})=>{let t=Rl()({repo:r,preload:e}),i=a0()({repo:r,preload:e});async function n(s,o,a={}){let c=await t(s,a);return i({...c,Data:o},a)}return HQe(n)}});var zne=y((gNt,Vne)=>{f();"use strict";var $Qe=Dne(),GQe=Mne(),WQe=Une(),YQe=Kne(),jne=class{constructor({repo:e,preload:t}){this.addLink=$Qe({repo:e,preload:t}),this.appendData=GQe({repo:e,preload:t}),this.rmLink=WQe({repo:e,preload:t}),this.setData=YQe({repo:e,preload:t})}};Vne.exports=jne});var Gne=y((mNt,$ne)=>{f();"use strict";var XQe=Ane(),QQe=Rl(),ZQe=Rne(),JQe=Pne(),eZe=a0(),tZe=qne(),rZe=zne(),Hne=class{constructor({repo:e,codecs:t,preload:i}){this.data=XQe({repo:e,preload:i}),this.get=QQe({repo:e,preload:i}),this.links=ZQe({repo:e,codecs:t}),this.new=JQe({repo:e,preload:i}),this.put=eZe({repo:e,preload:i}),this.stat=tZe({repo:e,preload:i}),this.patch=new rZe({repo:e,preload:i})}};$ne.exports=Hne});var Yne=y((bNt,Wne)=>{f();"use strict";var iZe=be()("ipfs:repo:gc"),nZe=Oe(),sZe=rE();Wne.exports=({repo:r,hashers:e})=>{async function*t(i={}){let n=Date.now(),s;try{s=await sZe({repo:r,hashers:e},i),await r.pins.pinRecursively(s),yield*r.gc()}finally{s&&await r.pins.unpin(s)}iZe(`Complete (${Date.now()-n}ms)`)}return nZe(t)}});var BR=y((vNt,Xne)=>{f();"use strict";var oZe=Oe();Xne.exports=({repo:r})=>{async function e(t={}){let i=await r.stat();return{numObjects:BigInt(i.numObjects.toString()),repoSize:BigInt(i.repoSize.toString()),repoPath:i.repoPath,version:`${i.version}`,storageMax:BigInt(i.storageMax.toString())}}return oZe(e)}});var Zne=y((wNt,Qne)=>{f();"use strict";var{repoVersion:aZe}=$f(),cZe=Oe();Qne.exports=({repo:r})=>{async function e(t={}){try{await r._checkInitialized(t)}catch(i){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(s=>s.test(i.message)))return aZe;throw i}return r.version.get()}return cZe(e)}});var tse=y((_Nt,ese)=>{f();"use strict";var uZe=Yne(),lZe=BR(),fZe=Zne(),Jne=class{constructor({repo:e,hashers:t}){this.gc=uZe({repo:e,hashers:t}),this.stat=lZe({repo:e}),this.version=fZe({repo:e}),this.setApiAddr=i=>e.apiAddr.set(i)}};ese.exports=Jne});var nse=y((ENt,ise)=>{f();"use strict";var{default:dZe}=dm(),hZe=ae(),pZe=Oe();function rse(r,e){let t;if(r.metrics?e.peer?t=r.metrics.forPeer(e.peer):e.proto?t=r.metrics.forProtocol(e.proto):t=r.metrics.global:t=void 0,!t)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let{movingAverages:i,snapshot:n}=t;return{totalIn:BigInt(n.dataReceived.integerValue().toString()),totalOut:BigInt(n.dataSent.integerValue().toString()),rateIn:i.dataReceived[6e4].movingAverage()/60,rateOut:i.dataSent[6e4].movingAverage()/60}}ise.exports=({network:r})=>pZe(async function*(t={}){let{libp2p:i}=await r.use(t);if(!t.poll){yield rse(i,t);return}let n=t.interval||1e3,s=-1;try{if(s=typeof n=="string"?dZe(n)||-1:n,!s||s<0)throw new Error("invalid duration")}catch(a){throw hZe(a,"ERR_INVALID_POLL_INTERVAL")}let o;try{for(;;)yield rse(i,t),await new Promise(a=>{o=setTimeout(a,s)})}finally{clearTimeout(o)}})});var ase=y((SNt,ose)=>{f();"use strict";var yZe=nse(),gZe=BR(),mZe=i5(),sse=class{constructor({repo:e,network:t}){this.repo=gZe({repo:e}),this.bw=yZe({network:t}),this.bitswap=mZe({network:t})}};ose.exports=sse});var MR=y((xNt,cse)=>{f();"use strict";cse.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(t in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==n||o.enumerable!==!0)return!1}return!0}});var Eb=y((ANt,use)=>{f();"use strict";var bZe=MR();use.exports=function(){return bZe()&&!!Symbol.toStringTag}});var dse=y((INt,fse)=>{f();"use strict";var lse=typeof Symbol!="undefined"&&Symbol,vZe=MR();fse.exports=function(){return typeof lse!="function"||typeof Symbol!="function"||typeof lse("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:vZe()}});var pse=y((TNt,hse)=>{f();"use strict";var wZe="Function.prototype.bind called on incompatible ",LR=Array.prototype.slice,_Ze=Object.prototype.toString,EZe="[object Function]";hse.exports=function(e){var t=this;if(typeof t!="function"||_Ze.call(t)!==EZe)throw new TypeError(wZe+t);for(var i=LR.call(arguments,1),n,s=function(){if(this instanceof n){var l=t.apply(this,i.concat(LR.call(arguments)));return Object(l)===l?l:this}else return t.apply(e,i.concat(LR.call(arguments)))},o=Math.max(0,t.length-i.length),a=[],c=0;c<o;c++)a.push("$"+c);if(n=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(s),t.prototype){var u=function(){};u.prototype=t.prototype,n.prototype=new u,u.prototype=null}return n}});var hE=y((RNt,yse)=>{f();"use strict";var SZe=pse();yse.exports=Function.prototype.bind||SZe});var mse=y((CNt,gse)=>{f();"use strict";var xZe=hE();gse.exports=xZe.call(Function.call,Object.prototype.hasOwnProperty)});var mE=y((PNt,_se)=>{f();"use strict";var Ot,Sb=SyntaxError,bse=Function,c0=TypeError,UR=function(r){try{return bse('"use strict"; return ('+r+").constructor;")()}catch(e){}},md=Object.getOwnPropertyDescriptor;if(md)try{md({},"")}catch(r){md=null}var FR=function(){throw new c0},AZe=md?function(){try{return arguments.callee,FR}catch(r){try{return md(arguments,"callee").get}catch(e){return FR}}}():FR,u0=dse()(),Cl=Object.getPrototypeOf||function(r){return r.__proto__},l0={},IZe=typeof Uint8Array=="undefined"?Ot:Cl(Uint8Array),f0={"%AggregateError%":typeof AggregateError=="undefined"?Ot:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?Ot:ArrayBuffer,"%ArrayIteratorPrototype%":u0?Cl([][Symbol.iterator]()):Ot,"%AsyncFromSyncIteratorPrototype%":Ot,"%AsyncFunction%":l0,"%AsyncGenerator%":l0,"%AsyncGeneratorFunction%":l0,"%AsyncIteratorPrototype%":l0,"%Atomics%":typeof Atomics=="undefined"?Ot:Atomics,"%BigInt%":typeof BigInt=="undefined"?Ot:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?Ot:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?Ot:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?Ot:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?Ot:FinalizationRegistry,"%Function%":bse,"%GeneratorFunction%":l0,"%Int8Array%":typeof Int8Array=="undefined"?Ot:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?Ot:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?Ot:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":u0?Cl(Cl([][Symbol.iterator]())):Ot,"%JSON%":typeof JSON=="object"?JSON:Ot,"%Map%":typeof Map=="undefined"?Ot:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!u0?Ot:Cl(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?Ot:Promise,"%Proxy%":typeof Proxy=="undefined"?Ot:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?Ot:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?Ot:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!u0?Ot:Cl(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?Ot:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":u0?Cl(""[Symbol.iterator]()):Ot,"%Symbol%":u0?Symbol:Ot,"%SyntaxError%":Sb,"%ThrowTypeError%":AZe,"%TypedArray%":IZe,"%TypeError%":c0,"%Uint8Array%":typeof Uint8Array=="undefined"?Ot:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?Ot:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?Ot:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?Ot:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?Ot:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?Ot:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?Ot:WeakSet},TZe=function r(e){var t;if(e==="%AsyncFunction%")t=UR("async function () {}");else if(e==="%GeneratorFunction%")t=UR("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=UR("async function* () {}");else if(e==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(t=i.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=r("%AsyncGenerator%");n&&(t=Cl(n.prototype))}return f0[e]=t,t},vse={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},pE=hE(),yE=mse(),RZe=pE.call(Function.call,Array.prototype.concat),CZe=pE.call(Function.apply,Array.prototype.splice),wse=pE.call(Function.call,String.prototype.replace),gE=pE.call(Function.call,String.prototype.slice),PZe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,OZe=/\\(\\)?/g,kZe=function(e){var t=gE(e,0,1),i=gE(e,-1);if(t==="%"&&i!=="%")throw new Sb("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&t!=="%")throw new Sb("invalid intrinsic syntax, expected opening `%`");var n=[];return wse(e,PZe,function(s,o,a,c){n[n.length]=a?wse(c,OZe,"$1"):o||s}),n},qZe=function(e,t){var i=e,n;if(yE(vse,i)&&(n=vse[i],i="%"+n[0]+"%"),yE(f0,i)){var s=f0[i];if(s===l0&&(s=TZe(i)),typeof s=="undefined"&&!t)throw new c0("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:s}}throw new Sb("intrinsic "+e+" does not exist!")};_se.exports=function(e,t){if(typeof e!="string"||e.length===0)throw new c0("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new c0('"allowMissing" argument must be a boolean');var i=kZe(e),n=i.length>0?i[0]:"",s=qZe("%"+n+"%",t),o=s.name,a=s.value,c=!1,u=s.alias;u&&(n=u[0],CZe(i,RZe([0,1],u)));for(var l=1,d=!0;l<i.length;l+=1){var h=i[l],p=gE(h,0,1),g=gE(h,-1);if((p==='"'||p==="'"||p==="`"||g==='"'||g==="'"||g==="`")&&p!==g)throw new Sb("property names with quotes must have matching quotes");if((h==="constructor"||!d)&&(c=!0),n+="."+h,o="%"+n+"%",yE(f0,o))a=f0[o];else if(a!=null){if(!(h in a)){if(!t)throw new c0("base intrinsic for "+e+" exists, but the property is not available.");return}if(md&&l+1>=i.length){var b=md(a,h);d=!!b,d&&"get"in b&&!("originalValue"in b.get)?a=b.get:a=a[h]}else d=yE(a,h),a=a[h];d&&!c&&(f0[o]=a)}}return a}});var Tse=y((ONt,bE)=>{f();"use strict";var KR=hE(),d0=mE(),Ese=d0("%Function.prototype.apply%"),Sse=d0("%Function.prototype.call%"),xse=d0("%Reflect.apply%",!0)||KR.call(Sse,Ese),Ase=d0("%Object.getOwnPropertyDescriptor%",!0),bd=d0("%Object.defineProperty%",!0),NZe=d0("%Math.max%");if(bd)try{bd({},"a",{value:1})}catch(r){bd=null}bE.exports=function(e){var t=xse(KR,Sse,arguments);if(Ase&&bd){var i=Ase(t,"length");i.configurable&&bd(t,"length",{value:1+NZe(0,e.length-(arguments.length-1))})}return t};var Ise=function(){return xse(KR,Ese,arguments)};bd?bd(bE.exports,"apply",{value:Ise}):bE.exports.apply=Ise});var vE=y((kNt,Pse)=>{f();"use strict";var Rse=mE(),Cse=Tse(),DZe=Cse(Rse("String.prototype.indexOf"));Pse.exports=function(e,t){var i=Rse(e,!!t);return typeof i=="function"&&DZe(e,".prototype.")>-1?Cse(i):i}});var qse=y((qNt,kse)=>{f();"use strict";var BZe=Eb()(),MZe=vE(),jR=MZe("Object.prototype.toString"),wE=function(e){return BZe&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:jR(e)==="[object Arguments]"},Ose=function(e){return wE(e)?!0:e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&jR(e)!=="[object Array]"&&jR(e.callee)==="[object Function]"},LZe=function(){return wE(arguments)}();wE.isLegacyArguments=Ose;kse.exports=LZe?wE:Ose});var Bse=y((NNt,Dse)=>{f();"use strict";var UZe=Object.prototype.toString,FZe=Function.prototype.toString,KZe=/^\s*(?:function)?\*/,Nse=Eb()(),VR=Object.getPrototypeOf,jZe=function(){if(!Nse)return!1;try{return Function("return function*() {}")()}catch(r){}},zR;Dse.exports=function(e){if(typeof e!="function")return!1;if(KZe.test(FZe.call(e)))return!0;if(!Nse){var t=UZe.call(e);return t==="[object GeneratorFunction]"}if(!VR)return!1;if(typeof zR=="undefined"){var i=jZe();zR=i?VR(i):!1}return VR(e)===zR}});var HR=y((DNt,Mse)=>{f();var VZe=Object.prototype.hasOwnProperty,zZe=Object.prototype.toString;Mse.exports=function(e,t,i){if(zZe.call(t)!=="[object Function]")throw new TypeError("iterator must be a function");var n=e.length;if(n===+n)for(var s=0;s<n;s++)t.call(i,e[s],s,e);else for(var o in e)VZe.call(e,o)&&t.call(i,e[o],o,e)}});var GR=y((BNt,Lse)=>{f();"use strict";var $R=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"];Lse.exports=function(){for(var e=[],t=0;t<$R.length;t++)typeof globalThis[$R[t]]=="function"&&(e[e.length]=$R[t]);return e}});var WR=y((MNt,Use)=>{f();"use strict";var HZe=mE(),_E=HZe("%Object.getOwnPropertyDescriptor%");if(_E)try{_E([],"length")}catch(r){_E=null}Use.exports=_E});var QR=y((LNt,zse)=>{f();"use strict";var Fse=HR(),$Ze=GR(),YR=vE(),GZe=YR("Object.prototype.toString"),Kse=Eb()(),jse=$Ze(),WZe=YR("Array.prototype.indexOf",!0)||function(e,t){for(var i=0;i<e.length;i+=1)if(e[i]===t)return i;return-1},YZe=YR("String.prototype.slice"),Vse={},EE=WR(),XR=Object.getPrototypeOf;Kse&&EE&&XR&&Fse(jse,function(r){var e=new globalThis[r];if(Symbol.toStringTag in e){var t=XR(e),i=EE(t,Symbol.toStringTag);if(!i){var n=XR(t);i=EE(n,Symbol.toStringTag)}Vse[r]=i.get}});var XZe=function(e){var t=!1;return Fse(Vse,function(i,n){if(!t)try{t=i.call(e)===n}catch(s){}}),t};zse.exports=function(e){if(!e||typeof e!="object")return!1;if(!Kse||!(Symbol.toStringTag in e)){var t=YZe(GZe(e),8,-1);return WZe(jse,t)>-1}return EE?XZe(e):!1}});var Xse=y((UNt,Yse)=>{f();"use strict";var Hse=HR(),QZe=GR(),$se=vE(),ZZe=$se("Object.prototype.toString"),Gse=Eb()(),JZe=QZe(),eJe=$se("String.prototype.slice"),Wse={},ZR=WR(),JR=Object.getPrototypeOf;Gse&&ZR&&JR&&Hse(JZe,function(r){if(typeof globalThis[r]=="function"){var e=new globalThis[r];if(Symbol.toStringTag in e){var t=JR(e),i=ZR(t,Symbol.toStringTag);if(!i){var n=JR(t);i=ZR(n,Symbol.toStringTag)}Wse[r]=i.get}}});var tJe=function(e){var t=!1;return Hse(Wse,function(i,n){if(!t)try{var s=i.call(e);s===n&&(t=s)}catch(o){}}),t},rJe=QR();Yse.exports=function(e){return rJe(e)?!Gse||!(Symbol.toStringTag in e)?eJe(ZZe(e),8,-1):tJe(e):!1}});var loe=y(Et=>{f();"use strict";var iJe=qse(),nJe=Bse(),ea=Xse(),Qse=QR();function h0(r){return r.call.bind(r)}var Zse=typeof BigInt!="undefined",Jse=typeof Symbol!="undefined",so=h0(Object.prototype.toString),sJe=h0(Number.prototype.valueOf),oJe=h0(String.prototype.valueOf),aJe=h0(Boolean.prototype.valueOf);Zse&&(eoe=h0(BigInt.prototype.valueOf));var eoe;Jse&&(toe=h0(Symbol.prototype.valueOf));var toe;function xb(r,e){if(typeof r!="object")return!1;try{return e(r),!0}catch(t){return!1}}Et.isArgumentsObject=iJe;Et.isGeneratorFunction=nJe;Et.isTypedArray=Qse;function cJe(r){return typeof Promise!="undefined"&&r instanceof Promise||r!==null&&typeof r=="object"&&typeof r.then=="function"&&typeof r.catch=="function"}Et.isPromise=cJe;function uJe(r){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(r):Qse(r)||ioe(r)}Et.isArrayBufferView=uJe;function lJe(r){return ea(r)==="Uint8Array"}Et.isUint8Array=lJe;function fJe(r){return ea(r)==="Uint8ClampedArray"}Et.isUint8ClampedArray=fJe;function dJe(r){return ea(r)==="Uint16Array"}Et.isUint16Array=dJe;function hJe(r){return ea(r)==="Uint32Array"}Et.isUint32Array=hJe;function pJe(r){return ea(r)==="Int8Array"}Et.isInt8Array=pJe;function yJe(r){return ea(r)==="Int16Array"}Et.isInt16Array=yJe;function gJe(r){return ea(r)==="Int32Array"}Et.isInt32Array=gJe;function mJe(r){return ea(r)==="Float32Array"}Et.isFloat32Array=mJe;function bJe(r){return ea(r)==="Float64Array"}Et.isFloat64Array=bJe;function vJe(r){return ea(r)==="BigInt64Array"}Et.isBigInt64Array=vJe;function wJe(r){return ea(r)==="BigUint64Array"}Et.isBigUint64Array=wJe;function SE(r){return so(r)==="[object Map]"}SE.working=typeof Map!="undefined"&&SE(new Map);function _Je(r){return typeof Map=="undefined"?!1:SE.working?SE(r):r instanceof Map}Et.isMap=_Je;function xE(r){return so(r)==="[object Set]"}xE.working=typeof Set!="undefined"&&xE(new Set);function EJe(r){return typeof Set=="undefined"?!1:xE.working?xE(r):r instanceof Set}Et.isSet=EJe;function AE(r){return so(r)==="[object WeakMap]"}AE.working=typeof WeakMap!="undefined"&&AE(new WeakMap);function SJe(r){return typeof WeakMap=="undefined"?!1:AE.working?AE(r):r instanceof WeakMap}Et.isWeakMap=SJe;function e8(r){return so(r)==="[object WeakSet]"}e8.working=typeof WeakSet!="undefined"&&e8(new WeakSet);function xJe(r){return e8(r)}Et.isWeakSet=xJe;function IE(r){return so(r)==="[object ArrayBuffer]"}IE.working=typeof ArrayBuffer!="undefined"&&IE(new ArrayBuffer);function roe(r){return typeof ArrayBuffer=="undefined"?!1:IE.working?IE(r):r instanceof ArrayBuffer}Et.isArrayBuffer=roe;function TE(r){return so(r)==="[object DataView]"}TE.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&TE(new DataView(new ArrayBuffer(1),0,1));function ioe(r){return typeof DataView=="undefined"?!1:TE.working?TE(r):r instanceof DataView}Et.isDataView=ioe;var t8=typeof SharedArrayBuffer!="undefined"?SharedArrayBuffer:void 0;function Ab(r){return so(r)==="[object SharedArrayBuffer]"}function noe(r){return typeof t8=="undefined"?!1:(typeof Ab.working=="undefined"&&(Ab.working=Ab(new t8)),Ab.working?Ab(r):r instanceof t8)}Et.isSharedArrayBuffer=noe;function AJe(r){return so(r)==="[object AsyncFunction]"}Et.isAsyncFunction=AJe;function IJe(r){return so(r)==="[object Map Iterator]"}Et.isMapIterator=IJe;function TJe(r){return so(r)==="[object Set Iterator]"}Et.isSetIterator=TJe;function RJe(r){return so(r)==="[object Generator]"}Et.isGeneratorObject=RJe;function CJe(r){return so(r)==="[object WebAssembly.Module]"}Et.isWebAssemblyCompiledModule=CJe;function soe(r){return xb(r,sJe)}Et.isNumberObject=soe;function ooe(r){return xb(r,oJe)}Et.isStringObject=ooe;function aoe(r){return xb(r,aJe)}Et.isBooleanObject=aoe;function coe(r){return Zse&&xb(r,eoe)}Et.isBigIntObject=coe;function uoe(r){return Jse&&xb(r,toe)}Et.isSymbolObject=uoe;function PJe(r){return soe(r)||ooe(r)||aoe(r)||coe(r)||uoe(r)}Et.isBoxedPrimitive=PJe;function OJe(r){return typeof Uint8Array!="undefined"&&(roe(r)||noe(r))}Et.isAnyArrayBuffer=OJe;["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(r){Object.defineProperty(Et,r,{enumerable:!1,value:function(){throw new Error(r+" is not supported in userland")}})})});var doe=y((KNt,foe)=>{f();foe.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var boe=y(St=>{f();var hoe=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},kJe=/%[sdj%]/g;St.format=function(r){if(!kE(r)){for(var e=[],t=0;t<arguments.length;t++)e.push(Pl(arguments[t]));return e.join(" ")}for(var t=1,i=arguments,n=i.length,s=String(r).replace(kJe,function(a){if(a==="%%")return"%";if(t>=n)return a;switch(a){case"%s":return String(i[t++]);case"%d":return Number(i[t++]);case"%j":try{return JSON.stringify(i[t++])}catch(c){return"[Circular]"}default:return a}}),o=i[t];t<n;o=i[++t])OE(o)||!p0(o)?s+=" "+o:s+=" "+Pl(o);return s};St.deprecate=function(r,e){if(typeof process!="undefined"&&process.noDeprecation===!0)return r;if(typeof process=="undefined")return function(){return St.deprecate(r,e).apply(this,arguments)};var t=!1;function i(){if(!t){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),t=!0}return r.apply(this,arguments)}return i};var RE={},poe=/^$/;process.env.NODE_DEBUG&&(CE=process.env.NODE_DEBUG,CE=CE.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),poe=new RegExp("^"+CE+"$","i"));var CE;St.debuglog=function(r){if(r=r.toUpperCase(),!RE[r])if(poe.test(r)){var e=process.pid;RE[r]=function(){var t=St.format.apply(St,arguments);console.error("%s %d: %s",r,e,t)}}else RE[r]=function(){};return RE[r]};function Pl(r,e){var t={seen:[],stylize:NJe};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),n8(e)?t.showHidden=e:e&&St._extend(t,e),vd(t.showHidden)&&(t.showHidden=!1),vd(t.depth)&&(t.depth=2),vd(t.colors)&&(t.colors=!1),vd(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=qJe),PE(t,r,t.depth)}St.inspect=Pl;Pl.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Pl.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function qJe(r,e){var t=Pl.styles[e];return t?"["+Pl.colors[t][0]+"m"+r+"["+Pl.colors[t][1]+"m":r}function NJe(r,e){return r}function DJe(r){var e={};return r.forEach(function(t,i){e[t]=!0}),e}function PE(r,e,t){if(r.customInspect&&e&&NE(e.inspect)&&e.inspect!==St.inspect&&!(e.constructor&&e.constructor.prototype===e)){var i=e.inspect(t,r);return kE(i)||(i=PE(r,i,t)),i}var n=BJe(r,e);if(n)return n;var s=Object.keys(e),o=DJe(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),Tb(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return r8(e);if(s.length===0){if(NE(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(Ib(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(qE(e))return r.stylize(Date.prototype.toString.call(e),"date");if(Tb(e))return r8(e)}var c="",u=!1,l=["{","}"];if(yoe(e)&&(u=!0,l=["[","]"]),NE(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if(Ib(e)&&(c=" "+RegExp.prototype.toString.call(e)),qE(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Tb(e)&&(c=" "+r8(e)),s.length===0&&(!u||e.length==0))return l[0]+c+l[1];if(t<0)return Ib(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var h;return u?h=MJe(r,e,t,o,s):h=s.map(function(p){return i8(r,e,t,o,p,u)}),r.seen.pop(),LJe(h,c,l)}function BJe(r,e){if(vd(e))return r.stylize("undefined","undefined");if(kE(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(goe(e))return r.stylize(""+e,"number");if(n8(e))return r.stylize(""+e,"boolean");if(OE(e))return r.stylize("null","null")}function r8(r){return"["+Error.prototype.toString.call(r)+"]"}function MJe(r,e,t,i,n){for(var s=[],o=0,a=e.length;o<a;++o)moe(e,String(o))?s.push(i8(r,e,t,i,String(o),!0)):s.push("");return n.forEach(function(c){c.match(/^\d+$/)||s.push(i8(r,e,t,i,c,!0))}),s}function i8(r,e,t,i,n,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),moe(i,n)||(o="["+n+"]"),a||(r.seen.indexOf(c.value)<0?(OE(t)?a=PE(r,c.value,null):a=PE(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=r.stylize("[Circular]","special")),vd(o)){if(s&&n.match(/^\d+$/))return a;o=JSON.stringify(""+n),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function LJe(r,e,t){var i=0,n=r.reduce(function(s,o){return i++,o.indexOf(`
`)>=0&&i++,s+o.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}St.types=loe();function yoe(r){return Array.isArray(r)}St.isArray=yoe;function n8(r){return typeof r=="boolean"}St.isBoolean=n8;function OE(r){return r===null}St.isNull=OE;function UJe(r){return r==null}St.isNullOrUndefined=UJe;function goe(r){return typeof r=="number"}St.isNumber=goe;function kE(r){return typeof r=="string"}St.isString=kE;function FJe(r){return typeof r=="symbol"}St.isSymbol=FJe;function vd(r){return r===void 0}St.isUndefined=vd;function Ib(r){return p0(r)&&s8(r)==="[object RegExp]"}St.isRegExp=Ib;St.types.isRegExp=Ib;function p0(r){return typeof r=="object"&&r!==null}St.isObject=p0;function qE(r){return p0(r)&&s8(r)==="[object Date]"}St.isDate=qE;St.types.isDate=qE;function Tb(r){return p0(r)&&(s8(r)==="[object Error]"||r instanceof Error)}St.isError=Tb;St.types.isNativeError=Tb;function NE(r){return typeof r=="function"}St.isFunction=NE;function KJe(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r=="undefined"}St.isPrimitive=KJe;St.isBuffer=doe();function s8(r){return Object.prototype.toString.call(r)}function o8(r){return r<10?"0"+r.toString(10):r.toString(10)}var jJe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function VJe(){var r=new Date,e=[o8(r.getHours()),o8(r.getMinutes()),o8(r.getSeconds())].join(":");return[r.getDate(),jJe[r.getMonth()],e].join(" ")}St.log=function(){console.log("%s - %s",VJe(),St.format.apply(St,arguments))};St.inherits=Gi();St._extend=function(r,e){if(!e||!p0(e))return r;for(var t=Object.keys(e),i=t.length;i--;)r[t[i]]=e[t[i]];return r};function moe(r,e){return Object.prototype.hasOwnProperty.call(r,e)}var wd=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;St.promisify=function(e){if(typeof e!="function")throw new TypeError('The "original" argument must be of type Function');if(wd&&e[wd]){var t=e[wd];if(typeof t!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,wd,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var i,n,s=new Promise(function(c,u){i=c,n=u}),o=[],a=0;a<arguments.length;a++)o.push(arguments[a]);o.push(function(c,u){c?n(c):i(u)});try{e.apply(this,o)}catch(c){n(c)}return s}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),wd&&Object.defineProperty(t,wd,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,hoe(e))};St.promisify.custom=wd;function zJe(r,e){if(!r){var t=new Error("Promise was rejected with a falsy value");t.reason=r,r=t}return e(r)}function HJe(r){if(typeof r!="function")throw new TypeError('The "original" argument must be of type Function');function e(){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i]);var n=t.pop();if(typeof n!="function")throw new TypeError("The last argument must be of type Function");var s=this,o=function(){return n.apply(s,arguments)};r.apply(this,t).then(function(a){process.nextTick(o.bind(null,null,a))},function(a){process.nextTick(zJe.bind(null,a,o))})}return Object.setPrototypeOf(e,Object.getPrototypeOf(r)),Object.defineProperties(e,hoe(r)),e}St.callbackify=HJe});var a8=y((VNt,voe)=>{f();"use strict";voe.exports=function(...e){let t=e.reduce((i,n)=>Object.assign(i,n),{});return Object.assign(t,{bufferKeys:t.bufferKeys||!1,snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,openCallback:t.openCallback||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:t.encodings||!1,additionalMethods:Object.assign({},t.additionalMethods)})}});var c8=y((zNt,woe)=>{f();woe.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var DE=y((HNt,Eoe)=>{f();var _oe;Eoe.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window!="undefined"?window:globalThis):r=>(_oe||(_oe=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var BE=y(($Nt,xoe)=>{f();"use strict";var Soe=DE();xoe.exports=function(r,...e){e.length===0?Soe(r):Soe(()=>r(...e))}});var u8=y((GNt,Aoe)=>{f();"use strict";function Ol(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._ended=!1,this._nexting=!1}Ol.prototype.next=function(r){if(typeof r!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(r,new Error("cannot call next() after end()")),this):this._nexting?(this._nextTick(r,new Error("cannot call next() before previous next() has completed")),this):(this._nexting=!0,this._next((e,...t)=>{this._nexting=!1,r(e,...t)}),this)};Ol.prototype._next=function(r){this._nextTick(r)};Ol.prototype.seek=function(r){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");r=this.db._serializeKey(r),this._seek(r)};Ol.prototype._seek=function(r){};Ol.prototype.end=function(r){if(typeof r!="function")throw new Error("end() requires a callback argument");if(this._ended)return this._nextTick(r,new Error("end() already called on iterator"));this._ended=!0,this._end(r)};Ol.prototype._end=function(r){this._nextTick(r)};Ol.prototype._nextTick=BE();Aoe.exports=Ol});var l8=y((WNt,Toe)=>{f();"use strict";var Ioe=Object.freeze({});function ta(r){if(typeof r!="object"||r===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=r,this._operations=[],this._written=!1}ta.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};ta.prototype.put=function(r,e,t){this._checkWritten();let i=this.db._checkKey(r)||this.db._checkValue(e);if(i)throw i;return r=this.db._serializeKey(r),e=this.db._serializeValue(e),this._put(r,e,t??Ioe),this};ta.prototype._put=function(r,e,t){this._operations.push({...t,type:"put",key:r,value:e})};ta.prototype.del=function(r,e){this._checkWritten();let t=this.db._checkKey(r);if(t)throw t;return r=this.db._serializeKey(r),this._del(r,e??Ioe),this};ta.prototype._del=function(r,e){this._operations.push({...e,type:"del",key:r})};ta.prototype.clear=function(){return this._checkWritten(),this._clear(),this};ta.prototype._clear=function(){this._operations=[]};ta.prototype.write=function(r,e){if(this._checkWritten(),typeof r=="function"&&(e=r),typeof e!="function")throw new Error("write() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),this._written=!0,this._write(r,e)};ta.prototype._write=function(r,e){this.db._batch(this._operations,r,e)};ta.prototype._nextTick=BE();Toe.exports=ta});var Poe=y((YNt,Coe)=>{f();"use strict";var $Je=a8(),GJe=c8(),WJe=u8(),YJe=l8(),XJe=Object.prototype.hasOwnProperty,QJe=["lt","lte","gt","gte"];function wr(r){this.status="new",this.supports=$Je(r,{status:!0})}wr.prototype.open=function(r,e){let t=this.status;if(typeof r=="function"&&(e=r),typeof e!="function")throw new Error("open() requires a callback argument");(typeof r!="object"||r===null)&&(r={}),r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists,this.status="opening",this._open(r,i=>{if(i)return this.status=t,e(i);this.status="open",e()})};wr.prototype._open=function(r,e){this._nextTick(e)};wr.prototype.close=function(r){let e=this.status;if(typeof r!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(t=>{if(t)return this.status=e,r(t);this.status="closed",r()})};wr.prototype._close=function(r){this._nextTick(r)};wr.prototype.get=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("get() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(r,e,t)};wr.prototype._get=function(r,e,t){this._nextTick(function(){t(new Error("NotFound"))})};wr.prototype.put=function(r,e,t,i){if(typeof t=="function"&&(i=t),typeof i!="function")throw new Error("put() requires a callback argument");let n=this._checkKey(r)||this._checkValue(e);if(n)return this._nextTick(i,n);r=this._serializeKey(r),e=this._serializeValue(e),(typeof t!="object"||t===null)&&(t={}),this._put(r,e,t,i)};wr.prototype._put=function(r,e,t,i){this._nextTick(i)};wr.prototype.del=function(r,e,t){if(typeof e=="function"&&(t=e),typeof t!="function")throw new Error("del() requires a callback argument");let i=this._checkKey(r);if(i)return this._nextTick(t,i);r=this._serializeKey(r),(typeof e!="object"||e===null)&&(e={}),this._del(r,e,t)};wr.prototype._del=function(r,e,t){this._nextTick(t)};wr.prototype.batch=function(r,e,t){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(t=e),typeof r=="function"&&(t=r),typeof t!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(r))return this._nextTick(t,new Error("batch(array) requires an array argument"));if(r.length===0)return this._nextTick(t);(typeof e!="object"||e===null)&&(e={});let i=new Array(r.length);for(let n=0;n<r.length;n++){if(typeof r[n]!="object"||r[n]===null)return this._nextTick(t,new Error("batch(array) element must be an object and not `null`"));let s=Object.assign({},r[n]);if(s.type!=="put"&&s.type!=="del")return this._nextTick(t,new Error("`type` must be 'put' or 'del'"));let o=this._checkKey(s.key);if(o)return this._nextTick(t,o);if(s.key=this._serializeKey(s.key),s.type==="put"){let a=this._checkValue(s.value);if(a)return this._nextTick(t,a);s.value=this._serializeValue(s.value)}i[n]=s}this._batch(i,e,t)};wr.prototype._batch=function(r,e,t){this._nextTick(t)};wr.prototype.clear=function(r,e){if(typeof r=="function")e=r;else if(typeof e!="function")throw new Error("clear() requires a callback argument");r=Roe(this,r),r.reverse=!!r.reverse,r.limit="limit"in r?r.limit:-1,this._clear(r,e)};wr.prototype._clear=function(r,e){r.keys=!0,r.values=!1,r.keyAsBuffer=!0,r.valueAsBuffer=!0;let t=this._iterator(r),i={},n=s=>{if(s)return t.end(function(){e(s)});t.next((o,a)=>{if(o)return n(o);if(a===void 0)return t.end(e);this._del(a,i,n)})};n()};wr.prototype._setupIteratorOptions=function(r){return r=Roe(this,r),r.reverse=!!r.reverse,r.keys=r.keys!==!1,r.values=r.values!==!1,r.limit="limit"in r?r.limit:-1,r.keyAsBuffer=r.keyAsBuffer!==!1,r.valueAsBuffer=r.valueAsBuffer!==!1,r};function Roe(r,e){let t={};for(let i in e){if(!XJe.call(e,i))continue;if(i==="start"||i==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let n=e[i];ZJe(i)&&(n=r._serializeKey(n)),t[i]=n}return t}function ZJe(r){return QJe.indexOf(r)!==-1}wr.prototype.iterator=function(r){return(typeof r!="object"||r===null)&&(r={}),r=this._setupIteratorOptions(r),this._iterator(r)};wr.prototype._iterator=function(r){return new WJe(this)};wr.prototype._chainedBatch=function(){return new YJe(this)};wr.prototype._serializeKey=function(r){return r};wr.prototype._serializeValue=function(r){return r};wr.prototype._checkKey=function(r){if(r==null)return new Error("key cannot be `null` or `undefined`");if(GJe(r)&&r.length===0)return new Error("key cannot be an empty Buffer");if(r==="")return new Error("key cannot be an empty String");if(Array.isArray(r)&&r.length===0)return new Error("key cannot be an empty Array")};wr.prototype._checkValue=function(r){if(r==null)return new Error("value cannot be `null` or `undefined`")};wr.prototype._nextTick=BE();Coe.exports=wr});var kl=y(ME=>{f();"use strict";ME.AbstractLevelDOWN=Poe();ME.AbstractIterator=u8();ME.AbstractChainedBatch=l8()});var qoe=y((QNt,koe)=>{f();"use strict";var Ooe=kl().AbstractIterator,JJe=Gi();function y0(r,e){Ooe.call(this,r),this._options=e,this._iterator=null,this._operations=[]}JJe(y0,Ooe);y0.prototype.setDb=function(r){let e=this._iterator=r.iterator(this._options);for(let t of this._operations)e[t.method](...t.args)};y0.prototype._operation=function(r,e){if(this._iterator)return this._iterator[r](...e);this._operations.push({method:r,args:e})};for(let r of["next","end"])y0.prototype["_"+r]=function(...e){this._operation(r,e)};y0.prototype.seek=function(...r){this._operation("seek",r)};koe.exports=y0});var Loe=y((ZNt,f8)=>{f();"use strict";var Noe=kl().AbstractLevelDOWN,eet=Gi(),Doe=qoe(),Boe="put get del batch clear".split(" "),tet="approximateSize compactRange".split(" ");function _d(r){Noe.call(this,r.supports||{});for(let e of tet)typeof r[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this._db=r,this._operations=[],Moe(this)}eet(_d,Noe);_d.prototype.type="deferred-leveldown";_d.prototype._open=function(r,e){this._db.open(r,t=>{if(t)return e(t);for(let i of this._operations)i.iterator?i.iterator.setDb(this._db):this._db[i.method](...i.args);this._operations=[],ret(this),e()})};_d.prototype._close=function(r){this._db.close(e=>{if(e)return r(e);Moe(this),r()})};function ret(r){for(let e of Boe.concat("iterator"))r["_"+e]=function(...t){return this._db[e](...t)};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){return this._db[e](...t)}}function Moe(r){for(let e of Boe)r["_"+e]=function(...t){this._operations.push({method:e,args:t})};for(let e of Object.keys(r.supports.additionalMethods))r[e]=function(...t){this._operations.push({method:e,args:t})};r._iterator=function(e){let t=new Doe(r,e);return this._operations.push({iterator:t}),t}}_d.prototype._serializeKey=function(r){return r};_d.prototype._serializeValue=function(r){return r};f8.exports=_d;f8.exports.DeferredIterator=Doe});var d8=y((JNt,Uoe)=>{f();Uoe.exports=yr().EventEmitter});var h8=y(()=>{f()});var Voe=y((rDt,joe)=>{f();"use strict";function Foe(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);e&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),t.push.apply(t,i)}return t}function iet(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Foe(Object(t),!0).forEach(function(i){net(r,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Foe(Object(t)).forEach(function(i){Object.defineProperty(r,i,Object.getOwnPropertyDescriptor(t,i))})}return r}function net(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function set(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Koe(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function oet(r,e,t){return e&&Koe(r.prototype,e),t&&Koe(r,t),r}var aet=Vt(),LE=aet.Buffer,cet=h8(),p8=cet.inspect,uet=p8&&p8.custom||"inspect";function fet(r,e,t){LE.prototype.copy.call(r,e,t)}joe.exports=function(){function r(){set(this,r),this.head=null,this.tail=null,this.length=0}return oet(r,[{key:"push",value:function(t){var i={data:t,next:null};this.length>0?this.tail.next=i:this.head=i,this.tail=i,++this.length}},{key:"unshift",value:function(t){var i={data:t,next:this.head};this.length===0&&(this.tail=i),this.head=i,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var i=this.head,n=""+i.data;i=i.next;)n+=t+i.data;return n}},{key:"concat",value:function(t){if(this.length===0)return LE.alloc(0);for(var i=LE.allocUnsafe(t>>>0),n=this.head,s=0;n;)fet(n.data,i,s),s+=n.data.length,n=n.next;return i}},{key:"consume",value:function(t,i){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=i?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var i=this.head,n=1,s=i.data;for(t-=s.length;i=i.next;){var o=i.data,a=t>o.length?o.length:t;if(a===o.length?s+=o:s+=o.slice(0,t),t-=a,t===0){a===o.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=o.slice(a));break}++n}return this.length-=n,s}},{key:"_getBuffer",value:function(t){var i=LE.allocUnsafe(t),n=this.head,s=1;for(n.data.copy(i),t-=n.data.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(o.copy(i,i.length-t,0,a),t-=a,t===0){a===o.length?(++s,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=o.slice(a));break}++s}return this.length-=s,i}},{key:uet,value:function(t,i){return p8(this,iet({},i,{depth:0,customInspect:!1}))}}]),r}()});var g8=y((iDt,Hoe)=>{f();"use strict";function det(r,e){var t=this,i=this._readableState&&this._readableState.destroyed,n=this._writableState&&this._writableState.destroyed;return i||n?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(y8,this,r)):process.nextTick(y8,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(s){!e&&s?t._writableState?t._writableState.errorEmitted?process.nextTick(UE,t):(t._writableState.errorEmitted=!0,process.nextTick(zoe,t,s)):process.nextTick(zoe,t,s):e?(process.nextTick(UE,t),e(s)):process.nextTick(UE,t)}),this)}function zoe(r,e){y8(r,e),UE(r)}function UE(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function het(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function y8(r,e){r.emit("error",e)}function pet(r,e){var t=r._readableState,i=r._writableState;t&&t.autoDestroy||i&&i.autoDestroy?r.destroy(e):r.emit("error",e)}Hoe.exports={destroy:det,undestroy:het,errorOrDestroy:pet}});var Ed=y((nDt,Woe)=>{f();"use strict";function yet(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var $oe={};function oo(r,e,t){t||(t=Error);function i(s,o,a){return typeof e=="string"?e:e(s,o,a)}var n=function(s){yet(o,s);function o(a,c,u){return s.call(this,i(a,c,u))||this}return o}(t);n.prototype.name=t.name,n.prototype.code=r,$oe[r]=n}function Goe(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(i){return String(i)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function get(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function met(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function bet(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}oo("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);oo("ERR_INVALID_ARG_TYPE",function(r,e,t){var i;typeof e=="string"&&get(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var n;if(met(r," argument"))n="The ".concat(r," ").concat(i," ").concat(Goe(e,"type"));else{var s=bet(r,".")?"property":"argument";n='The "'.concat(r,'" ').concat(s," ").concat(i," ").concat(Goe(e,"type"))}return n+=". Received type ".concat(typeof t),n},TypeError);oo("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");oo("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});oo("ERR_STREAM_PREMATURE_CLOSE","Premature close");oo("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});oo("ERR_MULTIPLE_CALLBACK","Callback called multiple times");oo("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");oo("ERR_STREAM_WRITE_AFTER_END","write after end");oo("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);oo("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);oo("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Woe.exports.codes=$oe});var m8=y((sDt,Yoe)=>{f();"use strict";var vet=Ed().codes.ERR_INVALID_OPT_VALUE;function wet(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function _et(r,e,t,i){var n=wet(e,i,t);if(n!=null){if(!(isFinite(n)&&Math.floor(n)===n)||n<0){var s=i?t:"highWaterMark";throw new vet(s,n)}return Math.floor(n)}return r.objectMode?16:16*1024}Yoe.exports={getHighWaterMark:_et}});var Qoe=y((oDt,Xoe)=>{f();Xoe.exports=Eet;function Eet(r,e){if(b8("noDeprecation"))return r;var t=!1;function i(){if(!t){if(b8("throwDeprecation"))throw new Error(e);b8("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return i}function b8(r){try{if(!globalThis.localStorage)return!1}catch(t){return!1}var e=globalThis.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}});var _8=y((aDt,iae)=>{f();"use strict";iae.exports=Vr;function Zoe(r){var e=this;this.next=null,this.entry=null,this.finish=function(){Xet(e,r)}}var g0;Vr.WritableState=Rb;var xet={deprecate:Qoe()},Joe=d8(),FE=Vt().Buffer,Aet=globalThis.Uint8Array||function(){};function Iet(r){return FE.from(r)}function Tet(r){return FE.isBuffer(r)||r instanceof Aet}var v8=g8(),Ret=m8(),Cet=Ret.getHighWaterMark,ql=Ed().codes,Pet=ql.ERR_INVALID_ARG_TYPE,Oet=ql.ERR_METHOD_NOT_IMPLEMENTED,ket=ql.ERR_MULTIPLE_CALLBACK,qet=ql.ERR_STREAM_CANNOT_PIPE,Net=ql.ERR_STREAM_DESTROYED,Det=ql.ERR_STREAM_NULL_VALUES,Bet=ql.ERR_STREAM_WRITE_AFTER_END,Met=ql.ERR_UNKNOWN_ENCODING,m0=v8.errorOrDestroy;Gi()(Vr,Joe);function Let(){}function Rb(r,e,t){g0=g0||Sd(),r=r||{},typeof t!="boolean"&&(t=e instanceof g0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.writableObjectMode),this.highWaterMark=Cet(this,r,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var i=r.decodeStrings===!1;this.decodeStrings=!i,this.defaultEncoding=r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(n){Het(e,n)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Zoe(this)}Rb.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t};(function(){try{Object.defineProperty(Rb.prototype,"buffer",{get:xet.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(r){}})();var KE;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(KE=Function.prototype[Symbol.hasInstance],Object.defineProperty(Vr,Symbol.hasInstance,{value:function(e){return KE.call(this,e)?!0:this!==Vr?!1:e&&e._writableState instanceof Rb}})):KE=function(e){return e instanceof this};function Vr(r){g0=g0||Sd();var e=this instanceof g0;if(!e&&!KE.call(Vr,this))return new Vr(r);this._writableState=new Rb(r,this,e),this.writable=!0,r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final)),Joe.call(this)}Vr.prototype.pipe=function(){m0(this,new qet)};function Uet(r,e){var t=new Bet;m0(r,t),process.nextTick(e,t)}function Fet(r,e,t,i){var n;return t===null?n=new Det:typeof t!="string"&&!e.objectMode&&(n=new Pet("chunk",["string","Buffer"],t)),n?(m0(r,n),process.nextTick(i,n),!1):!0}Vr.prototype.write=function(r,e,t){var i=this._writableState,n=!1,s=!i.objectMode&&Tet(r);return s&&!FE.isBuffer(r)&&(r=Iet(r)),typeof e=="function"&&(t=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),typeof t!="function"&&(t=Let),i.ending?Uet(this,t):(s||Fet(this,i,r,t))&&(i.pendingcb++,n=jet(this,i,s,r,e,t)),n};Vr.prototype.cork=function(){this._writableState.corked++};Vr.prototype.uncork=function(){var r=this._writableState;r.corked&&(r.corked--,!r.writing&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&tae(this,r))};Vr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new Met(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Vr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function Ket(r,e,t){return!r.objectMode&&r.decodeStrings!==!1&&typeof e=="string"&&(e=FE.from(e,t)),e}Object.defineProperty(Vr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function jet(r,e,t,i,n,s){if(!t){var o=Ket(e,i,n);i!==o&&(t=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var c=e.length<e.highWaterMark;if(c||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:s,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else w8(r,e,!1,a,i,n,s);return c}function w8(r,e,t,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new Net("write")):t?r._writev(n,e.onwrite):r._write(n,s,e.onwrite),e.sync=!1}function Vet(r,e,t,i,n){--e.pendingcb,t?(process.nextTick(n,i),process.nextTick(Cb,r,e),r._writableState.errorEmitted=!0,m0(r,i)):(n(i),r._writableState.errorEmitted=!0,m0(r,i),Cb(r,e))}function zet(r){r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0}function Het(r,e){var t=r._writableState,i=t.sync,n=t.writecb;if(typeof n!="function")throw new ket;if(zet(t),e)Vet(r,t,i,e,n);else{var s=rae(t)||r.destroyed;!s&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&tae(r,t),i?process.nextTick(eae,r,t,s,n):eae(r,t,s,n)}}function eae(r,e,t,i){t||$et(r,e),e.pendingcb--,i(),Cb(r,e)}function $et(r,e){e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"))}function tae(r,e){e.bufferProcessing=!0;var t=e.bufferedRequest;if(r._writev&&t&&t.next){var i=e.bufferedRequestCount,n=new Array(i),s=e.corkedRequestsFree;s.entry=t;for(var o=0,a=!0;t;)n[o]=t,t.isBuf||(a=!1),t=t.next,o+=1;n.allBuffers=a,w8(r,e,!0,e.length,n,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new Zoe(e),e.bufferedRequestCount=0}else{for(;t;){var c=t.chunk,u=t.encoding,l=t.callback,d=e.objectMode?1:c.length;if(w8(r,e,!1,d,c,u,l),t=t.next,e.bufferedRequestCount--,e.writing)break}t===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=t,e.bufferProcessing=!1}Vr.prototype._write=function(r,e,t){t(new Oet("_write()"))};Vr.prototype._writev=null;Vr.prototype.end=function(r,e,t){var i=this._writableState;return typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null),r!=null&&this.write(r,e),i.corked&&(i.corked=1,this.uncork()),i.ending||Yet(this,i,t),this};Object.defineProperty(Vr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function rae(r){return r.ending&&r.length===0&&r.bufferedRequest===null&&!r.finished&&!r.writing}function Get(r,e){r._final(function(t){e.pendingcb--,t&&m0(r,t),e.prefinished=!0,r.emit("prefinish"),Cb(r,e)})}function Wet(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(Get,r,e)):(e.prefinished=!0,r.emit("prefinish")))}function Cb(r,e){var t=rae(e);if(t&&(Wet(r,e),e.pendingcb===0&&(e.finished=!0,r.emit("finish"),e.autoDestroy))){var i=r._readableState;(!i||i.autoDestroy&&i.endEmitted)&&r.destroy()}return t}function Yet(r,e,t){e.ending=!0,Cb(r,e),t&&(e.finished?process.nextTick(t):r.once("finish",t)),e.ended=!0,r.writable=!1}function Xet(r,e,t){var i=r.entry;for(r.entry=null;i;){var n=i.callback;e.pendingcb--,n(t),i=i.next}e.corkedRequestsFree.next=r}Object.defineProperty(Vr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Vr.prototype.destroy=v8.destroy;Vr.prototype._undestroy=v8.undestroy;Vr.prototype._destroy=function(r,e){e(r)}});var Sd=y((cDt,sae)=>{f();"use strict";var Qet=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};sae.exports=ac;var nae=x8(),E8=_8();Gi()(ac,nae);for(S8=Qet(E8.prototype),jE=0;jE<S8.length;jE++)VE=S8[jE],ac.prototype[VE]||(ac.prototype[VE]=E8.prototype[VE]);var S8,VE,jE;function ac(r){if(!(this instanceof ac))return new ac(r);nae.call(this,r),E8.call(this,r),this.allowHalfOpen=!0,r&&(r.readable===!1&&(this.readable=!1),r.writable===!1&&(this.writable=!1),r.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",Zet)))}Object.defineProperty(ac.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(ac.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(ac.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Zet(){this._writableState.ended||process.nextTick(Jet,this)}function Jet(r){r.end()}Object.defineProperty(ac.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var I8=y((A8,aae)=>{f();var zE=Vt(),cc=zE.Buffer;function oae(r,e){for(var t in r)e[t]=r[t]}cc.from&&cc.alloc&&cc.allocUnsafe&&cc.allocUnsafeSlow?aae.exports=zE:(oae(zE,A8),A8.Buffer=xd);function xd(r,e,t){return cc(r,e,t)}xd.prototype=Object.create(cc.prototype);oae(cc,xd);xd.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return cc(r,e,t)};xd.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var i=cc(r);return e!==void 0?typeof t=="string"?i.fill(e,t):i.fill(e):i.fill(0),i};xd.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return cc(r)};xd.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return zE.SlowBuffer(r)}});var C8=y(uae=>{f();"use strict";var T8=I8().Buffer,cae=T8.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function ett(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function ttt(r){var e=ett(r);if(typeof e!="string"&&(T8.isEncoding===cae||!cae(r)))throw new Error("Unknown encoding: "+r);return e||r}uae.StringDecoder=Pb;function Pb(r){this.encoding=ttt(r);var e;switch(this.encoding){case"utf16le":this.text=att,this.end=ctt,e=4;break;case"utf8":this.fillLast=ntt,e=4;break;case"base64":this.text=utt,this.end=ltt,e=3;break;default:this.write=ftt,this.end=dtt;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=T8.allocUnsafe(e)}Pb.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Pb.prototype.end=ott;Pb.prototype.text=stt;Pb.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function R8(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function rtt(r,e,t){var i=e.length-1;if(i<t)return 0;var n=R8(e[i]);return n>=0?(n>0&&(r.lastNeed=n-1),n):--i<t||n===-2?0:(n=R8(e[i]),n>=0?(n>0&&(r.lastNeed=n-2),n):--i<t||n===-2?0:(n=R8(e[i]),n>=0?(n>0&&(n===2?n=0:r.lastNeed=n-3),n):0))}function itt(r,e,t){if((e[0]&192)!=128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!=128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!=128)return r.lastNeed=2,"\uFFFD"}}function ntt(r){var e=this.lastTotal-this.lastNeed,t=itt(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function stt(r,e){var t=rtt(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var i=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,i),r.toString("utf8",e,i)}function ott(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function att(r,e){if((r.length-e)%2==0){var t=r.toString("utf16le",e);if(t){var i=t.charCodeAt(t.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function ctt(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function utt(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function ltt(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function ftt(r){return r.toString(this.encoding)}function dtt(r){return r&&r.length?this.write(r):""}});var HE=y((lDt,dae)=>{f();"use strict";var lae=Ed().codes.ERR_STREAM_PREMATURE_CLOSE;function htt(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.apply(this,i)}}}function ptt(){}function ytt(r){return r.setHeader&&typeof r.abort=="function"}function fae(r,e,t){if(typeof e=="function")return fae(r,null,e);e||(e={}),t=htt(t||ptt);var i=e.readable||e.readable!==!1&&r.readable,n=e.writable||e.writable!==!1&&r.writable,s=function(){r.writable||a()},o=r._writableState&&r._writableState.finished,a=function(){n=!1,o=!0,i||t.call(r)},c=r._readableState&&r._readableState.endEmitted,u=function(){i=!1,c=!0,n||t.call(r)},l=function(g){t.call(r,g)},d=function(){var g;if(i&&!c)return(!r._readableState||!r._readableState.ended)&&(g=new lae),t.call(r,g);if(n&&!o)return(!r._writableState||!r._writableState.ended)&&(g=new lae),t.call(r,g)},h=function(){r.req.on("finish",a)};return ytt(r)?(r.on("complete",a),r.on("abort",d),r.req?h():r.on("request",h)):n&&!r._writableState&&(r.on("end",s),r.on("close",s)),r.on("end",u),r.on("finish",a),e.error!==!1&&r.on("error",l),r.on("close",d),function(){r.removeListener("complete",a),r.removeListener("abort",d),r.removeListener("request",h),r.req&&r.req.removeListener("finish",a),r.removeListener("end",s),r.removeListener("close",s),r.removeListener("finish",a),r.removeListener("end",u),r.removeListener("error",l),r.removeListener("close",d)}}dae.exports=fae});var pae=y((fDt,hae)=>{f();"use strict";var $E;function Nl(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var gtt=HE(),Dl=Symbol("lastResolve"),Ad=Symbol("lastReject"),Ob=Symbol("error"),GE=Symbol("ended"),Id=Symbol("lastPromise"),P8=Symbol("handlePromise"),Td=Symbol("stream");function Bl(r,e){return{value:r,done:e}}function mtt(r){var e=r[Dl];if(e!==null){var t=r[Td].read();t!==null&&(r[Id]=null,r[Dl]=null,r[Ad]=null,e(Bl(t,!1)))}}function btt(r){process.nextTick(mtt,r)}function vtt(r,e){return function(t,i){r.then(function(){if(e[GE]){t(Bl(void 0,!0));return}e[P8](t,i)},i)}}var wtt=Object.getPrototypeOf(function(){}),_tt=Object.setPrototypeOf(($E={get stream(){return this[Td]},next:function(){var e=this,t=this[Ob];if(t!==null)return Promise.reject(t);if(this[GE])return Promise.resolve(Bl(void 0,!0));if(this[Td].destroyed)return new Promise(function(o,a){process.nextTick(function(){e[Ob]?a(e[Ob]):o(Bl(void 0,!0))})});var i=this[Id],n;if(i)n=new Promise(vtt(i,this));else{var s=this[Td].read();if(s!==null)return Promise.resolve(Bl(s,!1));n=new Promise(this[P8])}return this[Id]=n,n}},Nl($E,Symbol.asyncIterator,function(){return this}),Nl($E,"return",function(){var e=this;return new Promise(function(t,i){e[Td].destroy(null,function(n){if(n){i(n);return}t(Bl(void 0,!0))})})}),$E),wtt),Ett=function(e){var t,i=Object.create(_tt,(t={},Nl(t,Td,{value:e,writable:!0}),Nl(t,Dl,{value:null,writable:!0}),Nl(t,Ad,{value:null,writable:!0}),Nl(t,Ob,{value:null,writable:!0}),Nl(t,GE,{value:e._readableState.endEmitted,writable:!0}),Nl(t,P8,{value:function(s,o){var a=i[Td].read();a?(i[Id]=null,i[Dl]=null,i[Ad]=null,s(Bl(a,!1))):(i[Dl]=s,i[Ad]=o)},writable:!0}),t));return i[Id]=null,gtt(e,function(n){if(n&&n.code!=="ERR_STREAM_PREMATURE_CLOSE"){var s=i[Ad];s!==null&&(i[Id]=null,i[Dl]=null,i[Ad]=null,s(n)),i[Ob]=n;return}var o=i[Dl];o!==null&&(i[Id]=null,i[Dl]=null,i[Ad]=null,o(Bl(void 0,!0))),i[GE]=!0}),e.on("readable",btt.bind(null,i)),i};hae.exports=Ett});var gae=y((dDt,yae)=>{f();yae.exports=function(){throw new Error("Readable.from is not available in the browser")}});var x8=y((pDt,Iae)=>{f();"use strict";Iae.exports=Nt;var b0;Nt.ReadableState=bae;var hDt=yr().EventEmitter,mae=function(e,t){return e.listeners(t).length},kb=d8(),WE=Vt().Buffer,Stt=globalThis.Uint8Array||function(){};function xtt(r){return WE.from(r)}function Att(r){return WE.isBuffer(r)||r instanceof Stt}var O8=h8(),mt;O8&&O8.debuglog?mt=O8.debuglog("stream"):mt=function(){};var Itt=Voe(),k8=g8(),Ttt=m8(),Rtt=Ttt.getHighWaterMark,YE=Ed().codes,Ctt=YE.ERR_INVALID_ARG_TYPE,Ptt=YE.ERR_STREAM_PUSH_AFTER_EOF,Ott=YE.ERR_METHOD_NOT_IMPLEMENTED,ktt=YE.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,v0,q8,N8;Gi()(Nt,kb);var qb=k8.errorOrDestroy,D8=["error","close","destroy","pause","resume"];function qtt(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):Array.isArray(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}function bae(r,e,t){b0=b0||Sd(),r=r||{},typeof t!="boolean"&&(t=e instanceof b0),this.objectMode=!!r.objectMode,t&&(this.objectMode=this.objectMode||!!r.readableObjectMode),this.highWaterMark=Rtt(this,r,"readableHighWaterMark",t),this.buffer=new Itt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=r.emitClose!==!1,this.autoDestroy=!!r.autoDestroy,this.destroyed=!1,this.defaultEncoding=r.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,r.encoding&&(v0||(v0=C8().StringDecoder),this.decoder=new v0(r.encoding),this.encoding=r.encoding)}function Nt(r){if(b0=b0||Sd(),!(this instanceof Nt))return new Nt(r);var e=this instanceof b0;this._readableState=new bae(r,this,e),this.readable=!0,r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy)),kb.call(this)}Object.defineProperty(Nt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Nt.prototype.destroy=k8.destroy;Nt.prototype._undestroy=k8.undestroy;Nt.prototype._destroy=function(r,e){e(r)};Nt.prototype.push=function(r,e){var t=this._readableState,i;return t.objectMode?i=!0:typeof r=="string"&&(e=e||t.defaultEncoding,e!==t.encoding&&(r=WE.from(r,e),e=""),i=!0),vae(this,r,e,!1,i)};Nt.prototype.unshift=function(r){return vae(this,r,null,!0,!1)};function vae(r,e,t,i,n){mt("readableAddChunk",e);var s=r._readableState;if(e===null)s.reading=!1,Btt(r,s);else{var o;if(n||(o=Ntt(s,e)),o)qb(r,o);else if(s.objectMode||e&&e.length>0)if(typeof e!="string"&&!s.objectMode&&Object.getPrototypeOf(e)!==WE.prototype&&(e=xtt(e)),i)s.endEmitted?qb(r,new ktt):B8(r,s,e,!0);else if(s.ended)qb(r,new Ptt);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!t?(e=s.decoder.write(e),s.objectMode||e.length!==0?B8(r,s,e,!1):M8(r,s)):B8(r,s,e,!1)}else i||(s.reading=!1,M8(r,s))}return!s.ended&&(s.length<s.highWaterMark||s.length===0)}function B8(r,e,t,i){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,i?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&XE(r)),M8(r,e)}function Ntt(r,e){var t;return!Att(e)&&typeof e!="string"&&e!==void 0&&!r.objectMode&&(t=new Ctt("chunk",["string","Buffer","Uint8Array"],e)),t}Nt.prototype.isPaused=function(){return this._readableState.flowing===!1};Nt.prototype.setEncoding=function(r){v0||(v0=C8().StringDecoder);var e=new v0(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var t=this._readableState.buffer.head,i="";t!==null;)i+=e.write(t.data),t=t.next;return this._readableState.buffer.clear(),i!==""&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var wae=1073741824;function Dtt(r){return r>=wae?r=wae:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r}function _ae(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:r!==r?e.flowing&&e.length?e.buffer.head.data.length:e.length:(r>e.highWaterMark&&(e.highWaterMark=Dtt(r)),r<=e.length?r:e.ended?e.length:(e.needReadable=!0,0))}Nt.prototype.read=function(r){mt("read",r),r=parseInt(r,10);var e=this._readableState,t=r;if(r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return mt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?U8(this):XE(this),null;if(r=_ae(r,e),r===0&&e.ended)return e.length===0&&U8(this),null;var i=e.needReadable;mt("need readable",i),(e.length===0||e.length-r<e.highWaterMark)&&(i=!0,mt("length less than watermark",i)),e.ended||e.reading?(i=!1,mt("reading or ended",i)):i&&(mt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(r=_ae(t,e)));var n;return r>0?n=xae(r,e):n=null,n===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&U8(this)),n!==null&&this.emit("data",n),n};function Btt(r,e){if(mt("onEofChunk"),!e.ended){if(e.decoder){var t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?XE(r):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,Eae(r)))}}function XE(r){var e=r._readableState;mt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(mt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(Eae,r))}function Eae(r){var e=r._readableState;mt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,L8(r)}function M8(r,e){e.readingMore||(e.readingMore=!0,process.nextTick(Mtt,r,e))}function Mtt(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var t=e.length;if(mt("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}Nt.prototype._read=function(r){qb(this,new Ott("_read()"))};Nt.prototype.pipe=function(r,e){var t=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1,mt("pipe count=%d opts=%j",i.pipesCount,e);var n=(!e||e.end!==!1)&&r!==process.stdout&&r!==process.stderr,s=n?a:b;i.endEmitted?process.nextTick(s):t.once("end",s),r.on("unpipe",o);function o(E,v){mt("onunpipe"),E===t&&v&&v.hasUnpiped===!1&&(v.hasUnpiped=!0,l())}function a(){mt("onend"),r.end()}var c=Ltt(t);r.on("drain",c);var u=!1;function l(){mt("cleanup"),r.removeListener("close",p),r.removeListener("finish",g),r.removeListener("drain",c),r.removeListener("error",h),r.removeListener("unpipe",o),t.removeListener("end",a),t.removeListener("end",b),t.removeListener("data",d),u=!0,i.awaitDrain&&(!r._writableState||r._writableState.needDrain)&&c()}t.on("data",d);function d(E){mt("ondata");var v=r.write(E);mt("dest.write",v),v===!1&&((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&Aae(i.pipes,r)!==-1)&&!u&&(mt("false write response, pause",i.awaitDrain),i.awaitDrain++),t.pause())}function h(E){mt("onerror",E),b(),r.removeListener("error",h),mae(r,"error")===0&&qb(r,E)}qtt(r,"error",h);function p(){r.removeListener("finish",g),b()}r.once("close",p);function g(){mt("onfinish"),r.removeListener("close",p),b()}r.once("finish",g);function b(){mt("unpipe"),t.unpipe(r)}return r.emit("pipe",t),i.flowing||(mt("pipe resume"),t.resume()),r};function Ltt(r){return function(){var t=r._readableState;mt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,t.awaitDrain===0&&mae(r,"data")&&(t.flowing=!0,L8(r))}}Nt.prototype.unpipe=function(r){var e=this._readableState,t={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return r&&r!==e.pipes?this:(r||(r=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,r&&r.emit("unpipe",this,t),this);if(!r){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=Aae(e.pipes,r);return o===-1?this:(e.pipes.splice(o,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),r.emit("unpipe",this,t),this)};Nt.prototype.on=function(r,e){var t=kb.prototype.on.call(this,r,e),i=this._readableState;return r==="data"?(i.readableListening=this.listenerCount("readable")>0,i.flowing!==!1&&this.resume()):r==="readable"&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,mt("on readable",i.length,i.reading),i.length?XE(this):i.reading||process.nextTick(Utt,this)),t};Nt.prototype.addListener=Nt.prototype.on;Nt.prototype.removeListener=function(r,e){var t=kb.prototype.removeListener.call(this,r,e);return r==="readable"&&process.nextTick(Sae,this),t};Nt.prototype.removeAllListeners=function(r){var e=kb.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&process.nextTick(Sae,this),e};function Sae(r){var e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:r.listenerCount("data")>0&&r.resume()}function Utt(r){mt("readable nexttick read 0"),r.read(0)}Nt.prototype.resume=function(){var r=this._readableState;return r.flowing||(mt("resume"),r.flowing=!r.readableListening,Ftt(this,r)),r.paused=!1,this};function Ftt(r,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(Ktt,r,e))}function Ktt(r,e){mt("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),L8(r),e.flowing&&!e.reading&&r.read(0)}Nt.prototype.pause=function(){return mt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(mt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function L8(r){var e=r._readableState;for(mt("flow",e.flowing);e.flowing&&r.read()!==null;);}Nt.prototype.wrap=function(r){var e=this,t=this._readableState,i=!1;r.on("end",function(){if(mt("wrapped end"),t.decoder&&!t.ended){var o=t.decoder.end();o&&o.length&&e.push(o)}e.push(null)}),r.on("data",function(o){if(mt("wrapped data"),t.decoder&&(o=t.decoder.write(o)),!(t.objectMode&&o==null)&&!(!t.objectMode&&(!o||!o.length))){var a=e.push(o);a||(i=!0,r.pause())}});for(var n in r)this[n]===void 0&&typeof r[n]=="function"&&(this[n]=function(a){return function(){return r[a].apply(r,arguments)}}(n));for(var s=0;s<D8.length;s++)r.on(D8[s],this.emit.bind(this,D8[s]));return this._read=function(o){mt("wrapped _read",o),i&&(i=!1,r.resume())},this};typeof Symbol=="function"&&(Nt.prototype[Symbol.asyncIterator]=function(){return q8===void 0&&(q8=pae()),q8(this)});Object.defineProperty(Nt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Nt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Nt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Nt._fromList=xae;Object.defineProperty(Nt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function xae(r,e){if(e.length===0)return null;var t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function U8(r){var e=r._readableState;mt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(jtt,e,r))}function jtt(r,e){if(mt("endReadableNT",r.endEmitted,r.length),!r.endEmitted&&r.length===0&&(r.endEmitted=!0,e.readable=!1,e.emit("end"),r.autoDestroy)){var t=e._writableState;(!t||t.autoDestroy&&t.finished)&&e.destroy()}}typeof Symbol=="function"&&(Nt.from=function(r,e){return N8===void 0&&(N8=gae()),N8(Nt,r,e)});function Aae(r,e){for(var t=0,i=r.length;t<i;t++)if(r[t]===e)return t;return-1}});var F8=y((yDt,Rae)=>{f();"use strict";Rae.exports=fu;var QE=Ed().codes,Vtt=QE.ERR_METHOD_NOT_IMPLEMENTED,ztt=QE.ERR_MULTIPLE_CALLBACK,Htt=QE.ERR_TRANSFORM_ALREADY_TRANSFORMING,$tt=QE.ERR_TRANSFORM_WITH_LENGTH_0,ZE=Sd();Gi()(fu,ZE);function Gtt(r,e){var t=this._transformState;t.transforming=!1;var i=t.writecb;if(i===null)return this.emit("error",new ztt);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),i(r);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function fu(r){if(!(this instanceof fu))return new fu(r);ZE.call(this,r),this._transformState={afterTransform:Gtt.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",Wtt)}function Wtt(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){Tae(r,e,t)}):Tae(this,null,null)}fu.prototype.push=function(r,e){return this._transformState.needTransform=!1,ZE.prototype.push.call(this,r,e)};fu.prototype._transform=function(r,e,t){t(new Vtt("_transform()"))};fu.prototype._write=function(r,e,t){var i=this._transformState;if(i.writecb=t,i.writechunk=r,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}};fu.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};fu.prototype._destroy=function(r,e){ZE.prototype._destroy.call(this,r,function(t){e(t)})};function Tae(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new $tt;if(r._transformState.transforming)throw new Htt;return r.push(null)}});var Oae=y((gDt,Pae)=>{f();"use strict";Pae.exports=Nb;var Cae=F8();Gi()(Nb,Cae);function Nb(r){if(!(this instanceof Nb))return new Nb(r);Cae.call(this,r)}Nb.prototype._transform=function(r,e,t){t(null,r)}});var Bae=y((mDt,Dae)=>{f();"use strict";var K8;function Ytt(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var kae=Ed().codes,Xtt=kae.ERR_MISSING_ARGS,Qtt=kae.ERR_STREAM_DESTROYED;function qae(r){if(r)throw r}function Ztt(r){return r.setHeader&&typeof r.abort=="function"}function Jtt(r,e,t,i){i=Ytt(i);var n=!1;r.on("close",function(){n=!0}),K8===void 0&&(K8=HE()),K8(r,{readable:e,writable:t},function(o){if(o)return i(o);n=!0,i()});var s=!1;return function(o){if(!n&&!s){if(s=!0,Ztt(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();i(o||new Qtt("pipe"))}}}function Nae(r){r()}function ert(r,e){return r.pipe(e)}function trt(r){return!r.length||typeof r[r.length-1]!="function"?qae:r.pop()}function rrt(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var i=trt(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Xtt("streams");var n,s=e.map(function(o,a){var c=a<e.length-1,u=a>0;return Jtt(o,c,u,function(l){n||(n=l),l&&s.forEach(Nae),!c&&(s.forEach(Nae),i(n))})});return e.reduce(ert)}Dae.exports=rrt});var j8=y((ao,Mae)=>{f();ao=Mae.exports=x8();ao.Stream=ao;ao.Readable=ao;ao.Writable=_8();ao.Duplex=Sd();ao.Transform=F8();ao.PassThrough=Oae();ao.finished=HE();ao.pipeline=Bae()});var Fae=y((bDt,Uae)=>{f();"use strict";var irt=Gi(),{Readable:Lae}=j8();Uae.exports=w0;irt(w0,Lae);function w0(r,e){if(!(this instanceof w0))return new w0(r,e);e=e||{},Lae.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=r,this._options=e,this.on("end",this.destroy.bind(this,null,null))}w0.prototype._read=function(){this.destroyed||this._iterator.next((r,e,t)=>{if(!this.destroyed){if(r)return this.destroy(r);e===void 0&&t===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(t):this.push({key:e,value:t})}})};w0.prototype._destroy=function(r,e){this._iterator.end(function(t){e(r||t)})}});var jae=y((Kae,JE)=>{f();(function(r,e,t){typeof JE!="undefined"&&JE.exports?JE.exports=t():e[r]=t()})("prr",Kae,function(){var r=typeof Object.defineProperty=="function"?function(i,n,s){return Object.defineProperty(i,n,s),i}:function(i,n,s){return i[n]=s.value,i},e=function(i,n){var s=typeof n=="object",o=!s&&typeof n=="string",a=function(c){return s?!!n[c]:o?n.indexOf(c[0])>-1:!1};return{enumerable:a("enumerable"),configurable:a("configurable"),writable:a("writable"),value:i}},t=function(i,n,s,o){var a;if(o=e(s,o),typeof n=="object"){for(a in n)Object.hasOwnProperty.call(n,a)&&(o.value=n[a],r(i,a,o));return i}return r(i,n,o)};return t})});var Hae=y((vDt,zae)=>{f();var nrt=jae();function Vae(r,e,t){!!e&&typeof e!="string"&&(e=e.message||e.name),nrt(this,{type:r,name:r,cause:typeof e!="string"?e:t,message:e},"ewr")}function V8(r,e){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),Vae.call(this,"CustomError",r,e)}V8.prototype=new Error;function srt(r,e,t){var i=function(n,s){Vae.call(this,e,n,s),e=="FilesystemError"&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(r.errno[this.cause.errno]?r.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,i)};return i.prototype=t?new t:new V8,i}zae.exports=function(r){var e=function(t,i){return srt(r,t,i)};return{CustomError:V8,FilesystemError:e("FilesystemError"),createError:e}}});var $ae=y((wDt,uc)=>{f();var ort=uc.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];uc.exports.errno={};uc.exports.code={};ort.forEach(function(r){uc.exports.errno[r.errno]=r,uc.exports.code[r.code]=r});uc.exports.custom=Hae()(uc.exports);uc.exports.create=uc.exports.custom.createError});var eS=y((_Dt,Gae)=>{f();"use strict";var Rd=$ae().create,Cd=Rd("LevelUPError"),z8=Rd("NotFoundError",Cd);z8.prototype.notFound=!0;z8.prototype.status=404;Gae.exports={LevelUPError:Cd,InitializationError:Rd("InitializationError",Cd),OpenError:Rd("OpenError",Cd),ReadError:Rd("ReadError",Cd),WriteError:Rd("WriteError",Cd),NotFoundError:z8,EncodingError:Rd("EncodingError",Cd)}});var $8=y(H8=>{f();"use strict";H8.fromCallback=function(r){if(r===void 0){var e=new Promise(function(t,i){r=function(n,s){n?i(n):t(s)}});r.promise=e}return r};H8.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){process.nextTick(e,null,t)}).catch(function(t){process.nextTick(e,t)})}});var Db=y(G8=>{f();"use strict";G8.getCallback=function(r,e){return typeof r=="function"?r:e};G8.getOptions=function(r){return typeof r=="object"&&r!==null?r:{}}});var Yae=y((xDt,Wae)=>{f();"use strict";var Bb=eS().WriteError,art=$8(),crt=Db().getCallback,urt=Db().getOptions;function Mb(r){this.db=r,this.batch=r.db.batch(),this.ops=[],this.length=0}Mb.prototype.put=function(r,e,t){try{this.batch.put(r,e,t)}catch(i){throw new Bb(i)}return this.ops.push({...t,type:"put",key:r,value:e}),this.length++,this};Mb.prototype.del=function(r,e){try{this.batch.del(r,e)}catch(t){throw new Bb(t)}return this.ops.push({...e,type:"del",key:r}),this.length++,this};Mb.prototype.clear=function(){try{this.batch.clear()}catch(r){throw new Bb(r)}return this.ops=[],this.length=0,this};Mb.prototype.write=function(r,e){let t=this.db,i=this.ops;e=crt(r,e),e=art.fromCallback(e),r=urt(r);try{this.batch.write(r,function(n){if(n)return e(new Bb(n));t.emit("batch",i),e()})}catch(n){throw new Bb(n)}return e.promise};Wae.exports=Mb});var Zae=y((ADt,Qae)=>{f();"use strict";var Xae=DE();Qae.exports=function(r,...e){e.length===0?Xae(r):Xae(()=>r(...e))}});var rce=y((IDt,tce)=>{f();"use strict";var tS=yr().EventEmitter,lrt=boe().inherits,Jae=Loe(),frt=Fae(),drt=Yae(),_0=eS(),hrt=a8(),Pd=$8(),Lb=Db().getCallback,E0=Db().getOptions,rS=Zae(),iS=_0.WriteError,ece=_0.ReadError,prt=_0.NotFoundError,yrt=_0.OpenError,grt=_0.InitializationError;function lr(r,e,t){if(!(this instanceof lr))return new lr(r,e,t);let i;if(tS.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(t=e,e={}),e=e||{},!r||typeof r!="object"){if(i=new grt("First argument must be an abstract-leveldown compliant store"),typeof t=="function")return rS(t,i);throw i}if(typeof r.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=E0(e),this._db=r,this.db=new Jae(r),this.open(t||(n=>{n&&this.emit("error",n)})),this.supports=hrt(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let n of Object.keys(this.supports.additionalMethods))this[n]==null&&(this[n]=function(...s){return this.db[n](...s)})}lr.prototype.emit=tS.prototype.emit;lr.prototype.once=tS.prototype.once;lrt(lr,tS);lr.prototype.open=function(r,e){return typeof r=="function"&&(e=r,r=null),e=Pd.fromCallback(e),r||(r=this.options),this.isOpen()?(rS(e,null,this),e.promise):this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.emit("opening"),this.db.open(r,t=>{if(t)return e(new yrt(t));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};lr.prototype.close=function(r){return r=Pd.fromCallback(r),this.isOpen()?(this.db.close((e,...t)=>{this.emit("closed"),r(e,...t)}),this.emit("closing"),this.db=new Jae(this._db)):this.isClosed()?rS(r):this.db.status==="closing"?this.once("closed",r):this._isOpening()&&this.once("open",()=>{this.close(r)}),r.promise};lr.prototype.isOpen=function(){return this.db.status==="open"};lr.prototype._isOpening=function(){return this.db.status==="opening"};lr.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};lr.prototype.get=function(r,e,t){return t=Lb(e,t),t=Pd.fromCallback(t),Ub(this,t)||(e=E0(e),this.db.get(r,e,function(i,n){if(i)return/notfound/i.test(i)||i.notFound?i=new prt("Key not found in database ["+r+"]",i):i=new ece(i),t(i);t(null,n)})),t.promise};lr.prototype.put=function(r,e,t,i){return i=Lb(t,i),i=Pd.fromCallback(i),Ub(this,i)||(t=E0(t),this.db.put(r,e,t,n=>{if(n)return i(new iS(n));this.emit("put",r,e),i()})),i.promise};lr.prototype.del=function(r,e,t){return t=Lb(e,t),t=Pd.fromCallback(t),Ub(this,t)||(e=E0(e),this.db.del(r,e,i=>{if(i)return t(new iS(i));this.emit("del",r),t()})),t.promise};lr.prototype.batch=function(r,e,t){return arguments.length?(typeof r=="function"?t=r:t=Lb(e,t),t=Pd.fromCallback(t),Ub(this,t)||(e=E0(e),this.db.batch(r,e,i=>{if(i)return t(new iS(i));this.emit("batch",r),t()})),t.promise):new drt(this)};lr.prototype.iterator=function(r){return this.db.iterator(r)};lr.prototype.clear=function(r,e){return e=Lb(r,e),r=E0(r),e=Pd.fromCallback(e),Ub(this,e)||this.db.clear(r,t=>{if(t)return e(new iS(t));this.emit("clear",r),e()}),e.promise};lr.prototype.readStream=lr.prototype.createReadStream=function(r){return r=Object.assign({keys:!0,values:!0},r),typeof r.limit!="number"&&(r.limit=-1),new frt(this.db.iterator(r),r)};lr.prototype.keyStream=lr.prototype.createKeyStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!0,values:!1}))};lr.prototype.valueStream=lr.prototype.createValueStream=function(r){return this.createReadStream(Object.assign({},r,{keys:!1,values:!0}))};lr.prototype.toString=function(){return"LevelUP"};lr.prototype.type="levelup";function Ub(r,e){if(!r._isOpening()&&!r.isOpen())return rS(e,new ece("Database is not open")),!0}lr.errors=_0;tce.exports=lr});var ice=y(du=>{f();"use strict";var{Buffer:W8}=Vt();du.utf8=du["utf-8"]={encode:function(r){return Y8(r)?r:String(r)},decode:nS,buffer:!1,type:"utf8"};du.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};du.binary={encode:function(r){return Y8(r)?r:W8.from(r)},decode:nS,buffer:!0,type:"binary"};du.none={encode:nS,decode:nS,buffer:!1,type:"id"};du.id=du.none;var mrt=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let r of mrt)du[r]={encode:function(e){return Y8(e)?e:W8.from(e,r)},decode:function(e){return e.toString(r)},buffer:!0,type:r};function nS(r){return r}function Y8(r){return r==null||W8.isBuffer(r)}});var sce=y((RDt,nce)=>{f();"use strict";var X8=ice(),brt=new Set(["lt","gt","lte","gte"]);nce.exports=Un;function Un(r){if(!(this instanceof Un))return new Un(r);this.opts=r||{},this.encodings=X8}Un.prototype._encoding=function(r){return typeof r=="string"&&(r=X8[r]),r||(r=X8.id),r};Un.prototype._keyEncoding=function(r,e){return this._encoding(e&&e.keyEncoding||r&&r.keyEncoding||this.opts.keyEncoding)};Un.prototype._valueEncoding=function(r,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||r&&(r.valueEncoding||r.encoding)||this.opts.valueEncoding||this.opts.encoding)};Un.prototype.encodeKey=function(r,e,t){return this._keyEncoding(e,t).encode(r)};Un.prototype.encodeValue=function(r,e,t){return this._valueEncoding(e,t).encode(r)};Un.prototype.decodeKey=function(r,e){return this._keyEncoding(e).decode(r)};Un.prototype.decodeValue=function(r,e){return this._valueEncoding(e).decode(r)};Un.prototype.encodeBatch=function(r,e){return r.map(t=>{let i={type:t.type,key:this.encodeKey(t.key,e,t)};return this.keyAsBuffer(e,t)&&(i.keyEncoding="binary"),t.prefix&&(i.prefix=t.prefix),"value"in t&&(i.value=this.encodeValue(t.value,e,t),this.valueAsBuffer(e,t)&&(i.valueEncoding="binary")),i})};Un.prototype.encodeLtgt=function(r){let e={};for(let t of Object.keys(r)){if(t==="start"||t==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[t]=brt.has(t)?this.encodeKey(r[t],r):r[t]}return e};Un.prototype.createStreamDecoder=function(r){return r.keys&&r.values?(e,t)=>({key:this.decodeKey(e,r),value:this.decodeValue(t,r)}):r.keys?e=>this.decodeKey(e,r):r.values?(e,t)=>this.decodeValue(t,r):function(){}};Un.prototype.keyAsBuffer=function(r){return this._keyEncoding(r).buffer};Un.prototype.valueAsBuffer=function(r){return this._valueEncoding(r).buffer}});var fce=y((CDt,lce)=>{f();"use strict";var oce=kl().AbstractLevelDOWN,ace=kl().AbstractChainedBatch,cce=kl().AbstractIterator,Q8=Gi(),vrt=sce(),uce=eS().EncodingError,wrt=["approximateSize","compactRange"];lce.exports=vn;function vn(r,e){if(!(this instanceof vn))return new vn(r,e);let t=r.supports||{},i=t.additionalMethods||{};oce.call(this,t),this.supports.encodings=!0,this.supports.additionalMethods={},wrt.forEach(function(n){let s=typeof r[n]=="function";(i[n]||s)&&(this.supports.additionalMethods[n]=!0,this[n]=function(o,a,c,u){return o=this.codec.encodeKey(o,c),a=this.codec.encodeKey(a,c),this.db[n](o,a,c,u)})},this),e=e||{},typeof e.keyEncoding=="undefined"&&(e.keyEncoding="utf8"),typeof e.valueEncoding=="undefined"&&(e.valueEncoding="utf8"),this.db=r,this.codec=new vrt(e)}Q8(vn,oce);vn.prototype.type="encoding-down";vn.prototype._serializeKey=vn.prototype._serializeValue=function(r){return r};vn.prototype._open=function(r,e){this.db.open(r,e)};vn.prototype._close=function(r){this.db.close(r)};vn.prototype._put=function(r,e,t,i){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.db.put(r,e,t,i)};vn.prototype._get=function(r,e,t){r=this.codec.encodeKey(r,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(r,e,(i,n)=>{if(i)return t(i);try{n=this.codec.decodeValue(n,e)}catch(s){return t(new uce(s))}t(null,n)})};vn.prototype._del=function(r,e,t){r=this.codec.encodeKey(r,e),this.db.del(r,e,t)};vn.prototype._chainedBatch=function(){return new S0(this)};vn.prototype._batch=function(r,e,t){r=this.codec.encodeBatch(r,e),this.db.batch(r,e,t)};vn.prototype._iterator=function(r){return r.keyAsBuffer=this.codec.keyAsBuffer(r),r.valueAsBuffer=this.codec.valueAsBuffer(r),new Fb(this,r)};vn.prototype._clear=function(r,e){r=this.codec.encodeLtgt(r),this.db.clear(r,e)};function Fb(r,e){cce.call(this,r),this.codec=r.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=r.db.iterator(this.opts)}Q8(Fb,cce);Fb.prototype._next=function(r){this.it.next((e,t,i)=>{if(e)return r(e);try{this.keys&&typeof t!="undefined"?t=this.codec.decodeKey(t,this.opts):t=void 0,this.values&&typeof i!="undefined"?i=this.codec.decodeValue(i,this.opts):i=void 0}catch(n){return r(new uce(n))}r(null,t,i)})};Fb.prototype._seek=function(r){r=this.codec.encodeKey(r,this.opts),this.it.seek(r)};Fb.prototype._end=function(r){this.it.end(r)};function S0(r,e){ace.call(this,r),this.codec=r.codec,this.batch=r.db.batch()}Q8(S0,ace);S0.prototype._put=function(r,e,t){r=this.codec.encodeKey(r,t),e=this.codec.encodeValue(e,t),this.batch.put(r,e)};S0.prototype._del=function(r,e){r=this.codec.encodeKey(r,e),this.batch.del(r)};S0.prototype._clear=function(){this.batch.clear()};S0.prototype._write=function(r,e){this.batch.write(r,e)}});var pce=y((PDt,hce)=>{f();"use strict";var dce=rce(),_rt=fce();function Ert(r){function e(i,n,s){return typeof i=="function"?s=i:typeof n=="function"&&(s=n),t(n)||(n=t(i)?i:{}),dce(_rt(r(i,n),n),n,s)}function t(i){return typeof i=="object"&&i!==null}for(let i of["destroy","repair"])typeof r[i]=="function"&&(e[i]=function(...n){r[i](...n)});return e.errors=dce.errors,e}hce.exports=Ert});var gce=y(si=>{f();si.compare=function(r,e){if(Buffer.isBuffer(r)){for(var t=Math.min(r.length,e.length),i=0;i<t;i++){var n=r[i]-e[i];if(n)return n}return r.length-e.length}return r<e?-1:r>e?1:0};function yce(r){return r!==void 0&&r!==""}function x0(r,e){return Object.hasOwnProperty.call(r,e)}function lc(r,e){return Object.hasOwnProperty.call(r,e)&&e}var Srt=si.lowerBoundKey=function(r){return lc(r,"gt")||lc(r,"gte")||lc(r,"min")||(r.reverse?lc(r,"end"):lc(r,"start"))||void 0},Z8=si.lowerBound=function(r,e){var t=Srt(r);return t?r[t]:e},J8=si.lowerBoundInclusive=function(r){return!x0(r,"gt")},eC=si.upperBoundInclusive=function(r){return!x0(r,"lt")},xrt=si.lowerBoundExclusive=function(r){return!J8(r)},Art=si.upperBoundExclusive=function(r){return!eC(r)},Irt=si.upperBoundKey=function(r){return lc(r,"lt")||lc(r,"lte")||lc(r,"max")||(r.reverse?lc(r,"start"):lc(r,"end"))||void 0},tC=si.upperBound=function(r,e){var t=Irt(r);return t?r[t]:e};si.start=function(r,e){return r.reverse?tC(r,e):Z8(r,e)};si.end=function(r,e){return r.reverse?Z8(r,e):tC(r,e)};si.startInclusive=function(r){return r.reverse?eC(r):J8(r)};si.endInclusive=function(r){return r.reverse?J8(r):eC(r)};function Trt(r){return r}si.toLtgt=function(r,e,t,i,n){e=e||{},t=t||Trt;var s=arguments.length>3,o=si.lowerBoundKey(r),a=si.upperBoundKey(r);return o?o==="gt"?e.gt=t(r.gt,!1):e.gte=t(r[o],!1):s&&(e.gte=t(i,!1)),a?a==="lt"?e.lt=t(r.lt,!0):e.lte=t(r[a],!0):s&&(e.lte=t(n,!0)),r.reverse!=null&&(e.reverse=!!r.reverse),x0(e,"max")&&delete e.max,x0(e,"min")&&delete e.min,x0(e,"start")&&delete e.start,x0(e,"end")&&delete e.end,e};si.contains=function(r,e,t){t=t||si.compare;var i=Z8(r);if(yce(i)){var n=t(e,i);if(n<0||n===0&&xrt(r))return!1}var s=tC(r);if(yce(s)){var n=t(e,s);if(n>0||n===0&&Art(r))return!1}return!0};si.filter=function(r,e){return function(t){return si.contains(r,t,e)}}});var rC=y((kDt,mce)=>{f();"use strict";var sS=gce(),Ml=Symbol("none");mce.exports=function(e){let t=sS.lowerBound(e,Ml),i=sS.upperBound(e,Ml),n=sS.lowerBoundExclusive(e,Ml),s=sS.upperBoundExclusive(e,Ml);return t!==Ml&&i!==Ml?IDBKeyRange.bound(t,i,n,s):t!==Ml?IDBKeyRange.lowerBound(t,n):i!==Ml?IDBKeyRange.upperBound(i,s):null}});var iC=y((qDt,vce)=>{f();"use strict";var oS=Vt().Buffer,Rrt=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return bce(e).toString()}}(),Crt=function(){if(globalThis.TextDecoder){let r=new TextDecoder("utf-8");return r.decode.bind(r)}else return function(e){return oS.from(e).toString()}}();function bce(r){let e=oS.from(r.buffer);return r.byteLength===r.buffer.byteLength?e:e.slice(r.byteOffset,r.byteOffset+r.byteLength)}vce.exports=function(r,e){return r instanceof Uint8Array?e?bce(r):Rrt(r):r instanceof ArrayBuffer?e?oS.from(r):Crt(r):e?oS.from(String(r)):String(r)}});var Sce=y((NDt,Ece)=>{f();"use strict";var Prt=Gi(),wce=kl().AbstractIterator,Ort=rC(),_ce=iC(),krt=function(){};Ece.exports=ra;function ra(r,e,t){if(wce.call(this,r),this._limit=t.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=t.keys,this._values=t.values,this._keyAsBuffer=t.keyAsBuffer,this._valueAsBuffer=t.valueAsBuffer,this._limit===0){this._completed=!0;return}let i;try{i=Ort(t)}catch(n){this._completed=!0;return}this.createIterator(e,i,t.reverse)}Prt(ra,wce);ra.prototype.createIterator=function(r,e,t){let i=this.db.db.transaction([r],"readonly"),s=i.objectStore(r).openCursor(e,t?"prev":"next");s.onsuccess=o=>{let a=o.target.result;a&&this.onItem(a)},this._transaction=i,i.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},i.oncomplete=()=>{this.onComplete()}};ra.prototype.onItem=function(r){this._cache.push(r.key,r.value),(this._limit<=0||++this._count<this._limit)&&r.continue(),this.maybeNext()};ra.prototype.onAbort=function(r){this._aborted=!0,this._error=r,this.maybeNext()};ra.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};ra.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};ra.prototype._next=function(r){if(this._aborted){let e=this._error;this._error=null,this._nextTick(r,e)}else if(this._cache.length>0){let e=this._cache.shift(),t=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&t!==void 0?t=this._deserializeValue(t,this._valueAsBuffer):t=void 0,this._nextTick(r,null,e,t)}else this._completed?this._nextTick(r):this._callback=r};ra.prototype._deserializeKey=_ce;ra.prototype._deserializeValue=_ce;ra.prototype._end=function(r){if(this._aborted||this._completed)return this._nextTick(r,this._error);this.onItem=krt,this.onAbort=r,this.onComplete=r}});var Ice=y((DDt,Ace)=>{f();"use strict";var xce=Vt().Buffer,qrt=function(){if(globalThis.TextEncoder){let r=new TextEncoder("utf-8");return r.encode.bind(r)}else return xce.from}();Ace.exports=function(r,e){return e?xce.isBuffer(r)?r:qrt(String(r)):String(r)}});var Tce=y(aS=>{f();"use strict";var Nrt=Vt().Buffer;aS.test=function(r){return function(t){try{return t.cmp(r,0),!0}catch(i){return!1}}};aS.bufferKeys=aS.test(Nrt.alloc(0))});var Cce=y((MDt,Rce)=>{f();"use strict";Rce.exports=function(e,t,i,n,s){if(n.limit===0)return e._nextTick(s);let o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),c=0;o.oncomplete=function(){s()},o.onabort=function(){s(o.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",l=n.reverse?"prev":"next";a[u](i,l).onsuccess=function(d){let h=d.target.result;h&&(a.delete(h.key).onsuccess=function(){(n.limit<=0||++c<n.limit)&&h.continue()})}}});var Nce=y((LDt,qce)=>{f();"use strict";qce.exports=Si;var Pce=kl().AbstractLevelDOWN,Drt=Gi(),Brt=Sce(),Oce=Ice(),nC=iC(),Mrt=Tce(),Lrt=Cce(),Urt=rC(),kce="level-js-";function Si(r,e){if(!(this instanceof Si))return new Si(r,e);if(Pce.call(this,{bufferKeys:Mrt.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),e=e||{},typeof r!="string")throw new Error("constructor requires a location string argument");this.location=r,this.prefix=e.prefix==null?kce:e.prefix,this.version=parseInt(e.version||1,10)}Drt(Si,Pce);Si.prototype.type="level-js";Si.prototype._open=function(r,e){let t=indexedDB.open(this.prefix+this.location,this.version);t.onerror=function(){e(t.error||new Error("unknown error"))},t.onsuccess=()=>{this.db=t.result,e()},t.onupgradeneeded=i=>{let n=i.target.result;n.objectStoreNames.contains(this.location)||n.createObjectStore(this.location)}};Si.prototype.store=function(r){return this.db.transaction([this.location],r).objectStore(this.location)};Si.prototype.await=function(r,e){let t=r.transaction;t.onabort=function(){e(t.error||new Error("aborted by user"))},t.oncomplete=function(){e(null,r.result)}};Si.prototype._get=function(r,e,t){let i=this.store("readonly"),n;try{n=i.get(r)}catch(s){return this._nextTick(t,s)}this.await(n,function(s,o){if(s)return t(s);if(o===void 0)return t(new Error("NotFound"));t(null,nC(o,e.asBuffer))})};Si.prototype._del=function(r,e,t){let i=this.store("readwrite"),n;try{n=i.delete(r)}catch(s){return this._nextTick(t,s)}this.await(n,t)};Si.prototype._put=function(r,e,t,i){let n=this.store("readwrite"),s;try{s=n.put(e,r)}catch(o){return this._nextTick(i,o)}this.await(s,i)};Si.prototype._serializeKey=function(r){return Oce(r,this.supports.bufferKeys)};Si.prototype._serializeValue=function(r){return Oce(r,!0)};Si.prototype._iterator=function(r){return new Brt(this,this.location,r)};Si.prototype._batch=function(r,e,t){if(r.length===0)return this._nextTick(t);let i=this.store("readwrite"),n=i.transaction,s=0,o;n.onabort=function(){t(o||n.error||new Error("aborted by user"))},n.oncomplete=function(){t()};function a(){let c=r[s++],u=c.key,l;try{l=c.type==="del"?i.delete(u):i.put(c.value,u)}catch(d){o=d,n.abort();return}s<r.length&&(l.onsuccess=a)}a()};Si.prototype._clear=function(r,e){let t,i;try{t=Urt(r)}catch(n){return this._nextTick(e)}if(r.limit>=0)return Lrt(this,this.location,t,r,e);try{let n=this.store("readwrite");i=t?n.delete(t):n.clear()}catch(n){return this._nextTick(e,n)}this.await(i,e)};Si.prototype._close=function(r){this.db.close(),this._nextTick(r)};Si.prototype.upgrade=function(r){if(this.status!=="open")return this._nextTick(r,new Error("cannot upgrade() before open()"));let e=this.iterator(),t={},i=this;e._deserializeKey=e._deserializeValue=a,n();function n(c){if(c)return o(c);e.next(s)}function s(c,u,l){if(c||u===void 0)return o(c);let d=i._serializeKey(nC(u,!0)),h=i._serializeValue(nC(l,!0));i._batch([{type:"del",key:u},{type:"put",key:d,value:h}],t,n)}function o(c){e.end(function(u){r(c||u)})}function a(c){return c}};Si.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=kce);let i=indexedDB.deleteDatabase(e+r);i.onsuccess=function(){t()},i.onerror=function(n){t(n)}}});var Bce=y((UDt,Dce)=>{f();Dce.exports=pce()(Nce())});var Kce=y((FDt,Fce)=>{f();"use strict";var{Key:Frt,Errors:Kb,Adapter:Krt,utils:{sortAll:Mce}}=Ut(),cS=Ya(),jrt=Ho(),Lce=bp(),Uce=class extends Krt{constructor(e,t){super();this.path=e,this.opts=t,t&&t.db?(this.database=t.db,delete t.db):this.database=Bce()}_initDb(){return new Promise((e,t)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},i=>{if(i)return t(i);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw Kb.dbOpenFailedError(e)}}async put(e,t){try{await this.db.put(e.toString(),t)}catch(i){throw Kb.dbWriteFailedError(i)}}async get(e){let t;try{t=await this.db.get(e.toString())}catch(i){throw i.notFound?Kb.notFoundError(i):Kb.dbWriteFailedError(i)}return t}async has(e){try{await this.db.get(e.toString())}catch(t){if(t.notFound)return!1;throw t}return!0}async delete(e){try{await this.db.del(e.toString())}catch(t){throw Kb.dbDeleteFailedError(t)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(t,i)=>{e.push({type:"put",key:t.toString(),value:i})},delete:t=>{e.push({type:"del",key:t.toString()})},commit:()=>this.db.batch(e)}}query(e){let t=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>cS(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>Mce(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=cS(t,()=>s++>=i)}return n&&(t=Lce(t,n)),t}queryKeys(e){let t=jrt(this._query({values:!1,prefix:e.prefix}),({key:s})=>s);Array.isArray(e.filters)&&(t=e.filters.reduce((s,o)=>cS(s,o),t)),Array.isArray(e.orders)&&(t=e.orders.reduce((s,o)=>Mce(s,o),t));let{offset:i,limit:n}=e;if(i){let s=0;t=cS(t,()=>s++>=i)}return n&&(t=Lce(t,n)),t}_query(e){let t={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let i=e.prefix.toString();t.gte=i,t.lt=i+"\xFF"}return Vrt(this.db.iterator(t))}};function Vrt(r){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,t)=>{r.next((i,n,s)=>{if(i)return t(i);if(n==null)return r.end(o=>{if(o)return t(o);e({done:!0,value:void 0})});e({done:!1,value:{key:new Frt(n,!1),value:s}})})}),return:()=>new Promise((e,t)=>{r.end(i=>{if(i)return t(i);e({done:!0,value:void 0})})})}}}}Fce.exports=Uce});var sC=y((KDt,$ce)=>{f();"use strict";var jce=Wa(),A0=Ya(),Vce=bp(),zrt=mp(),zce=(r,e)=>async function*(){yield*(await zrt(r)).sort(e)}(),Hce=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,t,i){return Promise.reject(new Error(".put is not implemented"))}get(e,t){return Promise.reject(new Error(".get is not implemented"))}has(e,t){return Promise.reject(new Error(".has is not implemented"))}delete(e,t){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,t={}){for await(let{key:i,value:n}of e)await this.put(i,n,t),yield{key:i,value:n}}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}async*deleteMany(e,t={}){for await(let i of e)await this.delete(i,t),yield i}batch(){let e=[],t=[];return{put(i,n){e.push({key:i,value:n})},delete(i){t.push(i)},commit:async i=>{await jce(this.putMany(e,i)),e=[],await jce(this.deleteMany(t,i)),t=[]}}}async*_all(e,t){throw new Error("._all is not implemented")}async*_allKeys(e,t){throw new Error("._allKeys is not implemented")}query(e,t){let i=this._all(e,t);if(e.prefix!=null&&(i=A0(i,n=>n.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>A0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>zce(n,s),i)),e.offset!=null){let n=0;i=A0(i,()=>n++>=(e.offset||0))}return e.limit!=null&&(i=Vce(i,e.limit)),i}queryKeys(e,t){let i=this._allKeys(e,t);if(e.prefix!=null&&(i=A0(i,n=>n.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(i=e.filters.reduce((n,s)=>A0(n,s),i)),Array.isArray(e.orders)&&(i=e.orders.reduce((n,s)=>zce(n,s),i)),e.offset!=null){let n=0;i=A0(i,()=>n++>=e.offset)}return e.limit!=null&&(i=Vce(i,e.limit)),i}};$ce.exports=Hce});var Wce=y((jDt,Gce)=>{f();"use strict";var Hrt=ae();function $rt(r){return r=r||new Error("Not Found"),Hrt(r,"ERR_NOT_FOUND")}Gce.exports={notFoundError:$rt}});var eue=y((VDt,Jce)=>{f();"use strict";var Grt=sC(),{base32:I0}=(sn(),nn),Yce=(Ls(),Po),{CID:Xce}=(Ie(),De),Qce=(Cn(),Wn),Wrt=Wce(),Zce=class extends Grt{constructor(){super();this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,t){this.data[I0.encode(e.multihash.bytes)]=t}async get(e){if(!await this.has(e))throw Wrt.notFoundError();return this.data[I0.encode(e.multihash.bytes)]}async has(e){return this.data[I0.encode(e.multihash.bytes)]!==void 0}async delete(e){delete this.data[I0.encode(e.multihash.bytes)]}async*_all(){yield*Object.entries(this.data).map(([e,t])=>({key:Xce.createV1(Yce.code,Qce.decode(I0.decode(e))),value:t}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>Xce.createV1(Yce.code,Qce.decode(I0.decode(e))))}};Jce.exports=Zce});var uS=y((zDt,tue)=>{f();"use strict";var Yrt=sC(),Xrt=eue();tue.exports={BlockstoreAdapter:Yrt,MemoryBlockstore:Xrt}});var cue=y((HDt,aue)=>{f();"use strict";var rue=Wa(),iue=Qa(),{Key:Qrt}=Ut(),{CID:nue}=(Ie(),De),Zrt=(Ls(),Po),Jrt=(Cn(),Wn),{base32:jb,base32pad:eit}=(sn(),nn),{base58btc:sue}=(ei(),Jr),tit=ae(),{BlockstoreAdapter:rit}=uS();function T0(r){if(!(r instanceof nue))throw tit(new Error("Not a valid cid"),"ERR_INVALID_CID");return new Qrt("/"+jb.encode(r.multihash.bytes).slice(1).toUpperCase(),!1)}function Ll(r){return nue.createV1(Zrt.code,Jrt.decode(jb.decode("b"+r.toString().slice(1).toLowerCase())))}function oC(r){let e,t=r.substring(0,1);return t==="/"?oC(r.substring(1)):(t.toLowerCase()==="b"?e=jb.decode(r.toLowerCase()).subarray(2):t.toLowerCase()==="c"?e=eit.decode(r.toLowerCase()).subarray(2):t==="z"?e=sue.decode(r).subarray(2):t==="Q"?e=sue.decode("z"+r):e=jb.decode("b"+r.toLowerCase()).subarray(2),jb.encode(e).substring(1).toUpperCase()||"C")}function iit(r){return{...r,prefix:r.prefix?`/${oC(r.prefix)}`:void 0,filters:r.filters?r.filters.map(e=>t=>e({key:Ll(t.key),value:t.value})):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e({key:Ll(t.key),value:t.value},{key:Ll(i.key),value:i.value})):void 0}}function nit(r){return{...r,prefix:r.prefix?`/${oC(r.prefix)}`:void 0,filters:r.filters?r.filters.map(e=>t=>e(Ll(t))):void 0,orders:r.orders?r.orders.map(e=>(t,i)=>e(Ll(t),Ll(i))):void 0}}var oue=class extends rit{constructor(e){super();this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,t){for await(let{key:i,value:n}of this.child.query(iit(e),t))yield{key:Ll(i),value:n}}async*queryKeys(e,t){for await(let i of this.child.queryKeys(nit(e),t))yield Ll(i)}async get(e,t){return this.child.get(T0(e),t)}async*getMany(e,t){for await(let i of e)yield this.get(i,t)}async put(e,t,i){await this.child.put(T0(e),t,i)}async*putMany(e,t){let i=iue();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{let s=this.child;await rue(this.child.putMany(async function*(){for await(let o of e){let a=T0(o.key);await s.has(a,t)||(yield{key:a,value:o.value}),i.push(o)}}())),i.end()}catch(s){i.end(s)}}),yield*i}has(e,t){return this.child.has(T0(e),t)}delete(e,t){return this.child.delete(T0(e),t)}deleteMany(e,t){let i=iue();return rue(this.child.deleteMany(async function*(){for await(let n of e)yield T0(n),i.push(n);i.end()}(),t)).catch(n=>{i.end(n)}),i}};aue.exports=oue});var lue=y(($Dt,uue)=>{f();"use strict";var{createRepo:sit}=$f(),Vb=Kce(),oit=cue();uue.exports=(r,e,t)=>{let i=t.path||"ipfs";return sit(i,n=>e.getCodec(n),{root:new Vb(i,{prefix:"",version:2}),blocks:new oit(new Vb(`${i}/blocks`,{prefix:"",version:2})),datastore:new Vb(`${i}/datastore`,{prefix:"",version:2}),keys:new Vb(`${i}/keys`,{prefix:"",version:2}),pins:new Vb(`${i}/pins`,{prefix:"",version:2})},{autoMigrate:t.autoMigrate,onMigrationProgress:t.onMigrationProgress||r})}});var aC=y((GDt,pue)=>{f();"use strict";var fue=()=>{},due=Symbol.for("@libp2p/js-interfaces/topology"),hue=class{constructor({min:e=0,max:t=1/0,handlers:i={}}){this.min=e,this.max=t,this._onConnect=i.onConnect||fue,this._onDisconnect=i.onDisconnect||fue,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[due](){return!0}static isTopology(e){return Boolean(e&&e[due])}set registrar(e){this._registrar=e}disconnect(e){this._onDisconnect(e)}};pue.exports=hue});var lS=y((WDt,mue)=>{f();"use strict";var ait=aC(),yue=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology"),gue=class extends ait{constructor({min:e,max:t,multicodecs:i,handlers:n}){super({min:e,max:t,handlers:n});if(!i)throw new Error("one or more multicodec should be provided");if(!n)throw new Error("the handlers should be provided");if(typeof n.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof n.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(i)?i:[i],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[yue](){return!0}static isMulticodecTopology(e){return Boolean(e&&e[yue])}set registrar(e){this._registrar=e,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(e){for(let{id:t,protocols:i}of e)if(this.multicodecs.filter(n=>i.includes(n)).length){this.peers.add(t.toB58String());let n=this._registrar.getConnection(t);n&&this._onConnect(t,n)}else this.peers.delete(t.toB58String())}_onProtocolChange({peerId:e,protocols:t}){let i=this.peers.has(e.toB58String()),n=t.filter(s=>this.multicodecs.includes(s));i&&n.length===0&&this._onDisconnect(e);for(let s of t)if(this.multicodecs.includes(s)){let o=this._registrar.peerStore.get(e);this._updatePeers([o]);return}}_onPeerConnect(e){let t=e.remotePeer,i=this._registrar.peerStore.protoBook.get(t);!i||this.multicodecs.find(n=>i.includes(n))&&(this.peers.add(t.toB58String()),this._onConnect(t,e))}};mue.exports=gue});var fS=y(bue=>{f();"use strict";bue.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"}});var uC=y((XDt,vue)=>{f();"use strict";var Ul=ki(),R0=Ul.Reader,cC=Ul.Writer,xt=Ul.util,xi=Ul.roots["libp2p-pubsub-rpc"]||(Ul.roots["libp2p-pubsub-rpc"]={});xi.RPC=function(){function r(e){if(this.subscriptions=[],this.msgs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.subscriptions=xt.emptyArray,r.prototype.msgs=xt.emptyArray,r.encode=function(t,i){if(i||(i=cC.create()),t.subscriptions!=null&&t.subscriptions.length)for(var n=0;n<t.subscriptions.length;++n)xi.RPC.SubOpts.encode(t.subscriptions[n],i.uint32(10).fork()).ldelim();if(t.msgs!=null&&t.msgs.length)for(var n=0;n<t.msgs.length;++n)xi.RPC.Message.encode(t.msgs[n],i.uint32(18).fork()).ldelim();return i},r.decode=function(t,i){t instanceof R0||(t=R0.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new xi.RPC;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.subscriptions&&s.subscriptions.length||(s.subscriptions=[]),s.subscriptions.push(xi.RPC.SubOpts.decode(t,t.uint32()));break;case 2:s.msgs&&s.msgs.length||(s.msgs=[]),s.msgs.push(xi.RPC.Message.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof xi.RPC)return t;var i=new xi.RPC;if(t.subscriptions){if(!Array.isArray(t.subscriptions))throw TypeError(".RPC.subscriptions: array expected");i.subscriptions=[];for(var n=0;n<t.subscriptions.length;++n){if(typeof t.subscriptions[n]!="object")throw TypeError(".RPC.subscriptions: object expected");i.subscriptions[n]=xi.RPC.SubOpts.fromObject(t.subscriptions[n])}}if(t.msgs){if(!Array.isArray(t.msgs))throw TypeError(".RPC.msgs: array expected");i.msgs=[];for(var n=0;n<t.msgs.length;++n){if(typeof t.msgs[n]!="object")throw TypeError(".RPC.msgs: object expected");i.msgs[n]=xi.RPC.Message.fromObject(t.msgs[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.subscriptions=[],n.msgs=[]),t.subscriptions&&t.subscriptions.length){n.subscriptions=[];for(var s=0;s<t.subscriptions.length;++s)n.subscriptions[s]=xi.RPC.SubOpts.toObject(t.subscriptions[s],i)}if(t.msgs&&t.msgs.length){n.msgs=[];for(var s=0;s<t.msgs.length;++s)n.msgs[s]=xi.RPC.Message.toObject(t.msgs[s],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ul.util.toJSONOptions)},r.SubOpts=function(){function e(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.subscribe=null,e.prototype.topicID=null;var t;return Object.defineProperty(e.prototype,"_subscribe",{get:xt.oneOfGetter(t=["subscribe"]),set:xt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_topicID",{get:xt.oneOfGetter(t=["topicID"]),set:xt.oneOfSetter(t)}),e.encode=function(n,s){return s||(s=cC.create()),n.subscribe!=null&&Object.hasOwnProperty.call(n,"subscribe")&&s.uint32(8).bool(n.subscribe),n.topicID!=null&&Object.hasOwnProperty.call(n,"topicID")&&s.uint32(18).string(n.topicID),s},e.decode=function(n,s){n instanceof R0||(n=R0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new xi.RPC.SubOpts;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.subscribe=n.bool();break;case 2:a.topicID=n.string();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof xi.RPC.SubOpts)return n;var s=new xi.RPC.SubOpts;return n.subscribe!=null&&(s.subscribe=Boolean(n.subscribe)),n.topicID!=null&&(s.topicID=String(n.topicID)),s},e.toObject=function(n,s){s||(s={});var o={};return n.subscribe!=null&&n.hasOwnProperty("subscribe")&&(o.subscribe=n.subscribe,s.oneofs&&(o._subscribe="subscribe")),n.topicID!=null&&n.hasOwnProperty("topicID")&&(o.topicID=n.topicID,s.oneofs&&(o._topicID="topicID")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ul.util.toJSONOptions)},e}(),r.Message=function(){function e(i){if(this.topicIDs=[],i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}e.prototype.from=null,e.prototype.data=null,e.prototype.seqno=null,e.prototype.topicIDs=xt.emptyArray,e.prototype.signature=null,e.prototype.key=null;var t;return Object.defineProperty(e.prototype,"_from",{get:xt.oneOfGetter(t=["from"]),set:xt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_data",{get:xt.oneOfGetter(t=["data"]),set:xt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_seqno",{get:xt.oneOfGetter(t=["seqno"]),set:xt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_signature",{get:xt.oneOfGetter(t=["signature"]),set:xt.oneOfSetter(t)}),Object.defineProperty(e.prototype,"_key",{get:xt.oneOfGetter(t=["key"]),set:xt.oneOfSetter(t)}),e.encode=function(n,s){if(s||(s=cC.create()),n.from!=null&&Object.hasOwnProperty.call(n,"from")&&s.uint32(10).bytes(n.from),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&s.uint32(18).bytes(n.data),n.seqno!=null&&Object.hasOwnProperty.call(n,"seqno")&&s.uint32(26).bytes(n.seqno),n.topicIDs!=null&&n.topicIDs.length)for(var o=0;o<n.topicIDs.length;++o)s.uint32(34).string(n.topicIDs[o]);return n.signature!=null&&Object.hasOwnProperty.call(n,"signature")&&s.uint32(42).bytes(n.signature),n.key!=null&&Object.hasOwnProperty.call(n,"key")&&s.uint32(50).bytes(n.key),s},e.decode=function(n,s){n instanceof R0||(n=R0.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new xi.RPC.Message;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.from=n.bytes();break;case 2:a.data=n.bytes();break;case 3:a.seqno=n.bytes();break;case 4:a.topicIDs&&a.topicIDs.length||(a.topicIDs=[]),a.topicIDs.push(n.string());break;case 5:a.signature=n.bytes();break;case 6:a.key=n.bytes();break;default:n.skipType(c&7);break}}return a},e.fromObject=function(n){if(n instanceof xi.RPC.Message)return n;var s=new xi.RPC.Message;if(n.from!=null&&(typeof n.from=="string"?xt.base64.decode(n.from,s.from=xt.newBuffer(xt.base64.length(n.from)),0):n.from.length&&(s.from=n.from)),n.data!=null&&(typeof n.data=="string"?xt.base64.decode(n.data,s.data=xt.newBuffer(xt.base64.length(n.data)),0):n.data.length&&(s.data=n.data)),n.seqno!=null&&(typeof n.seqno=="string"?xt.base64.decode(n.seqno,s.seqno=xt.newBuffer(xt.base64.length(n.seqno)),0):n.seqno.length&&(s.seqno=n.seqno)),n.topicIDs){if(!Array.isArray(n.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");s.topicIDs=[];for(var o=0;o<n.topicIDs.length;++o)s.topicIDs[o]=String(n.topicIDs[o])}return n.signature!=null&&(typeof n.signature=="string"?xt.base64.decode(n.signature,s.signature=xt.newBuffer(xt.base64.length(n.signature)),0):n.signature.length&&(s.signature=n.signature)),n.key!=null&&(typeof n.key=="string"?xt.base64.decode(n.key,s.key=xt.newBuffer(xt.base64.length(n.key)),0):n.key.length&&(s.key=n.key)),s},e.toObject=function(n,s){s||(s={});var o={};if((s.arrays||s.defaults)&&(o.topicIDs=[]),n.from!=null&&n.hasOwnProperty("from")&&(o.from=s.bytes===String?xt.base64.encode(n.from,0,n.from.length):s.bytes===Array?Array.prototype.slice.call(n.from):n.from,s.oneofs&&(o._from="from")),n.data!=null&&n.hasOwnProperty("data")&&(o.data=s.bytes===String?xt.base64.encode(n.data,0,n.data.length):s.bytes===Array?Array.prototype.slice.call(n.data):n.data,s.oneofs&&(o._data="data")),n.seqno!=null&&n.hasOwnProperty("seqno")&&(o.seqno=s.bytes===String?xt.base64.encode(n.seqno,0,n.seqno.length):s.bytes===Array?Array.prototype.slice.call(n.seqno):n.seqno,s.oneofs&&(o._seqno="seqno")),n.topicIDs&&n.topicIDs.length){o.topicIDs=[];for(var a=0;a<n.topicIDs.length;++a)o.topicIDs[a]=n.topicIDs[a]}return n.signature!=null&&n.hasOwnProperty("signature")&&(o.signature=s.bytes===String?xt.base64.encode(n.signature,0,n.signature.length):s.bytes===Array?Array.prototype.slice.call(n.signature):n.signature,s.oneofs&&(o._signature="signature")),n.key!=null&&n.hasOwnProperty("key")&&(o.key=s.bytes===String?xt.base64.encode(n.key,0,n.key.length):s.bytes===Array?Array.prototype.slice.call(n.key):n.key,s.oneofs&&(o._key="key")),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ul.util.toJSONOptions)},e}(),r}();vue.exports=xi});var lC=y((QDt,Eue)=>{f();"use strict";var wue=ys(),{Buffer:cit}=Vt(),_ue=(r,e,t)=>{let i=wue.encode(r,e,t);return _ue.bytes=wue.encode.bytes,e||cit.from(i)};Eue.exports=_ue});var Rue=y((ZDt,dS)=>{f();"use strict";var{Buffer:Sue}=Vt(),xue=bn(),Aue=lC(),fC=8,Iue=10*1024;function Tue(r){r=r||{};let e=Math.max(r.poolSize||Iue,r.minPoolSize||fC),t=r.lengthEncoder||Aue;return async function*(n){let s=Sue.alloc(e),o=0;for await(let a of n){t(a.length,s,o);let c=s.slice(o,o+t.bytes);o+=t.bytes,s.length-o<fC&&(s=Sue.alloc(e),o=0),yield new xue().append(c).append(a)}}}Tue.single=(r,e)=>{e=e||{};let t=e.lengthEncoder||Aue;return new xue([t(r.length),r.slice()])};dS.exports=Tue;dS.exports.MIN_POOL_SIZE=fC;dS.exports.DEFAULT_POOL_SIZE=Iue});var dC=y((JDt,Oue)=>{f();"use strict";var Cue=ys(),{Buffer:uit}=Vt(),lit=r=>new Proxy({},{get:(e,t)=>t[0]==="l"?r[t]:r.get(parseInt(t))}),Pue=r=>{let e=Cue.decode(uit.isBuffer(r)?r:lit(r));return Pue.bytes=Cue.decode.bytes,e};Oue.exports=Pue});var Due=y((eBt,hS)=>{f();"use strict";var{Buffer:fit}=Vt(),hC=bn(),dit=dC(),kue=8,que=1024*1024*4,Nue=fit.alloc(0),Fl={LENGTH:"readLength",DATA:"readData"},hit={[Fl.LENGTH]:(r,e,t,i)=>{e=e.append(r);let n;try{n=i.lengthDecoder(e)}catch(s){if(e.length>i.maxLengthLength)throw Object.assign(s,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(s instanceof RangeError)return{mode:Fl.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw s}if(n>i.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return r=e.shallowSlice(i.lengthDecoder.bytes),e=new hC,i.onLength&&i.onLength(n),n<=0?(i.onData&&i.onData(Nue),{mode:Fl.LENGTH,chunk:r,buffer:e,data:Nue}):{mode:Fl.DATA,chunk:r,buffer:e,state:{dataLength:n},data:void 0}},[Fl.DATA]:(r,e,t,i)=>{if(e=e.append(r),!t)throw new Error("state is required");if(e.length<t.dataLength)return{mode:Fl.DATA,buffer:e,state:t,chunk:void 0,data:void 0};let{dataLength:n}=t,s=e.shallowSlice(0,n),o=e.length>n?e.shallowSlice(n):void 0;return e=new hC,i.onData&&i.onData(s),{mode:Fl.LENGTH,chunk:o,buffer:e,state:void 0,data:s}}};function pC(r){r=r||{};let e={lengthDecoder:r.lengthDecoder||dit,maxLengthLength:r.maxLengthLength||kue,maxDataLength:r.maxDataLength||que,onLength:r.onLength,onData:r.onData};return async function*(i){let n=new hC,s=Fl.LENGTH,o;for await(let a of i){let c=a;for(;c;){let u=hit[s](c,n,o,e);s=u.mode,c=u.chunk,n=u.buffer,o=u.state,u.data&&(yield u.data)}}if(n.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}pC.fromReader=(r,e)=>{let t=1,i={[Symbol.asyncIterator](){return this},next:async()=>{try{return await r.next(t)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{t=1}}};return pC({...e||{},onLength:s=>{t=s}})(i)};hS.exports=pC;hS.exports.MAX_LENGTH_LENGTH=kue;hS.exports.MAX_DATA_LENGTH=que});var Lue=y((tBt,Mue)=>{f();"use strict";var{Buffer:pit}=Vt(),Bue=(r,e,t)=>(e=e||pit.allocUnsafe(4),e.writeInt32BE(r,t),e);Bue.bytes=4;Mue.exports=Bue});var Kue=y((rBt,Fue)=>{f();"use strict";var Uue=r=>{if(r.length<4)throw RangeError("Could not decode int32BE");return r.readInt32BE(0)};Uue.bytes=4;Fue.exports=Uue});var ia=y(Od=>{f();"use strict";Od.encode=Rue();Od.decode=Due();Od.varintEncode=lC();Od.varintDecode=dC();Od.int32BEEncode=Lue();Od.int32BEDecode=Kue()});var pS=y((nBt,jue)=>{f();jue.exports=function(e){if(e){if(typeof e[Symbol.iterator]=="function")return e[Symbol.iterator]();if(typeof e[Symbol.asyncIterator]=="function")return e[Symbol.asyncIterator]();if(typeof e.next=="function")return e}throw new Error("argument is not an iterator or iterable")}});var zue=y((oBt,Vue)=>{f();Vue.exports=class extends Error{constructor(e,t){super(e||"The operation was aborted");this.type="aborted",this.code=t||"ABORT_ERR"}}});var fc=y((aBt,kd)=>{f();var yit=pS(),yC=zue(),Hue=(r,e,t)=>gC(r,Array.isArray(e)?e:[{signal:e,options:t}]),gC=(r,e)=>{r=yit(r),e=e.map(({signal:i,options:n})=>({signal:i,options:n||{}}));async function*t(){let i,n=()=>{i&&i()};for(let{signal:s}of e)s.addEventListener("abort",n);for(;;){let s;try{for(let{signal:a,options:c}of e)if(a.aborted){let{abortMessage:u,abortCode:l}=c;throw new yC(u,l)}let o=new Promise((a,c)=>{i=()=>{let{options:u}=e.find(({signal:h})=>h.aborted),{abortMessage:l,abortCode:d}=u;c(new yC(l,d))}});s=await Promise.race([o,r.next()]),i=null}catch(o){for(let{signal:u}of e)u.removeEventListener("abort",n);let a=e.find(({signal:u})=>u.aborted),c=o.type==="aborted"&&a;if(c&&a.options.onAbort&&await a.options.onAbort(r),typeof r.return=="function"&&await r.return(),c&&a.options.returnOnAbort)return;throw o}if(s.done)break;yield s.value}for(let{signal:s}of e)s.removeEventListener("abort",n)}return t()},$ue=(r,e,t)=>Gue(r,Array.isArray(e)?e:[{signal:e,options:t}]),Gue=(r,e)=>t=>r(gC(t,e)),git=(r,e,t)=>mit(r,Array.isArray(e)?e:[{signal:e,options:t}]),mit=(r,e)=>({sink:Gue(r.sink,e),source:gC(r.source,e)});kd.exports=Hue;kd.exports.AbortError=yC;kd.exports.source=Hue;kd.exports.sink=$ue;kd.exports.transform=$ue;kd.exports.duplex=git});var Jue=y((cBt,Zue)=>{f();"use strict";var Wue=be(),bit=Object.assign(Wue("libp2p-pubsub:peer-streams"),{error:Wue("libp2p-pubsub:peer-streams:err")}),{EventEmitter:vit}=yr(),Yue=ia(),wit=Qa(),{pipe:Xue}=Ar(),{source:_it}=fc(),Eit=df().default,Que=class extends vit{constructor({id:e,protocol:t}){super();this.id=e,this.protocol=t,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new Eit,this.outboundStream=null,this.inboundStream=null}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(!this.outboundStream){let t=this.id.toB58String();throw new Error("No writable connection to "+t)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=_it(Xue(this._rawInboundStream,Yue.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(e){let t=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=wit({onEnd:i=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,i&&this.emit("close")}}),Xue(this.outboundStream,Yue.encode(),this._rawOutboundStream).catch(i=>{bit.error(i)}),t||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};Zue.exports=Que});var tle=y(ele=>{f();"use strict";var Sit={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};ele.SignaturePolicy=Sit});var mC=y((lBt,nle)=>{f();"use strict";var xit=xg(),{toString:Ait}=(tt(),et),{fromString:rle}=(ft(),ht),ile=rt(),{sha256:Iit}=(ri(),li),Tit=()=>xit(8),Rit=(r,e)=>{let t;r instanceof Uint8Array?t=ile.createFromBytes(r).id:t=ile.parse(r).id;let i=new Uint8Array(t.length+e.length);return i.set(t,0),i.set(e,t.length),i},Cit=r=>Iit.encode(r),Pit=(r,e)=>{let t;Array.isArray(e)?t=i=>e.indexOf(i)>-1:t=i=>e.has(i);for(let i of r)if(t(i))return!0;return!1},Oit=r=>Array.isArray(r)?r:[r],kit=(r,e)=>{let t=Object.assign({},r);return r.from instanceof Uint8Array&&(t.from=Ait(r.from,"base58btc")),e&&(t.receivedFrom=e),t},qit=r=>{let e=Object.assign({},r);return typeof r.from=="string"&&(e.from=rle(r.from,"base58btc")),typeof r.data=="string"&&(e.data=rle(r.data)),e};nle.exports={randomSeqno:Tit,msgId:Rit,noSignMsgId:Cit,anyMatch:Pit,ensureArray:Oit,normalizeInRpcMessage:kit,normalizeOutRpcMessage:qit}});var ule=y((fBt,cle)=>{f();"use strict";var bC=rt(),{RPC:sle}=uC(),{concat:ole}=(cn(),an),{fromString:Nit}=(ft(),ht),vC=Nit("libp2p-pubsub:"),{normalizeOutRpcMessage:Dit}=mC();async function Bit(r,e){let t=ole([vC,sle.Message.encode(Dit(e)).finish()]),i=await r.privKey.sign(t);return{...e,signature:i,key:r.pubKey.bytes}}async function Mit(r){if(!r.signature)throw new Error("Message must contain a signature to be verified");if(!r.from)throw new Error("Message must contain a from property to be verified");let e=ole([vC,sle.Message.encode({...r,from:bC.createFromB58String(r.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await ale(r)).verify(e,r.signature)}async function ale(r){if(!r.from)throw new Error("Could not get the public key from the originator id");let e=bC.createFromB58String(r.from);if(r.key){let t=await bC.createFromPubKey(r.key);if(t.equals(e))return t.pubKey;throw new Error("Public Key does not match the originator")}else{if(e.pubKey)return e.pubKey;throw new Error("Could not get the public key from the originator id")}}cle.exports={messagePublicKey:ale,signMessage:Bit,SignPrefix:vC,verifySignature:Mit}});var hle=y((dBt,dle)=>{f();"use strict";var lle=be(),{EventEmitter:Lit}=yr(),cs=ae(),{pipe:Uit}=Ar(),Fit=lS(),{codes:na}=fS(),{RPC:fle}=uC(),Kit=Jue(),{SignaturePolicy:hu}=tle(),Kl=mC(),{signMessage:jit,verifySignature:Vit}=ule(),yS=class extends Lit{constructor({debugName:e,multicodecs:t,libp2p:i,globalSignaturePolicy:n=hu.StrictSign,canRelayMessage:s=!1,emitSelf:o=!1}){if(typeof e!="string")throw new Error("a debugname `string` is required");if(!t)throw new Error("multicodecs are required");if(!i)throw new Error("libp2p is required");super();if(this.log=Object.assign(lle(e),{err:lle(`${e}:error`)}),this.multicodecs=Kl.ensureArray(t),this._libp2p=i,this.registrar=i.registrar,this.peerId=i.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!hu[n])throw cs(new Error("Invalid global signature policy"),na.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=n,this.canRelayMessage=s,this.emitSelf=o,this.topicValidators=new Map,this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);let e=new Fit({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(e),this.log("started"),this.started=!0}stop(){!this.started||(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(e=>e.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:e,stream:t,connection:i}){let n=i.remotePeer,s=n.toB58String(),o=this._addPeer(n,e),a=o.attachInboundStream(t);this._processMessages(s,a,o)}async _onPeerConnected(e,t){let i=e.toB58String();this.log("connected",i);try{let{stream:n,protocol:s}=await t.newStream(this.multicodecs);await this._addPeer(e,s).attachOutboundStream(n)}catch(n){this.log.err(n)}this._sendSubscriptions(i,Array.from(this.subscriptions),!0)}_onPeerDisconnected(e,t){let i=e.toB58String();this.log("connection ended",i,t?t.message:""),this._removePeer(e)}_addPeer(e,t){let i=e.toB58String(),n=this.peers.get(i);if(n)return n;this.log("new peer",i);let s=new Kit({id:e,protocol:t});return this.peers.set(i,s),s.once("close",()=>this._removePeer(e)),s}_removePeer(e){if(!e)return;let t=e.toB58String(),i=this.peers.get(t);if(!!i){i.removeAllListeners(),i.close(),this.log("delete peer",t),this.peers.delete(t);for(let n of this.topics.values())n.delete(t);return i}}async _processMessages(e,t,i){try{await Uit(t,async n=>{for await(let s of n){let o=s instanceof Uint8Array?s:s.slice(),a=this._decodeRpc(o);await this._processRpc(e,i,a)}})}catch(n){this._onPeerDisconnected(i.id,n)}}async _processRpc(e,t,i){this.log("rpc from",e);let n=i.subscriptions,s=i.msgs;if(n.length&&(n.forEach(o=>{this._processRpcSubOpt(e,o)}),this.emit("pubsub:subscription-change",t.id,n)),!this._acceptFrom(e))return this.log("received message from unacceptable peer %s",e),!1;if(s.length)for(let o of s){if(!(this.canRelayMessage||o.topicIDs&&o.topicIDs.some(c=>this.subscriptions.has(c)))){this.log("received message we didn't subscribe to. Dropping.");continue}let a=Kl.normalizeInRpcMessage(o,e);await this._processRpcMessage(a)}return!0}_processRpcSubOpt(e,t){let i=t.topicID;if(!i)return;let n=this.topics.get(i);n||(n=new Set,this.topics.set(i,n)),t.subscribe?n.add(e):n.delete(e)}async _processRpcMessage(e){if(!(this.peerId.toB58String()===e.from&&!this.emitSelf)){try{await this.validate(e)}catch(t){this.log("Message is invalid, dropping it. %O",t);return}return this._emitMessage(e),this._publish(Kl.normalizeOutRpcMessage(e))}}_emitMessage(e){e.topicIDs.forEach(t=>{this.subscriptions.has(t)&&this.emit(t,e)})}getMsgId(e){let t=this.globalSignaturePolicy;switch(t){case hu.StrictSign:return Kl.msgId(e.from,e.seqno);case hu.StrictNoSign:return Kl.noSignMsgId(e.data);default:throw cs(new Error("Cannot get message id: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(e){return!0}_decodeRpc(e){return fle.decode(e)}_encodeRpc(e){return fle.encode(e).finish()}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable){let n=`Cannot send RPC to ${e} as there is no open stream to it available`;this.log.err(n);return}i.write(this._encodeRpc(t))}_sendSubscriptions(e,t,i){return this._sendRpc(e,{subscriptions:t.map(n=>({topicID:n,subscribe:i}))})}async validate(e){let t=this.globalSignaturePolicy;switch(t){case hu.StrictNoSign:if(e.from)throw cs(new Error("StrictNoSigning: from should not be present"),na.ERR_UNEXPECTED_FROM);if(e.signature)throw cs(new Error("StrictNoSigning: signature should not be present"),na.ERR_UNEXPECTED_SIGNATURE);if(e.key)throw cs(new Error("StrictNoSigning: key should not be present"),na.ERR_UNEXPECTED_KEY);if(e.seqno)throw cs(new Error("StrictNoSigning: seqno should not be present"),na.ERR_UNEXPECTED_SEQNO);break;case hu.StrictSign:if(!e.signature)throw cs(new Error("StrictSigning: Signing required and no signature was present"),na.ERR_MISSING_SIGNATURE);if(!e.seqno)throw cs(new Error("StrictSigning: Signing required and no seqno was present"),na.ERR_MISSING_SEQNO);if(!await Vit(e))throw cs(new Error("StrictSigning: Invalid message signature"),na.ERR_INVALID_SIGNATURE);break;default:throw cs(new Error("Cannot validate message: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}for(let i of e.topicIDs){let n=this.topicValidators.get(i);n&&await n(i,e)}}_buildMessage(e){let t=this.globalSignaturePolicy;switch(t){case hu.StrictSign:return e.from=this.peerId.toB58String(),e.seqno=Kl.randomSeqno(),jit(this.peerId,e);case hu.StrictNoSign:return Promise.resolve(e);default:throw cs(new Error("Cannot build message: unhandled signature policy: "+t),na.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(e){if(!this.started)throw cs(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!e||typeof e!="string")throw cs(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");let t=this.topics.get(e);return t?Array.from(t):[]}async publish(e,t){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",e,t);let n={receivedFrom:this.peerId.toB58String(),data:t,topicIDs:[e]},s=await this._buildMessage(n),o=Kl.normalizeInRpcMessage(s);this.emitSelf&&this._emitMessage(o),await this._publish(o)}_publish(e){throw cs(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(e){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(e)||(this.subscriptions.add(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!0)))}unsubscribe(e){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(e)&&this.listenerCount(e)===0&&(this.subscriptions.delete(e),this.peers.forEach((t,i)=>this._sendSubscriptions(i,[e],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}};yS.utils=Kl;yS.SignaturePolicy=hu;dle.exports=yS});var ple=y(gS=>{f();"use strict";Object.defineProperty(gS,"__esModule",{value:!0});gS.createGossipRpc=void 0;function zit(r=[],e={}){return{subscriptions:[],msgs:r,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},e)}}gS.createGossipRpc=zit});var yle=y(mS=>{f();"use strict";Object.defineProperty(mS,"__esModule",{value:!0});mS.shuffle=void 0;function Hit(r){if(r.length<=1)return r;let e=()=>Math.floor(Math.random()*Math.floor(r.length));for(let t=0;t<r.length;t++){let i=e(),n=r[t];r[t]=r[i],r[i]=n}return r}mS.shuffle=Hit});var qd=y(Pe=>{f();"use strict";Object.defineProperty(Pe,"__esModule",{value:!0});Pe.ERR_TOPIC_VALIDATOR_IGNORE=Pe.ERR_TOPIC_VALIDATOR_REJECT=Pe.TimeCacheDuration=Pe.GossipsubIWantFollowupTime=Pe.GossipsubMaxIHaveMessages=Pe.GossipsubMaxIHaveLength=Pe.GossipsubGraftFloodThreshold=Pe.GossipsubOpportunisticGraftPeers=Pe.GossipsubOpportunisticGraftTicks=Pe.GossipsubDirectConnectInitialDelay=Pe.GossipsubDirectConnectTicks=Pe.GossipsubConnectionTimeout=Pe.GossipsubMaxPendingConnections=Pe.GossipsubConnectors=Pe.GossipsubPruneBackoffTicks=Pe.GossipsubPruneBackoff=Pe.GossipsubPrunePeers=Pe.GossipsubFanoutTTL=Pe.GossipsubHeartbeatInterval=Pe.GossipsubHeartbeatInitialDelay=Pe.GossipsubGossipRetransmission=Pe.GossipsubGossipFactor=Pe.GossipsubDlazy=Pe.GossipsubHistoryGossip=Pe.GossipsubHistoryLength=Pe.GossipsubDout=Pe.GossipsubDscore=Pe.GossipsubDhi=Pe.GossipsubDlo=Pe.GossipsubD=Pe.GossipsubIDv11=Pe.GossipsubIDv10=Pe.FloodsubID=Pe.minute=Pe.second=void 0;Pe.second=1e3;Pe.minute=60*Pe.second;Pe.FloodsubID="/floodsub/1.0.0";Pe.GossipsubIDv10="/meshsub/1.0.0";Pe.GossipsubIDv11="/meshsub/1.1.0";Pe.GossipsubD=6;Pe.GossipsubDlo=4;Pe.GossipsubDhi=12;Pe.GossipsubDscore=4;Pe.GossipsubDout=2;Pe.GossipsubHistoryLength=5;Pe.GossipsubHistoryGossip=3;Pe.GossipsubDlazy=6;Pe.GossipsubGossipFactor=.25;Pe.GossipsubGossipRetransmission=3;Pe.GossipsubHeartbeatInitialDelay=100;Pe.GossipsubHeartbeatInterval=Pe.second;Pe.GossipsubFanoutTTL=Pe.minute;Pe.GossipsubPrunePeers=16;Pe.GossipsubPruneBackoff=Pe.minute;Pe.GossipsubPruneBackoffTicks=15;Pe.GossipsubConnectors=8;Pe.GossipsubMaxPendingConnections=128;Pe.GossipsubConnectionTimeout=30*Pe.second;Pe.GossipsubDirectConnectTicks=300;Pe.GossipsubDirectConnectInitialDelay=Pe.second;Pe.GossipsubOpportunisticGraftTicks=60;Pe.GossipsubOpportunisticGraftPeers=2;Pe.GossipsubGraftFloodThreshold=10*Pe.second;Pe.GossipsubMaxIHaveLength=5e3;Pe.GossipsubMaxIHaveMessages=10;Pe.GossipsubIWantFollowupTime=3*Pe.second;Pe.TimeCacheDuration=120*1e3;Pe.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT";Pe.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"});var mle=y(bS=>{f();"use strict";Object.defineProperty(bS,"__esModule",{value:!0});bS.hasGossipProtocol=void 0;var gle=qd();function $it(r){return r===gle.GossipsubIDv10||r===gle.GossipsubIDv11}bS.hasGossipProtocol=$it});var ble=y(vS=>{f();"use strict";Object.defineProperty(vS,"__esModule",{value:!0});vS.messageIdToString=void 0;var Git=(tt(),et);function Wit(r){return Git.toString(r,"base64")}vS.messageIdToString=Wit});var Nd=y(dc=>{f();"use strict";var Yit=dc&&dc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),wS=dc&&dc.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Yit(e,r,t)};Object.defineProperty(dc,"__esModule",{value:!0});wS(ple(),dc);wS(yle(),dc);wS(mle(),dc);wS(ble(),dc)});var wle=y(C0=>{f();"use strict";var Xit=C0&&C0.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(C0,"__esModule",{value:!0});C0.MessageCache=void 0;var _S=Nd(),vle=class{constructor(e,t,i){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let n=0;n<t;n++)this.history[n]=[];this.gossip=e,this.msgIdFn=i}put(e){return Xit(this,void 0,void 0,function*(){let t=yield this.getMsgId(e),i=_S.messageIdToString(t);this.msgs.set(i,e),this.history[0].push({msgID:t,topics:e.topicIDs})})}getMsgId(e){return this.msgIdFn(e)}get(e){return this.msgs.get(_S.messageIdToString(e))}getForPeer(e,t){let i=_S.messageIdToString(e),n=this.msgs.get(i);if(!n)return[void 0,0];let s=this.peertx.get(i);s||(s=new Map,this.peertx.set(i,s));let o=(s.get(t)||0)+1;return s.set(t,o),[n,o]}getGossipIDs(e){let t=[];for(let i=0;i<this.gossip;i++)this.history[i].forEach(n=>{for(let s of n.topics)if(s===e){t.push(n.msgID);break}});return t}shift(){this.history[this.history.length-1].forEach(t=>{let i=_S.messageIdToString(t.msgID);this.msgs.delete(i),this.peertx.delete(i)}),this.history.pop(),this.history.unshift([])}};C0.MessageCache=vle});var Ele=y((_le,zb)=>{f();(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof ya=="function"&&typeof zb=="object"&&zb&&zb.exports&&(zb.exports=e(ki()))})(_le,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots.default||(r.roots.default={});return n.RPC=function(){function s(a){if(this.subscriptions=[],this.msgs=[],a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}s.prototype.subscriptions=i.emptyArray,s.prototype.msgs=i.emptyArray,s.prototype.control=null;var o;return Object.defineProperty(s.prototype,"_control",{get:i.oneOfGetter(o=["control"]),set:i.oneOfSetter(o)}),s.encode=function(c,u){if(u||(u=t.create()),c.subscriptions!=null&&c.subscriptions.length)for(var l=0;l<c.subscriptions.length;++l)n.RPC.SubOpts.encode(c.subscriptions[l],u.uint32(10).fork()).ldelim();if(c.msgs!=null&&c.msgs.length)for(var l=0;l<c.msgs.length;++l)n.RPC.Message.encode(c.msgs[l],u.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&n.RPC.ControlMessage.encode(c.control,u.uint32(26).fork()).ldelim(),u},s.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.RPC;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.subscriptions&&d.subscriptions.length||(d.subscriptions=[]),d.subscriptions.push(n.RPC.SubOpts.decode(c,c.uint32()));break;case 2:d.msgs&&d.msgs.length||(d.msgs=[]),d.msgs.push(n.RPC.Message.decode(c,c.uint32()));break;case 3:d.control=n.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(h&7);break}}return d},s.fromObject=function(c){if(c instanceof n.RPC)return c;var u=new n.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");u.subscriptions=[];for(var l=0;l<c.subscriptions.length;++l){if(typeof c.subscriptions[l]!="object")throw TypeError(".RPC.subscriptions: object expected");u.subscriptions[l]=n.RPC.SubOpts.fromObject(c.subscriptions[l])}}if(c.msgs){if(!Array.isArray(c.msgs))throw TypeError(".RPC.msgs: array expected");u.msgs=[];for(var l=0;l<c.msgs.length;++l){if(typeof c.msgs[l]!="object")throw TypeError(".RPC.msgs: object expected");u.msgs[l]=n.RPC.Message.fromObject(c.msgs[l])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");u.control=n.RPC.ControlMessage.fromObject(c.control)}return u},s.toObject=function(c,u){u||(u={});var l={};if((u.arrays||u.defaults)&&(l.subscriptions=[],l.msgs=[]),c.subscriptions&&c.subscriptions.length){l.subscriptions=[];for(var d=0;d<c.subscriptions.length;++d)l.subscriptions[d]=n.RPC.SubOpts.toObject(c.subscriptions[d],u)}if(c.msgs&&c.msgs.length){l.msgs=[];for(var d=0;d<c.msgs.length;++d)l.msgs[d]=n.RPC.Message.toObject(c.msgs[d],u)}return c.control!=null&&c.hasOwnProperty("control")&&(l.control=n.RPC.ControlMessage.toObject(c.control,u),u.oneofs&&(l._control="control")),l},s.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},s.SubOpts=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.subscribe=null,a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:i.oneOfGetter(c=["subscribe"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.subscribe!=null&&Object.hasOwnProperty.call(l,"subscribe")&&d.uint32(8).bool(l.subscribe),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(18).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.SubOpts;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.subscribe=l.bool();break;case 2:p.topicID=l.string();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.SubOpts)return l;var d=new n.RPC.SubOpts;return l.subscribe!=null&&(d.subscribe=Boolean(l.subscribe)),l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.subscribe!=null&&l.hasOwnProperty("subscribe")&&(h.subscribe=l.subscribe,d.oneofs&&(h._subscribe="subscribe")),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.Message=function(){function a(u){if(this.topicIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topicIDs=i.emptyArray,a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:i.oneOfGetter(c=["from"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:i.oneOfGetter(c=["data"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:i.oneOfGetter(c=["seqno"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:i.oneOfGetter(c=["signature"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:i.oneOfGetter(c=["key"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.from!=null&&Object.hasOwnProperty.call(l,"from")&&d.uint32(10).bytes(l.from),l.data!=null&&Object.hasOwnProperty.call(l,"data")&&d.uint32(18).bytes(l.data),l.seqno!=null&&Object.hasOwnProperty.call(l,"seqno")&&d.uint32(26).bytes(l.seqno),l.topicIDs!=null&&l.topicIDs.length)for(var h=0;h<l.topicIDs.length;++h)d.uint32(34).string(l.topicIDs[h]);return l.signature!=null&&Object.hasOwnProperty.call(l,"signature")&&d.uint32(42).bytes(l.signature),l.key!=null&&Object.hasOwnProperty.call(l,"key")&&d.uint32(50).bytes(l.key),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.Message;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.from=l.bytes();break;case 2:p.data=l.bytes();break;case 3:p.seqno=l.bytes();break;case 4:p.topicIDs&&p.topicIDs.length||(p.topicIDs=[]),p.topicIDs.push(l.string());break;case 5:p.signature=l.bytes();break;case 6:p.key=l.bytes();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.Message)return l;var d=new n.RPC.Message;if(l.from!=null&&(typeof l.from=="string"?i.base64.decode(l.from,d.from=i.newBuffer(i.base64.length(l.from)),0):l.from.length&&(d.from=l.from)),l.data!=null&&(typeof l.data=="string"?i.base64.decode(l.data,d.data=i.newBuffer(i.base64.length(l.data)),0):l.data.length&&(d.data=l.data)),l.seqno!=null&&(typeof l.seqno=="string"?i.base64.decode(l.seqno,d.seqno=i.newBuffer(i.base64.length(l.seqno)),0):l.seqno.length&&(d.seqno=l.seqno)),l.topicIDs){if(!Array.isArray(l.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");d.topicIDs=[];for(var h=0;h<l.topicIDs.length;++h)d.topicIDs[h]=String(l.topicIDs[h])}return l.signature!=null&&(typeof l.signature=="string"?i.base64.decode(l.signature,d.signature=i.newBuffer(i.base64.length(l.signature)),0):l.signature.length&&(d.signature=l.signature)),l.key!=null&&(typeof l.key=="string"?i.base64.decode(l.key,d.key=i.newBuffer(i.base64.length(l.key)),0):l.key.length&&(d.key=l.key)),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.topicIDs=[]),l.from!=null&&l.hasOwnProperty("from")&&(h.from=d.bytes===String?i.base64.encode(l.from,0,l.from.length):d.bytes===Array?Array.prototype.slice.call(l.from):l.from,d.oneofs&&(h._from="from")),l.data!=null&&l.hasOwnProperty("data")&&(h.data=d.bytes===String?i.base64.encode(l.data,0,l.data.length):d.bytes===Array?Array.prototype.slice.call(l.data):l.data,d.oneofs&&(h._data="data")),l.seqno!=null&&l.hasOwnProperty("seqno")&&(h.seqno=d.bytes===String?i.base64.encode(l.seqno,0,l.seqno.length):d.bytes===Array?Array.prototype.slice.call(l.seqno):l.seqno,d.oneofs&&(h._seqno="seqno")),l.topicIDs&&l.topicIDs.length){h.topicIDs=[];for(var p=0;p<l.topicIDs.length;++p)h.topicIDs[p]=l.topicIDs[p]}return l.signature!=null&&l.hasOwnProperty("signature")&&(h.signature=d.bytes===String?i.base64.encode(l.signature,0,l.signature.length):d.bytes===Array?Array.prototype.slice.call(l.signature):l.signature,d.oneofs&&(h._signature="signature")),l.key!=null&&l.hasOwnProperty("key")&&(h.key=d.bytes===String?i.base64.encode(l.key,0,l.key.length):d.bytes===Array?Array.prototype.slice.call(l.key):l.key,d.oneofs&&(h._key="key")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.ihave=i.emptyArray,a.prototype.iwant=i.emptyArray,a.prototype.graft=i.emptyArray,a.prototype.prune=i.emptyArray,a.encode=function(u,l){if(l||(l=t.create()),u.ihave!=null&&u.ihave.length)for(var d=0;d<u.ihave.length;++d)n.RPC.ControlIHave.encode(u.ihave[d],l.uint32(10).fork()).ldelim();if(u.iwant!=null&&u.iwant.length)for(var d=0;d<u.iwant.length;++d)n.RPC.ControlIWant.encode(u.iwant[d],l.uint32(18).fork()).ldelim();if(u.graft!=null&&u.graft.length)for(var d=0;d<u.graft.length;++d)n.RPC.ControlGraft.encode(u.graft[d],l.uint32(26).fork()).ldelim();if(u.prune!=null&&u.prune.length)for(var d=0;d<u.prune.length;++d)n.RPC.ControlPrune.encode(u.prune[d],l.uint32(34).fork()).ldelim();return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlMessage;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.ihave&&h.ihave.length||(h.ihave=[]),h.ihave.push(n.RPC.ControlIHave.decode(u,u.uint32()));break;case 2:h.iwant&&h.iwant.length||(h.iwant=[]),h.iwant.push(n.RPC.ControlIWant.decode(u,u.uint32()));break;case 3:h.graft&&h.graft.length||(h.graft=[]),h.graft.push(n.RPC.ControlGraft.decode(u,u.uint32()));break;case 4:h.prune&&h.prune.length||(h.prune=[]),h.prune.push(n.RPC.ControlPrune.decode(u,u.uint32()));break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlMessage)return u;var l=new n.RPC.ControlMessage;if(u.ihave){if(!Array.isArray(u.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");l.ihave=[];for(var d=0;d<u.ihave.length;++d){if(typeof u.ihave[d]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");l.ihave[d]=n.RPC.ControlIHave.fromObject(u.ihave[d])}}if(u.iwant){if(!Array.isArray(u.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");l.iwant=[];for(var d=0;d<u.iwant.length;++d){if(typeof u.iwant[d]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");l.iwant[d]=n.RPC.ControlIWant.fromObject(u.iwant[d])}}if(u.graft){if(!Array.isArray(u.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");l.graft=[];for(var d=0;d<u.graft.length;++d){if(typeof u.graft[d]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");l.graft[d]=n.RPC.ControlGraft.fromObject(u.graft[d])}}if(u.prune){if(!Array.isArray(u.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");l.prune=[];for(var d=0;d<u.prune.length;++d){if(typeof u.prune[d]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");l.prune[d]=n.RPC.ControlPrune.fromObject(u.prune[d])}}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.ihave=[],d.iwant=[],d.graft=[],d.prune=[]),u.ihave&&u.ihave.length){d.ihave=[];for(var h=0;h<u.ihave.length;++h)d.ihave[h]=n.RPC.ControlIHave.toObject(u.ihave[h],l)}if(u.iwant&&u.iwant.length){d.iwant=[];for(var h=0;h<u.iwant.length;++h)d.iwant[h]=n.RPC.ControlIWant.toObject(u.iwant[h],l)}if(u.graft&&u.graft.length){d.graft=[];for(var h=0;h<u.graft.length;++h)d.graft[h]=n.RPC.ControlGraft.toObject(u.graft[h],l)}if(u.prune&&u.prune.length){d.prune=[];for(var h=0;h<u.prune.length;++h)d.prune[h]=n.RPC.ControlPrune.toObject(u.prune[h],l)}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIHave=function(){function a(u){if(this.messageIDs=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.messageIDs=i.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.messageIDs!=null&&l.messageIDs.length)for(var h=0;h<l.messageIDs.length;++h)d.uint32(18).bytes(l.messageIDs[h]);return d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlIHave;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;case 2:p.messageIDs&&p.messageIDs.length||(p.messageIDs=[]),p.messageIDs.push(l.bytes());break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlIHave)return l;var d=new n.RPC.ControlIHave;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.messageIDs){if(!Array.isArray(l.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");d.messageIDs=[];for(var h=0;h<l.messageIDs.length;++h)typeof l.messageIDs[h]=="string"?i.base64.decode(l.messageIDs[h],d.messageIDs[h]=i.newBuffer(i.base64.length(l.messageIDs[h])),0):l.messageIDs[h].length&&(d.messageIDs[h]=l.messageIDs[h])}return d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.messageIDs=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.messageIDs&&l.messageIDs.length){h.messageIDs=[];for(var p=0;p<l.messageIDs.length;++p)h.messageIDs[p]=d.bytes===String?i.base64.encode(l.messageIDs[p],0,l.messageIDs[p].length):d.bytes===Array?Array.prototype.slice.call(l.messageIDs[p]):l.messageIDs[p]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var u=Object.keys(c),l=0;l<u.length;++l)c[u[l]]!=null&&(this[u[l]]=c[u[l]])}return a.prototype.messageIDs=i.emptyArray,a.encode=function(u,l){if(l||(l=t.create()),u.messageIDs!=null&&u.messageIDs.length)for(var d=0;d<u.messageIDs.length;++d)l.uint32(10).bytes(u.messageIDs[d]);return l},a.decode=function(u,l){u instanceof e||(u=e.create(u));for(var d=l===void 0?u.len:u.pos+l,h=new n.RPC.ControlIWant;u.pos<d;){var p=u.uint32();switch(p>>>3){case 1:h.messageIDs&&h.messageIDs.length||(h.messageIDs=[]),h.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return h},a.fromObject=function(u){if(u instanceof n.RPC.ControlIWant)return u;var l=new n.RPC.ControlIWant;if(u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");l.messageIDs=[];for(var d=0;d<u.messageIDs.length;++d)typeof u.messageIDs[d]=="string"?i.base64.decode(u.messageIDs[d],l.messageIDs[d]=i.newBuffer(i.base64.length(u.messageIDs[d])),0):u.messageIDs[d].length&&(l.messageIDs[d]=u.messageIDs[d])}return l},a.toObject=function(u,l){l||(l={});var d={};if((l.arrays||l.defaults)&&(d.messageIDs=[]),u.messageIDs&&u.messageIDs.length){d.messageIDs=[];for(var h=0;h<u.messageIDs.length;++h)d.messageIDs[h]=l.bytes===String?i.base64.encode(u.messageIDs[h],0,u.messageIDs[h].length):l.bytes===Array?Array.prototype.slice.call(u.messageIDs[h]):u.messageIDs[h]}return d},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlGraft=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlGraft;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlGraft)return l;var d=new n.RPC.ControlGraft;return l.topicID!=null&&(d.topicID=String(l.topicID)),d},a.toObject=function(l,d){d||(d={});var h={};return l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.ControlPrune=function(){function a(u){if(this.peers=[],u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.topicID=null,a.prototype.peers=i.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:i.oneOfGetter(c=["topicID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:i.oneOfGetter(c=["backoff"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){if(d||(d=t.create()),l.topicID!=null&&Object.hasOwnProperty.call(l,"topicID")&&d.uint32(10).string(l.topicID),l.peers!=null&&l.peers.length)for(var h=0;h<l.peers.length;++h)n.RPC.PeerInfo.encode(l.peers[h],d.uint32(18).fork()).ldelim();return l.backoff!=null&&Object.hasOwnProperty.call(l,"backoff")&&d.uint32(24).uint64(l.backoff),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.ControlPrune;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.topicID=l.string();break;case 2:p.peers&&p.peers.length||(p.peers=[]),p.peers.push(n.RPC.PeerInfo.decode(l,l.uint32()));break;case 3:p.backoff=l.uint64();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.ControlPrune)return l;var d=new n.RPC.ControlPrune;if(l.topicID!=null&&(d.topicID=String(l.topicID)),l.peers){if(!Array.isArray(l.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");d.peers=[];for(var h=0;h<l.peers.length;++h){if(typeof l.peers[h]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");d.peers[h]=n.RPC.PeerInfo.fromObject(l.peers[h])}}return l.backoff!=null&&(i.Long?(d.backoff=i.Long.fromValue(l.backoff)).unsigned=!0:typeof l.backoff=="string"?d.backoff=parseInt(l.backoff,10):typeof l.backoff=="number"?d.backoff=l.backoff:typeof l.backoff=="object"&&(d.backoff=new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0))),d},a.toObject=function(l,d){d||(d={});var h={};if((d.arrays||d.defaults)&&(h.peers=[]),l.topicID!=null&&l.hasOwnProperty("topicID")&&(h.topicID=l.topicID,d.oneofs&&(h._topicID="topicID")),l.peers&&l.peers.length){h.peers=[];for(var p=0;p<l.peers.length;++p)h.peers[p]=n.RPC.PeerInfo.toObject(l.peers[p],d)}return l.backoff!=null&&l.hasOwnProperty("backoff")&&(typeof l.backoff=="number"?h.backoff=d.longs===String?String(l.backoff):l.backoff:h.backoff=d.longs===String?i.Long.prototype.toString.call(l.backoff):d.longs===Number?new i.LongBits(l.backoff.low>>>0,l.backoff.high>>>0).toNumber(!0):l.backoff,d.oneofs&&(h._backoff="backoff")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s.PeerInfo=function(){function a(u){if(u)for(var l=Object.keys(u),d=0;d<l.length;++d)u[l[d]]!=null&&(this[l[d]]=u[l[d]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:i.oneOfGetter(c=["peerID"]),set:i.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:i.oneOfGetter(c=["signedPeerRecord"]),set:i.oneOfSetter(c)}),a.encode=function(l,d){return d||(d=t.create()),l.peerID!=null&&Object.hasOwnProperty.call(l,"peerID")&&d.uint32(10).bytes(l.peerID),l.signedPeerRecord!=null&&Object.hasOwnProperty.call(l,"signedPeerRecord")&&d.uint32(18).bytes(l.signedPeerRecord),d},a.decode=function(l,d){l instanceof e||(l=e.create(l));for(var h=d===void 0?l.len:l.pos+d,p=new n.RPC.PeerInfo;l.pos<h;){var g=l.uint32();switch(g>>>3){case 1:p.peerID=l.bytes();break;case 2:p.signedPeerRecord=l.bytes();break;default:l.skipType(g&7);break}}return p},a.fromObject=function(l){if(l instanceof n.RPC.PeerInfo)return l;var d=new n.RPC.PeerInfo;return l.peerID!=null&&(typeof l.peerID=="string"?i.base64.decode(l.peerID,d.peerID=i.newBuffer(i.base64.length(l.peerID)),0):l.peerID.length&&(d.peerID=l.peerID)),l.signedPeerRecord!=null&&(typeof l.signedPeerRecord=="string"?i.base64.decode(l.signedPeerRecord,d.signedPeerRecord=i.newBuffer(i.base64.length(l.signedPeerRecord)),0):l.signedPeerRecord.length&&(d.signedPeerRecord=l.signedPeerRecord)),d},a.toObject=function(l,d){d||(d={});var h={};return l.peerID!=null&&l.hasOwnProperty("peerID")&&(h.peerID=d.bytes===String?i.base64.encode(l.peerID,0,l.peerID.length):d.bytes===Array?Array.prototype.slice.call(l.peerID):l.peerID,d.oneofs&&(h._peerID="peerID")),l.signedPeerRecord!=null&&l.hasOwnProperty("signedPeerRecord")&&(h.signedPeerRecord=d.bytes===String?i.base64.encode(l.signedPeerRecord,0,l.signedPeerRecord.length):d.bytes===Array?Array.prototype.slice.call(l.signedPeerRecord):l.signedPeerRecord,d.oneofs&&(h._signedPeerRecord="signedPeerRecord")),h},a.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},a}(),s}(),n})});var wC=y(ES=>{f();"use strict";Object.defineProperty(ES,"__esModule",{value:!0});ES.getGossipPeers=void 0;var Sle=Nd();function Qit(r,e,t,i=()=>!0){let n=r.topics.get(e);if(!n)return new Set;let s=[];return n.forEach(o=>{let a=r.peers.get(o);!a||Sle.hasGossipProtocol(a.protocol)&&i(o)&&s.push(o)}),s=Sle.shuffle(s),t>0&&s.length>t&&(s=s.slice(0,t)),new Set(s)}ES.getGossipPeers=Qit});var Ale=y(hc=>{f();"use strict";var Zit=hc&&hc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Jit=hc&&hc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),ent=hc&&hc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Zit(e,r,t);return Jit(e,r),e};Object.defineProperty(hc,"__esModule",{value:!0});hc.Heartbeat=void 0;var Hb=ent(qd()),SS=wC(),tnt=Nd(),xle=class{constructor(e){this.gossipsub=e}start(){if(this._heartbeatTimer)return;let e=this._heartbeat.bind(this),t=setTimeout(()=>{e(),this._heartbeatTimer.runPeriodically(e,Hb.GossipsubHeartbeatInterval)},Hb.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(i,n)=>{this._heartbeatTimer._intervalId=setInterval(i,n)},cancel:()=>{clearTimeout(t),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){!this._heartbeatTimer||(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){let{D:e,Dlo:t,Dhi:i,Dscore:n,Dout:s}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;let o=new Map,a=h=>{let p=o.get(h);return p===void 0&&(p=this.gossipsub.score.score(h),o.set(h,p)),p},c=new Map,u=new Map,l=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((h,p)=>{let g=E=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",E,p),this.gossipsub.score.prune(E,p),this.gossipsub._addBackoff(E,p),h.delete(E);let v=u.get(E);v?v.push(p):u.set(E,[p])},b=E=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",E,p),this.gossipsub.score.graft(E,p),h.add(E);let v=c.get(E);v?v.push(p):c.set(E,[p])};if(h.forEach(E=>{let v=a(E);v<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",E,v,p),g(E),l.set(E,!0))}),h.size<t){let E=this.gossipsub.backoff.get(p),v=e-h.size;SS.getGossipPeers(this.gossipsub,p,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!E||!E.has(R))&&a(R)>=0).forEach(b)}if(h.size>i){let E=Array.from(h);E.sort((A,R)=>a(R)-a(A)),E=E.slice(0,n).concat(tnt.shuffle(E.slice(n)));let v=0;if(E.slice(0,e).forEach(A=>{this.gossipsub.outbound.get(A)&&v++}),v<s){let A=F=>{let q=E[F];for(let N=F;N>0;N--)E[N]=E[N-1];E[0]=q};if(v>0){let F=v;for(let q=1;q<e&&F>0;q++)this.gossipsub.outbound.get(E[q])&&(A(q),F--)}let R=e-v;for(let F=e;F<E.length&&R>0;F++)this.gossipsub.outbound.get(E[F])&&(A(F),R--)}E.slice(e).forEach(g)}if(h.size>=t){let E=0;if(h.forEach(v=>{this.gossipsub.outbound.get(v)&&E++}),E<s){let v=s-E,A=this.gossipsub.backoff.get(p);SS.getGossipPeers(this.gossipsub,p,v,R=>!h.has(R)&&!this.gossipsub.direct.has(R)&&(!A||!A.has(R))&&a(R)>=0).forEach(b)}}if(this.gossipsub.heartbeatTicks%Hb.GossipsubOpportunisticGraftTicks==0&&h.size>1){let E=Array.from(h).sort((R,F)=>a(R)-a(F)),v=h.size/2,A=a(E[v]);if(A<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){let R=this.gossipsub.backoff.get(p);SS.getGossipPeers(this.gossipsub,p,Hb.GossipsubOpportunisticGraftPeers,q=>h.has(q)&&!this.gossipsub.direct.has(q)&&(!R||!R.has(q))&&a(q)>A).forEach(q=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",q,p),b(q)})}}this.gossipsub._emitGossip(p,h)});let d=this.gossipsub._now();this.gossipsub.lastpub.forEach((h,p)=>{h+Hb.GossipsubFanoutTTL<d&&(this.gossipsub.fanout.delete(p),this.gossipsub.lastpub.delete(p))}),this.gossipsub.fanout.forEach((h,p)=>{let g=this.gossipsub.topics.get(p);if(h.forEach(b=>{(!g.has(b)||a(b)<this.gossipsub._options.scoreThresholds.publishThreshold)&&h.delete(b)}),h.size<e){let b=e-h.size;SS.getGossipPeers(this.gossipsub,p,b,v=>!h.has(v)&&!this.gossipsub.direct.has(v)&&a(v)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(v=>{h.add(v)})}this.gossipsub._emitGossip(p,h)}),this.gossipsub._sendGraftPrune(c,u,l),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}};hc.Heartbeat=xle});var _C=y(P0=>{f();"use strict";Object.defineProperty(P0,"__esModule",{value:!0});P0.ERR_INVALID_PEER_SCORE_THRESHOLDS=P0.ERR_INVALID_PEER_SCORE_PARAMS=void 0;P0.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS";P0.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS"});var EC=y(wn=>{f();"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.validateTopicScoreParams=wn.validatePeerScoreParams=wn.createTopicScoreParams=wn.createPeerScoreParams=wn.defaultTopicScoreParams=wn.defaultPeerScoreParams=void 0;var tr=_C(),rr=ae();wn.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3};wn.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function rnt(r={}){return Object.assign(Object.assign(Object.assign({},wn.defaultPeerScoreParams),r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=Ile(i),e),{}):{}})}wn.createPeerScoreParams=rnt;function Ile(r={}){return Object.assign(Object.assign({},wn.defaultTopicScoreParams),r)}wn.createTopicScoreParams=Ile;function int(r){for(let[e,t]of Object.entries(r.topics))try{Tle(t)}catch(i){throw rr(new Error(`invalid score parameters for topic ${e}: ${i.message}`),tr.ERR_INVALID_PEER_SCORE_PARAMS)}if(r.topicScoreCap<0)throw rr(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.appSpecificScore===null||r.appSpecificScore===void 0)throw rr(new Error("missing application specific score function"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight>0)throw rr(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.IPColocationFactorWeight!==0&&r.IPColocationFactorThreshold<1)throw rr(new Error("invalid IPColocationFactorThreshold; must be at least 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight>0)throw rr(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.behaviourPenaltyWeight!==0&&(r.behaviourPenaltyDecay<=0||r.behaviourPenaltyDecay>=1))throw rr(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayInterval<1e3)throw rr(new Error("invalid DecayInterval; must be at least 1s"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.decayToZero<=0||r.decayToZero>=1)throw rr(new Error("invalid DecayToZero; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS)}wn.validatePeerScoreParams=int;function Tle(r){if(r.topicWeight<0)throw rr(new Error("invalid topic weight; must be >= 0"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshQuantum===0)throw rr(new Error("invalid TimeInMeshQuantum; must be non zero"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight<0)throw rr(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshQuantum<=0)throw rr(new Error("invalid TimeInMeshQuantum; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.timeInMeshWeight!==0&&r.timeInMeshCap<=0)throw rr(new Error("invalid TimeInMeshCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight<0)throw rr(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&(r.firstMessageDeliveriesDecay<=0||r.firstMessageDeliveriesDecay>=1))throw rr(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.firstMessageDeliveriesWeight!==0&&r.firstMessageDeliveriesCap<=0)throw rr(new Error("invalid FirstMessageDeliveriesCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight>0)throw rr(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&(r.meshMessageDeliveriesDecay<=0||r.meshMessageDeliveriesDecay>=1))throw rr(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesCap<=0)throw rr(new Error("invalid MeshMessageDeliveriesCap; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesThreshold<=0)throw rr(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWindow<0)throw rr(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshMessageDeliveriesWeight!==0&&r.meshMessageDeliveriesActivation<1e3)throw rr(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight>0)throw rr(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.meshFailurePenaltyWeight!==0&&(r.meshFailurePenaltyDecay<=0||r.meshFailurePenaltyDecay>=1))throw rr(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesWeight>0)throw rr(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),tr.ERR_INVALID_PEER_SCORE_PARAMS);if(r.invalidMessageDeliveriesDecay<=0||r.invalidMessageDeliveriesDecay>=1)throw rr(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),tr.ERR_INVALID_PEER_SCORE_PARAMS)}wn.validateTopicScoreParams=Tle});var Rle=y(pu=>{f();"use strict";Object.defineProperty(pu,"__esModule",{value:!0});pu.validatePeerScoreThresholds=pu.createPeerScoreThresholds=pu.defaultPeerScoreThresholds=void 0;var $b=_C(),Gb=ae();pu.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function nnt(r={}){return Object.assign(Object.assign({},pu.defaultPeerScoreThresholds),r)}pu.createPeerScoreThresholds=nnt;function snt(r){if(r.gossipThreshold>0)throw Gb(new Error("invalid gossip threshold; it must be <= 0"),$b.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.publishThreshold>0||r.publishThreshold>r.gossipThreshold)throw Gb(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),$b.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.graylistThreshold>0||r.graylistThreshold>r.publishThreshold)throw Gb(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),$b.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.acceptPXThreshold<0)throw Gb(new Error("invalid accept PX threshold; it must be >= 0"),$b.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(r.opportunisticGraftThreshold<0)throw Gb(new Error("invalid opportunistic grafting threshold; it must be >= 0"),$b.ERR_INVALID_PEER_SCORE_THRESHOLDS)}pu.validatePeerScoreThresholds=snt});var Cle=y(jl=>{f();"use strict";Object.defineProperty(jl,"__esModule",{value:!0});jl.ensureTopicStats=jl.createTopicStats=jl.createPeerStats=void 0;function ont(r={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},r),{topics:r.topics?Object.entries(r.topics).reduce((e,[t,i])=>(e[t]=SC(i),e),{}):{}})}jl.createPeerStats=ont;function SC(r={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r)}jl.createTopicStats=SC;function ant(r,e,t){let i=e.topics[r];if(i)return i;if(!!t.topics[r])return e.topics[r]=i=SC(),i}jl.ensureTopicStats=ant});var Ple=y(xS=>{f();"use strict";Object.defineProperty(xS,"__esModule",{value:!0});xS.computeScore=void 0;function cnt(r,e,t,i){let n=0;return Object.entries(e.topics).forEach(([a,c])=>{let u=t.topics[a];if(!u)return;let l=0;if(c.inMesh){let g=c.meshTime/u.timeInMeshQuantum;g>u.timeInMeshCap&&(g=u.timeInMeshCap),l+=g*u.timeInMeshWeight}if(l+=c.firstMessageDeliveries*u.firstMessageDeliveriesWeight,c.meshMessageDeliveriesActive&&c.meshMessageDeliveries<u.meshMessageDeliveriesThreshold){let g=u.meshMessageDeliveriesThreshold-c.meshMessageDeliveries;l+=g*g*u.meshMessageDeliveriesWeight}l+=c.meshFailurePenalty*u.meshFailurePenaltyWeight,l+=c.invalidMessageDeliveries*c.invalidMessageDeliveries*u.invalidMessageDeliveriesWeight,n+=l*u.topicWeight}),t.topicScoreCap>0&&n>t.topicScoreCap&&(n=t.topicScoreCap),n+=t.appSpecificScore(r)*t.appSpecificWeight,e.ips.forEach(a=>{if(t.IPColocationFactorWhitelist.has(a))return;let c=i.get(a),u=c?c.size:0;if(u>t.IPColocationFactorThreshold){let l=u-t.IPColocationFactorThreshold;n+=l*l*t.IPColocationFactorWeight}}),n+=e.behaviourPenalty*e.behaviourPenalty*t.behaviourPenaltyWeight,n}xS.computeScore=cnt});var kle=y((TBt,Ole)=>{f();"use strict";function zr(r,e){var e=e||{};this._head=0,this._tail=0,this._capacity=e.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(r)&&this._fromArray(r)}zr.prototype.peekAt=function(e){var t=e;if(t===(t|0)){var i=this.size();if(!(t>=i||t<-i))return t<0&&(t+=i),t=this._head+t&this._capacityMask,this._list[t]}};zr.prototype.get=function(e){return this.peekAt(e)};zr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};zr.prototype.peekFront=function(){return this.peek()};zr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(zr.prototype,"length",{get:function(){return this.size()}});zr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.unshift=function(e){if(e===void 0)return this.size();var t=this._list.length;return this._head=this._head-1+t&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var t=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),t}};zr.prototype.push=function(e){if(e===void 0)return this.size();var t=this._tail;return this._list[t]=e,this._tail=t+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};zr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var t=this._list.length;this._tail=e-1+t&this._capacityMask;var i=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=t>>>2&&this._shrinkArray(),i}};zr.prototype.removeOne=function(e){var t=e;if(t===(t|0)&&this._head!==this._tail){var i=this.size(),n=this._list.length;if(!(t>=i||t<-i)){t<0&&(t+=i),t=this._head+t&this._capacityMask;var s=this._list[t],o;if(e<i/2){for(o=e;o>0;o--)this._list[t]=this._list[t=t-1+n&this._capacityMask];this._list[t]=void 0,this._head=this._head+1+n&this._capacityMask}else{for(o=i-1-e;o>0;o--)this._list[t]=this._list[t=t+1+n&this._capacityMask];this._list[t]=void 0,this._tail=this._tail-1+n&this._capacityMask}return s}}};zr.prototype.remove=function(e,t){var i=e,n,s=t;if(i===(i|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(i>=o||i<-o||t<1)){if(i<0&&(i+=o),t===1||!t)return n=new Array(1),n[0]=this.removeOne(i),n;if(i===0&&i+t>=o)return n=this.toArray(),this.clear(),n;i+t>o&&(t=o-i);var c;for(n=new Array(t),c=0;c<t;c++)n[c]=this._list[this._head+i+c&this._capacityMask];if(i=this._head+i&this._capacityMask,e+t===o){for(this._tail=this._tail-t+a&this._capacityMask,c=t;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(e===0){for(this._head=this._head+t+a&this._capacityMask,c=t-1;c>0;c--)this._list[i=i+1+a&this._capacityMask]=void 0;return n}if(i<o/2){for(this._head=this._head+e+t+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[i=i-1+a&this._capacityMask]);for(i=this._head-1+a&this._capacityMask;s>0;)this._list[i=i-1+a&this._capacityMask]=void 0,s--;e<0&&(this._tail=i)}else{for(this._tail=i,i=i+t+a&this._capacityMask,c=o-(t+e);c>0;c--)this.push(this._list[i++]);for(i=this._tail;s>0;)this._list[i=i+1+a&this._capacityMask]=void 0,s--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),n}}};zr.prototype.splice=function(e,t){var i=e;if(i===(i|0)){var n=this.size();if(i<0&&(i+=n),!(i>n))if(arguments.length>2){var s,o,a,c=arguments.length,u=this._list.length,l=2;if(!n||i<n/2){for(o=new Array(i),s=0;s<i;s++)o[s]=this._list[this._head+s&this._capacityMask];for(t===0?(a=[],i>0&&(this._head=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._head=this._head+i+u&this._capacityMask);c>l;)this.unshift(arguments[--c]);for(s=i;s>0;s--)this.unshift(o[s-1])}else{o=new Array(n-(i+t));var d=o.length;for(s=0;s<d;s++)o[s]=this._list[this._head+i+t+s&this._capacityMask];for(t===0?(a=[],i!=n&&(this._tail=this._head+i+u&this._capacityMask)):(a=this.remove(i,t),this._tail=this._tail-d+u&this._capacityMask);l<c;)this.push(arguments[l++]);for(s=0;s<d;s++)this.push(o[s])}return a}else return this.remove(i,t)}};zr.prototype.clear=function(){this._head=0,this._tail=0};zr.prototype.isEmpty=function(){return this._head===this._tail};zr.prototype.toArray=function(){return this._copyArray(!1)};zr.prototype._fromArray=function(e){for(var t=0;t<e.length;t++)this.push(e[t])};zr.prototype._copyArray=function(e){var t=[],i=this._list,n=i.length,s;if(e||this._head>this._tail){for(s=this._head;s<n;s++)t.push(i[s]);for(s=0;s<this._tail;s++)t.push(i[s])}else for(s=this._head;s<this._tail;s++)t.push(i[s]);return t};zr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};zr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Ole.exports=zr});var Dle=y(yu=>{f();"use strict";var unt=yu&&yu.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(yu,"__esModule",{value:!0});yu.MessageDeliveries=yu.DeliveryRecordStatus=void 0;var lnt=qd(),fnt=unt(kle()),dnt=Nd(),qle;(function(r){r[r.unknown=0]="unknown",r[r.valid=1]="valid",r[r.invalid=2]="invalid",r[r.ignored=3]="ignored"})(qle=yu.DeliveryRecordStatus||(yu.DeliveryRecordStatus={}));var Nle=class{constructor(){this.records=new Map,this.queue=new fnt.default}ensureRecord(e){let t=dnt.messageIdToString(e),i=this.records.get(t);if(i)return i;i={status:qle.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(t,i);let n={msgId:t,expire:Date.now()+lnt.TimeCacheDuration};return this.queue.push(n),i}gc(){let e=Date.now(),t=this.queue.peekFront();for(;t&&t.expire<e;)this.records.delete(t.msgId),this.queue.shift(),t=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};yu.MessageDeliveries=Nle});var Mle=y(Vl=>{f();"use strict";var AS=Vl&&Vl.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},hnt=Vl&&Vl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vl,"__esModule",{value:!0});Vl.PeerScore=void 0;var pnt=EC(),O0=Cle(),ynt=Ple(),sa=Dle(),gnt=qd(),mnt=hnt(rt()),bnt=be(),vnt=fS(),{ERR_INVALID_SIGNATURE:wnt,ERR_MISSING_SIGNATURE:_nt}=vnt.codes,k0=bnt("libp2p:gossipsub:score"),Ble=class{constructor(e,t,i){pnt.validatePeerScoreParams(e),this.params=e,this._connectionManager=t,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new sa.MessageDeliveries,this.msgId=i}start(){if(this._backgroundInterval){k0("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),k0("started")}stop(){if(!this._backgroundInterval){k0("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),k0("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){let e=Date.now(),t=this.params.decayToZero;this.peerStats.forEach((i,n)=>{if(!i.connected){e>i.expire&&(this._removeIPs(n,i.ips),this.peerStats.delete(n));return}Object.entries(i.topics).forEach(([s,o])=>{let a=this.params.topics[s];!a||(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<t&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<t&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<t&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<t&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),i.behaviourPenalty*=this.params.behaviourPenaltyDecay,i.behaviourPenalty<t&&(i.behaviourPenalty=0)})}score(e){let t=this.peerStats.get(e);return t?ynt.computeScore(e,t,this.params,this.peerIPs):0}addPenalty(e,t){let i=this.peerStats.get(e);!i||(i.behaviourPenalty+=t)}addPeer(e){let t=O0.createPeerStats({connected:!0});this.peerStats.set(e,t);let i=this._getIPs(e);this._setIPs(e,i,t.ips),t.ips=i}removePeer(e){let t=this.peerStats.get(e);if(!!t){if(this.score(e)>0){this._removeIPs(e,t.ips),this.peerStats.delete(e);return}Object.entries(t.topics).forEach(([i,n])=>{n.firstMessageDeliveries=0;let s=this.params.topics[i].meshMessageDeliveriesThreshold;if(n.inMesh&&n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}),t.connected=!1,t.expire=Date.now()+this.params.retainScore}}graft(e,t){let i=this.peerStats.get(e);if(!i)return;let n=O0.ensureTopicStats(t,i,this.params);!n||(n.inMesh=!0,n.graftTime=Date.now(),n.meshTime=0,n.meshMessageDeliveriesActive=!1)}prune(e,t){let i=this.peerStats.get(e);if(!i)return;let n=O0.ensureTopicStats(t,i,this.params);if(!n)return;let s=this.params.topics[t].meshMessageDeliveriesThreshold;if(n.meshMessageDeliveriesActive&&n.meshMessageDeliveries<s){let o=s-n.meshMessageDeliveries;n.meshFailurePenalty+=o*o}n.inMesh=!1}validateMessage(e){return AS(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(yield this.msgId(e))})}deliverMessage(e){return AS(this,void 0,void 0,function*(){let t=e.receivedFrom;this._markFirstMessageDelivery(t,e);let i=this.deliveryRecords.ensureRecord(yield this.msgId(e)),n=Date.now();if(i.status!==sa.DeliveryRecordStatus.unknown){k0("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",t,n-i.firstSeen,sa.DeliveryRecordStatus[i.status]);return}i.status=sa.DeliveryRecordStatus.valid,i.validated=n,i.peers.forEach(s=>{s!==t&&this._markDuplicateMessageDelivery(s,e)})})}rejectMessage(e,t){return AS(this,void 0,void 0,function*(){let i=e.receivedFrom;switch(t){case _nt:case wnt:this._markInvalidMessageDelivery(i,e);return}let n=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(n.status!==sa.DeliveryRecordStatus.unknown){k0("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",i,Date.now()-n.firstSeen,sa.DeliveryRecordStatus[n.status]);return}switch(t){case gnt.ERR_TOPIC_VALIDATOR_IGNORE:n.status=sa.DeliveryRecordStatus.ignored;return}n.status=sa.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(i,e),n.peers.forEach(s=>{this._markInvalidMessageDelivery(s,e)})})}duplicateMessage(e){return AS(this,void 0,void 0,function*(){let t=e.receivedFrom,i=this.deliveryRecords.ensureRecord(yield this.msgId(e));if(!i.peers.has(t))switch(i.status){case sa.DeliveryRecordStatus.unknown:i.peers.add(t);break;case sa.DeliveryRecordStatus.valid:i.peers.add(t),this._markDuplicateMessageDelivery(t,e,i.validated);break;case sa.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(t,e);break}})}_markInvalidMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=O0.ensureTopicStats(n,i,this.params);!s||(s.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(e,t){let i=this.peerStats.get(e);!i||t.topicIDs.forEach(n=>{let s=O0.ensureTopicStats(n,i,this.params);if(!s)return;let o=this.params.topics[n].firstMessageDeliveriesCap;s.firstMessageDeliveries+=1,s.firstMessageDeliveries>o&&(s.firstMessageDeliveries=o),!!s.inMesh&&(o=this.params.topics[n].meshMessageDeliveriesCap,s.meshMessageDeliveries+=1,s.meshMessageDeliveries>o&&(s.meshMessageDeliveries=o))})}_markDuplicateMessageDelivery(e,t,i=0){let n=this.peerStats.get(e);if(!n)return;let s=i?Date.now():0;t.topicIDs.forEach(o=>{let a=O0.ensureTopicStats(o,n,this.params);if(!a||!a.inMesh)return;let c=this.params.topics[o];if(i&&s>i+c.meshMessageDeliveriesWindow)return;let u=c.meshMessageDeliveriesCap;a.meshMessageDeliveries+=1,a.meshMessageDeliveries>u&&(a.meshMessageDeliveries=u)})}_getIPs(e){return this._connectionManager.getAll(mnt.default.createFromB58String(e)).map(t=>t.remoteAddr.toOptions().host)}_setIPs(e,t,i){e:for(let n of t){for(let o of i)if(n===o)continue e;let s=this.peerIPs.get(n);s||(s=new Set,this.peerIPs.set(n,s)),s.add(e)}e:for(let n of i){for(let o of t)if(n===o)continue e;let s=this.peerIPs.get(n);!s||(s.delete(e),s.size||this.peerIPs.delete(n))}}_removeIPs(e,t){t.forEach(i=>{let n=this.peerIPs.get(i);!n||(n.delete(e),n.size||this.peerIPs.delete(i))})}_updateIPs(){this.peerStats.forEach((e,t)=>{let i=this._getIPs(t);this._setIPs(t,i,e.ips),e.ips=i})}};Vl.PeerScore=Ble});var Lle=y(gu=>{f();"use strict";var Ent=gu&&gu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),xC=gu&&gu.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Ent(e,r,t)};Object.defineProperty(gu,"__esModule",{value:!0});xC(EC(),gu);xC(Rle(),gu);xC(Mle(),gu)});var Kle=y(q0=>{f();"use strict";var Ule=q0&&q0.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})};Object.defineProperty(q0,"__esModule",{value:!0});q0.IWantTracer=void 0;var Snt=qd(),AC=Nd(),xnt=fS(),{ERR_INVALID_SIGNATURE:Ant,ERR_MISSING_SIGNATURE:Int}=xnt.codes,Fle=class{constructor(e){this.getMsgId=e,this.promises=new Map}addPromise(e,t){let i=Math.floor(Math.random()*t.length),n=t[i],s=AC.messageIdToString(n),o=this.promises.get(s);o||(o=new Map,this.promises.set(s,o)),o.has(e)||o.set(e,Date.now()+Snt.GossipsubIWantFollowupTime)}getBrokenPromises(){let e=Date.now(),t=new Map;return this.promises.forEach((i,n)=>{i.forEach((s,o)=>{s<e&&(t.set(o,(t.get(o)||0)+1),i.delete(o))}),i.size||this.promises.delete(n)}),t}deliverMessage(e){return Ule(this,void 0,void 0,function*(){let t=yield this.getMsgId(e),i=AC.messageIdToString(t);this.promises.delete(i)})}rejectMessage(e,t){return Ule(this,void 0,void 0,function*(){switch(t){case Ant:case Int:return}let i=yield this.getMsgId(e),n=AC.messageIdToString(i);this.promises.delete(n)})}clear(){this.promises.clear()}};q0.IWantTracer=Fle});var $le=y((kBt,Hle)=>{f();var jle="Expected a function",Vle=0/0,Tnt="[object Symbol]",Rnt=/^\s+|\s+$/g,Cnt=/^[-+]0x[0-9a-f]+$/i,Pnt=/^0b[01]+$/i,Ont=/^0o[0-7]+$/i,knt=parseInt,qnt=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,Nnt=typeof self=="object"&&self&&self.Object===Object&&self,Dnt=qnt||Nnt||Function("return this")(),Bnt=Object.prototype,Mnt=Bnt.toString,Lnt=Math.max,Unt=Math.min,IC=function(){return Dnt.Date.now()};function Fnt(r,e,t){var i,n,s,o,a,c,u=0,l=!1,d=!1,h=!0;if(typeof r!="function")throw new TypeError(jle);e=zle(e)||0,IS(t)&&(l=!!t.leading,d="maxWait"in t,s=d?Lnt(zle(t.maxWait)||0,e):s,h="trailing"in t?!!t.trailing:h);function p(N){var z=i,G=n;return i=n=void 0,u=N,o=r.apply(G,z),o}function g(N){return u=N,a=setTimeout(v,e),l?p(N):o}function b(N){var z=N-c,G=N-u,Y=e-z;return d?Unt(Y,s-G):Y}function E(N){var z=N-c,G=N-u;return c===void 0||z>=e||z<0||d&&G>=s}function v(){var N=IC();if(E(N))return A(N);a=setTimeout(v,b(N))}function A(N){return a=void 0,h&&i?p(N):(i=n=void 0,o)}function R(){a!==void 0&&clearTimeout(a),u=0,i=c=n=a=void 0}function F(){return a===void 0?o:A(IC())}function q(){var N=IC(),z=E(N);if(i=arguments,n=this,c=N,z){if(a===void 0)return g(c);if(d)return a=setTimeout(v,e),p(c)}return a===void 0&&(a=setTimeout(v,e)),o}return q.cancel=R,q.flush=F,q}function Knt(r,e,t){var i=!0,n=!0;if(typeof r!="function")throw new TypeError(jle);return IS(t)&&(i="leading"in t?!!t.leading:i,n="trailing"in t?!!t.trailing:n),Fnt(r,e,{leading:i,maxWait:e,trailing:n})}function IS(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function jnt(r){return!!r&&typeof r=="object"}function Vnt(r){return typeof r=="symbol"||jnt(r)&&Mnt.call(r)==Tnt}function zle(r){if(typeof r=="number")return r;if(Vnt(r))return Vle;if(IS(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=IS(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(Rnt,"");var t=Pnt.test(r);return t||Ont.test(r)?knt(r.slice(2),t?2:8):Cnt.test(r)?Vle:+r}Hle.exports=Knt});var Yle=y((Gle,Wle)=>{f();"use strict";var znt=$le();Gle=Wle.exports=TC;function TC(r){if(!(this instanceof TC))return new TC(r);r=r||{};let e=r.validity||30,t=new Map,i=znt(()=>{t.forEach((n,s)=>{let o=n.validity||e;Hnt(n.timestamp)>o&&t.delete(s)})},200);this.put=(n,s,o)=>{this.has(n)||t.set(n,{value:s,timestamp:new Date,validity:o}),i()},this.get=n=>{if(t.has(n))return t.get(n).value;throw new Error("key does not exist")},this.has=n=>t.has(n)}function Hnt(r){let t=new Date().getTime()-r.getTime();return Math.floor(t/1e3)}});var yi=y(RC=>{f();"use strict";RC.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"};RC.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}});var Zle=y((NBt,Qle)=>{f();"use strict";var N0=ki(),Xle=N0.Reader,$nt=N0.Writer,_r=N0.util,Wb=N0.roots["libp2p-envelope"]||(N0.roots["libp2p-envelope"]={});Wb.Envelope=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.publicKey=_r.newBuffer([]),r.prototype.payloadType=_r.newBuffer([]),r.prototype.payload=_r.newBuffer([]),r.prototype.signature=_r.newBuffer([]),r.encode=function(t,i){return i||(i=$nt.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.payloadType!=null&&Object.hasOwnProperty.call(t,"payloadType")&&i.uint32(18).bytes(t.payloadType),t.payload!=null&&Object.hasOwnProperty.call(t,"payload")&&i.uint32(26).bytes(t.payload),t.signature!=null&&Object.hasOwnProperty.call(t,"signature")&&i.uint32(42).bytes(t.signature),i},r.decode=function(t,i){t instanceof Xle||(t=Xle.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Wb.Envelope;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.publicKey=t.bytes();break;case 2:s.payloadType=t.bytes();break;case 3:s.payload=t.bytes();break;case 5:s.signature=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Wb.Envelope)return t;var i=new Wb.Envelope;return t.publicKey!=null&&(typeof t.publicKey=="string"?_r.base64.decode(t.publicKey,i.publicKey=_r.newBuffer(_r.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.payloadType!=null&&(typeof t.payloadType=="string"?_r.base64.decode(t.payloadType,i.payloadType=_r.newBuffer(_r.base64.length(t.payloadType)),0):t.payloadType.length&&(i.payloadType=t.payloadType)),t.payload!=null&&(typeof t.payload=="string"?_r.base64.decode(t.payload,i.payload=_r.newBuffer(_r.base64.length(t.payload)),0):t.payload.length&&(i.payload=t.payload)),t.signature!=null&&(typeof t.signature=="string"?_r.base64.decode(t.signature,i.signature=_r.newBuffer(_r.base64.length(t.signature)),0):t.signature.length&&(i.signature=t.signature)),i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=_r.newBuffer(n.publicKey))),i.bytes===String?n.payloadType="":(n.payloadType=[],i.bytes!==Array&&(n.payloadType=_r.newBuffer(n.payloadType))),i.bytes===String?n.payload="":(n.payload=[],i.bytes!==Array&&(n.payload=_r.newBuffer(n.payload))),i.bytes===String?n.signature="":(n.signature=[],i.bytes!==Array&&(n.signature=_r.newBuffer(n.signature)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?_r.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.payloadType!=null&&t.hasOwnProperty("payloadType")&&(n.payloadType=i.bytes===String?_r.base64.encode(t.payloadType,0,t.payloadType.length):i.bytes===Array?Array.prototype.slice.call(t.payloadType):t.payloadType),t.payload!=null&&t.hasOwnProperty("payload")&&(n.payload=i.bytes===String?_r.base64.encode(t.payload,0,t.payload.length):i.bytes===Array?Array.prototype.slice.call(t.payload):t.payload),t.signature!=null&&t.hasOwnProperty("signature")&&(n.signature=i.bytes===String?_r.base64.encode(t.signature,0,t.signature.length):i.bytes===Array?Array.prototype.slice.call(t.signature):t.signature),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,N0.util.toJSONOptions)},r}();Qle.exports=Wb});var Yb=y((DBt,tfe)=>{f();"use strict";var Gnt=ae(),{concat:Wnt}=(cn(),an),{fromString:Ynt}=(ft(),ht),Xnt=qw(),Qnt=rt(),CC=ys(),{equals:TS}=(di(),fi),{codes:Znt}=yi(),{Envelope:Jle}=Zle(),zl=class{constructor({peerId:e,payloadType:t,payload:i,signature:n}){this.peerId=e,this.payloadType=t,this.payload=i,this.signature=n,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;let e=Xnt.marshalPublicKey(this.peerId.pubKey);return this._marshal=Jle.encode({publicKey:e,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(e){return TS(this.peerId.pubKey.bytes,e.peerId.pubKey.bytes)&&TS(this.payloadType,e.payloadType)&&TS(this.payload,e.payload)&&TS(this.signature,e.signature)}validate(e){let t=efe(e,this.payloadType,this.payload);return this.peerId.pubKey.verify(t,this.signature)}},efe=(r,e,t)=>{let i=Ynt(r),n=CC.encode(i.byteLength),s=CC.encode(e.length),o=CC.encode(t.length);return Wnt([new Uint8Array(n),i,new Uint8Array(s),e,new Uint8Array(o),t])};zl.createFromProtobuf=async r=>{let e=Jle.decode(r),t=await Qnt.createFromPubKey(e.publicKey);return new zl({peerId:t,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};zl.seal=async(r,e)=>{let t=r.domain,i=r.codec,n=r.marshal(),s=efe(t,i,n),o=await e.privKey.sign(s);return new zl({peerId:e,payloadType:i,payload:n,signature:o})};zl.openAndCertify=async(r,e)=>{let t=await zl.createFromProtobuf(r);if(!await t.validate(e))throw Gnt(new Error("envelope signature is not valid for the given domain"),Znt.ERR_SIGNATURE_NOT_VALID);return t};tfe.exports=zl});var DC=y((mu,ife)=>{f();"use strict";var Jnt=mu&&mu.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),est=mu&&mu.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),rfe=mu&&mu.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Jnt(e,r,t);return est(e,r),e},D0=mu&&mu.__awaiter||function(r,e,t,i){function n(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{u(i.next(l))}catch(d){o(d)}}function c(l){try{u(i.throw(l))}catch(d){o(d)}}function u(l){l.done?s(l.value):n(l.value).then(a,c)}u((i=i.apply(r,e||[])).next())})},PC=rfe(hle()),tst=wle(),OC=Ele(),Dt=rfe(qd()),rst=Ale(),RS=wC(),ji=Nd(),kC=Lle(),ist=Kle(),nst=Yle(),qC=rt(),sst=Yb(),NC=class extends PC.default{constructor(e,t={}){let i=[Dt.GossipsubIDv11,Dt.GossipsubIDv10],n=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:Dt.GossipsubD,Dlo:Dt.GossipsubDlo,Dhi:Dt.GossipsubDhi,Dscore:Dt.GossipsubDscore,Dout:Dt.GossipsubDout,Dlazy:Dt.GossipsubDlazy},t),{scoreParams:kC.createPeerScoreParams(t.scoreParams),scoreThresholds:kC.createPeerScoreThresholds(t.scoreThresholds)});n.fallbackToFloodsub&&i.push(Dt.FloodsubID);super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:i,libp2p:e},n));this._options=n,this.direct=new Set(n.directPeers.map(s=>s.id.toB58String())),n.directPeers.forEach(s=>{e.peerStore.addressBook.add(s.id,s.addrs)}),this.seenCache=new nst,this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=t.messageCache||new tst.MessageCache(Dt.GossipsubHistoryGossip,Dt.GossipsubHistoryLength,this.getMsgId.bind(this)),this.heartbeat=new rst.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new ist.IWantTracer(this.getMsgId.bind(this)),this._libp2p=e,this.score=new kC.PeerScore(this._options.scoreParams,e.connectionManager,this.getMsgId.bind(this))}_decodeRpc(e){return OC.RPC.decode(e)}_encodeRpc(e){return OC.RPC.encode(e).finish()}_addPeer(e,t){let i=super._addPeer(e,t);this.score.addPeer(e.toB58String());let n=!1;for(let s of this._libp2p.connectionManager.getAll(e))if(s.stat.direction==="outbound"&&Array.from(s.registry.values()).some(o=>t===o.protocol)){n=!0;break}return this.outbound.set(i.id.toB58String(),n),i}_removePeer(e){let t=super._removePeer(e),i=e.toB58String();for(let n of this.mesh.values())n.delete(i);for(let n of this.fanout.values())n.delete(i);return this.gossip.delete(i),this.control.delete(i),this.outbound.delete(i),this.score.removePeer(i),t}_processRpc(e,t,i){let n=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return D0(this,void 0,void 0,function*(){return(yield n._processRpc.call(this,e,t,i))?(i.control&&this._processRpcControlMessage(e,i.control),!0):!1})}_processRpcControlMessage(e,t){if(!t)return;let i=t.ihave?this._handleIHave(e,t.ihave):[],n=t.iwant?this._handleIWant(e,t.iwant):[],s=t.graft?this._handleGraft(e,t.graft):[];if(t.prune&&this._handlePrune(e,t.prune),!i.length&&!n.length&&!s.length)return;let o=ji.createGossipRpc(n,{iwant:i,prune:s});this._sendRpc(e,o)}_processRpcMessage(e){let t=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return D0(this,void 0,void 0,function*(){let i=yield this.getMsgId(e),n=ji.messageIdToString(i);if(this.seenCache.has(n)){this.score.duplicateMessage(e);return}this.seenCache.put(n),yield this.score.validateMessage(e),yield t._processRpcMessage.call(this,e)})}_acceptFrom(e){return this.direct.has(e)||this.score.score(e)>=this._options.scoreThresholds.graylistThreshold}validate(e){let t=Object.create(null,{validate:{get:()=>super.validate}});return D0(this,void 0,void 0,function*(){try{yield t.validate.call(this,e)}catch(i){throw this.score.rejectMessage(e,i.code),this.gossipTracer.rejectMessage(e,i.code),i}})}_handleIHave(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,i),[];let n=(this.peerhave.get(e)||0)+1;if(this.peerhave.set(e,n),n>Dt.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,n),[];let s=this.iasked.get(e)||0;if(s>=Dt.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,s),[];let o=new Map;if(t.forEach(({topicID:u,messageIDs:l})=>{!u||!l||!this.mesh.has(u)||l.forEach(d=>{let h=ji.messageIdToString(d);this.seenCache.has(h)||o.set(h,d)})}),!o.size)return[];let a=o.size;a+s>Dt.GossipsubMaxIHaveLength&&(a=Dt.GossipsubMaxIHaveLength-s),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return ji.shuffle(c),c=c.slice(0,a),this.iasked.set(e,s+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}_handleIWant(e,t){if(!t.length)return[];let i=this.score.score(e);if(i<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,i),[];let n=new Map;return t.forEach(({messageIDs:s})=>{s&&s.forEach(o=>{let[a,c]=this.messageCache.getForPeer(o,e);if(!!a){if(c>Dt.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,o);return}n.set(ji.messageIdToString(o),a)}})}),n.size?(this.log("IWANT: Sending %d messages to %s",n.size,e),Array.from(n.values()).map(PC.utils.normalizeOutRpcMessage)):[]}_handleGraft(e,t){let i=[],n=this.score.score(e),s=this._now(),o=this._options.doPX;return t.forEach(({topicID:a})=>{var c;if(!a)return;let u=this.mesh.get(a);if(!u){o=!1;return}if(u.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),i.push(a),o=!1;return}let l=(c=this.backoff.get(a))===null||c===void 0?void 0:c.get(e);if(typeof l=="number"&&s<l){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1),o=!1;let d=l+Dt.GossipsubGraftFloodThreshold-Dt.GossipsubPruneBackoff;s<d&&this.score.addPenalty(e,1),this._addBackoff(e,a),i.push(a);return}if(n<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,n,a),i.push(a),o=!1,this._addBackoff(e,a);return}if(u.size>=this._options.Dhi&&!this.outbound.get(e)){i.push(a),this._addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),u.add(e)}),i.length?i.map(a=>this._makePrune(e,a,o)):[]}_handlePrune(e,t){let i=this.score.score(e);t.forEach(({topicID:n,backoff:s,peers:o})=>{if(!n)return;let a=this.mesh.get(n);if(!!a&&(this.log("PRUNE: Remove mesh link to %s in %s",e,n),this.score.prune(e,n),a.delete(e),typeof s=="number"&&s>0?this._doAddBackoff(e,n,s*1e3):this._addBackoff(e,n),o&&o.length)){if(i<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,i,n);return}this._pxConnect(o)}})}_addBackoff(e,t){this._doAddBackoff(e,t,Dt.GossipsubPruneBackoff)}_doAddBackoff(e,t,i){let n=this.backoff.get(t);n||(n=new Map,this.backoff.set(t,n));let s=this._now()+i;(n.get(e)||0)<s&&n.set(e,s)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,t)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",t,e),this.score.addPenalty(t,e)})}_clearBackoff(){if(this.heartbeatTicks%Dt.GossipsubPruneBackoffTicks!=0)return;let e=this._now();this.backoff.forEach((t,i)=>{t.forEach((n,s)=>{n<e&&t.delete(s)}),t.size===0&&this.backoff.delete(i)})}_directConnect(){if(this.heartbeatTicks%Dt.GossipsubDirectConnectTicks!=0)return;let e=[];this.direct.forEach(t=>{let i=this.peers.get(t);(!i||!i.isWritable)&&e.push(t)}),e.length&&e.forEach(t=>{this._connect(t)})}_pxConnect(e){return D0(this,void 0,void 0,function*(){e.length>Dt.GossipsubPrunePeers&&(ji.shuffle(e),e=e.slice(0,Dt.GossipsubPrunePeers));let t=[];yield Promise.all(e.map(i=>D0(this,void 0,void 0,function*(){if(!i.peerID)return;let s=qC.createFromBytes(i.peerID).toB58String();if(!this.peers.has(s)){if(!i.signedPeerRecord){t.push(s);return}try{let o=yield sst.openAndCertify(i.signedPeerRecord,"libp2p-peer-record"),a=o.peerId.toB58String();if(s!==a){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",a,s);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}t.push(s)}catch(o){this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),!!t.length&&t.forEach(i=>this._connect(i))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(e=>{this._connect(e)})},Dt.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(e){this.log("Initiating connection with %s",e),this._libp2p.dialProtocol(qC.createFromB58String(e),this.multicodecs)}subscribe(e){super.subscribe(e),this.join(e)}unsubscribe(e){super.unsubscribe(e),this.leave(e)}join(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",e);let t=this.fanout.get(e);if(t)t.forEach(i=>{this.score.score(i)<0&&t.delete(i)}),t.size<this._options.D&&RS.getGossipPeers(this,e,this._options.D-t.size,i=>!t.has(i)&&!this.direct.has(i)&&this.score.score(i)>=0).forEach(i=>t.add(i)),this.mesh.set(e,t),this.fanout.delete(e),this.lastpub.delete(e);else{let i=RS.getGossipPeers(this,e,this._options.D,n=>!this.direct.has(n)&&this.score.score(n)>=0);this.mesh.set(e,i)}this.mesh.get(e).forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this._sendGraft(i,e)})}leave(e){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e);let t=this.mesh.get(e);t&&(t.forEach(i=>{this.log("LEAVE: Remove mesh link to %s in %s",i,e),this._sendPrune(i,e)}),this.mesh.delete(e))}_publish(e){return D0(this,void 0,void 0,function*(){e.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(e),this.gossipTracer.deliverMessage(e));let t=yield this.getMsgId(e),i=ji.messageIdToString(t);this.seenCache.put(i),this.messageCache.put(e);let n=new Set;e.topicIDs.forEach(o=>{let a=this.topics.get(o);if(!!a)if(this._options.floodPublish&&e.from===this.peerId.toB58String())a.forEach(c=>{(this.direct.has(c)||this.score.score(c)>=this._options.scoreThresholds.publishThreshold)&&n.add(c)});else{this.direct.forEach(u=>{n.add(u)}),a.forEach(u=>{let l=this.score.score(u),d=this.peers.get(u);!d||d.protocol===Dt.FloodsubID&&l>=this._options.scoreThresholds.publishThreshold&&n.add(u)});let c=this.mesh.get(o);if(!c||!c.size){if(c=this.fanout.get(o),!c){let u=RS.getGossipPeers(this,o,this._options.D,l=>this.score.score(l)>=this._options.scoreThresholds.publishThreshold);u.size>0?(c=u,this.fanout.set(o,u)):c=new Set}this.lastpub.set(o,this._now())}c.forEach(u=>{n.add(u)})}});let s=ji.createGossipRpc([PC.utils.normalizeOutRpcMessage(e)]);n.forEach(o=>{o!==e.from&&this._sendRpc(o,s)})})}_sendGraft(e,t){let i=[{topicID:t}],n=ji.createGossipRpc([],{graft:i});this._sendRpc(e,n)}_sendPrune(e,t){let i=[this._makePrune(e,t,this._options.doPX)],n=ji.createGossipRpc([],{prune:i});this._sendRpc(e,n)}_sendRpc(e,t){let i=this.peers.get(e);if(!i||!i.isWritable)return;let n=this.control.get(e);n&&(this._piggybackControl(e,t,n),this.control.delete(e));let s=this.gossip.get(e);s&&(this._piggybackGossip(e,t,s),this.gossip.delete(e)),i.write(OC.RPC.encode(t).finish())}_piggybackControl(e,t,i){let n=(i.graft||[]).filter(({topicID:o})=>(o&&this.mesh.get(o)||new Set).has(e)),s=(i.prune||[]).filter(({topicID:o})=>!(o&&this.mesh.get(o)||new Set).has(e));!n.length&&!s.length||(t.control?(t.control.graft=t.control.graft&&t.control.graft.concat(n),t.control.prune=t.control.prune&&t.control.prune.concat(s)):t.control={ihave:[],iwant:[],graft:n,prune:s})}_piggybackGossip(e,t,i){t.control||(t.control={ihave:[],iwant:[],graft:[],prune:[]}),t.control.ihave=i}_sendGraftPrune(e,t,i){let n=this._options.doPX;for(let[s,o]of e){let a=o.map(d=>({topicID:d})),c=[],u=t.get(s);u&&(c=u.map(d=>this._makePrune(s,d,n&&!i.get(s))),t.delete(s));let l=ji.createGossipRpc([],{graft:a,prune:c});this._sendRpc(s,l)}for(let[s,o]of t){let a=o.map(u=>this._makePrune(s,u,n&&!i.get(s))),c=ji.createGossipRpc([],{prune:a});this._sendRpc(s,c)}}_emitGossip(e,t){let i=this.messageCache.getGossipIDs(e);if(!i.length)return;ji.shuffle(i),i.length>Dt.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",i.length);let n=[],s=this.topics.get(e);if(!s)return;s.forEach(c=>{let u=this.peers.get(c);!u||!t.has(c)&&!this.direct.has(c)&&ji.hasGossipProtocol(u.protocol)&&this.score.score(c)>=this._options.scoreThresholds.gossipThreshold&&n.push(c)});let o=this._options.Dlazy,a=Dt.GossipsubGossipFactor*n.length;a>o&&(o=a),o>n.length?o=n.length:ji.shuffle(n),n.slice(0,o).forEach(c=>{let u=i;i.length>Dt.GossipsubMaxIHaveLength&&(u=ji.shuffle(u.slice()).slice(0,Dt.GossipsubMaxIHaveLength)),this._pushGossip(c,{topicID:e,messageIDs:u})})}_flush(){for(let[e,t]of this.gossip.entries()){this.gossip.delete(e);let i=ji.createGossipRpc([],{ihave:t});this._sendRpc(e,i)}for(let[e,t]of this.control.entries()){this.control.delete(e);let i=ji.createGossipRpc([],{graft:t.graft,prune:t.prune});this._sendRpc(e,i)}}_pushGossip(e,t){this.log("Add gossip to %s",e);let i=this.gossip.get(e)||[];this.gossip.set(e,i.concat(t))}_now(){return Date.now()}_makePrune(e,t,i){if(this.peers.get(e).protocol===Dt.GossipsubIDv10)return{topicID:t,peers:[]};let n=Dt.GossipsubPruneBackoff/1e3,s=[];return i&&RS.getGossipPeers(this,t,Dt.GossipsubPrunePeers,a=>a!==e&&this.score.score(a)>=0).forEach(a=>{let c=qC.createFromB58String(a);s.push({peerID:c.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(c)})}),{topicID:t,peers:s,backoff:n}}};NC.multicodec=Dt.GossipsubIDv11;ife.exports=NC});var sfe=y((BBt,nfe)=>{f();"use strict";nfe.exports={gossipsub:DC()}});var afe=y((MBt,BC)=>{f();"use strict";var ost=Object.prototype.hasOwnProperty,Fn="~";function Xb(){}Object.create&&(Xb.prototype=Object.create(null),new Xb().__proto__||(Fn=!1));function ast(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function ofe(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new ast(t,i||r,n),o=Fn?Fn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function CS(r,e){--r._eventsCount==0?r._events=new Xb:delete r._events[e]}function _n(){this._events=new Xb,this._eventsCount=0}_n.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)ost.call(t,i)&&e.push(Fn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};_n.prototype.listeners=function(e){var t=Fn?Fn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};_n.prototype.listenerCount=function(e){var t=Fn?Fn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};_n.prototype.emit=function(e,t,i,n,s,o){var a=Fn?Fn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};_n.prototype.on=function(e,t,i){return ofe(this,e,t,i,!1)};_n.prototype.once=function(e,t,i){return ofe(this,e,t,i,!0)};_n.prototype.removeListener=function(e,t,i,n){var s=Fn?Fn+e:e;if(!this._events[s])return this;if(!t)return CS(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&CS(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:CS(this,s)}return this};_n.prototype.removeAllListeners=function(e){var t;return e?(t=Fn?Fn+e:e,this._events[t]&&CS(this,t)):(this._events=new Xb,this._eventsCount=0),this};_n.prototype.off=_n.prototype.removeListener;_n.prototype.addListener=_n.prototype.on;_n.prefixed=Fn;_n.EventEmitter=_n;typeof BC!="undefined"&&(BC.exports=_n)});var ufe=y((LBt,PS)=>{f();"use strict";var cst=Uf(),MC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},cfe=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new MC(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);cst(r.then(i,n),()=>{clearTimeout(s)})});PS.exports=cfe;PS.exports.default=cfe;PS.exports.TimeoutError=MC});var lfe=y(LC=>{f();"use strict";Object.defineProperty(LC,"__esModule",{value:!0});function ust(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}LC.default=ust});var dfe=y(UC=>{f();"use strict";Object.defineProperty(UC,"__esModule",{value:!0});var lst=lfe(),ffe=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=lst.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};UC.default=ffe});var yfe=y(FC=>{f();"use strict";Object.defineProperty(FC,"__esModule",{value:!0});var fst=afe(),hfe=ufe(),dst=dfe(),OS=()=>{},hst=new hfe.TimeoutError,pfe=class extends fst{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=OS,this._resolveIdle=OS,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:dst.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=OS,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=OS,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():hfe.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(hst)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};FC.default=pfe});var _fe=y((jBt,wfe)=>{f();"use strict";var KC=rt(),{base58btc:pst}=(ei(),Jr),{default:yst}=yfe(),gfe=ml(),mfe=be(),Hl=mfe("libp2p-delegated-peer-routing");Hl.error=mfe("libp2p-delegated-peer-routing:error");var bfe=3e4,gst=4,vfe=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this._client=e,this._httpQueue=new yst({concurrency:gst});let{protocol:t,host:i,port:n}=e.getEndpointConfig();Hl(`enabled DelegatedPeerRouting via ${t}://${i}:${n}`)}async findPeer(e,t={}){let i=e;KC.isPeerId(i)&&(i=e.toB58String()),Hl("findPeer starts: "+e),t.timeout=t.timeout||bfe;try{return await this._httpQueue.add(async()=>{let{addrs:n}=await this._client.dht.findPeer(i,{timeout:t.timeout});return{id:e,multiaddrs:n}})}catch(n){if(n.message.includes("not found"))return;throw n}finally{Hl("findPeer finished: "+e)}}async*getClosestPeers(e,t={}){let i=pst.encode(e).substring(1);Hl("getClosestPeers starts:",i),t.timeout=t.timeout||bfe;let n=gfe(),s=gfe();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;let o=new Map;for await(let a of this._client.dht.query(i,{timeout:t.timeout}))switch(a.type){case 1:a.responses.forEach(c=>{o.set(c.id,{id:KC.parse(c.id),multiaddrs:c.addrs})});break;case 2:yield o.get(a.id.string)||{id:KC.createFromCID(a.id),multiaddrs:[]};break;default:Hl("getClosestPeers unhandled response",a)}}catch(o){throw Hl.error("getClosestPeers errored:",o),o}finally{s.resolve(),Hl("getClosestPeers finished:",i)}}};wfe.exports=vfe});var Sfe=y((VBt,jC)=>{f();"use strict";var mst=Object.prototype.hasOwnProperty,Kn="~";function Qb(){}Object.create&&(Qb.prototype=Object.create(null),new Qb().__proto__||(Kn=!1));function bst(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Efe(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new bst(t,i||r,n),o=Kn?Kn+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function kS(r,e){--r._eventsCount==0?r._events=new Qb:delete r._events[e]}function En(){this._events=new Qb,this._eventsCount=0}En.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)mst.call(t,i)&&e.push(Kn?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};En.prototype.listeners=function(e){var t=Kn?Kn+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};En.prototype.listenerCount=function(e){var t=Kn?Kn+e:e,i=this._events[t];return i?i.fn?1:i.length:0};En.prototype.emit=function(e,t,i,n,s,o){var a=Kn?Kn+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};En.prototype.on=function(e,t,i){return Efe(this,e,t,i,!1)};En.prototype.once=function(e,t,i){return Efe(this,e,t,i,!0)};En.prototype.removeListener=function(e,t,i,n){var s=Kn?Kn+e:e;if(!this._events[s])return this;if(!t)return kS(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&kS(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:kS(this,s)}return this};En.prototype.removeAllListeners=function(e){var t;return e?(t=Kn?Kn+e:e,this._events[t]&&kS(this,t)):(this._events=new Qb,this._eventsCount=0),this};En.prototype.off=En.prototype.removeListener;En.prototype.addListener=En.prototype.on;En.prefixed=Kn;En.EventEmitter=En;typeof jC!="undefined"&&(jC.exports=En)});var Afe=y((zBt,qS)=>{f();"use strict";var vst=Uf(),VC=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},xfe=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new VC(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);vst(r.then(i,n),()=>{clearTimeout(s)})});qS.exports=xfe;qS.exports.default=xfe;qS.exports.TimeoutError=VC});var Ife=y(zC=>{f();"use strict";Object.defineProperty(zC,"__esModule",{value:!0});function wst(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}zC.default=wst});var Rfe=y(HC=>{f();"use strict";Object.defineProperty(HC,"__esModule",{value:!0});var _st=Ife(),Tfe=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=_st.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};HC.default=Tfe});var Ofe=y($C=>{f();"use strict";Object.defineProperty($C,"__esModule",{value:!0});var Est=Sfe(),Cfe=Afe(),Sst=Rfe(),NS=()=>{},xst=new Cfe.TimeoutError,Pfe=class extends Est{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=NS,this._resolveIdle=NS,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Sst.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=NS,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=NS,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():Cfe.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(xst)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};$C.default=Pfe});var Mfe=y((WBt,Bfe)=>{f();"use strict";var kfe=be(),Ast=rt(),Ist=Wa(),{default:qfe}=Ofe(),Nfe=ml(),Dd=kfe("libp2p-delegated-content-routing");Dd.error=kfe("libp2p-delegated-content-routing:error");var Tst=3e4,Rst=4,Dfe=class{constructor(e,t){if(e==null)throw new Error("missing self peerId");if(t==null)throw new Error("missing ipfs http client");this._client=t,this.peerId=e;let i={concurrency:Rst};this._httpQueue=new qfe(i),this._httpQueueRefs=new qfe(Object.assign({},i,{concurrency:2}));let{protocol:n,host:s,port:o}=t.getEndpointConfig();Dd(`enabled DelegatedContentRouting via ${n}://${s}:${o}`)}async*findProviders(e,t={}){Dd(`findProviders starts: ${e}`),t.timeout=t.timeout||Tst;let i=0,n=Nfe(),s=Nfe();this._httpQueue.add(()=>(n.resolve(),s.promise));try{await n.promise;for await(let{id:o,addrs:a}of this._client.dht.findProvs(e,{numProviders:t.numProviders,timeout:t.timeout}))yield{id:Ast.parse(o),multiaddrs:a},i++}catch(o){throw Dd.error("findProviders errored:",o),o}finally{s.resolve(),Dd(`findProviders finished: ${e} found ${i} providers`)}}async provide(e){Dd(`provide starts: ${e}`),await this._httpQueueRefs.add(async()=>{await this._client.block.stat(e),await Ist(this._client.dht.provide(e))}),Dd(`provide finished: ${e}`)}};Bfe.exports=Dfe});var GC=y((YBt,Ufe)=>{f();"use strict";var Cst=r=>Promise.reject(new Error(`No codec found for "${r}"`)),Lfe=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||Cst;for(let t of e.codecs)this.addCodec(t)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let t=typeof e=="string"?this._codecsByName:this._codecsByCode;if(t[e])return t[e];let i=await this._loadCodec(e);return t[e]==null&&this.addCodec(i),i}listCodecs(){return Object.values(this._codecsByName)}};Ufe.exports=Lfe});var WC=y((XBt,Kfe)=>{f();"use strict";var Pst=r=>Promise.reject(new Error(`No hasher found for "${r}"`)),Ffe=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||Pst;for(let t of e.hashers)this.addHasher(t)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let t=typeof e=="string"?this._hashersByName:this._hashersByCode;if(t[e])return t[e];let i=await this._loadHasher(e);return t[e]==null&&this.addHasher(i),i}listHashers(){return Object.values(this._hashersByName)}};Kfe.exports=Ffe});var YC=y((QBt,Vfe)=>{f();"use strict";var Ost=r=>Promise.reject(new Error(`No base found for "${r}"`)),jfe=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||Ost;for(let t of e.bases)this.addBase(t)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let t=await this._loadBase(e);return this._basesByName[t.name]==null&&this._basesByPrefix[t.prefix]==null&&this.addBase(t),t}listBases(){return Object.values(this._basesByName)}};Vfe.exports=jfe});var Hr=y((ZBt,zfe)=>{f();"use strict";zfe.exports=r=>{if(r==null)return r;let e=/^[A-Z]+$/,t={};return Object.keys(r).reduce((i,n)=>(e.test(n)?i[n.toLowerCase()]=r[n]:e.test(n[0])?i[n[0].toLowerCase()+n.slice(1)]=r[n]:i[n]=r[n],i),t)}});var $fe=y((JBt,Hfe)=>{f();"use strict";var{Multiaddr:kst}=it(),qst=J2();Hfe.exports=r=>{try{r=qst(new kst(r))}catch(e){}return r=r.toString(),r}});var Gfe=y(()=>{f()});var Wfe=y(()=>{f()});var BS=y((nMt,ede)=>{f();"use strict";var{Multiaddr:Yfe}=it(),{isBrowser:XC,isWebWorker:QC,isNode:Nst}=tg(),{default:Dst}=dm(),Xfe=be()("ipfs-http-client:lib:error-handler"),DS=ng(),Bst=gr().bind({ignoreUndefined:!0}),Qfe=$fe(),Mst=Gfe(),Lst=Wfe(),Ust=XC||QC?location.protocol:"http",Fst=XC||QC?location.hostname:"localhost",Kst=XC||QC?location.port:"5001",jst=(r={})=>{let e,t={},i;if(typeof r=="string"||Yfe.isMultiaddr(r))e=new URL(Qfe(r));else if(r instanceof URL)e=r;else if(typeof r.url=="string"||Yfe.isMultiaddr(r.url))e=new URL(Qfe(r.url)),t=r;else if(r.url instanceof URL)e=r.url,t=r;else{t=r||{};let n=(t.protocol||Ust).replace(":",""),s=(t.host||Fst).split(":")[0],o=t.port||Kst;e=new URL(`${n}://${s}:${o}`)}if(t.apiPath?e.pathname=t.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),Nst){let n=e.protocol.startsWith("https")?Lst.Agent:Mst.Agent;i=t.agent||new n({keepAlive:!0,maxSockets:6})}return{...t,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:i}},Zfe=async r=>{let e;try{if((r.headers.get("Content-Type")||"").startsWith("application/json")){let i=await r.json();Xfe(i),e=i.Message||i.message}else e=await r.text()}catch(i){Xfe("Failed to parse error response",i),e=i.message}let t=new DS.HTTPError(r);throw e&&e.includes("context deadline exceeded")&&(t=new DS.TimeoutError("Request timed out")),e&&e.includes("request timed out")&&(t=new DS.TimeoutError("Request timed out")),e&&(t.message=e),t},Vst=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Jfe=r=>r.replace(Vst,function(e){return"-"+e.toLowerCase()}),zst=r=>typeof r=="string"?Dst(r):r,ZC=class extends DS{constructor(e={}){let t=jst(e);super({timeout:zst(t.timeout||0)||6e4*20,headers:t.headers,base:`${t.url}`,handleError:Zfe,transformSearchParams:n=>{let s=new URLSearchParams;for(let[o,a]of n)a!=="undefined"&&a!=="null"&&o!=="signal"&&s.append(Jfe(o),a),o==="timeout"&&!isNaN(a)&&s.append(Jfe(o),a);return s},agent:t.agent});delete this.get,delete this.put,delete this.delete,delete this.options;let i=this.fetch;this.fetch=(n,s={})=>(typeof n=="string"&&!n.startsWith("/")&&(n=`${t.url}/${n}`),i.call(this,n,Bst(s,{method:"POST"})))}};ZC.errorHandler=Zfe;ede.exports=ZC});var ve=y((sMt,tde)=>{f();"use strict";var Hst=BS(),$st=r=>e=>r(new Hst(e),e);tde.exports=$st});var sde=y((oMt,nde)=>{f();"use strict";var Gst=ae(),Wst=Wm(),Yst=Gm(),Xst=mp(),{isBytes:rde,isBlob:Qst,isReadableStream:Zst}=m2();async function Jst(r){if(rde(r))return new Blob([r]);if(typeof r=="string"||r instanceof String)return new Blob([r.toString()]);if(Qst(r))return r;if(Zst(r)&&(r=Yst(r)),Symbol.iterator in r||Symbol.asyncIterator in r){let e=Wst(r),{value:t,done:i}=await e.peek();if(i)return ide(e);if(e.push(t),Number.isInteger(t))return new Blob([Uint8Array.from(await Xst(e))]);if(rde(t)||typeof t=="string"||t instanceof String)return ide(e)}throw Gst(new Error(`Unexpected input: ${r}`),"ERR_UNEXPECTED_INPUT")}async function ide(r){let e=[];for await(let t of r)e.push(t);return new Blob(e)}nde.exports=Jst});var ade=y((aMt,ode)=>{f();"use strict";var eot=sde(),tot=_5();function rot(r){return tot(r,eot)}ode.exports={normaliseInput:rot}});var MS=y((cMt,cde)=>{f();"use strict";cde.exports=r=>{if(r!=null)return typeof r=="string"?r:r.toString(8).padStart(4,"0")}});var oa=y((uMt,ude)=>{f();"use strict";var{normaliseInput:iot}=ade(),not=MS();async function sot(r,e,t={}){let i=[],n=new FormData,s=0,o=0;for await(let{content:a,path:c,mode:u,mtime:l}of iot(r)){let d="",h=a?"file":"dir";s>0&&(d=`-${s}`);let p=h+d,g=[];if(u!=null&&g.push(`mode=${not(u)}`),l!=null){let{secs:b,nsecs:E}=l;g.push(`mtime=${b}`),E!=null&&g.push(`mtime-nsecs=${E}`)}if(g.length&&(p=`${p}?${g.join("&")}`),a){n.set(p,a,c!=null?encodeURIComponent(c):void 0);let b=o+a.size;i.push({name:c,start:o,end:b}),o=b}else if(c!=null)n.set(p,new File([""],encodeURIComponent(c),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:o,parts:i,headers:t,body:n}}ude.exports=sot});var JC=y((lMt,lde)=>{f();"use strict";var oot=ae();function aot(r){if(r==null)return;let e;if(r.secs!=null&&(e={secs:r.secs,nsecs:r.nsecs}),r.Seconds!=null&&(e={secs:r.Seconds,nsecs:r.FractionalNanoseconds}),Array.isArray(r)&&(e={secs:r[0],nsecs:r[1]}),r instanceof Date){let t=r.getTime(),i=Math.floor(t/1e3);e={secs:i,nsecs:(t-i*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw oot(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}lde.exports=aot});var Se=y((fMt,fde)=>{f();"use strict";var cot=MS(),uot=JC();fde.exports=({arg:r,searchParams:e,hashAlg:t,mtime:i,mode:n,...s}={})=>{e&&(s={...s,...e}),t&&(s.hash=t),i!=null&&(i=uot(i),s.mtime=i.secs,s.mtimeNsecs=i.nsecs),n!=null&&(s.mode=cot(n)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),r==null?r=[]:Array.isArray(r)||(r=[r]);let o=new URLSearchParams(s);return r.forEach(a=>o.append("arg",a)),o}});var aa=y((dMt,dde)=>{f();"use strict";var{anySignal:lot}=hf();function fot(r){return r.filter(Boolean)}dde.exports=(...r)=>lot(fot(r))});var eP=y((hMt,hde)=>{f();"use strict";var{CID:dot}=(Ie(),De),hot=Hr(),pot=ve(),yot=oa(),got=Se(),mot=aa(),{AbortController:bot}=rn();hde.exports=pot(r=>{async function*e(t,i={}){let n=new bot,s=mot(n.signal,i.signal),{headers:o,body:a,total:c,parts:u}=await yot(t,n,i.headers),[l,d]=typeof i.progress=="function"?vot(c,u,i.progress):[void 0,void 0],h=await r.post("add",{searchParams:got({"stream-channels":!0,...i,progress:Boolean(l)}),timeout:i.timeout,onUploadProgress:d,signal:s,headers:o,body:a});for await(let p of h.ndjson())p=hot(p),p.hash!==void 0?yield _ot(p):l&&l(p.bytes||0,p.name)}return e});var vot=(r,e,t)=>e?[void 0,wot(r,e,t)]:[t,void 0],wot=(r,e,t)=>{let i=0,n=e.length;return({loaded:s,total:o})=>{let a=Math.floor(s/o*r);for(;i<n;){let{start:c,end:u,name:l}=e[i];if(a<u){t(a-c,l);break}else t(u-c,l),i+=1}}};function _ot({name:r,hash:e,size:t,mode:i,mtime:n,mtimeNsecs:s}){let o={path:r,cid:dot.parse(e),size:parseInt(t)};return i!=null&&(o.mode=parseInt(i,8)),n!=null&&(o.mtime={secs:n,nsecs:s||0}),o}});var yde=y((pMt,pde)=>{f();"use strict";var Eot=eP(),Sot=rs(),xot=ve();pde.exports=r=>{let e=Eot(r);return xot(()=>{async function t(i,n={}){return await Sot(e(i,n))}return t})(r)}});var mde=y((yMt,gde)=>{f();"use strict";var{CID:Aot}=(Ie(),De),Iot=ve(),Tot=Se();gde.exports=Iot(r=>{async function e(t={}){return((await(await r.post("bitswap/wantlist",{timeout:t.timeout,signal:t.signal,searchParams:Tot(t),headers:t.headers})).json()).Keys||[]).map(n=>Aot.parse(n["/"]))}return e})});var vde=y((gMt,bde)=>{f();"use strict";var{CID:Rot}=(Ie(),De),Cot=ve(),Pot=Se();bde.exports=Cot(r=>{async function e(t,i={}){return((await(await r.post("bitswap/wantlist",{timeout:i.timeout,signal:i.signal,searchParams:Pot({...i,peer:t.toString()}),headers:i.headers})).json()).Keys||[]).map(s=>Rot.parse(s["/"]))}return e})});var tP=y((mMt,wde)=>{f();"use strict";var{CID:Oot}=(Ie(),De),kot=ve(),qot=Se();wde.exports=kot(r=>{async function e(t={}){let i=await r.post("bitswap/stat",{searchParams:qot(t),timeout:t.timeout,signal:t.signal,headers:t.headers});return Not(await i.json())}return e});function Not(r){return{provideBufLen:r.ProvideBufLen,wantlist:(r.Wantlist||[]).map(e=>Oot.parse(e["/"])),peers:r.Peers||[],blocksReceived:BigInt(r.BlocksReceived),dataReceived:BigInt(r.DataReceived),blocksSent:BigInt(r.BlocksSent),dataSent:BigInt(r.DataSent),dupBlksReceived:BigInt(r.DupBlksReceived),dupDataReceived:BigInt(r.DupDataReceived)}}});var Ede=y((bMt,_de)=>{f();"use strict";var Dot=ve(),Bot=Se();_de.exports=Dot(r=>{async function e(t,i={}){return(await r.post("bitswap/unwant",{timeout:i.timeout,signal:i.signal,searchParams:Bot({arg:t.toString(),...i}),headers:i.headers})).json()}return e})});var xde=y((vMt,Sde)=>{f();"use strict";Sde.exports=r=>({wantlist:mde()(r),wantlistForPeer:vde()(r),stat:tP()(r),unwant:Ede()(r)})});var rP=y((wMt,Ade)=>{f();"use strict";var Mot=ve(),Lot=Se();Ade.exports=Mot(r=>{async function e(t,i={}){let n=await r.post("block/get",{timeout:i.timeout,signal:i.signal,searchParams:Lot({arg:t.toString(),...i}),headers:i.headers});return new Uint8Array(await n.arrayBuffer())}return e})});var Tde=y((_Mt,Ide)=>{f();"use strict";var{CID:Uot}=(Ie(),De),Fot=ve(),Kot=Se();Ide.exports=Fot(r=>{async function e(t,i={}){let s=await(await r.post("block/stat",{timeout:i.timeout,signal:i.signal,searchParams:Kot({arg:t.toString(),...i}),headers:i.headers})).json();return{cid:Uot.parse(s.Key),size:s.Size}}return e})});var Cde=y((EMt,Rde)=>{f();"use strict";var{CID:jot}=(Ie(),De),Vot=oa(),zot=ve(),Hot=Se(),$ot=aa(),{AbortController:Got}=rn();Rde.exports=zot(r=>{async function e(t,i={}){let n=new Got,s=$ot(n.signal,i.signal),o;try{o=await(await r.post("block/put",{timeout:i.timeout,signal:s,searchParams:Hot(i),...await Vot(t,n,i.headers)})).json()}catch(a){if(i.format==="dag-pb")return e(t,{...i,format:"protobuf"});if(i.format==="dag-cbor")return e(t,{...i,format:"cbor"});throw a}return jot.parse(o.Key)}return e})});var Ode=y((SMt,Pde)=>{f();"use strict";var{CID:Wot}=(Ie(),De),Yot=ve(),Xot=Se();Pde.exports=Yot(r=>{async function*e(t,i={}){Array.isArray(t)||(t=[t]);let n=await r.post("block/rm",{timeout:i.timeout,signal:i.signal,searchParams:Xot({arg:t.map(s=>s.toString()),"stream-channels":!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield Qot(s)}return e});function Qot(r){let e={cid:Wot.parse(r.Hash)};return r.Error&&(e.error=new Error(r.Error)),e}});var qde=y((xMt,kde)=>{f();"use strict";kde.exports=r=>({get:rP()(r),stat:Tde()(r),put:Cde()(r),rm:Ode()(r)})});var Dde=y((AMt,Nde)=>{f();"use strict";var Zot=ve(),Jot=Se(),{Multiaddr:eat}=it();Nde.exports=Zot(r=>{async function e(t,i={}){let n=await r.post("bootstrap/add",{timeout:i.timeout,signal:i.signal,searchParams:Jot({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new eat(o))}}return e})});var Mde=y((IMt,Bde)=>{f();"use strict";var tat=ve(),rat=Se(),{Multiaddr:iat}=it();Bde.exports=tat(r=>{async function e(t={}){let i=await r.post("bootstrap/rm",{timeout:t.timeout,signal:t.signal,searchParams:rat({...t,all:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new iat(s))}}return e})});var Ude=y((TMt,Lde)=>{f();"use strict";var nat=ve(),sat=Se(),{Multiaddr:oat}=it();Lde.exports=nat(r=>{async function e(t,i={}){let n=await r.post("bootstrap/rm",{timeout:i.timeout,signal:i.signal,searchParams:sat({arg:t,...i}),headers:i.headers}),{Peers:s}=await n.json();return{Peers:s.map(o=>new oat(o))}}return e})});var Kde=y((RMt,Fde)=>{f();"use strict";var aat=ve(),cat=Se(),{Multiaddr:uat}=it();Fde.exports=aat(r=>{async function e(t={}){let i=await r.post("bootstrap/add",{timeout:t.timeout,signal:t.signal,searchParams:cat({...t,default:!0}),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new uat(s))}}return e})});var Vde=y((CMt,jde)=>{f();"use strict";var lat=ve(),fat=Se(),{Multiaddr:dat}=it();jde.exports=lat(r=>{async function e(t={}){let i=await r.post("bootstrap/list",{timeout:t.timeout,signal:t.signal,searchParams:fat(t),headers:t.headers}),{Peers:n}=await i.json();return{Peers:n.map(s=>new dat(s))}}return e})});var Hde=y((PMt,zde)=>{f();"use strict";zde.exports=r=>({add:Dde()(r),clear:Mde()(r),rm:Ude()(r),reset:Kde()(r),list:Vde()(r)})});var Gde=y((OMt,$de)=>{f();"use strict";var hat=ve(),pat=Se();$de.exports=hat(r=>{async function*e(t,i={}){yield*(await r.post("cat",{timeout:i.timeout,signal:i.signal,searchParams:pat({arg:t.toString(),...i}),headers:i.headers})).iterator()}return e})});var Yde=y((kMt,Wde)=>{f();"use strict";var yat=ve(),gat=Se();Wde.exports=yat(r=>async(t={})=>(await r.post("commands",{timeout:t.timeout,signal:t.signal,searchParams:gat(t),headers:t.headers})).json())});var Qde=y((qMt,Xde)=>{f();"use strict";var mat=ve(),bat=Se();Xde.exports=mat(r=>async(t={})=>await(await r.post("config/show",{timeout:t.timeout,signal:t.signal,searchParams:bat({...t}),headers:t.headers})).json())});var Jde=y((NMt,Zde)=>{f();"use strict";var vat=ve(),wat=Se();Zde.exports=vat(r=>async(t,i={})=>{if(!t)throw new Error("key argument is required");return(await(await r.post("config",{timeout:i.timeout,signal:i.signal,searchParams:wat({arg:t,...i}),headers:i.headers})).json()).Value})});var the=y((DMt,ehe)=>{f();"use strict";var _at=ve(),Eat=Se();ehe.exports=_at(r=>async(t,i,n={})=>{if(typeof t!="string")throw new Error("Invalid key type");let s={...n,...Sat(t,i)};await(await r.post("config",{timeout:n.timeout,signal:n.signal,searchParams:Eat(s),headers:n.headers})).text()});var Sat=(r,e)=>{switch(typeof e){case"boolean":return{arg:[r,e.toString()],bool:!0};case"string":return{arg:[r,e]};default:return{arg:[r,JSON.stringify(e)],json:!0}}}});var ihe=y((BMt,rhe)=>{f();"use strict";var{fromString:xat}=(ft(),ht),Aat=oa(),Iat=ve(),Tat=Se(),Rat=aa(),{AbortController:Cat}=rn();rhe.exports=Iat(r=>async(t,i={})=>{let n=new Cat,s=Rat(n.signal,i.signal);await(await r.post("config/replace",{timeout:i.timeout,signal:s,searchParams:Tat(i),...await Aat(xat(JSON.stringify(t)),n,i.headers)})).text()})});var she=y((MMt,nhe)=>{f();"use strict";var Pat=ve(),Oat=Se();nhe.exports=Pat(r=>{async function e(t,i={}){let s=await(await r.post("config/profile/apply",{timeout:i.timeout,signal:i.signal,searchParams:Oat({arg:t,...i}),headers:i.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return e})});var ahe=y((LMt,ohe)=>{f();"use strict";var kat=Hr(),qat=ve(),Nat=Se();ohe.exports=qat(r=>{async function e(t={}){return(await(await r.post("config/profile/list",{timeout:t.timeout,signal:t.signal,searchParams:Nat(t),headers:t.headers})).json()).map(s=>kat(s))}return e})});var uhe=y((UMt,che)=>{f();"use strict";che.exports=r=>({apply:she()(r),list:ahe()(r)})});var fhe=y((FMt,lhe)=>{f();"use strict";lhe.exports=r=>({getAll:Qde()(r),get:Jde()(r),set:the()(r),replace:ihe()(r),profiles:uhe()(r)})});var hhe=y((KMt,dhe)=>{f();"use strict";var Dat=ve(),Bat=Se();dhe.exports=Dat(r=>{async function*e(t,i={}){yield*(await r.post("dag/export",{timeout:i.timeout,signal:i.signal,searchParams:Bat({arg:t.toString()}),headers:i.headers})).iterator()}return e})});var ghe=y((jMt,yhe)=>{f();"use strict";var{CID:Mat}=(Ie(),De),phe=ae(),Lat=async function*(r,e,t,i,n){let s=async u=>{let l=await t.getCodec(u.code),d=await i(u,n);return l.decode(d)},o=e.split("/").filter(Boolean),a=await s(r),c=r;for(o.length||(yield{value:a,remainderPath:""});o.length;){let u=o.shift();if(!u)throw phe(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:o.join("/")};else throw phe(new Error(`no link named "${u}" under ${c}`),"ERR_NO_LINK");a instanceof Mat&&(c=a,a=await s(a))}};yhe.exports=Lat});var vhe=y((VMt,bhe)=>{f();"use strict";var Uat=ve(),mhe=ghe(),Fat=zf(),Kat=rs(),jat=ae();bhe.exports=(r,e)=>Uat((i,n)=>{let s=rP()(n);return async(a,c={})=>{if(c.path){let p=c.localResolve?await Fat(mhe(a,c.path,r,s,c)):await Kat(mhe(a,c.path,r,s,c));if(!p)throw jat(new Error("Not found"),"ERR_NOT_FOUND");return p}let u=await r.getCodec(a.code),l=await s(a,c);return{value:u.decode(l),remainderPath:""}}})(e)});var _he=y((zMt,whe)=>{f();"use strict";var Vat=ve(),zat=Se(),Hat=aa(),$at=oa(),{AbortController:Gat}=rn(),{CID:Wat}=(Ie(),De);whe.exports=Vat(r=>{async function*e(t,i={}){let n=new Gat,s=Hat(n.signal,i.signal),{headers:o,body:a}=await $at(t,n,i.headers),c=await r.post("dag/import",{timeout:i.timeout,signal:s,headers:o,body:a,searchParams:zat({"pin-roots":i.pinRoots})});for await(let{Root:u}of c.ndjson())if(u!==void 0){let{Cid:{"/":l},PinErrorMsg:d}=u;yield{root:{cid:Wat.parse(l),pinErrorMsg:d}}}}return e})});var iP=y((HMt,Ehe)=>{f();"use strict";var{CID:Yat}=(Ie(),De),Xat=ve(),Qat=oa(),Zat=Se(),Jat=aa(),{AbortController:ect}=rn();Ehe.exports=(r,e)=>Xat(i=>async(s,o={})=>{let a={format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw",...o},u=(await r.getCodec(a.format)).encode(s),l=new ect,d=Jat(l.signal,a.signal),p=await(await i.post("dag/put",{timeout:a.timeout,signal:d,searchParams:Zat(a),...await Qat(u,l,a.headers)})).json();return Yat.parse(p.Cid["/"])})(e)});var xhe=y(($Mt,She)=>{f();"use strict";var{CID:tct}=(Ie(),De),rct=ve(),ict=Se();She.exports=rct(r=>async(t,i={})=>{let s=await(await r.post("dag/resolve",{timeout:i.timeout,signal:i.signal,searchParams:ict({arg:`${t}${i.path?`/${i.path}`.replace(/\/[/]+/g,"/"):""}`,...i}),headers:i.headers})).json();return{cid:tct.parse(s.Cid["/"]),remainderPath:s.RemPath}})});var Ihe=y((GMt,Ahe)=>{f();"use strict";Ahe.exports=(r,e)=>({export:hhe()(e),get:vhe()(r,e),import:_he()(e),put:iP()(r,e),resolve:xhe()(e)})});var LS=y((WMt,The)=>{f();"use strict";The.exports={SendingQuery:0,PeerResponse:1,FinalPeer:2,QueryError:3,Provider:4,Value:5,AddingPeer:6,DialingPeer:7}});var Che=y((YMt,Rhe)=>{f();"use strict";var nct=ve(),sct=Se(),{Value:oct}=LS(),{fromString:act}=(ft(),ht),{toString:cct}=(tt(),et);Rhe.exports=nct(r=>{async function e(t,i={}){let n=await r.post("dht/get",{timeout:i.timeout,signal:i.signal,searchParams:sct({arg:t instanceof Uint8Array?cct(t):t,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===oct)return act(s.Extra,"base64pad");throw new Error("not found")}return e})});var Ohe=y((XMt,Phe)=>{f();"use strict";var{Multiaddr:uct}=it(),lct=Hr(),fct=ve(),dct=Se(),hct=oa(),pct=aa(),{AbortController:yct}=rn(),{toString:gct}=(tt(),et);Phe.exports=fct(r=>{async function*e(t,i,n={}){let s=new yct,o=pct(s.signal,n.signal),a=await r.post("dht/put",{timeout:n.timeout,signal:o,searchParams:dct({arg:gct(t),...n}),...await hct(i,s,n.headers)});for await(let c of a.ndjson())c=lct(c),c.responses&&(c.responses=c.responses.map(({ID:u,Addrs:l})=>({id:u,addrs:(l||[]).map(d=>new uct(d))}))),yield c}return e})});var qhe=y((QMt,khe)=>{f();"use strict";var{Multiaddr:mct}=it(),bct=ve(),vct=Se(),{Provider:wct}=LS();khe.exports=bct(r=>{async function*e(t,i={}){let n=await r.post("dht/findprovs",{timeout:i.timeout,signal:i.signal,searchParams:vct({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===wct&&s.Responses)for(let{ID:o,Addrs:a}of s.Responses)yield{id:o,addrs:(a||[]).map(c=>new mct(c))}}return e})});var Dhe=y((ZMt,Nhe)=>{f();"use strict";var{Multiaddr:_ct}=it(),Ect=ve(),Sct=Se(),{FinalPeer:xct}=LS();Nhe.exports=Ect(r=>{async function e(t,i={}){let n=await r.post("dht/findpeer",{timeout:i.timeout,signal:i.signal,searchParams:Sct({arg:t,...i}),headers:i.headers});for await(let s of n.ndjson())if(s.Type===xct&&s.Responses){let{ID:o,Addrs:a}=s.Responses[0];return{id:o,addrs:(a||[]).map(c=>new _ct(c))}}throw new Error("not found")}return e})});var Mhe=y((JMt,Bhe)=>{f();"use strict";var{Multiaddr:Act}=it(),Ict=Hr(),Tct=ve(),Rct=Se();Bhe.exports=Tct(r=>{async function*e(t,i={recursive:!1}){let n=Array.isArray(t)?t:[t],s=await r.post("dht/provide",{timeout:i.timeout,signal:i.signal,searchParams:Rct({arg:n.map(o=>o.toString()),...i}),headers:i.headers});for await(let o of s.ndjson())o=Ict(o),o.responses?o.responses=o.responses.map(({ID:a,Addrs:c})=>({id:a,addrs:(c||[]).map(u=>new Act(u))})):o.responses=[],yield o}return e})});var Uhe=y((e7t,Lhe)=>{f();"use strict";var{Multiaddr:Cct}=it(),Pct=Hr(),Oct=ve(),kct=Se();Lhe.exports=Oct(r=>{async function*e(t,i={}){let n=await r.post("dht/query",{timeout:i.timeout,signal:i.signal,searchParams:kct({arg:t.toString(),...i}),headers:i.headers});for await(let s of n.ndjson())s=Pct(s),s.responses=(s.responses||[]).map(({ID:o,Addrs:a})=>({id:o,addrs:(a||[]).map(c=>new Cct(c))})),yield s}return e})});var Khe=y((t7t,Fhe)=>{f();"use strict";Fhe.exports=r=>({get:Che()(r),put:Ohe()(r),findProvs:qhe()(r),findPeer:Dhe()(r),provide:Mhe()(r),query:Uhe()(r)})});var Vhe=y((r7t,jhe)=>{f();"use strict";var qct=ve(),Nct=Se();jhe.exports=qct(r=>{async function e(t={}){return(await r.post("diag/net",{timeout:t.timeout,signal:t.signal,searchParams:Nct(t),headers:t.headers})).json()}return e})});var Hhe=y((i7t,zhe)=>{f();"use strict";var Dct=ve(),Bct=Se();zhe.exports=Dct(r=>{async function e(t={}){return(await r.post("diag/sys",{timeout:t.timeout,signal:t.signal,searchParams:Bct(t),headers:t.headers})).json()}return e})});var Ghe=y((n7t,$he)=>{f();"use strict";var Mct=ve(),Lct=Se();$he.exports=Mct(r=>{async function e(t={}){return(await r.post("diag/cmds",{timeout:t.timeout,signal:t.signal,searchParams:Lct(t),headers:t.headers})).json()}return e})});var Yhe=y((s7t,Whe)=>{f();"use strict";Whe.exports=r=>({net:Vhe()(r),sys:Hhe()(r),cmds:Ghe()(r)})});var Qhe=y((o7t,Xhe)=>{f();"use strict";var Uct=ve(),Fct=Se();Xhe.exports=Uct(r=>async(t,i={})=>(await(await r.post("dns",{timeout:i.timeout,signal:i.signal,searchParams:Fct({arg:t,...i}),headers:i.headers})).json()).Path)});var Jhe=y((a7t,Zhe)=>{f();"use strict";var Kct=ve(),jct=Se();Zhe.exports=Kct(r=>{async function e(t,i,n={}){await(await r.post("files/chmod",{timeout:n.timeout,signal:n.signal,searchParams:jct({arg:t,mode:i,...n}),headers:n.headers})).text()}return e})});var tpe=y((c7t,epe)=>{f();"use strict";var{CID:Vct}=(Ie(),De),zct=ve(),Hct=Se();epe.exports=zct(r=>{async function e(t,i,n={}){let s=Array.isArray(t)?t:[t];await(await r.post("files/cp",{timeout:n.timeout,signal:n.signal,searchParams:Hct({arg:s.concat(i).map(a=>a instanceof Vct?`/ipfs/${a}`:a),...n}),headers:n.headers})).text()}return e})});var ipe=y((u7t,rpe)=>{f();"use strict";var{CID:$ct}=(Ie(),De),Gct=ve(),Wct=Se();rpe.exports=Gct(r=>{async function e(t,i={}){if(!t||typeof t!="string")throw new Error("ipfs.files.flush requires a path");let s=await(await r.post("files/flush",{timeout:i.timeout,signal:i.signal,searchParams:Wct({arg:t,...i}),headers:i.headers})).json();return $ct.parse(s.Cid)}return e})});var nP=y((l7t,npe)=>{f();"use strict";var Yct=Hr();function Xct(r){let e=Yct(r);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}npe.exports=Xct});var upe=y((f7t,cpe)=>{f();"use strict";var{CID:spe}=(Ie(),De),ope=nP(),Qct=ve(),Zct=Se();cpe.exports=Qct(r=>{async function*e(t,i={}){if(!t)throw new Error("ipfs.files.ls requires a path");let n=await r.post("files/ls",{timeout:i.timeout,signal:i.signal,searchParams:Zct({arg:t instanceof spe?`/ipfs/${t}`:t,long:!0,...i,stream:!0}),headers:i.headers});for await(let s of n.ndjson())if("Entries"in s)for(let o of s.Entries||[])yield ape(ope(o));else yield ape(ope(s))}return e});function ape(r){return r.hash&&(r.cid=spe.parse(r.hash)),delete r.hash,r.type=r.type===1?"directory":"file",r}});var fpe=y((d7t,lpe)=>{f();"use strict";var Jct=ve(),eut=Se();lpe.exports=Jct(r=>{async function e(t,i={}){await(await r.post("files/mkdir",{timeout:i.timeout,signal:i.signal,searchParams:eut({arg:t,...i}),headers:i.headers})).text()}return e})});var hpe=y((h7t,dpe)=>{f();"use strict";var tut=ve(),rut=Se();dpe.exports=tut(r=>{async function e(t,i,n={}){Array.isArray(t)||(t=[t]),await(await r.post("files/mv",{timeout:n.timeout,signal:n.signal,searchParams:rut({arg:t.concat(i),...n}),headers:n.headers})).text()}return e})});var Zb=y((p7t,ppe)=>{f();ppe.exports=r=>{if(r[Symbol.asyncIterator])return r;if(r.getReader)return async function*(){let e=r.getReader();try{for(;;){let{done:t,value:i}=await e.read();if(t)return;yield i}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var gpe=y((y7t,ype)=>{f();"use strict";var iut=Zb(),nut=ve(),sut=Se();ype.exports=nut(r=>{async function*e(t,i={}){let n=await r.post("files/read",{timeout:i.timeout,signal:i.signal,searchParams:sut({arg:t,count:i.length,...i}),headers:i.headers});yield*iut(n.body)}return e})});var bpe=y((g7t,mpe)=>{f();"use strict";var out=ve(),aut=Se();mpe.exports=out(r=>{async function e(t,i={}){await(await r.post("files/rm",{timeout:i.timeout,signal:i.signal,searchParams:aut({arg:t,...i}),headers:i.headers})).text()}return e})});var sP=y((m7t,wpe)=>{f();"use strict";var{CID:vpe}=(Ie(),De),cut=nP(),uut=ve(),lut=Se();wpe.exports=uut(r=>{async function e(t,i={}){t&&!(t instanceof vpe)&&typeof t!="string"&&(i=t||{},t="/"),i=i||{};let s=await(await r.post("files/stat",{timeout:i.timeout,signal:i.signal,searchParams:lut({arg:t,...i}),headers:i.headers})).json();return s.WithLocality=s.WithLocality||!1,fut(cut(s))}return e});function fut(r){return r.cid=vpe.parse(r.hash),delete r.hash,r}});var Epe=y((b7t,_pe)=>{f();"use strict";var dut=ve(),hut=Se();_pe.exports=dut(r=>{async function e(t,i={}){await(await r.post("files/touch",{timeout:i.timeout,signal:i.signal,searchParams:hut({arg:t,...i}),headers:i.headers})).text()}return e})});var xpe=y((v7t,Spe)=>{f();"use strict";var put=MS(),yut=JC(),gut=ve(),mut=oa(),but=Se(),vut=aa(),{AbortController:wut}=rn();Spe.exports=gut(r=>{async function e(t,i,n={}){let s=new wut,o=vut(s.signal,n.signal);await(await r.post("files/write",{timeout:n.timeout,signal:o,searchParams:but({arg:t,streamChannels:!0,count:n.length,...n}),...await mut({content:i,path:"arg",mode:put(n.mode),mtime:yut(n.mtime)},s,n.headers)})).text()}return e})});var Ipe=y((w7t,Ape)=>{f();"use strict";Ape.exports=r=>({chmod:Jhe()(r),cp:tpe()(r),flush:ipe()(r),ls:upe()(r),mkdir:fpe()(r),mv:hpe()(r),read:gpe()(r),rm:bpe()(r),stat:sP()(r),touch:Epe()(r),write:xpe()(r)})});var Rpe=y((_7t,Tpe)=>{f();"use strict";var{CID:_ut}=(Ie(),De),Eut=ve(),Sut=Se();Tpe.exports=Eut(r=>{async function*e(t,i={}){let n={arg:`${t instanceof Uint8Array?_ut.decode(t):t}`,...i};n.compressionLevel&&(n["compression-level"]=n.compressionLevel,delete n.compressionLevel),yield*(await r.post("get",{timeout:i.timeout,signal:i.signal,searchParams:Sut(n),headers:i.headers})).iterator()}return e})});var Ppe=y((E7t,Cpe)=>{f();"use strict";var xut=ve();Cpe.exports=xut(r=>()=>{let e=new URL(r.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}})});var oP=y((S7t,Ope)=>{f();"use strict";var Aut=Hr(),{Multiaddr:Iut}=it(),Tut=ve(),Rut=Se();Ope.exports=Tut(r=>{async function e(t={}){let n=await(await r.post("id",{timeout:t.timeout,signal:t.signal,searchParams:Rut({arg:t.peerId?t.peerId.toString():void 0,...t}),headers:t.headers})).json(),s={...Aut(n)};return s.addresses&&(s.addresses=s.addresses.map(o=>new Iut(o))),s}return e})});var qpe=y((x7t,kpe)=>{f();"use strict";var Cut=oP();kpe.exports=r=>{let e=Cut(r);async function t(i={}){let n=await e(i);return Boolean(n&&n.addresses&&n.addresses.length)}return t}});var Dpe=y((A7t,Npe)=>{f();"use strict";var Put=Hr(),Out=ve(),kut=Se();Npe.exports=Out(r=>{async function e(t,i={type:"rsa",size:2048}){let s=await(await r.post("key/gen",{timeout:i.timeout,signal:i.signal,searchParams:kut({arg:t,...i}),headers:i.headers})).json();return Put(s)}return e})});var Mpe=y((I7t,Bpe)=>{f();"use strict";var qut=Hr(),Nut=ve(),Dut=Se();Bpe.exports=Nut(r=>{async function e(t={}){return((await(await r.post("key/list",{timeout:t.timeout,signal:t.signal,searchParams:Dut(t),headers:t.headers})).json()).Keys||[]).map(s=>qut(s))}return e})});var Upe=y((T7t,Lpe)=>{f();"use strict";var But=Hr(),Mut=ve(),Lut=Se();Lpe.exports=Mut(r=>{async function e(t,i,n={}){let s=await r.post("key/rename",{timeout:n.timeout,signal:n.signal,searchParams:Lut({arg:[t,i],...n}),headers:n.headers});return But(await s.json())}return e})});var Kpe=y((R7t,Fpe)=>{f();"use strict";var Uut=Hr(),Fut=ve(),Kut=Se();Fpe.exports=Fut(r=>{async function e(t,i={}){let s=await(await r.post("key/rm",{timeout:i.timeout,signal:i.signal,searchParams:Kut({arg:t,...i}),headers:i.headers})).json();return Uut(s.Keys[0])}return e})});var Vpe=y((C7t,jpe)=>{f();"use strict";var jut=Hr(),Vut=ve(),zut=Se();jpe.exports=Vut(r=>{async function e(t,i,n,s={}){let a=await(await r.post("key/import",{timeout:s.timeout,signal:s.signal,searchParams:zut({arg:t,pem:i,password:n,...s}),headers:s.headers})).json();return jut(a)}return e})});var Hpe=y((P7t,zpe)=>{f();"use strict";var Hut=ve(),$ut=ae();zpe.exports=Hut(r=>async(t,i,n={})=>{throw $ut(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Gpe=y((O7t,$pe)=>{f();"use strict";var Gut=ve(),Wut=ae();$pe.exports=Gut(r=>async(t,i={})=>{throw Wut(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Ype=y((k7t,Wpe)=>{f();"use strict";Wpe.exports=r=>({gen:Dpe()(r),list:Mpe()(r),rename:Upe()(r),rm:Kpe()(r),import:Vpe()(r),export:Hpe()(r),info:Gpe()(r)})});var Qpe=y((q7t,Xpe)=>{f();"use strict";var Yut=ve(),Xut=Se();Xpe.exports=Yut(r=>{async function*e(t={}){yield*(await r.post("log/tail",{timeout:t.timeout,signal:t.signal,searchParams:Xut(t),headers:t.headers})).ndjson()}return e})});var Jpe=y((N7t,Zpe)=>{f();"use strict";var Qut=ve(),Zut=Se();Zpe.exports=Qut(r=>{async function e(t={}){return(await(await r.post("log/ls",{timeout:t.timeout,signal:t.signal,searchParams:Zut(t),headers:t.headers})).json()).Strings}return e})});var t0e=y((D7t,e0e)=>{f();"use strict";var Jut=Hr(),elt=ve(),tlt=Se();e0e.exports=elt(r=>{async function e(t,i,n={}){let s=await r.post("log/level",{timeout:n.timeout,signal:n.signal,searchParams:tlt({arg:[t,i],...n}),headers:n.headers});return Jut(await s.json())}return e})});var i0e=y((B7t,r0e)=>{f();"use strict";r0e.exports=r=>({tail:Qpe()(r),ls:Jpe()(r),level:t0e()(r)})});var o0e=y((M7t,s0e)=>{f();"use strict";var{CID:n0e}=(Ie(),De),rlt=ve(),ilt=Se(),nlt=sP();s0e.exports=rlt((r,e)=>{async function*t(i,n={}){let s=`${i instanceof Uint8Array?n0e.decode(i):i}`;async function o(c){let u=c.Hash;if(u.includes("/")){let d=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await nlt(e)(d)).cid}else u=n0e.parse(u);let l={name:c.Name,path:s+(c.Name?`/${c.Name}`:""),size:c.Size,cid:u,type:slt(c)};return c.Mode&&(l.mode=parseInt(c.Mode,8)),c.Mtime!==void 0&&c.Mtime!==null&&(l.mtime={secs:c.Mtime},c.MtimeNsecs!==void 0&&c.MtimeNsecs!==null&&(l.mtime.nsecs=c.MtimeNsecs)),l}let a=await r.post("ls",{timeout:n.timeout,signal:n.signal,searchParams:ilt({arg:s,...n}),headers:n.headers});for await(let c of a.ndjson()){if(c=c.Objects,!c)throw new Error("expected .Objects in results");if(c=c[0],!c)throw new Error("expected one array in results.Objects");let u=c.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(c);return}yield*u.map(o)}}return t});function slt(r){switch(r.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}});var c0e=y((L7t,a0e)=>{f();"use strict";var olt=Hr(),alt=ve(),clt=Se();a0e.exports=alt(r=>{async function e(t={}){let i=await r.post("dns",{timeout:t.timeout,signal:t.signal,searchParams:clt(t),headers:t.headers});return olt(await i.json())}return e})});var l0e=y((U7t,u0e)=>{f();"use strict";var ult=Hr(),llt=ve(),flt=Se();u0e.exports=llt(r=>{async function e(t,i={}){let n=await r.post("name/publish",{timeout:i.timeout,signal:i.signal,searchParams:flt({arg:`${t}`,...i}),headers:i.headers});return ult(await n.json())}return e})});var d0e=y((F7t,f0e)=>{f();"use strict";var dlt=ve(),hlt=Se();f0e.exports=dlt(r=>{async function*e(t,i={}){let n=await r.post("name/resolve",{timeout:i.timeout,signal:i.signal,searchParams:hlt({arg:t,stream:!0,...i}),headers:i.headers});for await(let s of n.ndjson())yield s.Path}return e})});var p0e=y((K7t,h0e)=>{f();"use strict";var plt=Hr(),ylt=ve(),glt=Se();h0e.exports=ylt(r=>{async function e(t,i={}){let n=await r.post("name/pubsub/cancel",{timeout:i.timeout,signal:i.signal,searchParams:glt({arg:t,...i}),headers:i.headers});return plt(await n.json())}return e})});var g0e=y((j7t,y0e)=>{f();"use strict";var mlt=Hr(),blt=ve(),vlt=Se();y0e.exports=blt(r=>{async function e(t={}){let i=await r.post("name/pubsub/state",{timeout:t.timeout,signal:t.signal,searchParams:vlt(t),headers:t.headers});return mlt(await i.json())}return e})});var b0e=y((V7t,m0e)=>{f();"use strict";var wlt=ve(),_lt=Se();m0e.exports=wlt(r=>{async function e(t={}){return(await(await r.post("name/pubsub/subs",{timeout:t.timeout,signal:t.signal,searchParams:_lt(t),headers:t.headers})).json()).Strings||[]}return e})});var w0e=y((z7t,v0e)=>{f();"use strict";v0e.exports=r=>({cancel:p0e()(r),state:g0e()(r),subs:b0e()(r)})});var E0e=y((H7t,_0e)=>{f();"use strict";_0e.exports=r=>({publish:l0e()(r),resolve:d0e()(r),pubsub:w0e()(r)})});var x0e=y(($7t,S0e)=>{f();"use strict";var{CID:Elt}=(Ie(),De),Slt=ve(),xlt=Se();S0e.exports=Slt(r=>{async function e(t,i={}){let s=await(await r.post("object/data",{timeout:i.timeout,signal:i.signal,searchParams:xlt({arg:`${t instanceof Uint8Array?Elt.decode(t):t}`,...i}),headers:i.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return e})});var T0e=y((G7t,I0e)=>{f();"use strict";var{CID:A0e}=(Ie(),De),Alt=ve(),Ilt=Se(),{fromString:Tlt}=(ft(),ht);I0e.exports=Alt(r=>{async function e(t,i={}){let s=await(await r.post("object/get",{timeout:i.timeout,signal:i.signal,searchParams:Ilt({arg:`${t instanceof Uint8Array?A0e.decode(t):t}`,dataEncoding:"base64",...i}),headers:i.headers})).json();return{Data:Tlt(s.Data,"base64pad"),Links:(s.Links||[]).map(o=>({Name:o.Name,Hash:A0e.parse(o.Hash),Tsize:o.Size}))}}return e})});var P0e=y((W7t,C0e)=>{f();"use strict";var{CID:R0e}=(Ie(),De),Rlt=ve(),Clt=Se();C0e.exports=Rlt(r=>{async function e(t,i={}){return((await(await r.post("object/links",{timeout:i.timeout,signal:i.signal,searchParams:Clt({arg:`${t instanceof Uint8Array?R0e.decode(t):t}`,...i}),headers:i.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:R0e.parse(o.Hash)}))}return e})});var k0e=y((Y7t,O0e)=>{f();"use strict";var{CID:Plt}=(Ie(),De),Olt=ve(),klt=Se();O0e.exports=Olt(r=>{async function e(t={}){let i=await r.post("object/new",{timeout:t.timeout,signal:t.signal,searchParams:klt({arg:t.template,...t}),headers:t.headers}),{Hash:n}=await i.json();return Plt.parse(n)}return e})});var N0e=y((X7t,q0e)=>{f();"use strict";var{CID:qlt}=(Ie(),De),Nlt=ve(),Dlt=Se();q0e.exports=Nlt(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/add-link",{timeout:n.timeout,signal:n.signal,searchParams:Dlt({arg:[`${t}`,i.Name||i.name||"",(i.Hash||i.cid||"").toString()||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return qlt.parse(o)}return e})});var B0e=y((Q7t,D0e)=>{f();"use strict";var{CID:Blt}=(Ie(),De),Mlt=oa(),Llt=ve(),Ult=Se(),Flt=aa(),{AbortController:Klt}=rn();D0e.exports=Llt(r=>{async function e(t,i,n={}){let s=new Klt,o=Flt(s.signal,n.signal),a=await r.post("object/patch/append-data",{timeout:n.timeout,signal:o,searchParams:Ult({arg:`${t}`,...n}),...await Mlt(i,s,n.headers)}),{Hash:c}=await a.json();return Blt.parse(c)}return e})});var L0e=y((Z7t,M0e)=>{f();"use strict";var{CID:jlt}=(Ie(),De),Vlt=ve(),zlt=Se();M0e.exports=Vlt(r=>{async function e(t,i,n={}){let s=await r.post("object/patch/rm-link",{timeout:n.timeout,signal:n.signal,searchParams:zlt({arg:[`${t}`,i.Name||i.name||null],...n}),headers:n.headers}),{Hash:o}=await s.json();return jlt.parse(o)}return e})});var F0e=y((J7t,U0e)=>{f();"use strict";var{CID:Hlt}=(Ie(),De),$lt=oa(),Glt=ve(),Wlt=Se(),Ylt=aa(),{AbortController:Xlt}=rn();U0e.exports=Glt(r=>{async function e(t,i,n={}){let s=new Xlt,o=Ylt(s.signal,n.signal),a=await r.post("object/patch/set-data",{timeout:n.timeout,signal:o,searchParams:Wlt({arg:[`${t}`],...n}),...await $lt(i,s,n.headers)}),{Hash:c}=await a.json();return Hlt.parse(c)}return e})});var j0e=y((eLt,K0e)=>{f();"use strict";K0e.exports=r=>({addLink:N0e()(r),appendData:B0e()(r),rmLink:L0e()(r),setData:F0e()(r)})});var z0e=y((tLt,V0e)=>{f();"use strict";var Qlt=ve();V0e.exports=(r,e)=>Qlt(i=>{let n=iP()(r,e);async function s(o,a={}){return n(o,{...a,format:"dag-pb",hashAlg:"sha2-256",version:0})}return s})(e)});var $0e=y((rLt,H0e)=>{f();"use strict";var{CID:Zlt}=(Ie(),De),Jlt=ve(),eft=Se();H0e.exports=Jlt(r=>{async function e(t,i={}){let s=await(await r.post("object/stat",{timeout:i.timeout,signal:i.signal,searchParams:eft({arg:`${t}`,...i}),headers:i.headers})).json();return{...s,Hash:Zlt.parse(s.Hash)}}return e})});var W0e=y((iLt,G0e)=>{f();"use strict";G0e.exports=(r,e)=>({data:x0e()(e),get:T0e()(e),links:P0e()(e),new:k0e()(e),patch:j0e()(e),put:z0e()(r,e),stat:$0e()(e)})});var X0e=y((nLt,Y0e)=>{f();"use strict";var tft=BS(),aP=Se(),bu=class{constructor(e){this.client=new tft(e)}static encodeEndpoint(e){let t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}static decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:bu.decodeStat(e.Stat)}}}static decodeStat(e){switch(e.Status){case"valid":{let{Pinning:t,Pinned:i,Queued:n,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:i,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}};bu.prototype.add=async function(e,t){let{endpoint:i,key:n,headers:s,timeout:o,signal:a}=t;await this.client.post("pin/remote/service/add",{timeout:o,signal:a,searchParams:aP({arg:[e,bu.encodeEndpoint(i),n]}),headers:s})};bu.prototype.rm=async function(e,t={}){await this.client.post("pin/remote/service/rm",{timeout:t.timeout,signal:t.signal,headers:t.headers,searchParams:aP({arg:e})})};bu.prototype.ls=async function(e={}){let{stat:t,headers:i,timeout:n,signal:s}=e,o=await this.client.post("pin/remote/service/ls",{timeout:n,signal:s,headers:i,searchParams:t===!0?aP({stat:t}):void 0}),{RemoteServices:a}=await o.json();return a.map(bu.decodeRemoteService)};Y0e.exports=bu});var iye=y((sLt,rye)=>{f();"use strict";var{CID:Q0e}=(Ie(),De),rft=BS(),ift=X0e(),Z0e=Se(),B0=class{constructor(e){this.client=new rft(e),this.service=new ift(e)}};B0.prototype.add=async function(e,{timeout:t,signal:i,headers:n,...s}){let o=await this.client.post("pin/remote/add",{timeout:t,signal:i,headers:n,searchParams:nft({cid:e,...s})});return J0e(await o.json())};B0.prototype.ls=async function*({timeout:e,signal:t,headers:i,...n}){let s=await this.client.post("pin/remote/ls",{timeout:e,signal:t,headers:i,searchParams:cP(n)});for await(let o of s.ndjson())yield J0e(o)};B0.prototype.rm=async function({timeout:e,signal:t,headers:i,...n}){await this.client.post("pin/remote/rm",{timeout:e,signal:t,headers:i,searchParams:cP({...n,all:!1})})};B0.prototype.rmAll=async function({timeout:r,signal:e,headers:t,...i}){await this.client.post("pin/remote/rm",{timeout:r,signal:e,headers:t,searchParams:cP({...i,all:!0})})};var J0e=({Name:r,Status:e,Cid:t})=>({cid:Q0e.parse(t),name:r,status:e}),eye=r=>{if(typeof r=="string"&&r!=="")return r;throw new TypeError("service name must be passed")},tye=r=>{if(r instanceof Q0e)return r.toString();throw new TypeError(`CID instance expected instead of ${typeof r}`)},cP=({service:r,cid:e,name:t,status:i,all:n})=>{let s=Z0e({service:eye(r),name:t,force:n?!0:void 0});if(e)for(let o of e)s.append("cid",tye(o));if(i)for(let o of i)s.append("status",o);return s},nft=({cid:r,service:e,background:t,name:i,origins:n})=>{let s=Z0e({arg:tye(r),service:eye(e),name:i,background:t?!0:void 0});if(n)for(let o of n)s.append("origin",o.toString());return s};rye.exports=B0});var uP=y((oLt,sye)=>{f();"use strict";var{CID:nye}=(Ie(),De),sft=ve(),{normaliseInput:oft}=_p(),aft=Se();sye.exports=sft(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s,metadata:o}of oft(t)){let a=await r.post("pin/add",{timeout:i.timeout,signal:i.signal,searchParams:aft({...i,arg:n,recursive:s,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:i.headers});for await(let c of a.ndjson()){if(c.Pins){for(let u of c.Pins)yield nye.parse(u);continue}yield nye.parse(c)}}}return e})});var aye=y((aLt,oye)=>{f();"use strict";var cft=uP(),uft=rs(),lft=ve();oye.exports=r=>{let e=cft(r);return lft(()=>{async function t(i,n={}){return uft(e([{path:i,...n}],n))}return t})(r)}});var lye=y((cLt,uye)=>{f();"use strict";var{CID:fft}=(Ie(),De),dft=ve(),hft=Se();function cye(r,e,t){let i={type:r,cid:fft.parse(e)};return t&&(i.metadata=t),i}uye.exports=dft(r=>{async function*e(t={}){let i=[];t.paths&&(i=Array.isArray(t.paths)?t.paths:[t.paths]);let n=await r.post("pin/ls",{timeout:t.timeout,signal:t.signal,searchParams:hft({...t,arg:i.map(s=>`${s}`),stream:!0}),headers:t.headers});for await(let s of n.ndjson()){if(s.Keys){for(let o of Object.keys(s.Keys))yield cye(s.Keys[o].Type,o,s.Keys[o].Metadata);return}yield cye(s.Type,s.Cid,s.Metadata)}}return e})});var lP=y((uLt,dye)=>{f();"use strict";var{CID:fye}=(Ie(),De),pft=ve(),{normaliseInput:yft}=_p(),gft=Se();dye.exports=pft(r=>{async function*e(t,i={}){for await(let{path:n,recursive:s}of yft(t)){let o=new URLSearchParams(i.searchParams);o.append("arg",`${n}`),s!=null&&o.set("recursive",String(s));let a=await r.post("pin/rm",{timeout:i.timeout,signal:i.signal,headers:i.headers,searchParams:gft({...i,arg:`${n}`,recursive:s})});for await(let c of a.ndjson()){if(c.Pins){yield*c.Pins.map(u=>fye.parse(u));continue}yield fye.parse(c)}}}return e})});var pye=y((lLt,hye)=>{f();"use strict";var mft=lP(),bft=rs(),vft=ve();hye.exports=r=>{let e=mft(r);return vft(()=>{async function t(i,n={}){return bft(e([{path:i,...n}],n))}return t})(r)}});var gye=y((fLt,yye)=>{f();"use strict";var wft=iye();yye.exports=r=>({add:aye()(r),addAll:uP()(r),ls:lye()(r),rm:pye()(r),rmAll:lP()(r),remote:new wft(r)})});var bye=y((dLt,mye)=>{f();"use strict";var _ft=Hr(),Eft=ve(),Sft=Se();mye.exports=Eft(r=>{async function*e(t,i={}){yield*(await r.post("ping",{timeout:i.timeout,signal:i.signal,searchParams:Sft({arg:`${t}`,...i}),headers:i.headers,transform:_ft})).ndjson()}return e})});var _ye=y((hLt,wye)=>{f();"use strict";var{AbortController:xft}=rn(),vye=class{constructor(){this._subs=new Map}subscribe(e,t,i){let n=this._subs.get(e)||[];if(n.find(o=>o.handler===t))throw new Error(`Already subscribed to ${e} with this handler`);let s=new xft;return this._subs.set(e,[{handler:t,controller:s}].concat(n)),i&&i.addEventListener("abort",()=>this.unsubscribe(e,t)),s.signal}unsubscribe(e,t){let i=this._subs.get(e)||[],n;t?(this._subs.set(e,i.filter(s=>s.handler!==t)),n=i.filter(s=>s.handler===t)):(this._subs.set(e,[]),n=i),(this._subs.get(e)||[]).length||this._subs.delete(e),n.forEach(s=>s.controller.abort())}};wye.exports=vye});var Sye=y((pLt,Eye)=>{f();"use strict";var Aft=ve(),Ift=Se();Eye.exports=Aft(r=>{async function e(t={}){let{Strings:i}=await(await r.post("pubsub/ls",{timeout:t.timeout,signal:t.signal,searchParams:Ift(t),headers:t.headers})).json();return i||[]}return e})});var Aye=y((yLt,xye)=>{f();"use strict";var Tft=ve(),Rft=Se();xye.exports=Tft(r=>{async function e(t,i={}){let n=await r.post("pubsub/peers",{timeout:i.timeout,signal:i.signal,searchParams:Rft({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var Tye=y((gLt,Iye)=>{f();"use strict";var Cft=ve(),Pft=Se(),Oft=oa(),kft=aa(),{AbortController:qft}=rn();Iye.exports=Cft(r=>{async function e(t,i,n={}){let s=Pft({arg:t,...n}),o=new qft,a=kft(o.signal,n.signal);await(await r.post("pubsub/pub",{timeout:n.timeout,signal:a,searchParams:s,...await Oft(i,o,n.headers)})).text()}return e})});var Cye=y((mLt,Rye)=>{f();"use strict";var{fromString:fP}=(ft(),ht),{toString:Nft}=(tt(),et),Dft=be()("ipfs-http-client:pubsub:subscribe"),Bft=ve(),Mft=Se();Rye.exports=(r,e)=>Bft(t=>{async function i(n,s,o={}){o.signal=e.subscribe(n,s,o.signal);let a,c,u=new Promise((d,h)=>{a=d,c=h}),l=setTimeout(()=>a(),1e3);return t.post("pubsub/sub",{timeout:o.timeout,signal:o.signal,searchParams:Mft({arg:n,...o}),headers:o.headers}).catch(d=>{e.unsubscribe(n,s),c(d)}).then(d=>{clearTimeout(l),!!d&&(Lft(d,{onMessage:s,onEnd:()=>e.unsubscribe(n,s),onError:o.onError}),a())}),u}return i})(r);async function Lft(r,{onMessage:e,onEnd:t,onError:i}){i=i||Dft;try{for await(let n of r.ndjson())try{if(!n.from)continue;e({from:Nft(fP(n.from,"base64pad"),"base58btc"),data:fP(n.data,"base64pad"),seqno:fP(n.seqno,"base64pad"),topicIDs:n.topicIDs})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,i(s,!1,n)}}catch(n){Uft(n)||i(n,!0)}finally{t()}}var Uft=r=>{switch(r.type){case"aborted":return!0;case"abort":return!0;default:return r.name==="AbortError"}}});var Oye=y((bLt,Pye)=>{f();"use strict";Pye.exports=(r,e)=>{async function t(i,n){e.unsubscribe(i,n)}return t}});var qye=y((vLt,kye)=>{f();"use strict";var Fft=_ye();kye.exports=r=>{let e=new Fft;return{ls:Sye()(r),peers:Aye()(r),publish:Tye()(r),subscribe:Cye()(r,e),unsubscribe:Oye()(r,e)}}});var Dye=y((wLt,Nye)=>{f();"use strict";var Kft=Hr(),jft=ve(),Vft=Se();Nye.exports=jft(r=>{async function*e(t={}){yield*(await r.post("refs/local",{timeout:t.timeout,signal:t.signal,transform:Kft,searchParams:Vft(t),headers:t.headers})).ndjson()}return e})});var Mye=y((_Lt,Bye)=>{f();"use strict";var{CID:zft}=(Ie(),De),Hft=Hr(),$ft=ve(),Gft=Se();Bye.exports=$ft((r,e)=>Object.assign(async function*(i,n={}){let s=Array.isArray(i)?i:[i];yield*(await r.post("refs",{timeout:n.timeout,signal:n.signal,searchParams:Gft({arg:s.map(a=>`${a instanceof Uint8Array?zft.decode(a):a}`),...n}),headers:n.headers,transform:Hft})).ndjson()},{local:Dye()(e)}))});var Uye=y((ELt,Lye)=>{f();"use strict";var{CID:Wft}=(Ie(),De),Yft=ve(),Xft=Se();Lye.exports=Yft(r=>{async function*e(t={}){yield*(await r.post("repo/gc",{timeout:t.timeout,signal:t.signal,searchParams:Xft(t),headers:t.headers,transform:n=>({err:n.Error?new Error(n.Error):null,cid:(n.Key||{})["/"]?Wft.parse(n.Key["/"]):null})})).ndjson()}return e})});var dP=y((SLt,Fye)=>{f();"use strict";var Qft=ve(),Zft=Se();Fye.exports=Qft(r=>{async function e(t={}){let n=await(await r.post("repo/stat",{timeout:t.timeout,signal:t.signal,searchParams:Zft(t),headers:t.headers})).json();return{numObjects:BigInt(n.NumObjects),repoSize:BigInt(n.RepoSize),repoPath:n.RepoPath,version:n.Version,storageMax:BigInt(n.StorageMax)}}return e})});var jye=y((xLt,Kye)=>{f();"use strict";var Jft=ve(),edt=Se();Kye.exports=Jft(r=>{async function e(t={}){return(await(await r.post("repo/version",{timeout:t.timeout,signal:t.signal,searchParams:edt(t),headers:t.headers})).json()).Version}return e})});var zye=y((ALt,Vye)=>{f();"use strict";Vye.exports=r=>({gc:Uye()(r),stat:dP()(r),version:jye()(r)})});var $ye=y((ILt,Hye)=>{f();"use strict";var tdt=ve(),rdt=Se();Hye.exports=tdt(r=>{async function e(t,i={}){let n=await r.post("resolve",{timeout:i.timeout,signal:i.signal,searchParams:rdt({arg:t,...i}),headers:i.headers}),{Path:s}=await n.json();return s}return e})});var Wye=y((TLt,Gye)=>{f();"use strict";var idt=ve(),ndt=ae();Gye.exports=idt(r=>async(t={})=>{throw ndt(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")})});var Xye=y((RLt,Yye)=>{f();"use strict";var sdt=ve(),odt=Se();Yye.exports=sdt(r=>{async function*e(t={}){yield*(await r.post("stats/bw",{timeout:t.timeout,signal:t.signal,searchParams:odt(t),headers:t.headers,transform:n=>({totalIn:BigInt(n.TotalIn),totalOut:BigInt(n.TotalOut),rateIn:parseFloat(n.RateIn),rateOut:parseFloat(n.RateOut)})})).ndjson()}return e})});var Zye=y((CLt,Qye)=>{f();"use strict";Qye.exports=r=>({bitswap:tP()(r),bw:Xye()(r),repo:dP()(r)})});var ege=y((PLt,Jye)=>{f();"use strict";var adt=ve(),cdt=Se();Jye.exports=adt(r=>{async function e(t={}){await(await r.post("shutdown",{timeout:t.timeout,signal:t.signal,searchParams:cdt(t),headers:t.headers})).text()}return e})});var rge=y((OLt,tge)=>{f();"use strict";var{Multiaddr:udt}=it(),ldt=ve(),fdt=Se();tge.exports=ldt(r=>{async function e(t={}){let i=await r.post("swarm/addrs",{timeout:t.timeout,signal:t.signal,searchParams:fdt(t),headers:t.headers}),{Addrs:n}=await i.json();return Object.keys(n).map(s=>({id:s,addrs:(n[s]||[]).map(o=>new udt(o))}))}return e})});var nge=y((kLt,ige)=>{f();"use strict";var ddt=ve(),hdt=Se();ige.exports=ddt(r=>{async function e(t,i={}){let n=await r.post("swarm/connect",{timeout:i.timeout,signal:i.signal,searchParams:hdt({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var oge=y((qLt,sge)=>{f();"use strict";var pdt=ve(),ydt=Se();sge.exports=pdt(r=>{async function e(t,i={}){let n=await r.post("swarm/disconnect",{timeout:i.timeout,signal:i.signal,searchParams:ydt({arg:t,...i}),headers:i.headers}),{Strings:s}=await n.json();return s||[]}return e})});var cge=y((NLt,age)=>{f();"use strict";var{Multiaddr:gdt}=it(),mdt=ve(),bdt=Se();age.exports=mdt(r=>{async function e(t={}){let i=await r.post("swarm/addrs/local",{timeout:t.timeout,signal:t.signal,searchParams:bdt(t),headers:t.headers}),{Strings:n}=await i.json();return(n||[]).map(s=>new gdt(s))}return e})});var lge=y((DLt,uge)=>{f();"use strict";var{Multiaddr:vdt}=it(),wdt=ve(),_dt=Se();uge.exports=wdt(r=>{async function e(t={}){let i=await r.post("swarm/peers",{timeout:t.timeout,signal:t.signal,searchParams:_dt(t),headers:t.headers}),{Peers:n}=await i.json();return(n||[]).map(s=>({addr:new vdt(s.Addr),peer:s.Peer,muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return e})});var dge=y((BLt,fge)=>{f();"use strict";fge.exports=r=>({addrs:rge()(r),connect:nge()(r),disconnect:oge()(r),localAddrs:cge()(r),peers:lge()(r)})});var pge=y((MLt,hge)=>{f();"use strict";var Edt=Hr(),Sdt=ve(),xdt=Se();hge.exports=Sdt(r=>{async function e(t={}){let i=await r.post("version",{timeout:t.timeout,signal:t.signal,searchParams:xdt(t),headers:t.headers});return Edt(await i.json())}return e})});var mge=y((LLt,gge)=>{f();"use strict";var{CID:Adt}=(Ie(),De),{multiaddr:Idt}=it(),Tdt=a6(),Rdt=b6(),Cdt=GC(),Pdt=WC(),Odt=YC(),kdt=(_t(),Mt),qdt=(eu(),l_),{identity:yge}=(Fc(),Uc),{bases:Ndt,hashes:Ddt,codecs:Bdt}=(iw(),yA);function Mdt(r={}){let e={name:yge.name,code:yge.code,encode:u=>u,decode:u=>u},t=Object.values(Ndt);(r.ipld&&r.ipld.bases?r.ipld.bases:[]).forEach(u=>t.push(u));let i=new Odt({bases:t,loadBase:r.ipld&&r.ipld.loadBase}),n=Object.values(Bdt);[kdt,qdt,e].concat(r.ipld&&r.ipld.codecs||[]).forEach(u=>n.push(u));let s=new Cdt({codecs:n,loadCodec:r.ipld&&r.ipld.loadCodec}),o=Object.values(Ddt);(r.ipld&&r.ipld.hashers?r.ipld.hashers:[]).forEach(u=>o.push(u));let a=new Pdt({hashers:o,loadHasher:r.ipld&&r.ipld.loadHasher});return{add:yde()(r),addAll:eP()(r),bitswap:xde()(r),block:qde()(r),bootstrap:Hde()(r),cat:Gde()(r),commands:Yde()(r),config:fhe()(r),dag:Ihe()(s,r),dht:Khe()(r),diag:Yhe()(r),dns:Qhe()(r),files:Ipe()(r),get:Rpe()(r),getEndpointConfig:Ppe()(r),id:oP()(r),isOnline:qpe()(r),key:Ype()(r),log:i0e()(r),ls:o0e()(r),mount:c0e()(r),name:E0e()(r),object:W0e()(s,r),pin:gye()(r),ping:bye()(r),pubsub:qye()(r),refs:Mye()(r),repo:zye()(r),resolve:$ye()(r),start:Wye()(r),stats:Zye()(r),stop:ege()(r),swarm:dge()(r),version:pge()(r),bases:i,codecs:s,hashers:a}}gge.exports={create:Mdt,CID:Adt,multiaddr:Idt,globSource:Tdt,urlSource:Rdt}});var hP=y((ULt,bge)=>{f();"use strict";var Ldt=ae(),Udt=Ya(),Fdt=Ho(),Kdt=bp();function jdt(r,e){return Fdt(r,t=>(e.addressBook.add(t.id,t.multiaddrs),t))}function Vdt(r){let e=new Set;return Udt(r,t=>e.has(t.id.toString())?!1:(e.add(t.id.toString()),!0))}async function*zdt(r,e=1){let t=0;for await(let i of r)t++,yield i;if(t<e)throw Ldt(new Error("not found"),"NOT_FOUND")}function Hdt(r,e){return e?Kdt(r,e):r}bge.exports={storeAddresses:jdt,uniquePeers:Vdt,requirePeers:zdt,maybeLimitSource:Hdt}});var pP=y((FLt,vge)=>{f();"use strict";var M0=new Map,$dt=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function Gdt(r,e,t){for(;M0.get(t);){try{await r()}catch(i){setTimeout(()=>{throw i},1);break}if(!M0.get(t))break;await new Promise(i=>{let n=setTimeout(i,e);M0.set(t,n)})}}function Wdt(r,e,t){t=t||e;let i=$dt(),n=setTimeout(()=>{Gdt(r,e,i)},t);return M0.set(i,n),i}function Ydt(r){let e=M0.get(r);e&&(clearTimeout(e),M0.delete(r))}vge.exports={setDelayedInterval:Wdt,clearDelayedInterval:Ydt}});var Ige=y((KLt,Age)=>{f();"use strict";var wge=be(),Xdt=Object.assign(wge("libp2p:peer-routing"),{error:wge("libp2p:peer-routing:err")}),US=ae(),{storeAddresses:_ge,uniquePeers:Qdt,requirePeers:Zdt}=hP(),Ege=Cp(),{pipe:Sge}=Ar(),Jdt=zf(),eht=Wa(),tht=Ya(),{setDelayedInterval:rht,clearDelayedInterval:iht}=pP(),xge=class{constructor(e){this._peerId=e.peerId,this._peerStore=e.peerStore,this._routers=e._modules.peerRouting||[],e._dht&&e._config.dht.enabled&&this._routers.push(e._dht),this._refreshManagerOptions=e._options.peerRouting.refreshManager,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}start(){!this._routers.length||this._timeoutId||!this._refreshManagerOptions.enabled||(this._timeoutId=rht(this._findClosestPeersTask,this._refreshManagerOptions.interval,this._refreshManagerOptions.bootDelay))}async _findClosestPeersTask(){try{await eht(this.getClosestPeers(this._peerId.id))}catch(e){Xdt.error(e)}}stop(){iht(this._timeoutId)}async findPeer(e,t){if(!this._routers.length)throw US(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");if(e.toB58String()===this._peerId.toB58String())throw US(new Error("Should not try to find self"),"ERR_FIND_SELF");let i=await Sge(Ege(...this._routers.map(n=>[n.findPeer(e,t)])),n=>tht(n,Boolean),n=>_ge(n,this._peerStore),n=>Jdt(n));if(i)return i;throw US(new Error("not found"),"NOT_FOUND")}async*getClosestPeers(e,t={timeout:3e4}){if(!this._routers.length)throw US(new Error("No peer routers available"),"NO_ROUTERS_AVAILABLE");yield*Sge(Ege(...this._routers.map(i=>i.getClosestPeers(e,t))),i=>_ge(i,this._peerStore),i=>Qdt(i),i=>Zdt(i))}};Age.exports=xge});var Cge=y((jLt,Rge)=>{f();"use strict";var Jb=ae(),{messages:yP,codes:gP}=yi(),{storeAddresses:nht,uniquePeers:sht,requirePeers:oht,maybeLimitSource:aht}=hP(),cht=Cp(),{pipe:uht}=Ar(),Tge=class{constructor(e){this.libp2p=e,this.routers=e._modules.contentRouting||[],this.dht=e._dht,this.dht&&e._config.dht.enabled&&this.routers.push(this.dht)}async*findProviders(e,t={}){if(!this.routers.length)throw Jb(new Error("No content this.routers available"),"NO_ROUTERS_AVAILABLE");yield*uht(cht(...this.routers.map(i=>i.findProviders(e,t))),i=>nht(i,this.libp2p.peerStore),i=>sht(i),i=>aht(i,t.maxNumProviders),i=>oht(i))}async provide(e){if(!this.routers.length)throw Jb(new Error("No content routers available"),"NO_ROUTERS_AVAILABLE");await Promise.all(this.routers.map(t=>t.provide(e)))}put(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Jb(new Error(yP.NOT_STARTED_YET),gP.DHT_NOT_STARTED);return this.dht.put(e,t,i)}get(e,t){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Jb(new Error(yP.NOT_STARTED_YET),gP.DHT_NOT_STARTED);return this.dht.get(e,t)}async getMany(e,t,i){if(!this.libp2p.isStarted()||!this.dht.isStarted)throw Jb(new Error(yP.NOT_STARTED_YET),gP.DHT_NOT_STARTED);return this.dht.getMany(e,t,i)}};Rge.exports=Tge});var mP=y((VLt,qge)=>{f();"use strict";var lht=rt(),{Multiaddr:Pge}=it(),Oge=ae(),{codes:kge}=yi();function fht(r){typeof r=="string"&&(r=new Pge(r));let e;if(Pge.isMultiaddr(r)){e=r;let t=r.getPeerId();if(!t)throw Oge(new Error(`${r} does not have a valid peer type`),kge.ERR_INVALID_MULTIADDR);try{r=lht.createFromB58String(t)}catch(i){throw Oge(new Error(`${r} is not a valid peer type`),kge.ERR_INVALID_MULTIADDR)}}return{id:r,multiaddrs:e?[e]:void 0}}qge.exports=fht});var Bge=y((zLt,Dge)=>{f();"use strict";Dge.exports=Nge;var dht=qI(),$l=Nge.prototype,hht=new Date%1e9;function pht(){return(Math.random()*1e9>>>0)+hht++}function Nge(r){r=r||{},this.id=r.id||pht(),this.max=r.max||1/0,this.items=r.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(r.lastModified||new Date);for(var e,t,i=this.items.length;i--;)e=this.items[i],t=new Date(e.expires)-new Date,this._lookup[e.key]=e,t>0?this.expire(e.key,t):t<=0&&this.delete(e.key)}$l.has=function(r){return r in this._lookup};$l.get=function(r){if(!this.has(r))return null;var e=this._lookup[r];return e.refresh&&this.expire(r,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};$l.meta=function(r){if(!this.has(r))return null;var e=this._lookup[r];return"meta"in e?e.meta:null};$l.set=function(r,e,t){var i=this._lookup[r],n=this._lookup[r]={key:r,value:e};return this.lastModified=new Date,i?(clearTimeout(i.timeout),this.items.splice(this.items.indexOf(i),1,n)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(n),this.size++),t&&("ttl"in t&&this.expire(r,t.ttl),"meta"in t&&(n.meta=t.meta),t.refresh&&(n.refresh=t.ttl)),this};$l.delete=function(r){var e=this._lookup[r];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[r],this.size--,this):!1};$l.expire=function(r,e){var t=e||0,i=this._lookup[r];if(!i)return this;if(typeof t=="string"&&(t=dht(e)),typeof t!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(i.timeout),i.timeout=setTimeout(this.delete.bind(this,i.key),t),i.expires=Number(new Date)+t,this};$l.clear=function(){for(var r=this.items.length;r--;)this.delete(this.items[r].key);return this};$l.toJSON=function(){for(var r=new Array(this.items.length),e,t=r.length;t--;)e=this.items[t],r[t]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:r}}});var Lge=y((HLt,Mge)=>{f();"use strict";var{default:yht,Headers:ght}=f6();function mht({serverResolver:r,hostname:e,recordType:t}){return`${r}?name=${e}&type=${t}`}function bht(r){return yht(r,{headers:new ght({accept:"application/dns-json"})})}function vht(r,e){return`${e}_${r}`}Mge.exports={buildResource:mht,fetch:bht,getCacheKey:vht}});var Kge=y(($Lt,Fge)=>{f();"use strict";var Uge=be(),FS=Uge("dns-over-http-resolver");FS.error=Uge("dns-over-http-resolver:error");var wht=Bge(),co=Lge(),KS=class{constructor({maxCache:e=100}={}){this._cache=new wht({max:e}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"]}getServers(){return this._servers}_getShuffledServers(){let e=[].concat(this._servers);for(let t=e.length-1;t>0;t--){let i=Math.floor(Math.random()*t),n=e[t];e[t]=e[i],e[i]=n}return e}setServers(e){this._servers=e}resolve(e,t="A"){switch(t){case"A":return this.resolve4(e);case"AAAA":return this.resolve6(e);case"TXT":return this.resolveTxt(e);default:throw new Error(`${t} is not supported`)}}async resolve4(e){let t="A",i=this._cache.get(co.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await co.fetch(co.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(co.getCacheKey(e,t),a,{ttl:c}),a}catch(s){FS.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolve6(e){let t="AAAA",i=this._cache.get(co.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await co.fetch(co.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>u.data),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(co.getCacheKey(e,t),a,{ttl:c}),a}catch(s){FS.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}async resolveTxt(e){let t="TXT",i=this._cache.get(co.getCacheKey(e,t));if(i)return i;for(let n of this._getShuffledServers())try{let o=await(await co.fetch(co.buildResource({serverResolver:n,hostname:e,recordType:t}))).json(),a=o.Answer.map(u=>[u.data.replace(/['"]+/g,"")]),c=Math.min(o.Answer.map(u=>u.TTL));return this._cache.set(co.getCacheKey(e,t),a,{ttl:c}),a}catch(s){FS.error(`${n} could not resolve ${e} record ${t}`)}throw new Error(`Could not resolve ${e} record ${t}`)}};KS.Resolver=KS;Fge.exports=KS});var Vge=y((GLt,jge)=>{f();"use strict";var _ht=Kge();jge.exports=_ht});var Hge=y((WLt,zge)=>{f();"use strict";var Eht=Ug(),{code:Sht}=Eht("dnsaddr");async function xht(r){let e=Vge(),t=new e,i=r.getPeerId(),[,n]=r.stringTuples().find(([a])=>a===Sht)||[],o=(await t.resolveTxt(`_dnsaddr.${n}`)).flat().map(a=>a.split("=")[1]);return i&&(o=o.filter(a=>a.includes(i))),o}zge.exports={dnsaddrResolver:xht}});var jS=y((YLt,$ge)=>{f();"use strict";$ge.exports={DIAL_TIMEOUT:3e4,MAX_PARALLEL_DIALS:100,MAX_PER_PEER_DIALS:4,MAX_ADDRS_TO_DIAL:25,METRICS:{computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50}}});var bP=y((XLt,Aht)=>{Aht.exports={name:"libp2p",version:"0.32.4",description:"JavaScript implementation of libp2p, a modular peer to peer network stack",leadMaintainer:"Jacob Heun <jacobheun@gmail.com>",main:"src/index.js",types:"dist/src/index.d.ts",typesVersions:{"*":{"src/*":["dist/src/*","dist/src/*/index"]}},files:["dist","src"],scripts:{lint:"aegir lint",build:"aegir build","build:proto":"npm run build:proto:circuit && npm run build:proto:identify && npm run build:proto:plaintext && npm run build:proto:address-book && npm run build:proto:proto-book && npm run build:proto:peer-record && npm run build:proto:envelope","build:proto:circuit":"pbjs -t static-module -w commonjs -r libp2p-circuit --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/circuit/protocol/index.js ./src/circuit/protocol/index.proto","build:proto:identify":"pbjs -t static-module -w commonjs -r libp2p-identify --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/identify/message.js ./src/identify/message.proto","build:proto:plaintext":"pbjs -t static-module -w commonjs -r libp2p-plaintext --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/insecure/proto.js ./src/insecure/proto.proto","build:proto:address-book":"pbjs -t static-module -w commonjs -r libp2p-address-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/address-book.js ./src/peer-store/persistent/pb/address-book.proto","build:proto:proto-book":"pbjs -t static-module -w commonjs -r libp2p-proto-book --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/peer-store/persistent/pb/proto-book.js ./src/peer-store/persistent/pb/proto-book.proto","build:proto:peer-record":"pbjs -t static-module -w commonjs -r libp2p-peer-record --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/peer-record/peer-record.js ./src/record/peer-record/peer-record.proto","build:proto:envelope":"pbjs -t static-module -w commonjs -r libp2p-envelope --force-number --no-verify --no-delimited --no-create --no-beautify --no-defaults --lint eslint-disable -o src/record/envelope/envelope.js ./src/record/envelope/envelope.proto","build:proto-types":"npm run build:proto-types:circuit && npm run build:proto-types:identify && npm run build:proto-types:plaintext && npm run build:proto-types:address-book && npm run build:proto-types:proto-book && npm run build:proto-types:peer-record && npm run build:proto-types:envelope","build:proto-types:circuit":"pbts -o src/circuit/protocol/index.d.ts src/circuit/protocol/index.js","build:proto-types:identify":"pbts -o src/identify/message.d.ts src/identify/message.js","build:proto-types:plaintext":"pbts -o src/insecure/proto.d.ts src/insecure/proto.js","build:proto-types:address-book":"pbts -o src/peer-store/persistent/pb/address-book.d.ts src/peer-store/persistent/pb/address-book.js","build:proto-types:proto-book":"pbts -o src/peer-store/persistent/pb/proto-book.d.ts src/peer-store/persistent/pb/proto-book.js","build:proto-types:peer-record":"pbts -o src/record/peer-record/peer-record.d.ts src/record/peer-record/peer-record.js","build:proto-types:envelope":"pbts -o src/record/envelope/envelope.d.ts src/record/envelope/envelope.js",test:"aegir test","test:ts":"aegir build --no-bundle && npm run test --prefix test/ts-use","test:node":'aegir test -t node -f "./test/**/*.{node,spec}.js"',"test:browser":"aegir test -t browser","test:examples":"cd examples && npm run test:all",prepare:"aegir build --no-bundle",release:"aegir release -t node -t browser","release-minor":"aegir release --type minor -t node -t browser","release-major":"aegir release --type major -t node -t browser",coverage:"nyc --reporter=text --reporter=lcov npm run test:node"},repository:{type:"git",url:"https://github.com/libp2p/js-libp2p.git"},keywords:["libp2p","network","p2p","peer","peer-to-peer","IPFS"],bugs:{url:"https://github.com/libp2p/js-libp2p/issues"},homepage:"https://libp2p.io",license:"MIT",engines:{node:">=14.0.0"},browser:{"@motrix/nat-api":!1},eslintConfig:{extends:"ipfs",ignorePatterns:["!.aegir.js","test/ts-use"]},dependencies:{"@motrix/nat-api":"^0.3.1","@vascosantos/moving-average":"^1.1.0","abort-controller":"^3.0.0","aggregate-error":"^3.1.0","any-signal":"^2.1.1","bignumber.js":"^9.0.1","class-is":"^1.1.0",debug:"^4.3.1","err-code":"^3.0.0","es6-promisify":"^6.1.1",events:"^3.3.0",hashlru:"^2.3.0","interface-datastore":"^5.1.1","it-all":"^1.0.4","it-buffer":"^0.1.2","it-drain":"^1.0.3","it-filter":"^1.0.1","it-first":"^1.0.4","it-handshake":"^2.0.0","it-length-prefixed":"^5.0.2","it-map":"^1.0.4","it-merge":"^1.0.0","it-pipe":"^1.1.0","it-take":"^1.0.0","libp2p-crypto":"^0.19.4","libp2p-interfaces":"^1.0.0","libp2p-utils":"^0.4.0",mafmt:"^10.0.0","merge-options":"^3.0.4",multiaddr:"^10.0.0",multiformats:"^9.0.0","multistream-select":"^2.0.0","mutable-proxy":"^1.0.0","node-forge":"^0.10.0","p-any":"^3.0.0","p-fifo":"^1.0.0","p-retry":"^4.4.0","p-settle":"^4.1.1","peer-id":"^0.15.0","private-ip":"^2.1.0",protobufjs:"^6.10.2",retimer:"^3.0.0","sanitize-filename":"^1.6.3","set-delayed-interval":"^1.0.0","streaming-iterables":"^6.0.0","timeout-abort-controller":"^1.1.1",uint8arrays:"^3.0.0",varint:"^6.0.0",wherearewe:"^1.0.0",xsalsa20:"^1.1.0"},devDependencies:{"@chainsafe/libp2p-noise":"^4.0.0","@nodeutils/defaults-deep":"^1.1.0","@types/es6-promisify":"^6.0.0","@types/node":"^16.0.1","@types/node-forge":"^0.10.1","@types/varint":"^6.0.0","abortable-iterator":"^3.0.0",aegir:"^33.1.1",buffer:"^6.0.3",delay:"^5.0.0","interop-libp2p":"^0.4.0","into-stream":"^6.0.0","ipfs-http-client":"^50.1.1","it-concat":"^2.0.0","it-pair":"^1.0.0","it-pushable":"^1.4.0",libp2p:".","libp2p-bootstrap":"^0.13.0","libp2p-delegated-content-routing":"^0.11.0","libp2p-delegated-peer-routing":"^0.10.0","libp2p-floodsub":"^0.27.0","libp2p-gossipsub":"^0.11.0","libp2p-interfaces-compliance-tests":"^1.0.0","libp2p-kad-dht":"^0.23.0","libp2p-mdns":"^0.17.0","libp2p-mplex":"^0.10.1","libp2p-tcp":"^0.17.0","libp2p-webrtc-star":"^0.23.0","libp2p-websockets":"^0.16.0",nock:"^13.0.3","p-defer":"^3.0.0","p-times":"^3.0.0","p-wait-for":"^3.2.0",rimraf:"^3.0.2",sinon:"^11.1.1",util:"^0.12.3"},contributors:["Vasco Santos <vasco.santos@moxy.studio>","David Dias <daviddias.p@gmail.com>","Jacob Heun <jacobheun@gmail.com>","Alex Potsides <alex@achingbrain.net>","Alan Shaw <alan@tableflip.io>","Cayman <caymannava@gmail.com>","Pedro Teixeira <i@pgte.me>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Maciej Kr\xFCger <mkg20001@gmail.com>","Hugo Dias <mail@hugodias.me>","Volker Mische <volker.mische@gmail.com>","Chris Dostert <chrisdostert@users.noreply.github.com>","dirkmc <dirkmdev@gmail.com>","Richard Littauer <richard.littauer@gmail.com>","zeim839 <50573884+zeim839@users.noreply.github.com>","Ryan Bell <ryan@piing.net>","a1300 <matthias-knopp@gmx.net>","\u1D20\u026A\u1D04\u1D1B\u1D0F\u0280 \u0299\u1D0A\u1D07\u029F\u1D0B\u029C\u1D0F\u029F\u1D0D <victorbjelkholm@gmail.com>","Andrew Nesbitt <andrewnez@gmail.com>","Elven <mon.samuel@qq.com>","Franck Royer <franck@royer.one>","Giovanni T. Parra <fiatjaf@gmail.com>","Samlior <samlior@foxmail.com>","Thomas Eizinger <thomas@eizinger.io>","acolytec3 <17355484+acolytec3@users.noreply.github.com>","Didrik Nordstr\xF6m <didrik@betamos.se>","Irakli Gozalishvili <rfobic@gmail.com>","Joel Gustafson <joelg@mit.edu>","John Rees <johnrees@users.noreply.github.com>","Jo\xE3o Santos <joaosantos15@users.noreply.github.com>","Julien Bouquillon <contact@revolunet.com>","Kevin Kwok <antimatter15@gmail.com>","Kevin Lacker <lacker@gmail.com>","Lars Gierth <lgierth@users.noreply.github.com>","Ethan Lam <elmemphis2000@gmail.com>","Marcin Tojek <mtojek@users.noreply.github.com>","Michael Burns <5170+mburns@users.noreply.github.com>","Miguel Mota <miguelmota2@gmail.com>","Nuno Nogueira <nunofmn@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Philipp Muens <raute1337@gmx.de>","RasmusErik Voel Jensen <github@solsort.com>","Diogo Silva <fsdiogo@gmail.com>","Robert Kiel <robert.kiel@hoprnet.org>","phillmac <phillmac@users.noreply.github.com>","robertkiel <robert.kiel@validitylabs.org>","Smite Chow <xiaopengyou@live.com>","Soeren <nikorpoulsen@gmail.com>","S\xF6nke Hahn <soenkehahn@gmail.com>","TJKoury <TJKoury@gmail.com>","shresthagrawal <34920931+shresthagrawal@users.noreply.github.com>","Tiago Alves <alvesjtiago@gmail.com>","Daijiro Wachi <daijiro.wachi@gmail.com>","Yusef Napora <yusef@napora.org>","Zane Starr <zcstarr@gmail.com>","swedneck <40505480+swedneck@users.noreply.github.com>","Aleksei <vozhdb@gmail.com>","Cindy Wu <ciindy.wu@gmail.com>","Aditya Bose <13054902+adbose@users.noreply.github.com>","Chris Bratlien <chrisbratlien@gmail.com>","ebinks <elizabethjbinks@gmail.com>","greenSnot <greenSnot@users.noreply.github.com>","Bernd Strehl <bernd.strehl@gmail.com>","Francis Gulotta <wizard@roborooter.com>","isan_rivkin <isanrivkin@gmail.com>","Florian-Merle <florian.david.merle@gmail.com>","mayerwin <mayerwin@users.noreply.github.com>","Guy Sviry <32539816+guysv@users.noreply.github.com>","Henrique Dias <hacdias@gmail.com>","mcclure <andi.m.mcclure@gmail.com>","Felipe Martins <felipebrasil93@gmail.com>","Fei Liu <liu.feiwood@gmail.com>"]}});var vP=y((QLt,pc)=>{f();"use strict";var Iht=bP().version;pc.exports.PROTOCOL_VERSION="ipfs/0.1.0";pc.exports.AGENT_VERSION=`js-libp2p/${Iht}`;pc.exports.MULTICODEC_IDENTIFY="/ipfs/id/1.0.0";pc.exports.MULTICODEC_IDENTIFY_PUSH="/ipfs/id/push/1.0.0";pc.exports.IDENTIFY_PROTOCOL_VERSION="0.1.0";pc.exports.MULTICODEC_IDENTIFY_PROTOCOL_NAME="id";pc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push";pc.exports.MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0";pc.exports.MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0"});var VS=y((ZLt,Wge)=>{f();"use strict";var Gge=60*1e3;Wge.exports={ADVERTISE_BOOT_DELAY:15*Gge,ADVERTISE_TTL:30*Gge,CIRCUIT_PROTO_CODE:290,HOP_METADATA_KEY:"hop_relay",HOP_METADATA_VALUE:"true",RELAY_RENDEZVOUS_NS:"/libp2p/relay"}});var Yge=y(e1=>{f();(function(){var r,e,t,i,n,s,o,a;a=function(c){var u,l,d,h;return u=(c&255<<24)>>>24,l=(c&255<<16)>>>16,d=(c&255<<8)>>>8,h=c&255,[u,l,d,h].join(".")},o=function(c){var u,l,d,h,p,g;for(u=[],d=h=0;h<=3&&c.length!==0;d=++h){if(d>0){if(c[0]!==".")throw new Error("Invalid IP");c=c.substring(1)}g=e(c),p=g[0],l=g[1],c=c.substring(l),u.push(p)}if(c.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},t=function(c){return c.charCodeAt(0)},i=t("0"),s=t("a"),n=t("A"),e=function(c){var u,l,d,h,p;for(h=0,u=10,l="9",d=0,c.length>1&&c[d]==="0"&&(c[d+1]==="x"||c[d+1]==="X"?(d+=2,u=16):"0"<=c[d+1]&&c[d+1]<="9"&&(d++,u=8,l="7")),p=d;d<c.length;){if("0"<=c[d]&&c[d]<=l)h=h*u+(t(c[d])-i)>>>0;else if(u===16)if("a"<=c[d]&&c[d]<="f")h=h*u+(10+t(c[d])-s)>>>0;else if("A"<=c[d]&&c[d]<="F")h=h*u+(10+t(c[d])-n)>>>0;else break;else break;if(h>4294967295)throw new Error("too large");d++}if(d===p)throw new Error("empty octet");return[h,d]},r=function(){function c(u,l){var d,h,p,g;if(typeof u!="string")throw new Error("Missing `net' parameter");if(l||(g=u.split("/",2),u=g[0],l=g[1]),l||(l=32),typeof l=="string"&&l.indexOf(".")>-1){try{this.maskLong=o(l)}catch(b){throw d=b,new Error("Invalid mask: "+l)}for(h=p=32;p>=0;h=--p)if(this.maskLong===4294967295<<32-h>>>0){this.bitmask=h;break}}else if(l||l===0)this.bitmask=parseInt(l,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(o(u)&this.maskLong)>>>0}catch(b){throw d=b,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+l);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return c.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new c(u)),u instanceof c?this.contains(u.base)&&this.contains(u.broadcast||u.last):(o(u)&this.maskLong)>>>0==(this.netLong&this.maskLong)>>>0},c.prototype.next=function(u){return u==null&&(u=1),new c(a(this.netLong+this.size*u),this.mask)},c.prototype.forEach=function(u){var l,d,h;for(h=o(this.first),d=o(this.last),l=0;h<=d;)u(a(h),h,l),l++,h++},c.prototype.toString=function(){return this.base+"/"+this.bitmask},c}(),e1.ip2long=o,e1.long2ip=a,e1.Netmask=r}).call(e1)});var Zge=y((e9t,Qge)=>{f();var Tht=Yge().Netmask,Xge=dI(),Rht=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],Cht=Rht.map(r=>new Tht(r));function Pht(r){for(let e of Cht)if(e.contains(r))return!0;return!1}function Oht(r){return/^::$/.test(r)||/^::1$/.test(r)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(r)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(r)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(r)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(r)||/^ff([0-9a-fA-F]{2,2}):/i.test(r)}Qge.exports=r=>Xge.v6().test(r)?Oht(r):Xge().test(r)||r.startsWith("0")?Pht(r):!1});var wP=y((t9t,Jge)=>{f();"use strict";Jge.exports=Zge()});var tme=y((r9t,eme)=>{f();"use strict";var kht=wP();function qht(r){let{address:e}=r.nodeAddress();return kht(e)}eme.exports=qht});var _P=y((i9t,ime)=>{f();"use strict";var rme=tme();function Nht(r,e){let t=rme(r.multiaddr),i=rme(e.multiaddr);return t&&!i?1:!t&&i||r.isCertified&&!e.isCertified?-1:!r.isCertified&&e.isCertified?1:0}function Dht(r){return[...r].sort(Nht)}ime.exports.publicAddressesFirst=Dht});var sme=y((n9t,EP)=>{f();"use strict";var nme=async r=>{try{let e=await r;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}};EP.exports=nme;EP.exports.default=nme});var ame=y((s9t,SP)=>{f();"use strict";var ome=(r,...e)=>new Promise(t=>{t(r(...e))});SP.exports=ome;SP.exports.default=ome});var ume=y((o9t,xP)=>{f();"use strict";var Bht=ame(),cme=r=>{if(!((Number.isInteger(r)||r===1/0)&&r>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));let e=[],t=0,i=()=>{t--,e.length>0&&e.shift()()},n=(a,c,...u)=>{t++;let l=Bht(a,...u);c(l),l.then(i,i)},s=(a,c,...u)=>{t<r?n(a,c,...u):e.push(n.bind(null,a,c,...u))},o=(a,...c)=>new Promise(u=>s(a,u,...c));return Object.defineProperties(o,{activeCount:{get:()=>t},pendingCount:{get:()=>e.length},clearQueue:{value:()=>{e.length=0}}}),o};xP.exports=cme;xP.exports.default=cme});var fme=y((a9t,lme)=>{f();"use strict";var AP=sme(),Mht=ume();lme.exports=async(r,e={})=>{let{concurrency:t=1/0}=e,i=Mht(t);return Promise.all(r.map(n=>n&&typeof n.then=="function"?AP(n):typeof n=="function"?AP(i(()=>n())):AP(Promise.resolve(n))))}});var hme=y((c9t,dme)=>{f();"use strict";function Lht(r,e){return r.length===e.length&&e.sort()&&r.sort().every((t,i)=>e[i].equals(t))}dme.exports=Lht});var gme=y((u9t,yme)=>{f();"use strict";var Bd=ki(),zS=Bd.Reader,pme=Bd.Writer,$r=Bd.util,uo=Bd.roots["libp2p-peer-record"]||(Bd.roots["libp2p-peer-record"]={});uo.PeerRecord=function(){function r(e){if(this.addresses=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.peerId=$r.newBuffer([]),r.prototype.seq=$r.Long?$r.Long.fromBits(0,0,!0):0,r.prototype.addresses=$r.emptyArray,r.encode=function(t,i){if(i||(i=pme.create()),t.peerId!=null&&Object.hasOwnProperty.call(t,"peerId")&&i.uint32(10).bytes(t.peerId),t.seq!=null&&Object.hasOwnProperty.call(t,"seq")&&i.uint32(16).uint64(t.seq),t.addresses!=null&&t.addresses.length)for(var n=0;n<t.addresses.length;++n)uo.PeerRecord.AddressInfo.encode(t.addresses[n],i.uint32(26).fork()).ldelim();return i},r.decode=function(t,i){t instanceof zS||(t=zS.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new uo.PeerRecord;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.peerId=t.bytes();break;case 2:s.seq=t.uint64();break;case 3:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(uo.PeerRecord.AddressInfo.decode(t,t.uint32()));break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof uo.PeerRecord)return t;var i=new uo.PeerRecord;if(t.peerId!=null&&(typeof t.peerId=="string"?$r.base64.decode(t.peerId,i.peerId=$r.newBuffer($r.base64.length(t.peerId)),0):t.peerId.length&&(i.peerId=t.peerId)),t.seq!=null&&($r.Long?(i.seq=$r.Long.fromValue(t.seq)).unsigned=!0:typeof t.seq=="string"?i.seq=parseInt(t.seq,10):typeof t.seq=="number"?i.seq=t.seq:typeof t.seq=="object"&&(i.seq=new $r.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0))),t.addresses){if(!Array.isArray(t.addresses))throw TypeError(".PeerRecord.addresses: array expected");i.addresses=[];for(var n=0;n<t.addresses.length;++n){if(typeof t.addresses[n]!="object")throw TypeError(".PeerRecord.addresses: object expected");i.addresses[n]=uo.PeerRecord.AddressInfo.fromObject(t.addresses[n])}}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addresses=[]),i.defaults)if(i.bytes===String?n.peerId="":(n.peerId=[],i.bytes!==Array&&(n.peerId=$r.newBuffer(n.peerId))),$r.Long){var s=new $r.Long(0,0,!0);n.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else n.seq=i.longs===String?"0":0;if(t.peerId!=null&&t.hasOwnProperty("peerId")&&(n.peerId=i.bytes===String?$r.base64.encode(t.peerId,0,t.peerId.length):i.bytes===Array?Array.prototype.slice.call(t.peerId):t.peerId),t.seq!=null&&t.hasOwnProperty("seq")&&(typeof t.seq=="number"?n.seq=i.longs===String?String(t.seq):t.seq:n.seq=i.longs===String?$r.Long.prototype.toString.call(t.seq):i.longs===Number?new $r.LongBits(t.seq.low>>>0,t.seq.high>>>0).toNumber(!0):t.seq),t.addresses&&t.addresses.length){n.addresses=[];for(var o=0;o<t.addresses.length;++o)n.addresses[o]=uo.PeerRecord.AddressInfo.toObject(t.addresses[o],i)}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Bd.util.toJSONOptions)},r.AddressInfo=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=$r.newBuffer([]),e.encode=function(i,n){return n||(n=pme.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),n},e.decode=function(i,n){i instanceof zS||(i=zS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new uo.PeerRecord.AddressInfo;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof uo.PeerRecord.AddressInfo)return i;var n=new uo.PeerRecord.AddressInfo;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?$r.base64.decode(i.multiaddr,n.multiaddr=$r.newBuffer($r.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=$r.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?$r.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Bd.util.toJSONOptions)},e}(),r}();yme.exports=uo});var bme=y((l9t,mme)=>{f();"use strict";var Uht="libp2p-peer-record",Fht=Uint8Array.from([3,1]);mme.exports={ENVELOPE_DOMAIN_PEER_RECORD:Uht,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:Fht}});var HS=y((f9t,_me)=>{f();"use strict";var{Multiaddr:Kht}=it(),jht=rt(),Vht=hme(),{PeerRecord:vme}=gme(),{ENVELOPE_DOMAIN_PEER_RECORD:wme,ENVELOPE_PAYLOAD_TYPE_PEER_RECORD:zht}=bme(),Md=class{constructor({peerId:e,multiaddrs:t=[],seqNumber:i=Date.now()}){this.domain=wme,this.codec=zht,this.peerId=e,this.multiaddrs=t,this.seqNumber=i,this._marshal=void 0}marshal(){return this._marshal?this._marshal:(this._marshal=vme.encode({peerId:this.peerId.toBytes(),seq:this.seqNumber,addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))}).finish(),this._marshal)}equals(e){return!(!(e instanceof Md)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!Vht(this.multiaddrs,e.multiaddrs))}};Md.createFromProtobuf=r=>{let e=vme.decode(r),t=jht.createFromBytes(e.peerId),i=(e.addresses||[]).map(s=>new Kht(s.multiaddr)),n=Number(e.seq);return new Md({peerId:t,multiaddrs:i,seqNumber:n})};Md.DOMAIN=wme;_me.exports=Md});var IP=y((d9t,Eme)=>{f();"use strict";var Hht=Yb(),$ht=HS();async function Ght(r){let e=new $ht({peerId:r.peerId,multiaddrs:r.multiaddrs}),t=await Hht.seal(e,r.peerId);r.peerStore.addressBook.consumePeerRecord(t)}Eme.exports.updateSelfPeerRecord=Ght});var RP=y((h9t,Ame)=>{f();"use strict";var Sme=be(),Ld=Object.assign(Sme("libp2p:transports"),{error:Sme("libp2p:transports:err")}),Wht=fme(),{codes:L0}=yi(),t1=ae(),{updateSelfPeerRecord:xme}=IP(),TP=class{constructor({libp2p:e,upgrader:t,faultTolerance:i=$S.FATAL_ALL}){this.libp2p=e,this.upgrader=t,this._transports=new Map,this._listeners=new Map,this._listenerOptions=new Map,this.faultTolerance=i}add(e,t,i={}){if(Ld("adding %s",e),!e)throw t1(new Error(`Transport must have a valid key, was given '${e}'`),L0.ERR_INVALID_KEY);if(this._transports.has(e))throw t1(new Error("There is already a transport with this key"),L0.ERR_DUPLICATE_TRANSPORT);let n=new t({...i,libp2p:this.libp2p,upgrader:this.upgrader});this._transports.set(e,n),this._listenerOptions.set(e,i.listenerOptions||{}),this._listeners.has(e)||this._listeners.set(e,[])}async close(){let e=[];for(let[t,i]of this._listeners)for(Ld("closing listeners for %s",t);i.length;){let n=i.pop();n.removeAllListeners("listening"),n.removeAllListeners("close"),e.push(n.close())}await Promise.all(e),Ld("all listeners closed");for(let t of this._listeners.keys())this._listeners.set(t,[])}async dial(e,t){let i=this.transportForMultiaddr(e);if(!i)throw t1(new Error(`No transport available for address ${String(e)}`),L0.ERR_TRANSPORT_UNAVAILABLE);try{return await i.dial(e,t)}catch(n){throw n.code||(n.code=L0.ERR_TRANSPORT_DIAL_FAILED),n}}getAddrs(){let e=[];for(let t of this._listeners.values())for(let i of t)e=[...e,...i.getAddrs()];return e}getTransports(){return this._transports.values()}transportForMultiaddr(e){for(let t of this._transports.values())if(t.filter([e]).length)return t;return null}async listen(e){if(!e||e.length===0){Ld("no addresses were provided for listening, this node is dial only");return}let t=[];for(let[i,n]of this._transports.entries()){let s=n.filter(e),o=[];for(let u of s){Ld("creating listener for %s on %s",i,u);let l=n.createListener(this._listenerOptions.get(i));this._listeners.get(i).push(l),l.on("listening",()=>xme(this.libp2p)),l.on("close",()=>xme(this.libp2p)),o.push(l.listen(u))}if(o.length===0){t.push(i);continue}if(!(await Wht(o)).find(u=>u.isFulfilled===!0)&&this.faultTolerance!==$S.NO_FATAL)throw t1(new Error(`Transport (${i}) could not listen on any available address`),L0.ERR_NO_VALID_ADDRESSES)}if(t.length===this._transports.size){let i=`no valid addresses were provided for transports [${t}]`;if(this.faultTolerance===$S.FATAL_ALL)throw t1(new Error(i),L0.ERR_NO_VALID_ADDRESSES);Ld(`libp2p in dial mode only: ${i}`)}}async remove(e){if(Ld("removing %s",e),this._listeners.has(e))for(let t of this._listeners.get(e))t.removeAllListeners("listening"),t.removeAllListeners("close"),await t.close();this._transports.delete(e),this._listeners.delete(e)}async removeAll(){let e=[];for(let t of this._transports.keys())e.push(this.remove(t));await Promise.all(e)}},$S={FATAL_ALL:0,NO_FATAL:1};TP.FaultTolerance=$S;Ame.exports=TP});var Rme=y((p9t,Tme)=>{f();"use strict";var Yht=gr(),{dnsaddrResolver:Xht}=Hge(),CP=jS(),{AGENT_VERSION:Qht}=vP(),Ime=VS(),{publicAddressesFirst:Zht}=_P(),{FaultTolerance:Jht}=RP(),ept={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:r=>r},connectionManager:{minConnections:25},transportManager:{faultTolerance:Jht.FATAL_ALL},dialer:{maxParallelDials:CP.MAX_PARALLEL_DIALS,maxDialsPerPeer:CP.MAX_PER_PEER_DIALS,dialTimeout:CP.DIAL_TIMEOUT,resolvers:{dnsaddr:Xht},addressSorter:Zht},host:{agentVersion:Qht},metrics:{enabled:!1},peerStore:{persistence:!1,threshold:5},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},config:{protocolPrefix:"ipfs",dht:{enabled:!1,kBucketSize:20,randomWalk:{enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0,gateway:null,externalIp:null,pmp:{enabled:!1}},peerDiscovery:{autoDial:!0},pubsub:{enabled:!0},relay:{enabled:!0,advertise:{bootDelay:Ime.ADVERTISE_BOOT_DELAY,enabled:!1,ttl:Ime.ADVERTISE_TTL},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},transport:{}}};Tme.exports.validate=r=>{let e=Yht(ept,r);if(e.modules.transport.length<1)throw new Error("'options.modules.transport' must contain at least 1 transport");return e}});var Ome=y((y9t,Pme)=>{f();"use strict";var{EventEmitter:tpt}=yr(),{Multiaddr:r1}=it(),rpt=rt(),Cme=class extends tpt{constructor(e,{listen:t=[],announce:i=[]}={}){super();this.peerId=e,this.listen=new Set(t.map(n=>n.toString())),this.announce=new Set(i.map(n=>n.toString())),this.observed=new Set}getListenAddrs(){return Array.from(this.listen).map(e=>new r1(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new r1(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new r1(e))}addObservedAddr(e){let t=new r1(e),i=t.getPeerId();i&&rpt.createFromB58String(i).equals(this.peerId)&&(t=t.decapsulate(new r1(`/p2p/${this.peerId}`)));let n=t.toString();this.observed.has(n)||(this.observed.add(n),this.emit("change:addresses"))}};Pme.exports=Cme});var Nme=y((g9t,qme)=>{f();"use strict";var{EventEmitter:ipt}=yr(),PP=be()("latency-monitor:VisibilityChangeEmitter"),kme=class extends ipt{constructor(){super();if(typeof document=="undefined"){PP('This is not a browser, no "document" found. Stopping.');return}this._initializeVisibilityVarNames(),this._addVisibilityChangeListener()}_initializeVisibilityVarNames(){let e,t;typeof document.hidden!="undefined"?(e="hidden",t="visibilitychange"):typeof document.mozHidden!="undefined"?(e="mozHidden",t="mozvisibilitychange"):typeof document.msHidden!="undefined"?(e="msHidden",t="msvisibilitychange"):typeof document.webkitHidden!="undefined"&&(e="webkitHidden",t="webkitvisibilitychange"),this._hidden=e,this._visibilityChange=t}_addVisibilityChangeListener(){typeof document.addEventListener=="undefined"||typeof document[this._hidden]=="undefined"?PP("Checking page visibility requires a browser that supports the Page Visibility API."):document.addEventListener(this._visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this._hidden===void 0||document[this._hidden]===void 0))return!document[this._hidden]}_handleVisibilityChange(){let e=!document[this._hidden];PP(e?"Page Visible":"Page Hidden"),this.emit("visibilityChange",e)}};qme.exports=kme});var Mme=y((m9t,Bme)=>{f();"use strict";var{EventEmitter:npt}=yr(),spt=Nme(),vu=be()("latency-monitor:LatencyMonitor"),Dme=class extends npt{constructor({latencyCheckIntervalMs:e,dataEmitIntervalMs:t,asyncTestFn:i,latencyRandomPercentage:n}={}){super();let s=this;s.latencyCheckIntervalMs=e||500,s.latencyRandomPercentage=n||10,s._latecyCheckMultiply=2*(s.latencyRandomPercentage/100)*s.latencyCheckIntervalMs,s._latecyCheckSubtract=s._latecyCheckMultiply/2,s.dataEmitIntervalMs=t===null||t===0?void 0:t||5*1e3,vu("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",s.latencyCheckIntervalMs,s.dataEmitIntervalMs),s.dataEmitIntervalMs?vu("Expecting ~%s events per summary",s.latencyCheckIntervalMs/s.dataEmitIntervalMs):vu("Not emitting summaries"),s.asyncTestFn=i}start(){globalThis.process&&globalThis.process.hrtime?(vu("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=e=>{let t=this.now(e);return t[0]*1e3+t[1]/1e6}):typeof window!="undefined"&&window.performance&&window.performance.now?(vu("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=e=>Math.round(this.now()-e)):(vu("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=e=>this.now()-e),this._latencyData=this._initLatencyData(),opt()&&(this._visibilityChangeEmitter=new spt,this._visibilityChangeEmitter.on("visibilityChange",e=>{e?this._startTimers():(this._emitSummary(),this._stopTimers())})),(!this._visibilityChangeEmitter||this._visibilityChangeEmitter.isVisible())&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this._checkLatencyID||(this._checkLatency(),this.dataEmitIntervalMs&&(this._emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this._emitIntervalID.unref=="function"&&this._emitIntervalID.unref()))}_stopTimers(){this._checkLatencyID&&(clearTimeout(this._checkLatencyID),this._checkLatencyID=void 0),this._emitIntervalID&&(clearInterval(this._emitIntervalID),this._emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.emit("data",e)}getSummary(){let e={events:this._latencyData.events,minMs:this._latencyData.minMs,maxMs:this._latencyData.maxMs,avgMs:this._latencyData.events?this._latencyData.totalMs/this._latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this._latencyData.startTime)};return this._latencyData=this._initLatencyData(),vu("Summary: %O",e),e}_checkLatency(){let e=this,t=Math.random()*e._latecyCheckMultiply-e._latecyCheckSubtract,i={deltaOffset:Math.ceil(e.latencyCheckIntervalMs+t),startTime:e.now()},n=()=>{if(!this._checkLatencyID)return;let s=e.getDeltaMS(i.startTime)-i.deltaOffset;e._checkLatency(),e._latencyData.events++,e._latencyData.minMs=Math.min(e._latencyData.minMs,s),e._latencyData.maxMs=Math.max(e._latencyData.maxMs,s),e._latencyData.totalMs+=s,vu("MS: %s Data: %O",s,e._latencyData)};vu("localData: %O",i),this._checkLatencyID=setTimeout(()=>{e.asyncTestFn?(i.deltaOffset=0,i.startTime=e.now(),e.asyncTestFn(n)):(i.deltaOffset-=1,n())},i.deltaOffset),typeof this._checkLatencyID.unref=="function"&&this._checkLatencyID.unref()}_initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function opt(){return typeof window!="undefined"}Bme.exports=Dme});var Ume=y((b9t,Lme)=>{f();"use strict";Lme.exports=function(){return Date.now()}});var OP=y((v9t,Kme)=>{f();"use strict";var GS=Ume(),Fme=class{constructor(e,t,i){let n=this;this._started=GS(),this._rescheduled=0,this._scheduled=t,this._args=i,this._triggered=!1,this._timerWrapper=()=>{n._rescheduled>0?(n._scheduled=n._rescheduled-(GS()-n._started),n._schedule(n._scheduled)):(n._triggered=!0,e.apply(null,n._args))},this._timer=setTimeout(this._timerWrapper,t)}reschedule(e){e||(e=this._scheduled);let t=GS();t+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=t,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=GS(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function apt(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let r;if(arguments.length>0){r=new Array(arguments.length-2);for(var e=0;e<r.length;e++)r[e]=arguments[e+2]}return new Fme(arguments[0],arguments[1],r)}Kme.exports=apt});var Gme=y((w9t,$me)=>{f();"use strict";var jme=be(),ca=Object.assign(jme("libp2p:connection-manager"),{error:jme("libp2p:connection-manager:err")}),Vme=ae(),cpt=gr(),upt=Mme(),WS=OP(),{EventEmitter:lpt}=yr(),fpt=rt(),{codes:{ERR_INVALID_PARAMETERS:zme}}=yi(),dpt={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:1},Hme=class extends lpt{constructor(e,t={}){super();if(this._libp2p=e,this._peerId=e.peerId.toB58String(),this._options=cpt.call({ignoreUndefined:!0},dpt,t),this._options.maxConnections<this._options.minConnections)throw Vme(new Error("Connection Manager maxConnections must be greater than minConnections"),zme);ca("options: %j",this._options),this._peerValues=new Map,this.connections=new Map,this._started=!1,this._timer=null,this._autoDialTimeout=null,this._checkMetrics=this._checkMetrics.bind(this),this._autoDial=this._autoDial.bind(this),this._latencyMonitor=new upt({latencyCheckIntervalMs:this._options.pollInterval,dataEmitIntervalMs:this._options.pollInterval})}get size(){return Array.from(this.connections.values()).reduce((e,t)=>e+t.length,0)}start(){this._libp2p.metrics&&(this._timer=this._timer||WS(this._checkMetrics,this._options.pollInterval)),this._latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this._latencyMonitor.on("data",this._onLatencyMeasure),this._started=!0,ca("started"),this._options.autoDial&&this._autoDial()}async stop(){this._autoDialTimeout&&this._autoDialTimeout.clear(),this._timer&&this._timer.clear(),this._latencyMonitor.removeListener("data",this._onLatencyMeasure),this._latencyMonitor.stop(),this._started=!1,await this._close(),ca("stopped")}async _close(){let e=[];for(let t of this.connections.values())for(let i of t)e.push(i.close());await Promise.all(e),this.connections.clear()}setPeerValue(e,t){if(t<0||t>1)throw new Error("value should be a number between 0 and 1");this._peerValues.set(e.toB58String(),t)}_checkMetrics(){if(this._libp2p.metrics){let e=this._libp2p.metrics.global.movingAverages,t=e.dataReceived[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxReceivedData",t);let i=e.dataSent[this._options.movingAverageInterval].movingAverage();this._checkMaxLimit("maxSentData",i);let n=t+i;this._checkMaxLimit("maxData",n),ca("metrics update",n),this._timer=WS(this._checkMetrics,this._options.pollInterval)}}onConnect(e){let t=e.remotePeer,i=t.toB58String(),n=this.connections.get(i);this.emit("peer:connect",e),n?n.push(e):this.connections.set(i,[e]),this._libp2p.peerStore.keyBook.set(t,t.pubKey),this._peerValues.has(i)||this._peerValues.set(i,this._options.defaultPeerValue),this._checkMaxLimit("maxConnections",this.size)}onDisconnect(e){let t=e.remotePeer.toB58String(),i=this.connections.get(t);i&&i.length>1?(i=i.filter(n=>n.id!==e.id),this.connections.set(t,i)):i&&(this.connections.delete(t),this._peerValues.delete(e.remotePeer.toB58String()),this.emit("peer:disconnect",e))}get(e){let t=this.getAll(e);return t.length?t[0]:null}getAll(e){if(!fpt.isPeerId(e))throw Vme(new Error("peerId must be an instance of peer-id"),zme);let t=e.toB58String(),i=this.connections.get(t);return i?i.filter(n=>n.stat.status==="open"):[]}_onLatencyMeasure(e){this._checkMaxLimit("maxEventLoopDelay",e.avgMs)}_checkMaxLimit(e,t){let i=this._options[e];ca("checking limit of %s. current value: %d of %d",e,t,i),t>i&&(ca("%s: limit exceeded: %s, %d",this._peerId,e,t),this._maybeDisconnectOne())}async _autoDial(){let e=this._options.minConnections;if(this.size>=e){this._autoDialTimeout=WS(this._autoDial,this._options.autoDialInterval);return}let t=Array.from(this._libp2p.peerStore.peers.values()).sort((i,n)=>n.protocols&&n.protocols.length&&(!i.protocols||!i.protocols.length)||n.id.pubKey&&!i.id.pubKey?1:-1);for(let i=0;i<t.length&&this.size<e;i++)if(!this.get(t[i].id)){ca("connecting to a peerStore stored peer %s",t[i].id.toB58String());try{if(await this._libp2p.dialer.connectToPeer(t[i].id),!this._started)return}catch(n){ca.error("could not connect to peerStore stored peer",n)}}this._autoDialTimeout=WS(this._autoDial,this._options.autoDialInterval)}_maybeDisconnectOne(){if(this._options.minConnections<this.connections.size){let e=Array.from(new Map([...this._peerValues.entries()].sort((i,n)=>i[1]-n[1])));ca("%s: sorted peer values: %j",this._peerId,e);let t=e[0];if(t){let i=t[0];ca("%s: lowest value peer is %s",this._peerId,i),ca("%s: closing a connection to %j",this._peerId,i);for(let n of this.connections.values())if(n[0].remotePeer.toB58String()===i){n[0].close();break}}}}};$me.exports=Hme});var U0=y((_9t,Yme)=>{f();"use strict";var Ud=ki(),YS=Ud.Reader,Wme=Ud.Writer,lo=Ud.util,Vi=Ud.roots["libp2p-circuit"]||(Ud.roots["libp2p-circuit"]={});Vi.CircuitRelay=function(){function r(e){if(e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.type=1,r.prototype.srcPeer=null,r.prototype.dstPeer=null,r.prototype.code=100,r.encode=function(t,i){return i||(i=Wme.create()),t.type!=null&&Object.hasOwnProperty.call(t,"type")&&i.uint32(8).int32(t.type),t.srcPeer!=null&&Object.hasOwnProperty.call(t,"srcPeer")&&Vi.CircuitRelay.Peer.encode(t.srcPeer,i.uint32(18).fork()).ldelim(),t.dstPeer!=null&&Object.hasOwnProperty.call(t,"dstPeer")&&Vi.CircuitRelay.Peer.encode(t.dstPeer,i.uint32(26).fork()).ldelim(),t.code!=null&&Object.hasOwnProperty.call(t,"code")&&i.uint32(32).int32(t.code),i},r.decode=function(t,i){t instanceof YS||(t=YS.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Vi.CircuitRelay;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.type=t.int32();break;case 2:s.srcPeer=Vi.CircuitRelay.Peer.decode(t,t.uint32());break;case 3:s.dstPeer=Vi.CircuitRelay.Peer.decode(t,t.uint32());break;case 4:s.code=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Vi.CircuitRelay)return t;var i=new Vi.CircuitRelay;switch(t.type){case"HOP":case 1:i.type=1;break;case"STOP":case 2:i.type=2;break;case"STATUS":case 3:i.type=3;break;case"CAN_HOP":case 4:i.type=4;break}if(t.srcPeer!=null){if(typeof t.srcPeer!="object")throw TypeError(".CircuitRelay.srcPeer: object expected");i.srcPeer=Vi.CircuitRelay.Peer.fromObject(t.srcPeer)}if(t.dstPeer!=null){if(typeof t.dstPeer!="object")throw TypeError(".CircuitRelay.dstPeer: object expected");i.dstPeer=Vi.CircuitRelay.Peer.fromObject(t.dstPeer)}switch(t.code){case"SUCCESS":case 100:i.code=100;break;case"HOP_SRC_ADDR_TOO_LONG":case 220:i.code=220;break;case"HOP_DST_ADDR_TOO_LONG":case 221:i.code=221;break;case"HOP_SRC_MULTIADDR_INVALID":case 250:i.code=250;break;case"HOP_DST_MULTIADDR_INVALID":case 251:i.code=251;break;case"HOP_NO_CONN_TO_DST":case 260:i.code=260;break;case"HOP_CANT_DIAL_DST":case 261:i.code=261;break;case"HOP_CANT_OPEN_DST_STREAM":case 262:i.code=262;break;case"HOP_CANT_SPEAK_RELAY":case 270:i.code=270;break;case"HOP_CANT_RELAY_TO_SELF":case 280:i.code=280;break;case"STOP_SRC_ADDR_TOO_LONG":case 320:i.code=320;break;case"STOP_DST_ADDR_TOO_LONG":case 321:i.code=321;break;case"STOP_SRC_MULTIADDR_INVALID":case 350:i.code=350;break;case"STOP_DST_MULTIADDR_INVALID":case 351:i.code=351;break;case"STOP_RELAY_REFUSED":case 390:i.code=390;break;case"MALFORMED_MESSAGE":case 400:i.code=400;break}return i},r.toObject=function(t,i){i||(i={});var n={};return i.defaults&&(n.type=i.enums===String?"HOP":1,n.srcPeer=null,n.dstPeer=null,n.code=i.enums===String?"SUCCESS":100),t.type!=null&&t.hasOwnProperty("type")&&(n.type=i.enums===String?Vi.CircuitRelay.Type[t.type]:t.type),t.srcPeer!=null&&t.hasOwnProperty("srcPeer")&&(n.srcPeer=Vi.CircuitRelay.Peer.toObject(t.srcPeer,i)),t.dstPeer!=null&&t.hasOwnProperty("dstPeer")&&(n.dstPeer=Vi.CircuitRelay.Peer.toObject(t.dstPeer,i)),t.code!=null&&t.hasOwnProperty("code")&&(n.code=i.enums===String?Vi.CircuitRelay.Status[t.code]:t.code),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ud.util.toJSONOptions)},r.Status=function(){var e={},t=Object.create(e);return t[e[100]="SUCCESS"]=100,t[e[220]="HOP_SRC_ADDR_TOO_LONG"]=220,t[e[221]="HOP_DST_ADDR_TOO_LONG"]=221,t[e[250]="HOP_SRC_MULTIADDR_INVALID"]=250,t[e[251]="HOP_DST_MULTIADDR_INVALID"]=251,t[e[260]="HOP_NO_CONN_TO_DST"]=260,t[e[261]="HOP_CANT_DIAL_DST"]=261,t[e[262]="HOP_CANT_OPEN_DST_STREAM"]=262,t[e[270]="HOP_CANT_SPEAK_RELAY"]=270,t[e[280]="HOP_CANT_RELAY_TO_SELF"]=280,t[e[320]="STOP_SRC_ADDR_TOO_LONG"]=320,t[e[321]="STOP_DST_ADDR_TOO_LONG"]=321,t[e[350]="STOP_SRC_MULTIADDR_INVALID"]=350,t[e[351]="STOP_DST_MULTIADDR_INVALID"]=351,t[e[390]="STOP_RELAY_REFUSED"]=390,t[e[400]="MALFORMED_MESSAGE"]=400,t}(),r.Type=function(){var e={},t=Object.create(e);return t[e[1]="HOP"]=1,t[e[2]="STOP"]=2,t[e[3]="STATUS"]=3,t[e[4]="CAN_HOP"]=4,t}(),r.Peer=function(){function e(t){if(this.addrs=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.id=lo.newBuffer([]),e.prototype.addrs=lo.emptyArray,e.encode=function(i,n){if(n||(n=Wme.create()),n.uint32(10).bytes(i.id),i.addrs!=null&&i.addrs.length)for(var s=0;s<i.addrs.length;++s)n.uint32(18).bytes(i.addrs[s]);return n},e.decode=function(i,n){i instanceof YS||(i=YS.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Vi.CircuitRelay.Peer;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.id=i.bytes();break;case 2:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(i.bytes());break;default:i.skipType(a&7);break}}if(!o.hasOwnProperty("id"))throw lo.ProtocolError("missing required 'id'",{instance:o});return o},e.fromObject=function(i){if(i instanceof Vi.CircuitRelay.Peer)return i;var n=new Vi.CircuitRelay.Peer;if(i.id!=null&&(typeof i.id=="string"?lo.base64.decode(i.id,n.id=lo.newBuffer(lo.base64.length(i.id)),0):i.id.length&&(n.id=i.id)),i.addrs){if(!Array.isArray(i.addrs))throw TypeError(".CircuitRelay.Peer.addrs: array expected");n.addrs=[];for(var s=0;s<i.addrs.length;++s)typeof i.addrs[s]=="string"?lo.base64.decode(i.addrs[s],n.addrs[s]=lo.newBuffer(lo.base64.length(i.addrs[s])),0):i.addrs[s].length&&(n.addrs[s]=i.addrs[s])}return n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.addrs=[]),n.defaults&&(n.bytes===String?s.id="":(s.id=[],n.bytes!==Array&&(s.id=lo.newBuffer(s.id)))),i.id!=null&&i.hasOwnProperty("id")&&(s.id=n.bytes===String?lo.base64.encode(i.id,0,i.id.length):n.bytes===Array?Array.prototype.slice.call(i.id):i.id),i.addrs&&i.addrs.length){s.addrs=[];for(var o=0;o<i.addrs.length;++o)s.addrs[o]=n.bytes===String?lo.base64.encode(i.addrs[o],0,i.addrs[o].length):n.bytes===Array?Array.prototype.slice.call(i.addrs[o]):i.addrs[o]}return s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ud.util.toJSONOptions)},e}(),r}();Yme.exports=Vi});var Zme=y((E9t,Qme)=>{f();"use strict";var{source:Xme}=fc(),hpt=be(),ppt=hpt("libp2p:stream:converter");function ypt({stream:r,remoteAddr:e,localAddr:t},i={}){let{sink:n,source:s}=r,o={async sink(c){i.signal&&(c=Xme(c,i.signal));try{await n(c)}catch(u){u.type!=="aborted"&&ppt(u)}a()},source:i.signal?Xme(s,i.signal):s,conn:r,localAddr:t,remoteAddr:e,timeline:{open:Date.now(),close:void 0},close(){return n(new Uint8Array(0)),a()}};function a(){return o.timeline.close||(o.timeline.close=Date.now()),Promise.resolve()}return o}Qme.exports=ypt});var i1=y((S9t,Jme)=>{f();"use strict";Jme.exports={relay:"/libp2p/circuit/relay/0.1.0"}});var tbe=y((x9t,ebe)=>{f();"use strict";var{EventEmitter:gpt}=yr(),{Multiaddr:mpt}=it();ebe.exports=r=>{let e=new Map;async function t(s){let o=String(s).split("/p2p-circuit").find(u=>u!==""),a=await r.dial(new mpt(o)),c=a.remoteAddr.encapsulate("/p2p-circuit");e.set(a.remotePeer.toB58String(),c),n.emit("listening")}function i(){let s=[];for(let o of e.values())s.push(o);return s}let n=Object.assign(new gpt,{close:()=>Promise.resolve(),listen:t,getAddrs:i});return r.connectionManager.on("peer:disconnect",s=>{e.delete(s.remotePeer.toB58String())&&n.emit("close")}),n}});var kP=y((A9t,nbe)=>{f();"use strict";var{Multiaddr:rbe}=it(),{CircuitRelay:Fd}=U0();function ibe(r,e){r.write({type:Fd.Type.STATUS,code:e})}function bpt(r,e){try{r.dstPeer&&r.dstPeer.addrs&&r.dstPeer.addrs.forEach(t=>new rbe(t))}catch(t){throw ibe(e,r.type===Fd.Type.HOP?Fd.Status.HOP_DST_MULTIADDR_INVALID:Fd.Status.STOP_DST_MULTIADDR_INVALID),t}try{r.srcPeer&&r.srcPeer.addrs&&r.srcPeer.addrs.forEach(t=>new rbe(t))}catch(t){throw ibe(e,r.type===Fd.Type.HOP?Fd.Status.HOP_SRC_MULTIADDR_INVALID:Fd.Status.STOP_SRC_MULTIADDR_INVALID),t}}nbe.exports={validateAddrs:bpt}});var F0=y((I9t,sbe)=>{f();"use strict";var vpt=I2(),wpt=Qa(),_pt=ml();sbe.exports=r=>{let e=wpt(),t=vpt(r.source),i=_pt(),n,s=r.sink(async function*(){yield*e,yield*await i.promise}());return s.catch(a=>{n=a}),{reader:t,writer:e,stream:{sink:a=>n?Promise.reject(n):(i.resolve(a),s),source:t},rest:()=>e.end(),write:e.push,read:async()=>(await t.next()).value}}});var QS=y((T9t,lbe)=>{f();"use strict";var obe=be(),XS=Object.assign(obe("libp2p:circuit:stream-handler"),{error:obe("libp2p:circuit:stream-handler:err")}),abe=ia(),Ept=F0(),{CircuitRelay:cbe}=U0(),ube=class{constructor({stream:e,maxLength:t=4096}){this.stream=e,this.shake=Ept(this.stream),this.decoder=abe.decode.fromReader(this.shake.reader,{maxDataLength:t})}async read(){let e=await this.decoder.next();if(e.value){let t=cbe.decode(e.value.slice());return XS("read message type",t.type),t}XS("read received no value, closing stream"),this.close()}write(e){XS("write message type %s",e.type),this.shake.write(abe.encode.single(cbe.encode(e).finish()))}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){XS("closing the stream"),this.rest().sink([])}};lbe.exports=ube});var DP=y((R9t,NP)=>{f();"use strict";var fbe=be(),n1=Object.assign(fbe("libp2p:circuit:stop"),{error:fbe("libp2p:circuit:stop:err")}),{CircuitRelay:qP}=U0(),Spt=i1(),xpt=QS(),{validateAddrs:Apt}=kP();NP.exports.handleStop=function({connection:e,request:t,streamHandler:i}){try{Apt(t,i)}catch(n){return n1.error("invalid stop request via peer %s",e.remotePeer.toB58String(),n)}return n1("stop request is valid"),i.write({type:qP.Type.STATUS,code:qP.Status.SUCCESS}),i.rest()};NP.exports.stop=async function({connection:e,request:t}){let{stream:i}=await e.newStream([Spt.relay]);n1("starting stop request to %s",e.remotePeer.toB58String());let n=new xpt({stream:i});n.write(t);let s=await n.read();if(!s)return n.close();if(s.code===qP.Status.SUCCESS)return n1("stop request to %s was successful",e.remotePeer.toB58String()),n.rest();n1("stop request failed with code %d",s.code),n.close()}});var BP=y((C9t,mbe)=>{f();"use strict";var dbe=be(),wu=Object.assign(dbe("libp2p:circuit:hop"),{error:dbe("libp2p:circuit:hop:err")}),hbe=ae(),Ipt=rt(),{validateAddrs:Tpt}=kP(),pbe=QS(),{CircuitRelay:Is}=U0(),{pipe:Rpt}=Ar(),{codes:ybe}=yi(),{stop:Cpt}=DP(),gbe=i1();async function Ppt({connection:r,request:e,streamHandler:t,circuit:i}){if(!i._options.hop.enabled)return wu("HOP request received but we are not acting as a relay"),t.end({type:Is.Type.STATUS,code:Is.Status.HOP_CANT_SPEAK_RELAY});try{Tpt(e,t)}catch(u){return wu.error("invalid hop request via peer %s",r.remotePeer.toB58String(),u)}if(!e.dstPeer){wu("HOP request received but we do not receive a dstPeer");return}let n=new Ipt(e.dstPeer.id),s=i._connectionManager.get(n);if(!s&&!i._options.hop.active)return wu("HOP request received but we are not connected to the destination peer"),t.end({type:Is.Type.STATUS,code:Is.Status.HOP_NO_CONN_TO_DST});if(!s)return;let o={type:Is.Type.STOP,dstPeer:e.dstPeer,srcPeer:e.srcPeer},a;try{a=await Cpt({connection:s,request:o})}catch(u){return wu.error(u)}wu("hop request from %s is valid",r.remotePeer.toB58String()),t.write({type:Is.Type.STATUS,code:Is.Status.SUCCESS});let c=t.rest();return Rpt(c,a,c)}async function Opt({connection:r,request:e}){let{stream:t}=await r.newStream([gbe.relay]),i=new pbe({stream:t});i.write(e);let n=await i.read();if(!n)throw hbe(new Error("HOP request had no response"),ybe.ERR_HOP_REQUEST_FAILED);if(n.code===Is.Status.SUCCESS)return wu("hop request was successful"),i.rest();throw wu("hop request failed with code %d, closing stream",n.code),i.close(),hbe(new Error(`HOP request failed with code ${n.code}`),ybe.ERR_HOP_REQUEST_FAILED)}async function kpt({connection:r}){let{stream:e}=await r.newStream([gbe.relay]),t=new pbe({stream:e});t.write({type:Is.Type.CAN_HOP});let i=await t.read();return await t.close(),!(!i||i.code!==Is.Status.SUCCESS)}function qpt({connection:r,streamHandler:e,circuit:t}){let i=t._options.hop.enabled;wu("can hop (%s) request from %s",i,r.remotePeer.toB58String()),e.end({type:Is.Type.STATUS,code:i?Is.Status.SUCCESS:Is.Status.HOP_CANT_SPEAK_RELAY})}mbe.exports={handleHop:Ppt,hop:Opt,canHop:kpt,handleCanHop:qpt}});var Sbe=y((P9t,Ebe)=>{f();"use strict";var bbe=be(),_u=Object.assign(bbe("libp2p:circuit"),{error:bbe("libp2p:circuit:err")}),Npt=ae(),Dpt=Bf(),{Multiaddr:s1}=it(),vbe=rt(),{CircuitRelay:o1}=U0(),{codes:Bpt}=yi(),wbe=Zme(),{relay:Mpt}=i1(),Lpt=tbe(),{handleCanHop:Upt,handleHop:Fpt,hop:Kpt}=BP(),{handleStop:jpt}=DP(),Vpt=QS(),zpt=Symbol.for("@libp2p/js-libp2p-circuit/circuit"),_be=class{constructor({libp2p:e,upgrader:t}){this._dialer=e.dialer,this._registrar=e.registrar,this._connectionManager=e.connectionManager,this._upgrader=t,this._options=e._config.relay,this._libp2p=e,this.peerId=e.peerId,this._registrar.handle(Mpt,this._onProtocol.bind(this))}async _onProtocol({connection:e,stream:t}){let i=new Vpt({stream:t}),n=await i.read();if(!n)return;let s=this,o;switch(n.type){case o1.Type.CAN_HOP:{_u("received CAN_HOP request from %s",e.remotePeer.toB58String()),await Upt({circuit:s,connection:e,streamHandler:i});break}case o1.Type.HOP:{_u("received HOP request from %s",e.remotePeer.toB58String()),o=await Fpt({connection:e,request:n,streamHandler:i,circuit:s});break}case o1.Type.STOP:{_u("received STOP request from %s",e.remotePeer.toB58String()),o=await jpt({connection:e,request:n,streamHandler:i});break}default:_u("Request of type %s not supported",n.type)}if(o){let a=new s1(n.dstPeer.addrs[0]),c=new s1(n.srcPeer.addrs[0]),u=wbe({stream:o,remoteAddr:a,localAddr:c}),l=n.type===o1.Type.HOP?"relay":"inbound";_u("new %s connection %s",l,u.remoteAddr);let d=await this._upgrader.upgradeInbound(u);_u("%s connection %s upgraded",l,u.remoteAddr),this.handler&&this.handler(d)}}async dial(e,t){let i=e.toString().split("/p2p-circuit"),n=new s1(i[0]),s=new s1(i[i.length-1]),o=n.getPeerId(),a=s.getPeerId();if(!o||!a){let h="Circuit relay dial failed as addresses did not have peer id";throw _u.error(h),Npt(new Error(h),Bpt.ERR_RELAYED_DIAL)}let c=vbe.createFromB58String(o),u=vbe.createFromB58String(a),l=!1,d=this._connectionManager.get(c);d||(d=await this._dialer.connectToPeer(n,t),l=!0);try{let h=await Kpt({connection:d,request:{type:o1.Type.HOP,srcPeer:{id:this.peerId.toBytes(),addrs:this._libp2p.multiaddrs.map(b=>b.bytes)},dstPeer:{id:u.toBytes(),addrs:[new s1(s).bytes]}}}),p=n.encapsulate(`/p2p-circuit/p2p/${this.peerId.toB58String()}`),g=wbe({stream:h,remoteAddr:e,localAddr:p});return _u("new outbound connection %s",g.remoteAddr),this._upgrader.upgradeOutbound(g)}catch(h){throw _u.error("Circuit relay dial failed",h),l&&await d.close(),h}}createListener(e,t){return typeof e=="function"&&(t=e,e={}),this.handler=t,Lpt(this._libp2p)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>Dpt.Circuit.matches(t))}get[Symbol.toStringTag](){return"Circuit"}static isTransport(e){return Boolean(e&&e[zpt])}};Ebe.exports=_be});var MP=y((O9t,xbe)=>{f();"use strict";var{CID:Hpt}=(Ie(),De),{sha256:$pt}=(ri(),li);xbe.exports.namespaceToCid=async r=>{let e=new TextEncoder().encode(r),t=await $pt.digest(e);return Hpt.createV0(t)}});var Obe=y((k9t,Pbe)=>{f();"use strict";var Abe=be(),Ibe=Object.assign(Abe("libp2p:auto-relay"),{error:Abe("libp2p:auto-relay:err")}),{fromString:Gpt}=(ft(),ht),{toString:Wpt}=(tt(),et),{Multiaddr:Ypt}=it(),Xpt=rt(),{relay:Qpt}=i1(),{canHop:Zpt}=BP(),{namespaceToCid:Jpt}=MP(),{CIRCUIT_PROTO_CODE:e0t,HOP_METADATA_KEY:Tbe,HOP_METADATA_VALUE:Rbe,RELAY_RENDEZVOUS_NS:t0t}=VS(),Cbe=class{constructor({libp2p:e,maxListeners:t=1,onError:i}){this._libp2p=e,this._peerId=e.peerId,this._peerStore=e.peerStore,this._connectionManager=e.connectionManager,this._transportManager=e.transportManager,this._addressSorter=e.dialer.addressSorter,this.maxListeners=t,this._listenRelays=new Set,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this._peerStore.on("change:protocols",this._onProtocolChange),this._connectionManager.on("peer:disconnect",this._onPeerDisconnected),this._onError=(n,s)=>{Ibe.error(s||n),i&&i(n,s)}}async _onProtocolChange({peerId:e,protocols:t}){let i=e.toB58String(),n=t.find(s=>s===Qpt);if(!n&&this._listenRelays.has(i)){this._removeListenRelay(i);return}else if(!n||this._listenRelays.has(i))return;try{let s=this._connectionManager.get(e);if(!s)return;if(s.remoteAddr.protoCodes().includes(e0t)){Ibe(`relayed connection to ${i} will not be used to hop on`);return}await Zpt({connection:s})&&(this._peerStore.metadataBook.set(e,Tbe,Gpt(Rbe)),await this._addListenRelay(s,i))}catch(s){this._onError(s)}}_onPeerDisconnected(e){let i=e.remotePeer.toB58String();!this._listenRelays.has(i)||this._removeListenRelay(i)}async _addListenRelay(e,t){if(this._listenRelays.size>=this.maxListeners)return;let i=this._peerStore.addressBook.getMultiaddrsForPeer(e.remotePeer,this._addressSorter);if(!i||!i.length)return;let n=`${i[0].toString()}/p2p-circuit`;this._listenRelays.add(t);try{await this._transportManager.listen([new Ypt(n)])}catch(s){this._onError(s),this._listenRelays.delete(t)}}_removeListenRelay(e){this._listenRelays.delete(e)&&this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this._listenRelays.size>=this.maxListeners)return;let t=[];for(let[i,n]of this._peerStore.metadataBook.data.entries()){if(this._listenRelays.has(i)||e.includes(i))continue;let s=n.get(Tbe);if(!s||Wpt(s)!==Rbe)continue;let o=Xpt.createFromB58String(i),a=this._connectionManager.get(o);if(!a){t.push(o);continue}if(await this._addListenRelay(a,i),this._listenRelays.size>=this.maxListeners)return}for(let i of t)if(await this._tryToListenOnRelay(i),this._listenRelays.size>=this.maxListeners)return;try{let i=await Jpt(t0t);for await(let n of this._libp2p.contentRouting.findProviders(i)){if(!n.multiaddrs.length)continue;let s=n.id;if(this._peerStore.addressBook.add(s,n.multiaddrs),await this._tryToListenOnRelay(s),this._listenRelays.size>=this.maxListeners)return}}catch(i){this._onError(i)}}async _tryToListenOnRelay(e){try{let t=await this._libp2p.dial(e);await this._addListenRelay(t,e.toB58String())}catch(t){this._onError(t,`could not connect and listen on known hop relay ${e.toB58String()}`)}}};Pbe.exports=Cbe});var Bbe=y((q9t,Dbe)=>{f();"use strict";var kbe=be(),qbe=Object.assign(kbe("libp2p:relay"),{error:kbe("libp2p:relay:err")}),{setDelayedInterval:r0t,clearDelayedInterval:i0t}=pP(),n0t=Obe(),{namespaceToCid:s0t}=MP(),{RELAY_RENDEZVOUS_NS:o0t}=VS(),Nbe=class{constructor(e){this._libp2p=e,this._options={...e._config.relay},this._autoRelay=this._options.autoRelay.enabled&&new n0t({libp2p:e,...this._options.autoRelay}),this._advertiseService=this._advertiseService.bind(this)}start(){this._options.hop.enabled&&this._options.advertise.enabled&&(this._timeout=r0t(this._advertiseService,this._options.advertise.ttl,this._options.advertise.bootDelay))}stop(){i0t(this._timeout)}async _advertiseService(){try{let e=await s0t(o0t);await this._libp2p.contentRouting.provide(e)}catch(e){e.code==="NO_ROUTERS_AVAILABLE"?(qbe.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),this.stop()):qbe.error(e)}}};Dbe.exports=Nbe});var Fbe=y((D9t,Ube)=>{f();var Mbe=rT(),Lbe=ml();Ube.exports=class{constructor(){this._buffer=new Mbe,this._waitingConsumers=new Mbe}push(e){let{promise:t,resolve:i}=Lbe();return this._buffer.push({chunk:e,resolve:i}),this._consume(),t}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),t=this._buffer.shift();e.resolve(t.chunk),t.resolve()}}shift(){let{promise:e,resolve:t}=Lbe();return this._waitingConsumers.push({resolve:t}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var jbe=y((B9t,Kbe)=>{f();"use strict";Kbe.exports=(r,e=1,t)=>{if(t={indent:" ",includeEmptyLines:!1,...t},typeof r!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof r}\``);if(typeof e!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if(typeof t.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``);if(e===0)return r;let i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return r.replace(i,t.indent.repeat(e))}});var Vbe=y(()=>{f()});var Gbe=y((U9t,$be)=>{f();"use strict";var zbe=Vbe(),Hbe=/\s+at.*(?:\(|\s)(.*)\)?/,a0t=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,c0t=typeof zbe.homedir=="undefined"?"":zbe.homedir();$be.exports=(r,e)=>(e=Object.assign({pretty:!1},e),r.replace(/\\/g,"/").split(`
`).filter(t=>{let i=t.match(Hbe);if(i===null||!i[1])return!0;let n=i[1];return n.includes(".app/Contents/Resources/electron.asar")||n.includes(".app/Contents/Resources/default_app.asar")?!1:!a0t.test(n)}).filter(t=>t.trim()!=="").map(t=>e.pretty?t.replace(Hbe,(i,n)=>i.replace(n,n.replace(c0t,"~"))):t).join(`
`))});var ZS=y((F9t,Ybe)=>{f();"use strict";var u0t=jbe(),l0t=Gbe(),f0t=r=>r.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),Wbe=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?f0t(l0t(i.stack)):String(i)).join(`
`);t=`
`+u0t(t,4);super(t);this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(let e of this._errors)yield e}};Ybe.exports=Wbe});var Xbe=y((K9t,UP)=>{f();"use strict";var LP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},a1=class{static fn(e){return(...t)=>new a1((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new LP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(a1.prototype,Promise.prototype);UP.exports=a1;UP.exports.CancelError=LP});var Zbe=y((j9t,JS)=>{f();"use strict";var Qbe=ZS(),d0t=Xbe(),FP=class extends Error{},h0t=(r,e)=>new d0t((t,i,n)=>{let{count:s,filter:o=()=>!0}=e;if(!Number.isFinite(s)){i(new TypeError(`Expected a finite number, got ${typeof e.count}`));return}let a=[],c=[],u=0,l=!1,d=new Set,h=()=>(a.length===s&&(t(a),l=!0),u-c.length<s&&(i(new Qbe(c)),l=!0),l),p=()=>{for(let g of r)!d.has(g)&&typeof g.cancel=="function"&&g.cancel()};n(p);for(let g of r)u++,(async()=>{try{let b=await g;if(l)return;if(!o(b))throw new FP("Value does not satisfy filter");a.push(b)}catch(b){c.push(b)}finally{d.add(g),!l&&h()&&p()}})();s>u&&(i(new RangeError(`Expected input to contain at least ${e.count} items, but contains ${u} items`)),p())});JS.exports=h0t;JS.exports.AggregateError=Qbe;JS.exports.FilterError=FP});var Jbe=y((V9t,jP)=>{f();"use strict";var KP=class extends Error{constructor(e){super(e||"Promise was canceled");this.name="CancelError"}get isCanceled(){return!0}},c1=class{static fn(e){return(...t)=>new c1((i,n,s)=>{t.push(s),e(...t).then(i,n)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,i)=>{this._reject=i;let n=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,t(a))},s=a=>{this._isPending=!1,i(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(n,s,o)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new KP(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(c1.prototype,Promise.prototype);jP.exports=c1;jP.exports.CancelError=KP});var t1e=y((z9t,VP)=>{f();"use strict";var e1e=Zbe(),p0t=Jbe();VP.exports=(r,e)=>{let t=e1e(r,{...e,count:1});return p0t.fn(async i=>{i(()=>{t.cancel()});let[n]=await t;return n})()};VP.exports.AggregateError=e1e.AggregateError});var n1e=y((H9t,i1e)=>{f();"use strict";var y0t=ae(),g0t=df().default,{anySignal:m0t}=hf(),b0t=Fbe(),v0t=t1e(),r1e=class{constructor({addrs:e,dialAction:t,dialer:i}){this.addrs=e,this.dialer=i,this.dialAction=t}async run(e={}){let t=this.dialer.getTokens(this.addrs.length);if(t.length<1)throw y0t(new Error("No dial tokens available"),"ERR_NO_DIAL_TOKENS");let i=new b0t;t.forEach(o=>i.push(o));let n=this.addrs.map(()=>new g0t),s=0;try{return await v0t(this.addrs.map(async(o,a)=>{let c=await i.shift(),u;try{let l=n[a].signal;u=await this.dialAction(o,{...e,signal:e.signal?m0t([l,e.signal]):l}),n.splice(a,1)}finally{s++,this.addrs.length-s>=t.length?i.push(c):this.dialer.releaseToken(t.splice(t.indexOf(c),1)[0])}return u}))}finally{n.map(o=>o.abort()),t.forEach(o=>this.dialer.releaseToken(o))}}};i1e.exports=r1e});var c1e=y(($9t,a1e)=>{f();"use strict";var s1e=be(),K0=Object.assign(s1e("libp2p:dialer"),{error:s1e("libp2p:dialer:err")}),zP=ae(),{Multiaddr:HP}=it(),w0t=l4(),{AbortError:_0t}=fc(),{anySignal:E0t}=hf(),S0t=n1e(),{publicAddressesFirst:x0t}=_P(),A0t=mP(),{codes:e3}=yi(),{DIAL_TIMEOUT:I0t,MAX_PARALLEL_DIALS:T0t,MAX_PER_PEER_DIALS:R0t,MAX_ADDRS_TO_DIAL:C0t}=jS(),o1e=class{constructor({transportManager:e,peerStore:t,addressSorter:i=x0t,maxParallelDials:n=T0t,maxAddrsToDial:s=C0t,dialTimeout:o=I0t,maxDialsPerPeer:a=R0t,resolvers:c={}}){this.transportManager=e,this.peerStore=t,this.addressSorter=i,this.maxParallelDials=n,this.maxAddrsToDial=s,this.timeout=o,this.maxDialsPerPeer=a,this.tokens=[...new Array(n)].map((u,l)=>l),this._pendingDials=new Map,this._pendingDialTargets=new Map;for(let[u,l]of Object.entries(c))HP.resolvers.set(u,l)}destroy(){for(let e of this._pendingDials.values())try{e.controller.abort()}catch(t){K0.error(t)}this._pendingDials.clear();for(let e of this._pendingDialTargets.values())e.reject(new _0t("Dialer was destroyed"));this._pendingDialTargets.clear()}async connectToPeer(e,t={}){let i=await this._createCancellableDialTarget(e);if(!i.addrs.length)throw zP(new Error("The dial request has no valid addresses"),e3.ERR_NO_VALID_ADDRESSES);let n=this._pendingDials.get(i.id)||this._createPendingDial(i,t);try{let s=await n.promise;return K0("dial succeeded to %s",i.id),s}catch(s){throw n.controller.signal.aborted&&(s.code=e3.ERR_TIMEOUT),K0.error(s),s}finally{n.destroy()}}async _createCancellableDialTarget(e){let t=`${parseInt(String(Math.random()*1e9),10).toString()+Date.now()}`,i=new Promise((s,o)=>{this._pendingDialTargets.set(t,{resolve:s,reject:o})}),n=await Promise.race([this._createDialTarget(e),i]);return this._pendingDialTargets.delete(t),n}async _createDialTarget(e){let{id:t,multiaddrs:i}=A0t(e);i&&this.peerStore.addressBook.add(t,i);let n=this.peerStore.addressBook.getMultiaddrsForPeer(t,this.addressSorter)||[];HP.isMultiaddr(e)&&(n=n.filter(a=>!e.equals(a)),n.unshift(e));let s=[];for(let a of n)(await this._resolve(a)).forEach(u=>s.push(u));let o=s.filter(a=>this.transportManager.transportForMultiaddr(a));if(o.length>this.maxAddrsToDial)throw this.peerStore.delete(t),zP(new Error("dial with more addresses than allowed"),e3.ERR_TOO_MANY_ADDRESSES);return{id:t.toB58String(),addrs:o}}_createPendingDial(e,t={}){let i=(u,l)=>{if(l.signal.aborted)throw zP(new Error("already aborted"),e3.ERR_ALREADY_ABORTED);return this.transportManager.dial(u,l)},n=new S0t({addrs:e.addrs,dialAction:i,dialer:this}),s=new w0t(this.timeout),o=[s.signal];t.signal&&o.push(t.signal);let a=E0t(o),c={dialRequest:n,controller:s,promise:n.run({...t,signal:a}),destroy:()=>{s.clear(),this._pendingDials.delete(e.id)}};return this._pendingDials.set(e.id,c),c}getTokens(e){let t=Math.min(e,this.maxDialsPerPeer,this.tokens.length),i=this.tokens.splice(0,t);return K0("%d tokens request, returning %d, %d remaining",e,t,this.tokens.length),i}releaseToken(e){this.tokens.indexOf(e)>-1||(K0("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let i=await this._resolveRecord(e);return(await Promise.all(i.map(o=>this._resolve(o)))).flat().reduce((o,a)=>(o.find(c=>c.equals(a))||o.push(a),o),[])}async _resolveRecord(e){try{return e=new HP(e.toString()),await e.resolve()}catch(t){return K0.error(`multiaddr ${e} could not be resolved`),[]}}};a1e.exports=o1e});var l1e=y((G9t,u1e)=>{f();"use strict";function P0t(r){return r>=55296&&r<=56319}function O0t(r){return r>=56320&&r<=57343}u1e.exports=function(e,t,i){if(typeof t!="string")throw new Error("Input must be string");for(var n=t.length,s=0,o,a,c=0;c<n;c+=1){if(o=t.charCodeAt(c),a=t[c],P0t(o)&&O0t(t.charCodeAt(c+1))&&(c+=1,a+=t[c]),s+=e(a),s===i)return t.slice(0,c+1);if(s>i)return t.slice(0,c-a.length+1)}return t}});var d1e=y((W9t,f1e)=>{f();"use strict";function k0t(r){return r>=55296&&r<=56319}function q0t(r){return r>=56320&&r<=57343}f1e.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var t=e.length,i=0,n=null,s=null,o=0;o<t;o++)n=e.charCodeAt(o),q0t(n)?s!=null&&k0t(s)?i+=1:i+=3:n<=127?i+=1:n>=128&&n<=2047?i+=2:n>=2048&&n<=65535&&(i+=3),s=n;return i}});var p1e=y((Y9t,h1e)=>{f();"use strict";var N0t=l1e(),D0t=d1e();h1e.exports=N0t.bind(null,D0t)});var m1e=y((X9t,g1e)=>{f();"use strict";var B0t=p1e(),M0t=/[\/\?<>\\:\*\|"]/g,L0t=/[\x00-\x1f\x80-\x9f]/g,U0t=/^\.+$/,F0t=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,K0t=/[\. ]+$/;function y1e(r,e){if(typeof r!="string")throw new Error("Input must be string");var t=r.replace(M0t,e).replace(L0t,e).replace(U0t,e).replace(F0t,e).replace(K0t,e);return B0t(t,255)}g1e.exports=function(r,e){var t=e&&e.replacement||"",i=y1e(r,t);return t===""?i:y1e(i,"")}});var _1e=y((Q9t,w1e)=>{f();var j0=dt();Nc();Qt();var Le=j0.asn1,V0=w1e.exports=j0.pkcs7asn1=j0.pkcs7asn1||{};j0.pkcs7=j0.pkcs7||{};j0.pkcs7.asn1=V0;var b1e={name:"ContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};V0.contentInfoValidator=b1e;var v1e={name:"EncryptedContentInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};V0.envelopedDataValidator={name:"EnvelopedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(v1e)};V0.encryptedDataValidator={name:"EncryptedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"}].concat(v1e)};var j0t={name:"SignerInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};V0.signedDataValidator={name:"SignedData",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},b1e,{name:"SignedData.Certificates",tagClass:Le.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Le.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SET,capture:"signerInfos",optional:!0,value:[j0t]}]};V0.recipientInfoValidator={name:"RecipientInfo",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Le.Class.UNIVERSAL,type:Le.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Le.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:Le.Class.UNIVERSAL,type:Le.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var S1e=y((Z9t,E1e)=>{f();var Kd=dt();Qt();Kd.mgf=Kd.mgf||{};var V0t=E1e.exports=Kd.mgf.mgf1=Kd.mgf1=Kd.mgf1||{};V0t.create=function(r){var e={generate:function(t,i){for(var n=new Kd.util.ByteBuffer,s=Math.ceil(i/r.digestLength),o=0;o<s;o++){var a=new Kd.util.ByteBuffer;a.putInt32(o),r.start(),r.update(t+a.getBytes()),n.putBuffer(r.digest())}return n.truncate(n.length()-i),n.getBytes()}};return e}});var A1e=y((J9t,x1e)=>{f();var t3=dt();S1e();x1e.exports=t3.mgf=t3.mgf||{};t3.mgf.mgf1=t3.mgf1});var T1e=y((eUt,I1e)=>{f();var jd=dt();Hu();Qt();var z0t=I1e.exports=jd.pss=jd.pss||{};z0t.create=function(r){arguments.length===3&&(r={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=r.md,t=r.mgf,i=e.digestLength,n=r.salt||null;typeof n=="string"&&(n=jd.util.createBuffer(n));var s;if("saltLength"in r)s=r.saltLength;else if(n!==null)s=n.length();else throw new Error("Salt length not specified or specific salt not given.");if(n!==null&&n.length()!==s)throw new Error("Given salt length does not match length of given salt.");var o=r.prng||jd.random,a={};return a.encode=function(c,u){var l,d=u-1,h=Math.ceil(d/8),p=c.digest().getBytes();if(h<i+s+2)throw new Error("Message is too long to encrypt.");var g;n===null?g=o.getBytesSync(s):g=n.bytes();var b=new jd.util.ByteBuffer;b.fillWithByte(0,8),b.putBytes(p),b.putBytes(g),e.start(),e.update(b.getBytes());var E=e.digest().getBytes(),v=new jd.util.ByteBuffer;v.fillWithByte(0,h-s-i-2),v.putByte(1),v.putBytes(g);var A=v.getBytes(),R=h-i-1,F=t.generate(E,R),q="";for(l=0;l<R;l++)q+=String.fromCharCode(A.charCodeAt(l)^F.charCodeAt(l));var N=65280>>8*h-d&255;return q=String.fromCharCode(q.charCodeAt(0)&~N)+q.substr(1),q+E+String.fromCharCode(188)},a.verify=function(c,u,l){var d,h=l-1,p=Math.ceil(h/8);if(u=u.substr(-p),p<i+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=p-i-1,b=u.substr(0,g),E=u.substr(g,i),v=65280>>8*p-h&255;if((b.charCodeAt(0)&v)!=0)throw new Error("Bits beyond keysize not zero as expected.");var A=t.generate(E,g),R="";for(d=0;d<g;d++)R+=String.fromCharCode(b.charCodeAt(d)^A.charCodeAt(d));R=String.fromCharCode(R.charCodeAt(0)&~v)+R.substr(1);var F=p-i-s-2;for(d=0;d<F;d++)if(R.charCodeAt(d)!==0)throw new Error("Leftmost octets not zero as expected");if(R.charCodeAt(F)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var q=R.substr(-s),N=new jd.util.ByteBuffer;N.fillWithByte(0,8),N.putBytes(c),N.putBytes(q),e.start(),e.update(N.getBytes());var z=e.digest().getBytes();return E===z},a}});var GP=y((tUt,O1e)=>{f();var ke=dt();Sh();Nc();Hv();zu();A1e();wh();Yv();T1e();bg();Qt();var O=ke.asn1,Te=O1e.exports=ke.pki=ke.pki||{},st=Te.oids,Gr={};Gr.CN=st.commonName;Gr.commonName="CN";Gr.C=st.countryName;Gr.countryName="C";Gr.L=st.localityName;Gr.localityName="L";Gr.ST=st.stateOrProvinceName;Gr.stateOrProvinceName="ST";Gr.O=st.organizationName;Gr.organizationName="O";Gr.OU=st.organizationalUnitName;Gr.organizationalUnitName="OU";Gr.E=st.emailAddress;Gr.emailAddress="E";var R1e=ke.pki.rsa.publicKeyValidator,H0t={name:"Certificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:O.Class.UNIVERSAL,type:O.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:O.Class.UNIVERSAL,type:O.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},R1e,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},$0t={name:"rsapss",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:O.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:O.Class.UNIVERSAL,type:O.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:O.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:O.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:O.Class.UNIVERSAL,type:O.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},G0t={name:"CertificationRequestInfo",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:O.Class.UNIVERSAL,type:O.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},R1e,{name:"CertificationRequestInfo.attributes",tagClass:O.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:O.Class.UNIVERSAL,type:O.Type.SET,constructed:!0}]}]}]},W0t={name:"CertificationRequest",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[G0t,{name:"CertificationRequest.signatureAlgorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:O.Class.UNIVERSAL,type:O.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:O.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:O.Class.UNIVERSAL,type:O.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};Te.RDNAttributesAsArray=function(r,e){for(var t=[],i,n,s,o=0;o<r.value.length;++o){i=r.value[o];for(var a=0;a<i.value.length;++a)s={},n=i.value[a],s.type=O.derToOid(n.value[0].value),s.value=n.value[1].value,s.valueTagClass=n.value[1].type,s.type in st&&(s.name=st[s.type],s.name in Gr&&(s.shortName=Gr[s.name])),e&&(e.update(s.type),e.update(s.value)),t.push(s)}return t};Te.CRIAttributesAsArray=function(r){for(var e=[],t=0;t<r.length;++t)for(var i=r[t],n=O.derToOid(i.value[0].value),s=i.value[1].value,o=0;o<s.length;++o){var a={};if(a.type=n,a.value=s[o].value,a.valueTagClass=s[o].type,a.type in st&&(a.name=st[a.type],a.name in Gr&&(a.shortName=Gr[a.name])),a.type===st.extensionRequest){a.extensions=[];for(var c=0;c<a.value.length;++c)a.extensions.push(Te.certificateExtensionFromAsn1(a.value[c]))}e.push(a)}return e};function Gl(r,e){typeof e=="string"&&(e={shortName:e});for(var t=null,i,n=0;t===null&&n<r.attributes.length;++n)i=r.attributes[n],(e.type&&e.type===i.type||e.name&&e.name===i.name||e.shortName&&e.shortName===i.shortName)&&(t=i);return t}var r3=function(r,e,t){var i={};if(r!==st["RSASSA-PSS"])return i;t&&(i={hash:{algorithmOid:st.sha1},mgf:{algorithmOid:st.mgf1,hash:{algorithmOid:st.sha1}},saltLength:20});var n={},s=[];if(!O.validate(e,$0t,n,s)){var o=new Error("Cannot read RSASSA-PSS parameter block.");throw o.errors=s,o}return n.hashOid!==void 0&&(i.hash=i.hash||{},i.hash.algorithmOid=O.derToOid(n.hashOid)),n.maskGenOid!==void 0&&(i.mgf=i.mgf||{},i.mgf.algorithmOid=O.derToOid(n.maskGenOid),i.mgf.hash=i.mgf.hash||{},i.mgf.hash.algorithmOid=O.derToOid(n.maskGenHashOid)),n.saltLength!==void 0&&(i.saltLength=n.saltLength.charCodeAt(0)),i};Te.certificateFromPem=function(r,e,t){var i=ke.pem.decode(r)[0];if(i.type!=="CERTIFICATE"&&i.type!=="X509 CERTIFICATE"&&i.type!=="TRUSTED CERTIFICATE"){var n=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=O.fromDer(i.body,t);return Te.certificateFromAsn1(s,e)};Te.certificateToPem=function(r,e){var t={type:"CERTIFICATE",body:O.toDer(Te.certificateToAsn1(r)).getBytes()};return ke.pem.encode(t,{maxline:e})};Te.publicKeyFromPem=function(r){var e=ke.pem.decode(r)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var t=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var i=O.fromDer(e.body);return Te.publicKeyFromAsn1(i)};Te.publicKeyToPem=function(r,e){var t={type:"PUBLIC KEY",body:O.toDer(Te.publicKeyToAsn1(r)).getBytes()};return ke.pem.encode(t,{maxline:e})};Te.publicKeyToRSAPublicKeyPem=function(r,e){var t={type:"RSA PUBLIC KEY",body:O.toDer(Te.publicKeyToRSAPublicKey(r)).getBytes()};return ke.pem.encode(t,{maxline:e})};Te.getPublicKeyFingerprint=function(r,e){e=e||{};var t=e.md||ke.md.sha1.create(),i=e.type||"RSAPublicKey",n;switch(i){case"RSAPublicKey":n=O.toDer(Te.publicKeyToRSAPublicKey(r)).getBytes();break;case"SubjectPublicKeyInfo":n=O.toDer(Te.publicKeyToAsn1(r)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}t.start(),t.update(n);var s=t.digest();if(e.encoding==="hex"){var o=s.toHex();return e.delimiter?o.match(/.{2}/g).join(e.delimiter):o}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};Te.certificationRequestFromPem=function(r,e,t){var i=ke.pem.decode(r)[0];if(i.type!=="CERTIFICATE REQUEST"){var n=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw n.headerType=i.type,n}if(i.procType&&i.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=O.fromDer(i.body,t);return Te.certificationRequestFromAsn1(s,e)};Te.certificationRequestToPem=function(r,e){var t={type:"CERTIFICATE REQUEST",body:O.toDer(Te.certificationRequestToAsn1(r)).getBytes()};return ke.pem.encode(t,{maxline:e})};Te.createCertificate=function(){var r={};return r.version=2,r.serialNumber="00",r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.validity={},r.validity.notBefore=new Date,r.validity.notAfter=new Date,r.issuer={},r.issuer.getField=function(e){return Gl(r.issuer,e)},r.issuer.addField=function(e){fo([e]),r.issuer.attributes.push(e)},r.issuer.attributes=[],r.issuer.hash=null,r.subject={},r.subject.getField=function(e){return Gl(r.subject,e)},r.subject.addField=function(e){fo([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.extensions=[],r.publicKey=null,r.md=null,r.setSubject=function(e,t){fo(e),r.subject.attributes=e,delete r.subject.uniqueId,t&&(r.subject.uniqueId=t),r.subject.hash=null},r.setIssuer=function(e,t){fo(e),r.issuer.attributes=e,delete r.issuer.uniqueId,t&&(r.issuer.uniqueId=t),r.issuer.hash=null},r.setExtensions=function(e){for(var t=0;t<e.length;++t)C1e(e[t],{cert:r});r.extensions=e},r.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var t=null,i,n=0;t===null&&n<r.extensions.length;++n)i=r.extensions[n],(e.id&&i.id===e.id||e.name&&i.name===e.name)&&(t=i);return t},r.sign=function(e,t){r.md=t||ke.md.sha1.create();var i=st[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.tbsCertificate=Te.getTBSCertificate(r);var s=O.toDer(r.tbsCertificate);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(e){var t=!1;if(!r.issued(e)){var i=e.issuer,n=r.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var o=e.md;if(o===null){if(e.signatureOid in st){var a=st[e.signatureOid];switch(a){case"sha1WithRSAEncryption":o=ke.md.sha1.create();break;case"md5WithRSAEncryption":o=ke.md.md5.create();break;case"sha256WithRSAEncryption":o=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o=ke.md.sha512.create();break;case"RSASSA-PSS":o=ke.md.sha256.create();break}}if(o===null){var s=new Error("Could not compute certificate digest. Unknown signature OID.");throw s.signatureOid=e.signatureOid,s}var c=e.tbsCertificate||Te.getTBSCertificate(e),u=O.toDer(c);o.update(u.getBytes())}if(o!==null){var l;switch(e.signatureOid){case st.sha1WithRSAEncryption:l=void 0;break;case st["RSASSA-PSS"]:var d,h;if(d=st[e.signatureParameters.mgf.hash.algorithmOid],d===void 0||ke.md[d]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=d,s}if(h=st[e.signatureParameters.mgf.algorithmOid],h===void 0||ke.mgf[h]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=h,s}if(h=ke.mgf[h].create(ke.md[d].create()),d=st[e.signatureParameters.hash.algorithmOid],d===void 0||ke.md[d]===void 0)throw{message:"Unsupported RSASSA-PSS hash function.",oid:e.signatureParameters.hash.algorithmOid,name:d};l=ke.pss.create(ke.md[d].create(),h,e.signatureParameters.saltLength);break}t=r.publicKey.verify(o.digest().getBytes(),e.signature,l)}return t},r.isIssuer=function(e){var t=!1,i=r.issuer,n=e.subject;if(i.hash&&n.hash)t=i.hash===n.hash;else if(i.attributes.length===n.attributes.length){t=!0;for(var s,o,a=0;t&&a<i.attributes.length;++a)s=i.attributes[a],o=n.attributes[a],(s.type!==o.type||s.value!==o.value)&&(t=!1)}return t},r.issued=function(e){return e.isIssuer(r)},r.generateSubjectKeyIdentifier=function(){return Te.getPublicKeyFingerprint(r.publicKey,{type:"RSAPublicKey"})},r.verifySubjectKeyIdentifier=function(){for(var e=st.subjectKeyIdentifier,t=0;t<r.extensions.length;++t){var i=r.extensions[t];if(i.id===e){var n=r.generateSubjectKeyIdentifier().getBytes();return ke.util.hexToBytes(i.subjectKeyIdentifier)===n}}return!1},r};Te.certificateFromAsn1=function(r,e){var t={},i=[];if(!O.validate(r,H0t,t,i)){var n=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw n.errors=i,n}var s=O.derToOid(t.publicKeyOid);if(s!==Te.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Te.createCertificate();o.version=t.certVersion?t.certVersion.charCodeAt(0):0;var a=ke.util.createBuffer(t.certSerialNumber);o.serialNumber=a.toHex(),o.signatureOid=ke.asn1.derToOid(t.certSignatureOid),o.signatureParameters=r3(o.signatureOid,t.certSignatureParams,!0),o.siginfo.algorithmOid=ke.asn1.derToOid(t.certinfoSignatureOid),o.siginfo.parameters=r3(o.siginfo.algorithmOid,t.certinfoSignatureParams,!1),o.signature=t.certSignature;var c=[];if(t.certValidity1UTCTime!==void 0&&c.push(O.utcTimeToDate(t.certValidity1UTCTime)),t.certValidity2GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(t.certValidity2GeneralizedTime)),t.certValidity3UTCTime!==void 0&&c.push(O.utcTimeToDate(t.certValidity3UTCTime)),t.certValidity4GeneralizedTime!==void 0&&c.push(O.generalizedTimeToDate(t.certValidity4GeneralizedTime)),c.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(c.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(o.validity.notBefore=c[0],o.validity.notAfter=c[1],o.tbsCertificate=t.tbsCertificate,e){if(o.md=null,o.signatureOid in st){var s=st[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=ke.md.sha1.create();break;case"md5WithRSAEncryption":o.md=ke.md.md5.create();break;case"sha256WithRSAEncryption":o.md=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=ke.md.sha512.create();break;case"RSASSA-PSS":o.md=ke.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certificate digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var u=O.toDer(o.tbsCertificate);o.md.update(u.getBytes())}var l=ke.md.sha1.create();o.issuer.getField=function(h){return Gl(o.issuer,h)},o.issuer.addField=function(h){fo([h]),o.issuer.attributes.push(h)},o.issuer.attributes=Te.RDNAttributesAsArray(t.certIssuer,l),t.certIssuerUniqueId&&(o.issuer.uniqueId=t.certIssuerUniqueId),o.issuer.hash=l.digest().toHex();var d=ke.md.sha1.create();return o.subject.getField=function(h){return Gl(o.subject,h)},o.subject.addField=function(h){fo([h]),o.subject.attributes.push(h)},o.subject.attributes=Te.RDNAttributesAsArray(t.certSubject,d),t.certSubjectUniqueId&&(o.subject.uniqueId=t.certSubjectUniqueId),o.subject.hash=d.digest().toHex(),t.certExtensions?o.extensions=Te.certificateExtensionsFromAsn1(t.certExtensions):o.extensions=[],o.publicKey=Te.publicKeyFromAsn1(t.subjectPublicKeyInfo),o};Te.certificateExtensionsFromAsn1=function(r){for(var e=[],t=0;t<r.value.length;++t)for(var i=r.value[t],n=0;n<i.value.length;++n)e.push(Te.certificateExtensionFromAsn1(i.value[n]));return e};Te.certificateExtensionFromAsn1=function(r){var e={};if(e.id=O.derToOid(r.value[0].value),e.critical=!1,r.value[1].type===O.Type.BOOLEAN?(e.critical=r.value[1].value.charCodeAt(0)!==0,e.value=r.value[2].value):e.value=r.value[1].value,e.id in st){if(e.name=st[e.id],e.name==="keyUsage"){var t=O.fromDer(e.value),i=0,n=0;t.value.length>1&&(i=t.value.charCodeAt(1),n=t.value.length>2?t.value.charCodeAt(2):0),e.digitalSignature=(i&128)==128,e.nonRepudiation=(i&64)==64,e.keyEncipherment=(i&32)==32,e.dataEncipherment=(i&16)==16,e.keyAgreement=(i&8)==8,e.keyCertSign=(i&4)==4,e.cRLSign=(i&2)==2,e.encipherOnly=(i&1)==1,e.decipherOnly=(n&128)==128}else if(e.name==="basicConstraints"){var t=O.fromDer(e.value);t.value.length>0&&t.value[0].type===O.Type.BOOLEAN?e.cA=t.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;t.value.length>0&&t.value[0].type===O.Type.INTEGER?s=t.value[0].value:t.value.length>1&&(s=t.value[1].value),s!==null&&(e.pathLenConstraint=O.derToInteger(s))}else if(e.name==="extKeyUsage")for(var t=O.fromDer(e.value),o=0;o<t.value.length;++o){var a=O.derToOid(t.value[o].value);a in st?e[st[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var t=O.fromDer(e.value),i=0;t.value.length>1&&(i=t.value.charCodeAt(1)),e.client=(i&128)==128,e.server=(i&64)==64,e.email=(i&32)==32,e.objsign=(i&16)==16,e.reserved=(i&8)==8,e.sslCA=(i&4)==4,e.emailCA=(i&2)==2,e.objCA=(i&1)==1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var c,t=O.fromDer(e.value),u=0;u<t.value.length;++u){c=t.value[u];var l={type:c.type,value:c.value};switch(e.altNames.push(l),c.type){case 1:case 2:case 6:break;case 7:l.ip=ke.util.bytesToIP(c.value);break;case 8:l.oid=O.derToOid(c.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var t=O.fromDer(e.value);e.subjectKeyIdentifier=ke.util.bytesToHex(t.value)}}return e};Te.certificationRequestFromAsn1=function(r,e){var t={},i=[];if(!O.validate(r,W0t,t,i)){var n=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw n.errors=i,n}var s=O.derToOid(t.publicKeyOid);if(s!==Te.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var o=Te.createCertificationRequest();if(o.version=t.csrVersion?t.csrVersion.charCodeAt(0):0,o.signatureOid=ke.asn1.derToOid(t.csrSignatureOid),o.signatureParameters=r3(o.signatureOid,t.csrSignatureParams,!0),o.siginfo.algorithmOid=ke.asn1.derToOid(t.csrSignatureOid),o.siginfo.parameters=r3(o.siginfo.algorithmOid,t.csrSignatureParams,!1),o.signature=t.csrSignature,o.certificationRequestInfo=t.certificationRequestInfo,e){if(o.md=null,o.signatureOid in st){var s=st[o.signatureOid];switch(s){case"sha1WithRSAEncryption":o.md=ke.md.sha1.create();break;case"md5WithRSAEncryption":o.md=ke.md.md5.create();break;case"sha256WithRSAEncryption":o.md=ke.md.sha256.create();break;case"sha384WithRSAEncryption":o.md=ke.md.sha384.create();break;case"sha512WithRSAEncryption":o.md=ke.md.sha512.create();break;case"RSASSA-PSS":o.md=ke.md.sha256.create();break}}if(o.md===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=o.signatureOid,n}var a=O.toDer(o.certificationRequestInfo);o.md.update(a.getBytes())}var c=ke.md.sha1.create();return o.subject.getField=function(u){return Gl(o.subject,u)},o.subject.addField=function(u){fo([u]),o.subject.attributes.push(u)},o.subject.attributes=Te.RDNAttributesAsArray(t.certificationRequestInfoSubject,c),o.subject.hash=c.digest().toHex(),o.publicKey=Te.publicKeyFromAsn1(t.subjectPublicKeyInfo),o.getAttribute=function(u){return Gl(o,u)},o.addAttribute=function(u){fo([u]),o.attributes.push(u)},o.attributes=Te.CRIAttributesAsArray(t.certificationRequestInfoAttributes||[]),o};Te.createCertificationRequest=function(){var r={};return r.version=0,r.signatureOid=null,r.signature=null,r.siginfo={},r.siginfo.algorithmOid=null,r.subject={},r.subject.getField=function(e){return Gl(r.subject,e)},r.subject.addField=function(e){fo([e]),r.subject.attributes.push(e)},r.subject.attributes=[],r.subject.hash=null,r.publicKey=null,r.attributes=[],r.getAttribute=function(e){return Gl(r,e)},r.addAttribute=function(e){fo([e]),r.attributes.push(e)},r.md=null,r.setSubject=function(e){fo(e),r.subject.attributes=e,r.subject.hash=null},r.setAttributes=function(e){fo(e),r.attributes=e},r.sign=function(e,t){r.md=t||ke.md.sha1.create();var i=st[r.md.algorithm+"WithRSAEncryption"];if(!i){var n=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw n.algorithm=r.md.algorithm,n}r.signatureOid=r.siginfo.algorithmOid=i,r.certificationRequestInfo=Te.getCertificationRequestInfo(r);var s=O.toDer(r.certificationRequestInfo);r.md.update(s.getBytes()),r.signature=e.sign(r.md)},r.verify=function(){var e=!1,t=r.md;if(t===null){if(r.signatureOid in st){var i=st[r.signatureOid];switch(i){case"sha1WithRSAEncryption":t=ke.md.sha1.create();break;case"md5WithRSAEncryption":t=ke.md.md5.create();break;case"sha256WithRSAEncryption":t=ke.md.sha256.create();break;case"sha384WithRSAEncryption":t=ke.md.sha384.create();break;case"sha512WithRSAEncryption":t=ke.md.sha512.create();break;case"RSASSA-PSS":t=ke.md.sha256.create();break}}if(t===null){var n=new Error("Could not compute certification request digest. Unknown signature OID.");throw n.signatureOid=r.signatureOid,n}var s=r.certificationRequestInfo||Te.getCertificationRequestInfo(r),o=O.toDer(s);t.update(o.getBytes())}if(t!==null){var a;switch(r.signatureOid){case st.sha1WithRSAEncryption:break;case st["RSASSA-PSS"]:var c,u;if(c=st[r.signatureParameters.mgf.hash.algorithmOid],c===void 0||ke.md[c]===void 0){var n=new Error("Unsupported MGF hash function.");throw n.oid=r.signatureParameters.mgf.hash.algorithmOid,n.name=c,n}if(u=st[r.signatureParameters.mgf.algorithmOid],u===void 0||ke.mgf[u]===void 0){var n=new Error("Unsupported MGF function.");throw n.oid=r.signatureParameters.mgf.algorithmOid,n.name=u,n}if(u=ke.mgf[u].create(ke.md[c].create()),c=st[r.signatureParameters.hash.algorithmOid],c===void 0||ke.md[c]===void 0){var n=new Error("Unsupported RSASSA-PSS hash function.");throw n.oid=r.signatureParameters.hash.algorithmOid,n.name=c,n}a=ke.pss.create(ke.md[c].create(),u,r.signatureParameters.saltLength);break}e=r.publicKey.verify(t.digest().getBytes(),r.signature,a)}return e},r};function z0(r){for(var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),t,i,n=r.attributes,s=0;s<n.length;++s){t=n[s];var o=t.value,a=O.Type.PRINTABLESTRING;"valueTagClass"in t&&(a=t.valueTagClass,a===O.Type.UTF8&&(o=ke.util.encodeUtf8(o))),i=O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(t.type).getBytes()),O.create(O.Class.UNIVERSAL,a,!1,o)])]),e.value.push(i)}return e}function fo(r){for(var e,t=0;t<r.length;++t){if(e=r[t],typeof e.name=="undefined"&&(e.type&&e.type in Te.oids?e.name=Te.oids[e.type]:e.shortName&&e.shortName in Gr&&(e.name=Te.oids[Gr[e.shortName]])),typeof e.type=="undefined")if(e.name&&e.name in Te.oids)e.type=Te.oids[e.name];else{var i=new Error("Attribute type not specified.");throw i.attribute=e,i}if(typeof e.shortName=="undefined"&&e.name&&e.name in Gr&&(e.shortName=Gr[e.name]),e.type===st.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=O.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var n=0;n<e.extensions.length;++n)e.value.push(Te.certificateExtensionToAsn1(C1e(e.extensions[n])))}if(typeof e.value=="undefined"){var i=new Error("Attribute value not specified.");throw i.attribute=e,i}}}function C1e(r,e){if(e=e||{},typeof r.name=="undefined"&&r.id&&r.id in Te.oids&&(r.name=Te.oids[r.id]),typeof r.id=="undefined")if(r.name&&r.name in Te.oids)r.id=Te.oids[r.name];else{var t=new Error("Extension ID not specified.");throw t.extension=r,t}if(typeof r.value!="undefined")return r;if(r.name==="keyUsage"){var i=0,n=0,s=0;r.digitalSignature&&(n|=128,i=7),r.nonRepudiation&&(n|=64,i=6),r.keyEncipherment&&(n|=32,i=5),r.dataEncipherment&&(n|=16,i=4),r.keyAgreement&&(n|=8,i=3),r.keyCertSign&&(n|=4,i=2),r.cRLSign&&(n|=2,i=1),r.encipherOnly&&(n|=1,i=0),r.decipherOnly&&(s|=128,i=7);var o=String.fromCharCode(i);s!==0?o+=String.fromCharCode(n)+String.fromCharCode(s):n!==0&&(o+=String.fromCharCode(n)),r.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(r.name==="basicConstraints")r.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),r.cA&&r.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in r&&r.value.value.push(O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(r.pathLenConstraint).getBytes()));else if(r.name==="extKeyUsage"){r.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=r.value.value;for(var c in r)r[c]===!0&&(c in st?a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(st[c]).getBytes())):c.indexOf(".")!==-1&&a.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(c).getBytes())))}else if(r.name==="nsCertType"){var i=0,n=0;r.client&&(n|=128,i=7),r.server&&(n|=64,i=6),r.email&&(n|=32,i=5),r.objsign&&(n|=16,i=4),r.reserved&&(n|=8,i=3),r.sslCA&&(n|=4,i=2),r.emailCA&&(n|=2,i=1),r.objCA&&(n|=1,i=0);var o=String.fromCharCode(i);n!==0&&(o+=String.fromCharCode(n)),r.value=O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,o)}else if(r.name==="subjectAltName"||r.name==="issuerAltName"){r.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var u,l=0;l<r.altNames.length;++l){u=r.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=ke.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));r.value.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}}else if(r.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(r.comment)||r.comment.length<1||r.comment.length>128)throw new Error('Invalid "nsComment" content.');r.value=O.create(O.Class.UNIVERSAL,O.Type.IA5STRING,!1,r.comment)}else if(r.name==="subjectKeyIdentifier"&&e.cert){var d=e.cert.generateSubjectKeyIdentifier();r.subjectKeyIdentifier=d.toHex(),r.value=O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,d.getBytes())}else if(r.name==="authorityKeyIdentifier"&&e.cert){r.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);var a=r.value.value;if(r.keyIdentifier){var h=r.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():r.keyIdentifier;a.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!1,h))}if(r.authorityCertIssuer){var p=[O.create(O.Class.CONTEXT_SPECIFIC,4,!0,[z0(r.authorityCertIssuer===!0?e.cert.issuer:r.authorityCertIssuer)])];a.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,p))}if(r.serialNumber){var g=ke.util.hexToBytes(r.serialNumber===!0?e.cert.serialNumber:r.serialNumber);a.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(r.name==="cRLDistributionPoints"){r.value=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);for(var a=r.value.value,b=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]),E=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]),u,l=0;l<r.altNames.length;++l){u=r.altNames[l];var o=u.value;if(u.type===7&&u.ip){if(o=ke.util.bytesFromIP(u.ip),o===null){var t=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw t.extension=r,t}}else u.type===8&&(u.oid?o=O.oidToDer(O.oidToDer(u.oid)):o=O.oidToDer(o));E.value.push(O.create(O.Class.CONTEXT_SPECIFIC,u.type,!1,o))}b.value.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[E])),a.push(b)}if(typeof r.value=="undefined"){var t=new Error("Extension value not specified.");throw t.extension=r,t}return r}function $P(r,e){switch(r){case st["RSASSA-PSS"]:var t=[];return e.hash.algorithmOid!==void 0&&t.push(O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&t.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(e.mgf.hash.algorithmOid).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&t.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(e.saltLength).getBytes())])),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,t);default:return O.create(O.Class.UNIVERSAL,O.Type.NULL,!1,"")}}function Y0t(r){var e=O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[]);if(r.attributes.length===0)return e;for(var t=r.attributes,i=0;i<t.length;++i){var n=t[i],s=n.value,o=O.Type.UTF8;"valueTagClass"in n&&(o=n.valueTagClass),o===O.Type.UTF8&&(s=ke.util.encodeUtf8(s));var a=!1;"valueConstructed"in n&&(a=n.valueConstructed);var c=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(n.type).getBytes()),O.create(O.Class.UNIVERSAL,O.Type.SET,!0,[O.create(O.Class.UNIVERSAL,o,a,s)])]);e.value.push(c)}return e}var X0t=new Date("1950-01-01T00:00:00Z"),Q0t=new Date("2050-01-01T00:00:00Z");function P1e(r){return r>=X0t&&r<Q0t?O.create(O.Class.UNIVERSAL,O.Type.UTCTIME,!1,O.dateToUtcTime(r)):O.create(O.Class.UNIVERSAL,O.Type.GENERALIZEDTIME,!1,O.dateToGeneralizedTime(r))}Te.getTBSCertificate=function(r){var e=P1e(r.validity.notBefore),t=P1e(r.validity.notAfter),i=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.CONTEXT_SPECIFIC,0,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(r.version).getBytes())]),O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,ke.util.hexToBytes(r.serialNumber)),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.siginfo.algorithmOid).getBytes()),$P(r.siginfo.algorithmOid,r.siginfo.parameters)]),z0(r.issuer),O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,t]),z0(r.subject),Te.publicKeyToAsn1(r.publicKey)]);return r.issuer.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,1,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+r.issuer.uniqueId)])),r.subject.uniqueId&&i.value.push(O.create(O.Class.CONTEXT_SPECIFIC,2,!0,[O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+r.subject.uniqueId)])),r.extensions.length>0&&i.value.push(Te.certificateExtensionsToAsn1(r.extensions)),i};Te.getCertificationRequestInfo=function(r){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.INTEGER,!1,O.integerToDer(r.version).getBytes()),z0(r.subject),Te.publicKeyToAsn1(r.publicKey),Y0t(r)]);return e};Te.distinguishedNameToAsn1=function(r){return z0(r)};Te.certificateToAsn1=function(r){var e=r.tbsCertificate||Te.getTBSCertificate(r);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.signatureOid).getBytes()),$P(r.signatureOid,r.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Te.certificateExtensionsToAsn1=function(r){var e=O.create(O.Class.CONTEXT_SPECIFIC,3,!0,[]),t=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(t);for(var i=0;i<r.length;++i)t.value.push(Te.certificateExtensionToAsn1(r[i]));return e};Te.certificateExtensionToAsn1=function(r){var e=O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[]);e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.id).getBytes())),r.critical&&e.value.push(O.create(O.Class.UNIVERSAL,O.Type.BOOLEAN,!1,String.fromCharCode(255)));var t=r.value;return typeof r.value!="string"&&(t=O.toDer(t).getBytes()),e.value.push(O.create(O.Class.UNIVERSAL,O.Type.OCTETSTRING,!1,t)),e};Te.certificationRequestToAsn1=function(r){var e=r.certificationRequestInfo||Te.getCertificationRequestInfo(r);return O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[e,O.create(O.Class.UNIVERSAL,O.Type.SEQUENCE,!0,[O.create(O.Class.UNIVERSAL,O.Type.OID,!1,O.oidToDer(r.signatureOid).getBytes()),$P(r.signatureOid,r.signatureParameters)]),O.create(O.Class.UNIVERSAL,O.Type.BITSTRING,!1,String.fromCharCode(0)+r.signature)])};Te.createCaStore=function(r){var e={certs:{}};e.getIssuer=function(o){var a=t(o.issuer);return a},e.addCertificate=function(o){if(typeof o=="string"&&(o=ke.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))if(o.subject.hash in e.certs){var a=e.certs[o.subject.hash];ke.util.isArray(a)||(a=[a]),a.push(o),e.certs[o.subject.hash]=a}else e.certs[o.subject.hash]=o},e.hasCertificate=function(o){typeof o=="string"&&(o=ke.pki.certificateFromPem(o));var a=t(o.subject);if(!a)return!1;ke.util.isArray(a)||(a=[a]);for(var c=O.toDer(Te.certificateToAsn1(o)).getBytes(),u=0;u<a.length;++u){var l=O.toDer(Te.certificateToAsn1(a[u])).getBytes();if(c===l)return!0}return!1},e.listAllCertificates=function(){var o=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var c=e.certs[a];if(!ke.util.isArray(c))o.push(c);else for(var u=0;u<c.length;++u)o.push(c[u])}return o},e.removeCertificate=function(o){var a;if(typeof o=="string"&&(o=ke.pki.certificateFromPem(o)),i(o.subject),!e.hasCertificate(o))return null;var c=t(o.subject);if(!ke.util.isArray(c))return a=e.certs[o.subject.hash],delete e.certs[o.subject.hash],a;for(var u=O.toDer(Te.certificateToAsn1(o)).getBytes(),l=0;l<c.length;++l){var d=O.toDer(Te.certificateToAsn1(c[l])).getBytes();u===d&&(a=c[l],c.splice(l,1))}return c.length===0&&delete e.certs[o.subject.hash],a};function t(o){return i(o),e.certs[o.hash]||null}function i(o){if(!o.hash){var a=ke.md.sha1.create();o.attributes=Te.RDNAttributesAsArray(z0(o),a),o.hash=a.digest().toHex()}}if(r)for(var n=0;n<r.length;++n){var s=r[n];e.addCertificate(s)}return e};Te.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};Te.verifyCertificateChain=function(r,e,t){typeof t=="function"&&(t={verify:t}),t=t||{},e=e.slice(0);var i=e.slice(0),n=t.validityCheckDate;typeof n=="undefined"&&(n=new Date);var s=!0,o=null,a=0;do{var c=e.shift(),u=null,l=!1;if(n&&(n<c.validity.notBefore||n>c.validity.notAfter)&&(o={message:"Certificate is not valid yet or has expired.",error:Te.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:n}),o===null){if(u=e[0]||r.getIssuer(c),u===null&&c.isIssuer(c)&&(l=!0,u=c),u){var d=u;ke.util.isArray(d)||(d=[d]);for(var h=!1;!h&&d.length>0;){u=d.shift();try{h=u.verify(c)}catch(q){}}h||(o={message:"Certificate signature is invalid.",error:Te.certificateError.bad_certificate})}o===null&&(!u||l)&&!r.hasCertificate(c)&&(o={message:"Certificate is not trusted.",error:Te.certificateError.unknown_ca})}if(o===null&&u&&!c.isIssuer(u)&&(o={message:"Certificate issuer is invalid.",error:Te.certificateError.bad_certificate}),o===null)for(var p={keyUsage:!0,basicConstraints:!0},g=0;o===null&&g<c.extensions.length;++g){var b=c.extensions[g];b.critical&&!(b.name in p)&&(o={message:"Certificate has an unsupported critical extension.",error:Te.certificateError.unsupported_certificate})}if(o===null&&(!s||e.length===0&&(!u||l))){var E=c.getExtension("basicConstraints"),v=c.getExtension("keyUsage");if(v!==null&&(!v.keyCertSign||E===null)&&(o={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:Te.certificateError.bad_certificate}),o===null&&E!==null&&!E.cA&&(o={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:Te.certificateError.bad_certificate}),o===null&&v!==null&&"pathLenConstraint"in E){var A=a-1;A>E.pathLenConstraint&&(o={message:"Certificate basicConstraints pathLenConstraint violated.",error:Te.certificateError.bad_certificate})}}var R=o===null?!0:o.error,F=t.verify?t.verify(R,a,i):R;if(F===!0)o=null;else throw R===!0&&(o={message:"The application rejected the certificate.",error:Te.certificateError.bad_certificate}),(F||F===0)&&(typeof F=="object"&&!ke.util.isArray(F)?(F.message&&(o.message=F.message),F.error&&(o.error=F.error)):typeof F=="string"&&(o.error=F)),o;s=!1,++a}while(e.length>0);return!0}});var N1e=y((rUt,q1e)=>{f();var Ne=dt();Sh();Nc();Hv();wh();Yv();_1e();Hu();Qt();GP();var te=Ne.asn1,jn=q1e.exports=Ne.pkcs7=Ne.pkcs7||{};jn.messageFromPem=function(r){var e=Ne.pem.decode(r)[0];if(e.type!=="PKCS7"){var t=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw t.headerType=e.type,t}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var i=te.fromDer(e.body);return jn.messageFromAsn1(i)};jn.messageToPem=function(r,e){var t={type:"PKCS7",body:te.toDer(r.toAsn1()).getBytes()};return Ne.pem.encode(t,{maxline:e})};jn.messageFromAsn1=function(r){var e={},t=[];if(!te.validate(r,jn.asn1.contentInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw i.errors=t,i}var n=te.derToOid(e.contentType),s;switch(n){case Ne.pki.oids.envelopedData:s=jn.createEnvelopedData();break;case Ne.pki.oids.encryptedData:s=jn.createEncryptedData();break;case Ne.pki.oids.signedData:s=jn.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+n+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};jn.createSignedData=function(){var r=null;return r={type:Ne.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(i){if(YP(r,i,jn.asn1.signedDataValidator),r.certificates=[],r.crls=[],r.digestAlgorithmIdentifiers=[],r.contentInfo=null,r.signerInfos=[],r.rawCapture.certificates)for(var n=r.rawCapture.certificates.value,s=0;s<n.length;++s)r.certificates.push(Ne.pki.certificateFromAsn1(n[s]))},toAsn1:function(){r.contentInfo||r.sign();for(var i=[],n=0;n<r.certificates.length;++n)i.push(Ne.pki.certificateToAsn1(r.certificates[n]));var s=[],o=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,r.digestAlgorithmIdentifiers),r.contentInfo])]);return i.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,i)),s.length>0&&o.value[0].value.push(te.create(te.Class.CONTEXT_SPECIFIC,1,!0,s)),o.value[0].value.push(te.create(te.Class.UNIVERSAL,te.Type.SET,!0,r.signerInfos)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),o])},addSigner:function(i){var n=i.issuer,s=i.serialNumber;if(i.certificate){var o=i.certificate;typeof o=="string"&&(o=Ne.pki.certificateFromPem(o)),n=o.issuer.attributes,s=o.serialNumber}var a=i.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=Ne.pki.privateKeyFromPem(a));var c=i.digestAlgorithm||Ne.pki.oids.sha1;switch(c){case Ne.pki.oids.sha1:case Ne.pki.oids.sha256:case Ne.pki.oids.sha384:case Ne.pki.oids.sha512:case Ne.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+c)}var u=i.authenticatedAttributes||[];if(u.length>0){for(var l=!1,d=!1,h=0;h<u.length;++h){var p=u[h];if(!l&&p.type===Ne.pki.oids.contentType){if(l=!0,d)break;continue}if(!d&&p.type===Ne.pki.oids.messageDigest){if(d=!0,l)break;continue}}if(!l||!d)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}r.signers.push({key:a,version:1,issuer:n,serialNumber:s,digestAlgorithm:c,signatureAlgorithm:Ne.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(i){if(i=i||{},(typeof r.content!="object"||r.contentInfo===null)&&(r.contentInfo=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Ne.pki.oids.data).getBytes())]),"content"in r)){var n;r.content instanceof Ne.util.ByteBuffer?n=r.content.bytes():typeof r.content=="string"&&(n=Ne.util.encodeUtf8(r.content)),i.detached?r.detachedContent=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n):r.contentInfo.value.push(te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,n)]))}if(r.signers.length!==0){var s=e();t(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(i){typeof i=="string"&&(i=Ne.pki.certificateFromPem(i)),r.certificates.push(i)},addCertificateRevokationList:function(i){throw new Error("PKCS#7 CRL support not yet implemented.")}},r;function e(){for(var i={},n=0;n<r.signers.length;++n){var s=r.signers[n],o=s.digestAlgorithm;o in i||(i[o]=Ne.md[Ne.pki.oids[o]].create()),s.authenticatedAttributes.length===0?s.md=i[o]:s.md=Ne.md[Ne.pki.oids[o]].create()}r.digestAlgorithmIdentifiers=[];for(var o in i)r.digestAlgorithmIdentifiers.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(o).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]));return i}function t(i){var n;if(r.detachedContent?n=r.detachedContent:(n=r.contentInfo.value[1],n=n.value[0]),!n)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=te.derToOid(r.contentInfo.value[0].value),o=te.toDer(n);o.getByte(),te.getBerValueLength(o),o=o.getBytes();for(var a in i)i[a].start().update(o);for(var c=new Date,u=0;u<r.signers.length;++u){var l=r.signers[u];if(l.authenticatedAttributes.length===0){if(s!==Ne.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{l.authenticatedAttributesAsn1=te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var d=te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[]),h=0;h<l.authenticatedAttributes.length;++h){var p=l.authenticatedAttributes[h];p.type===Ne.pki.oids.messageDigest?p.value=i[l.digestAlgorithm].digest():p.type===Ne.pki.oids.signingTime&&(p.value||(p.value=c)),d.value.push(WP(p)),l.authenticatedAttributesAsn1.value.push(WP(p))}o=te.toDer(d).getBytes(),l.md.start().update(o)}l.signature=l.key.sign(l.md,"RSASSA-PKCS1-V1_5")}r.signerInfos=iyt(r.signers)}};jn.createEncryptedData=function(){var r=null;return r={type:Ne.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Ne.pki.oids["aes256-CBC"]},fromAsn1:function(e){YP(r,e,jn.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(r.encryptedContent.key=e),k1e(r)}},r};jn.createEnvelopedData=function(){var r=null;return r={type:Ne.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Ne.pki.oids["aes256-CBC"]},fromAsn1:function(e){var t=YP(r,e,jn.asn1.envelopedDataValidator);r.recipients=eyt(t.recipientInfos.value)},toAsn1:function(){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,tyt(r.recipients)),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,nyt(r.encryptedContent))])])])},findRecipient:function(e){for(var t=e.issuer.attributes,i=0;i<r.recipients.length;++i){var n=r.recipients[i],s=n.issuer;if(n.serialNumber===e.serialNumber&&s.length===t.length){for(var o=!0,a=0;a<t.length;++a)if(s[a].type!==t[a].type||s[a].value!==t[a].value){o=!1;break}if(o)return n}}return null},decrypt:function(e,t){if(r.encryptedContent.key===void 0&&e!==void 0&&t!==void 0)switch(e.encryptedContent.algorithm){case Ne.pki.oids.rsaEncryption:case Ne.pki.oids.desCBC:var i=t.decrypt(e.encryptedContent.content);r.encryptedContent.key=Ne.util.createBuffer(i);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}k1e(r)},addRecipient:function(e){r.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:Ne.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,t){if(r.encryptedContent.content===void 0){t=t||r.encryptedContent.algorithm,e=e||r.encryptedContent.key;var i,n,s;switch(t){case Ne.pki.oids["aes128-CBC"]:i=16,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["aes192-CBC"]:i=24,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["aes256-CBC"]:i=32,n=16,s=Ne.aes.createEncryptionCipher;break;case Ne.pki.oids["des-EDE3-CBC"]:i=24,n=8,s=Ne.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+t)}if(e===void 0)e=Ne.util.createBuffer(Ne.random.getBytes(i));else if(e.length()!=i)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+i+".");r.encryptedContent.algorithm=t,r.encryptedContent.key=e,r.encryptedContent.parameter=Ne.util.createBuffer(Ne.random.getBytes(n));var o=s(e);if(o.start(r.encryptedContent.parameter.copy()),o.update(r.content),!o.finish())throw new Error("Symmetric encryption failed.");r.encryptedContent.content=o.output}for(var a=0;a<r.recipients.length;++a){var c=r.recipients[a];if(c.encryptedContent.content===void 0)switch(c.encryptedContent.algorithm){case Ne.pki.oids.rsaEncryption:c.encryptedContent.content=c.encryptedContent.key.encrypt(r.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+c.encryptedContent.algorithm)}}}},r};function Z0t(r){var e={},t=[];if(!te.validate(r,jn.asn1.recipientInfoValidator,e,t)){var i=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw i.errors=t,i}return{version:e.version.charCodeAt(0),issuer:Ne.pki.RDNAttributesAsArray(e.issuer),serialNumber:Ne.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:te.derToOid(e.encAlgorithm),parameter:e.encParameter.value,content:e.encKey}}}function J0t(r){return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Ne.pki.distinguishedNameToAsn1({attributes:r.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Ne.util.hexToBytes(r.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.encryptedContent.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")]),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.encryptedContent.content)])}function eyt(r){for(var e=[],t=0;t<r.length;++t)e.push(Z0t(r[t]));return e}function tyt(r){for(var e=[],t=0;t<r.length;++t)e.push(J0t(r[t]));return e}function ryt(r){var e=te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,te.integerToDer(r.version).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[Ne.pki.distinguishedNameToAsn1({attributes:r.issuer}),te.create(te.Class.UNIVERSAL,te.Type.INTEGER,!1,Ne.util.hexToBytes(r.serialNumber))]),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.digestAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])]);if(r.authenticatedAttributesAsn1&&e.value.push(r.authenticatedAttributesAsn1),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.signatureAlgorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.NULL,!1,"")])),e.value.push(te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.signature)),r.unauthenticatedAttributes.length>0){for(var t=te.create(te.Class.CONTEXT_SPECIFIC,1,!0,[]),i=0;i<r.unauthenticatedAttributes.length;++i){var n=r.unauthenticatedAttributes[i];t.values.push(WP(n))}e.value.push(t)}return e}function iyt(r){for(var e=[],t=0;t<r.length;++t)e.push(ryt(r[t]));return e}function WP(r){var e;if(r.type===Ne.pki.oids.contentType)e=te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.value).getBytes());else if(r.type===Ne.pki.oids.messageDigest)e=te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.value.bytes());else if(r.type===Ne.pki.oids.signingTime){var t=new Date("1950-01-01T00:00:00Z"),i=new Date("2050-01-01T00:00:00Z"),n=r.value;if(typeof n=="string"){var s=Date.parse(n);isNaN(s)?n.length===13?n=te.utcTimeToDate(n):n=te.generalizedTimeToDate(n):n=new Date(s)}n>=t&&n<i?e=te.create(te.Class.UNIVERSAL,te.Type.UTCTIME,!1,te.dateToUtcTime(n)):e=te.create(te.Class.UNIVERSAL,te.Type.GENERALIZEDTIME,!1,te.dateToGeneralizedTime(n))}return te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.type).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SET,!0,[e])])}function nyt(r){return[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(Ne.pki.oids.data).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.SEQUENCE,!0,[te.create(te.Class.UNIVERSAL,te.Type.OID,!1,te.oidToDer(r.algorithm).getBytes()),te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.parameter.getBytes())]),te.create(te.Class.CONTEXT_SPECIFIC,0,!0,[te.create(te.Class.UNIVERSAL,te.Type.OCTETSTRING,!1,r.content.getBytes())])]}function YP(r,e,t){var i={},n=[];if(!te.validate(e,t,i,n)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var o=te.derToOid(i.contentType);if(o!==Ne.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(i.encryptedContent){var a="";if(Ne.util.isArray(i.encryptedContent))for(var c=0;c<i.encryptedContent.length;++c){if(i.encryptedContent[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=i.encryptedContent[c].value}else a=i.encryptedContent;r.encryptedContent={algorithm:te.derToOid(i.encAlgorithm),parameter:Ne.util.createBuffer(i.encParameter.value),content:Ne.util.createBuffer(a)}}if(i.content){var a="";if(Ne.util.isArray(i.content))for(var c=0;c<i.content.length;++c){if(i.content[c].type!==te.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=i.content[c].value}else a=i.content;r.content=Ne.util.createBuffer(a)}return r.version=i.version.charCodeAt(0),r.rawCapture=i,i}function k1e(r){if(r.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(r.content===void 0){var e;switch(r.encryptedContent.algorithm){case Ne.pki.oids["aes128-CBC"]:case Ne.pki.oids["aes192-CBC"]:case Ne.pki.oids["aes256-CBC"]:e=Ne.aes.createDecryptionCipher(r.encryptedContent.key);break;case Ne.pki.oids.desCBC:case Ne.pki.oids["des-EDE3-CBC"]:e=Ne.des.createDecryptionCipher(r.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+r.encryptedContent.algorithm)}if(e.start(r.encryptedContent.parameter),e.update(r.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");r.content=e.output}}});var M1e=y((iUt,B1e)=>{f();"use strict";GP();var syt=dt(),D1e=syt.pki,oyt=(r,e)=>{let t=D1e.setRsaPublicKey(e.n,e.e),i=D1e.createCertificate();i.publicKey=t,i.serialNumber="01",i.validity.notBefore=new Date,i.validity.notAfter=new Date,i.validity.notAfter.setFullYear(i.validity.notBefore.getFullYear()+10);let n=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:r.id}];return i.setSubject(n),i.setIssuer(n),i.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),i.sign(e),i};async function ayt(r,e){let t=r.map(e),n=(await Promise.all(t)).findIndex(s=>s);return r[n]}B1e.exports={certificateForKey:oyt,findAsync:ayt}});var K1e=y((nUt,F1e)=>{f();"use strict";N1e();aA();var Wl=dt(),{certificateForKey:cyt,findAsync:uyt}=M1e(),H0=ae(),{fromString:L1e}=(ft(),ht),{toString:lyt}=(tt(),et),XP=new WeakMap,U1e=class{constructor(e,t){if(!e)throw H0(new Error("keychain is required"),"ERR_KEYCHAIN_REQUIRED");this.keychain=e,XP.set(this,{dek:t})}async encrypt(e,t){if(!(t instanceof Uint8Array))throw H0(new Error("Plain data must be a Uint8Array"),"ERR_INVALID_PARAMS");let i=await this.keychain.findKeyByName(e),n=await this.keychain._getPrivateKey(e),s=XP.get(this).dek,o=Wl.pki.decryptRsaPrivateKey(n,s),a=await cyt(i,o),c=Wl.pkcs7.createEnvelopedData();c.addRecipient(a),c.content=Wl.util.createBuffer(t),c.encrypt();let u=Wl.asn1.toDer(c.toAsn1()).getBytes();return L1e(u,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw H0(new Error("CMS data is required"),"ERR_INVALID_PARAMS");let t;try{let u=Wl.util.createBuffer(lyt(e,"ascii")),l=Wl.asn1.fromDer(u);t=Wl.pkcs7.messageFromAsn1(l)}catch(u){throw H0(new Error("Invalid CMS: "+u.message),"ERR_INVALID_CMS")}let i=t.recipients.filter(u=>u.issuer.find(l=>l.shortName==="O"&&l.value==="ipfs")).filter(u=>u.issuer.find(l=>l.shortName==="CN")).map(u=>({recipient:u,keyId:u.issuer.find(l=>l.shortName==="CN").value})),n=await uyt(i,async u=>{try{if(await this.keychain.findKeyById(u.keyId))return!0}catch(l){return!1}return!1});if(!n){let u=i.map(l=>l.keyId);throw H0(new Error("Decryption needs one of the key(s): "+u.join(", ")),"ERR_MISSING_KEYS",{missingKeys:u})}let s=await this.keychain.findKeyById(n.keyId);if(!s)throw H0(new Error("No key available to decrypto"),"ERR_NO_KEY");let o=await this.keychain._getPrivateKey(s.name),a=XP.get(this).dek,c=Wl.pki.decryptRsaPrivateKey(o,a);return t.decrypt(n.recipient,c),L1e(t.content.getBytes(),"ascii")}};F1e.exports=U1e});var W1e=y((sUt,G1e)=>{f();"use strict";var j1e=be(),V1e=Object.assign(j1e("libp2p:keychain"),{error:j1e("libp2p:keychain:err")}),fyt=m1e(),dyt=gr(),Vd=za(),{Key:z1e}=Ut(),hyt=K1e(),Er=ae(),{toString:zd}=(tt(),et),{fromString:Eu}=(ft(),ht);sw();var pyt="/pkcs8/",H1e="/info/",Yl=new WeakMap,Hd={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},QP={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function Su(r){return!r||typeof r!="string"?!1:r===fyt(r.trim())}async function $t(r){let e=200,t=1e3,i=Math.random()*(t-e)+e;throw await new Promise(n=>setTimeout(n,i)),r}function yc(r){return new z1e(pyt+r)}function Xl(r){return new z1e(H1e+r)}var $1e=class{constructor(e,t){if(!e)throw new Error("store is required");if(this.store=e,this.opts=dyt(QP,t),this.opts.pass&&this.opts.pass.length<20)throw new Error("pass must be least 20 characters");if(this.opts.dek.keyLength<Hd.minKeyLength)throw new Error(`dek.keyLength must be least ${Hd.minKeyLength} bytes`);if(this.opts.dek.salt.length<Hd.minSaltLength)throw new Error(`dek.saltLength must be least ${Hd.minSaltLength} bytes`);if(this.opts.dek.iterationCount<Hd.minIterationCount)throw new Error(`dek.iterationCount must be least ${Hd.minIterationCount}`);let i=this.opts.pass?Vd.pbkdf2(this.opts.pass,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Yl.set(this,{dek:i})}get cms(){return new hyt(this,Yl.get(this).dek)}static generateOptions(){let e=Object.assign({},QP),t=Math.ceil(Hd.minSaltLength/3)*3;return e.dek.salt=zd(Vd.randomBytes(t),"base64"),e}static get options(){return QP}async createKey(e,t,i=2048){let n=this;if(!Su(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(typeof t!="string")return $t(Er(new Error(`Invalid key type '${t}'`),"ERR_INVALID_KEY_TYPE"));let s=yc(e);if(await n.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));switch(t.toLowerCase()){case"rsa":if(!Number.isSafeInteger(i)||i<2048)return $t(Er(new Error(`Invalid RSA key size ${i}`),"ERR_INVALID_KEY_SIZE"));break;default:break}let a;try{let c=await Vd.keys.generateKeyPair(t,i),u=await c.id(),l=Yl.get(this).dek,d=await c.export(l);a={name:e,id:u};let h=n.store.batch();h.put(s,Eu(d)),h.put(Xl(e),Eu(JSON.stringify(a))),await h.commit()}catch(c){return $t(c)}return a}async listKeys(){let e=this,t={prefix:H1e},i=[];for await(let n of e.store.query(t))i.push(JSON.parse(zd(n.value)));return i}async findKeyById(e){try{return(await this.listKeys()).find(i=>i.id===e)}catch(t){return $t(t)}}async findKeyByName(e){if(!Su(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let t=Xl(e);try{let i=await this.store.get(t);return JSON.parse(zd(i))}catch(i){return $t(Er(new Error(`Key '${e}' does not exist. ${i.message}`),"ERR_KEY_NOT_FOUND"))}}async removeKey(e){let t=this;if(!Su(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));let i=yc(e),n=await t.findKeyByName(e),s=t.store.batch();return s.delete(i),s.delete(Xl(e)),await s.commit(),n}async renameKey(e,t){let i=this;if(!Su(e)||e==="self")return $t(Er(new Error(`Invalid old key name '${e}'`),"ERR_OLD_KEY_NAME_INVALID"));if(!Su(t)||t==="self")return $t(Er(new Error(`Invalid new key name '${t}'`),"ERR_NEW_KEY_NAME_INVALID"));let n=yc(e),s=yc(t),o=Xl(e),a=Xl(t);if(await i.store.has(s))return $t(Er(new Error(`Key '${t}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let u=await i.store.get(n),l=await i.store.get(o),d=JSON.parse(zd(l));d.name=t;let h=i.store.batch();return h.put(s,u),h.put(a,Eu(JSON.stringify(d))),h.delete(n),h.delete(o),await h.commit(),d}catch(u){return $t(u)}}async exportKey(e,t){if(!Su(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return $t(Er(new Error("Password is required"),"ERR_PASSWORD_REQUIRED"));let i=yc(e);try{let n=await this.store.get(i),s=zd(n),o=Yl.get(this).dek;return(await Vd.keys.import(s,o)).export(t)}catch(n){return $t(n)}}async importKey(e,t,i){let n=this;if(!Su(e)||e==="self")return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t)return $t(Er(new Error("PEM encoded key is required"),"ERR_PEM_REQUIRED"));let s=yc(e);if(await n.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));let a;try{a=await Vd.keys.import(t,i)}catch(d){return $t(Er(new Error("Cannot read the key, most likely the password is wrong"),"ERR_CANNOT_READ_KEY"))}let c;try{c=await a.id();let d=Yl.get(this).dek;t=await a.export(d)}catch(d){return $t(d)}let u={name:e,id:c},l=n.store.batch();return l.put(s,Eu(t)),l.put(Xl(e),Eu(JSON.stringify(u))),await l.commit(),u}async importPeer(e,t){let i=this;if(!Su(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));if(!t||!t.privKey)return $t(Er(new Error("Peer.privKey is required"),"ERR_MISSING_PRIVATE_KEY"));let n=t.privKey,s=yc(e);if(await i.store.has(s))return $t(Er(new Error(`Key '${e}' already exists`),"ERR_KEY_ALREADY_EXISTS"));try{let a=await n.id(),c=Yl.get(this).dek,u=await n.export(c),l={name:e,id:a},d=i.store.batch();return d.put(s,Eu(u)),d.put(Xl(e),Eu(JSON.stringify(l))),await d.commit(),l}catch(a){return $t(a)}}async _getPrivateKey(e){if(!Su(e))return $t(Er(new Error(`Invalid key name '${e}'`),"ERR_INVALID_KEY_NAME"));try{let t=yc(e),i=await this.store.get(t);return zd(i)}catch(t){return $t(Er(new Error(`Key '${e}' does not exist. ${t.message}`),"ERR_KEY_NOT_FOUND"))}}async rotateKeychainPass(e,t){if(typeof e!="string")return $t(Er(new Error(`Invalid old pass type '${typeof e}'`),"ERR_INVALID_OLD_PASS_TYPE"));if(typeof t!="string")return $t(Er(new Error(`Invalid new pass type '${typeof t}'`),"ERR_INVALID_NEW_PASS_TYPE"));if(t.length<20)return $t(Er(new Error(`Invalid pass length ${t.length}`),"ERR_INVALID_PASS_LENGTH"));V1e("recreating keychain");let i=Yl.get(this).dek;this.opts.pass=t;let n=t?Vd.pbkdf2(t,this.opts.dek.salt,this.opts.dek.iterationCount,this.opts.dek.keyLength,this.opts.dek.hash):"";Yl.set(this,{dek:n});let s=await this.listKeys();for(let o of s){let a=await this.store.get(yc(o.name)),c=zd(a),u=await Vd.keys.import(c,i),l=n.toString(),d=await u.export(l),h=this.store.batch(),p={name:o.name,id:o.id};h.put(yc(o.name),Eu(d)),h.put(Xl(o.name),Eu(JSON.stringify(p))),await h.commit()}V1e("keychain reconstructed")}};G1e.exports=$1e});var X1e=y((oUt,Y1e)=>{f();"use strict";var yyt=ym();Y1e.exports=r=>{let e=yyt(r);return e.delete=e.remove,e}});var Z1e=y((Q1e,i3)=>{f();(function(r){"use strict";var e,t=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,n=Math.floor,s="[BigNumber Error] ",o=s+"Number primitive has more than 15 significant digits: ",a=1e14,c=14,u=9007199254740991,l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,h=1e9;function p(q){var N,z,G,Y=X.prototype={constructor:X,toString:null,valueOf:null},C=new X(1),m=20,w=4,S=-7,P=21,B=-1e7,W=1e7,j=!1,M=1,_=0,L={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},ce="0123456789abcdefghijklmnopqrstuvwxyz";function X(k,K){var $,Z,I,U,V,D,Q,ee,J=this;if(!(J instanceof X))return new X(k,K);if(K==null){if(k&&k._isBigNumber===!0){J.s=k.s,!k.c||k.e>W?J.c=J.e=null:k.e<B?J.c=[J.e=0]:(J.e=k.e,J.c=k.c.slice());return}if((D=typeof k=="number")&&k*0==0){if(J.s=1/k<0?(k=-k,-1):1,k===~~k){for(U=0,V=k;V>=10;V/=10,U++);U>W?J.c=J.e=null:(J.e=U,J.c=[k]);return}ee=String(k)}else{if(!t.test(ee=String(k)))return G(J,ee,D);J.s=ee.charCodeAt(0)==45?(ee=ee.slice(1),-1):1}(U=ee.indexOf("."))>-1&&(ee=ee.replace(".","")),(V=ee.search(/e/i))>0?(U<0&&(U=V),U+=+ee.slice(V+1),ee=ee.substring(0,V)):U<0&&(U=ee.length)}else{if(v(K,2,ce.length,"Base"),K==10)return J=new X(k),pe(J,m+J.e+1,w);if(ee=String(k),D=typeof k=="number"){if(k*0!=0)return G(J,ee,D,K);if(J.s=1/k<0?(ee=ee.slice(1),-1):1,X.DEBUG&&ee.replace(/^0\.0*|\./,"").length>15)throw Error(o+k)}else J.s=ee.charCodeAt(0)===45?(ee=ee.slice(1),-1):1;for($=ce.slice(0,K),U=V=0,Q=ee.length;V<Q;V++)if($.indexOf(Z=ee.charAt(V))<0){if(Z=="."){if(V>U){U=Q;continue}}else if(!I&&(ee==ee.toUpperCase()&&(ee=ee.toLowerCase())||ee==ee.toLowerCase()&&(ee=ee.toUpperCase()))){I=!0,V=-1,U=0;continue}return G(J,String(k),D,K)}D=!1,ee=z(ee,K,10,J.s),(U=ee.indexOf("."))>-1?ee=ee.replace(".",""):U=ee.length}for(V=0;ee.charCodeAt(V)===48;V++);for(Q=ee.length;ee.charCodeAt(--Q)===48;);if(ee=ee.slice(V,++Q)){if(Q-=V,D&&X.DEBUG&&Q>15&&(k>u||k!==n(k)))throw Error(o+J.s*k);if((U=U-V-1)>W)J.c=J.e=null;else if(U<B)J.c=[J.e=0];else{if(J.e=U,J.c=[],V=(U+1)%c,U<0&&(V+=c),V<Q){for(V&&J.c.push(+ee.slice(0,V)),Q-=c;V<Q;)J.c.push(+ee.slice(V,V+=c));V=c-(ee=ee.slice(V)).length}else V-=Q;for(;V--;ee+="0");J.c.push(+ee)}}else J.c=[J.e=0]}X.clone=p,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(k){var K,$;if(k!=null)if(typeof k=="object"){if(k.hasOwnProperty(K="DECIMAL_PLACES")&&($=k[K],v($,0,h,K),m=$),k.hasOwnProperty(K="ROUNDING_MODE")&&($=k[K],v($,0,8,K),w=$),k.hasOwnProperty(K="EXPONENTIAL_AT")&&($=k[K],$&&$.pop?(v($[0],-h,0,K),v($[1],0,h,K),S=$[0],P=$[1]):(v($,-h,h,K),S=-(P=$<0?-$:$))),k.hasOwnProperty(K="RANGE"))if($=k[K],$&&$.pop)v($[0],-h,-1,K),v($[1],1,h,K),B=$[0],W=$[1];else if(v($,-h,h,K),$)B=-(W=$<0?-$:$);else throw Error(s+K+" cannot be zero: "+$);if(k.hasOwnProperty(K="CRYPTO"))if($=k[K],$===!!$)if($)if(typeof crypto!="undefined"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))j=$;else throw j=!$,Error(s+"crypto unavailable");else j=$;else throw Error(s+K+" not true or false: "+$);if(k.hasOwnProperty(K="MODULO_MODE")&&($=k[K],v($,0,9,K),M=$),k.hasOwnProperty(K="POW_PRECISION")&&($=k[K],v($,0,h,K),_=$),k.hasOwnProperty(K="FORMAT"))if($=k[K],typeof $=="object")L=$;else throw Error(s+K+" not an object: "+$);if(k.hasOwnProperty(K="ALPHABET"))if($=k[K],typeof $=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test($))ce=$;else throw Error(s+K+" invalid: "+$)}else throw Error(s+"Object expected: "+k);return{DECIMAL_PLACES:m,ROUNDING_MODE:w,EXPONENTIAL_AT:[S,P],RANGE:[B,W],CRYPTO:j,MODULO_MODE:M,POW_PRECISION:_,FORMAT:L,ALPHABET:ce}},X.isBigNumber=function(k){if(!k||k._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var K,$,Z=k.c,I=k.e,U=k.s;e:if({}.toString.call(Z)=="[object Array]"){if((U===1||U===-1)&&I>=-h&&I<=h&&I===n(I)){if(Z[0]===0){if(I===0&&Z.length===1)return!0;break e}if(K=(I+1)%c,K<1&&(K+=c),String(Z[0]).length==K){for(K=0;K<Z.length;K++)if($=Z[K],$<0||$>=a||$!==n($))break e;if($!==0)return!0}}}else if(Z===null&&I===null&&(U===null||U===1||U===-1))return!0;throw Error(s+"Invalid BigNumber: "+k)},X.maximum=X.max=function(){return oe(arguments,Y.lt)},X.minimum=X.min=function(){return oe(arguments,Y.gt)},X.random=function(){var k=9007199254740992,K=Math.random()*k&2097151?function(){return n(Math.random()*k)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function($){var Z,I,U,V,D,Q=0,ee=[],J=new X(C);if($==null?$=m:v($,0,h),V=i($/c),j)if(crypto.getRandomValues){for(Z=crypto.getRandomValues(new Uint32Array(V*=2));Q<V;)D=Z[Q]*131072+(Z[Q+1]>>>11),D>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),Z[Q]=I[0],Z[Q+1]=I[1]):(ee.push(D%1e14),Q+=2);Q=V/2}else if(crypto.randomBytes){for(Z=crypto.randomBytes(V*=7);Q<V;)D=(Z[Q]&31)*281474976710656+Z[Q+1]*1099511627776+Z[Q+2]*4294967296+Z[Q+3]*16777216+(Z[Q+4]<<16)+(Z[Q+5]<<8)+Z[Q+6],D>=9e15?crypto.randomBytes(7).copy(Z,Q):(ee.push(D%1e14),Q+=7);Q=V/7}else throw j=!1,Error(s+"crypto unavailable");if(!j)for(;Q<V;)D=K(),D<9e15&&(ee[Q++]=D%1e14);for(V=ee[--Q],$%=c,V&&$&&(D=l[c-$],ee[Q]=n(V/D)*D);ee[Q]===0;ee.pop(),Q--);if(Q<0)ee=[U=0];else{for(U=-1;ee[0]===0;ee.splice(0,1),U-=c);for(Q=1,D=ee[0];D>=10;D/=10,Q++);Q<c&&(U-=c-Q)}return J.e=U,J.c=ee,J}}(),X.sum=function(){for(var k=1,K=arguments,$=new X(K[0]);k<K.length;)$=$.plus(K[k++]);return $},z=function(){var k="0123456789";function K($,Z,I,U){for(var V,D=[0],Q,ee=0,J=$.length;ee<J;){for(Q=D.length;Q--;D[Q]*=Z);for(D[0]+=U.indexOf($.charAt(ee++)),V=0;V<D.length;V++)D[V]>I-1&&(D[V+1]==null&&(D[V+1]=0),D[V+1]+=D[V]/I|0,D[V]%=I)}return D.reverse()}return function($,Z,I,U,V){var D,Q,ee,J,ue,ge,me,je,Re=$.indexOf("."),Ve=m,Je=w;for(Re>=0&&(J=_,_=0,$=$.replace(".",""),je=new X(Z),ge=je.pow($.length-Re),_=J,je.c=K(F(b(ge.c),ge.e,"0"),10,I,k),je.e=je.c.length),me=K($,Z,I,V?(D=ce,k):(D=k,ce)),ee=J=me.length;me[--J]==0;me.pop());if(!me[0])return D.charAt(0);if(Re<0?--ee:(ge.c=me,ge.e=ee,ge.s=U,ge=N(ge,je,Ve,Je,I),me=ge.c,ue=ge.r,ee=ge.e),Q=ee+Ve+1,Re=me[Q],J=I/2,ue=ue||Q<0||me[Q+1]!=null,ue=Je<4?(Re!=null||ue)&&(Je==0||Je==(ge.s<0?3:2)):Re>J||Re==J&&(Je==4||ue||Je==6&&me[Q-1]&1||Je==(ge.s<0?8:7)),Q<1||!me[0])$=ue?F(D.charAt(1),-Ve,D.charAt(0)):D.charAt(0);else{if(me.length=Q,ue)for(--I;++me[--Q]>I;)me[Q]=0,Q||(++ee,me=[1].concat(me));for(J=me.length;!me[--J];);for(Re=0,$="";Re<=J;$+=D.charAt(me[Re++]));$=F($,ee,D.charAt(0))}return $}}(),N=function(){function k(Z,I,U){var V,D,Q,ee,J=0,ue=Z.length,ge=I%d,me=I/d|0;for(Z=Z.slice();ue--;)Q=Z[ue]%d,ee=Z[ue]/d|0,V=me*Q+ee*ge,D=ge*Q+V%d*d+J,J=(D/U|0)+(V/d|0)+me*ee,Z[ue]=D%U;return J&&(Z=[J].concat(Z)),Z}function K(Z,I,U,V){var D,Q;if(U!=V)Q=U>V?1:-1;else for(D=Q=0;D<U;D++)if(Z[D]!=I[D]){Q=Z[D]>I[D]?1:-1;break}return Q}function $(Z,I,U,V){for(var D=0;U--;)Z[U]-=D,D=Z[U]<I[U]?1:0,Z[U]=D*V+Z[U]-I[U];for(;!Z[0]&&Z.length>1;Z.splice(0,1));}return function(Z,I,U,V,D){var Q,ee,J,ue,ge,me,je,Re,Ve,Je,He,ze,gt,Yt,ir,Tn,zt,At=Z.s==I.s?1:-1,Qr=Z.c,nt=I.c;if(!Qr||!Qr[0]||!nt||!nt[0])return new X(!Z.s||!I.s||(Qr?nt&&Qr[0]==nt[0]:!nt)?NaN:Qr&&Qr[0]==0||!nt?At*0:At/0);for(Re=new X(At),Ve=Re.c=[],ee=Z.e-I.e,At=U+ee+1,D||(D=a,ee=g(Z.e/c)-g(I.e/c),At=At/c|0),J=0;nt[J]==(Qr[J]||0);J++);if(nt[J]>(Qr[J]||0)&&ee--,At<0)Ve.push(1),ue=!0;else{for(Yt=Qr.length,Tn=nt.length,J=0,At+=2,ge=n(D/(nt[0]+1)),ge>1&&(nt=k(nt,ge,D),Qr=k(Qr,ge,D),Tn=nt.length,Yt=Qr.length),gt=Tn,Je=Qr.slice(0,Tn),He=Je.length;He<Tn;Je[He++]=0);zt=nt.slice(),zt=[0].concat(zt),ir=nt[0],nt[1]>=D/2&&ir++;do{if(ge=0,Q=K(nt,Je,Tn,He),Q<0){if(ze=Je[0],Tn!=He&&(ze=ze*D+(Je[1]||0)),ge=n(ze/ir),ge>1)for(ge>=D&&(ge=D-1),me=k(nt,ge,D),je=me.length,He=Je.length;K(me,Je,je,He)==1;)ge--,$(me,Tn<je?zt:nt,je,D),je=me.length,Q=1;else ge==0&&(Q=ge=1),me=nt.slice(),je=me.length;if(je<He&&(me=[0].concat(me)),$(Je,me,He,D),He=Je.length,Q==-1)for(;K(nt,Je,Tn,He)<1;)ge++,$(Je,Tn<He?zt:nt,He,D),He=Je.length}else Q===0&&(ge++,Je=[0]);Ve[J++]=ge,Je[0]?Je[He++]=Qr[gt]||0:(Je=[Qr[gt]],He=1)}while((gt++<Yt||Je[0]!=null)&&At--);ue=Je[0]!=null,Ve[0]||Ve.splice(0,1)}if(D==a){for(J=1,At=Ve[0];At>=10;At/=10,J++);pe(Re,U+(Re.e=J+ee*c-1)+1,V,ue)}else Re.e=ee,Re.r=+ue;return Re}}();function ne(k,K,$,Z){var I,U,V,D,Q;if($==null?$=w:v($,0,8),!k.c)return k.toString();if(I=k.c[0],V=k.e,K==null)Q=b(k.c),Q=Z==1||Z==2&&(V<=S||V>=P)?R(Q,V):F(Q,V,"0");else if(k=pe(new X(k),K,$),U=k.e,Q=b(k.c),D=Q.length,Z==1||Z==2&&(K<=U||U<=S)){for(;D<K;Q+="0",D++);Q=R(Q,U)}else if(K-=V,Q=F(Q,U,"0"),U+1>D){if(--K>0)for(Q+=".";K--;Q+="0");}else if(K+=U-D,K>0)for(U+1==D&&(Q+=".");K--;Q+="0");return k.s<0&&I?"-"+Q:Q}function oe(k,K){for(var $,Z=1,I=new X(k[0]);Z<k.length;Z++)if($=new X(k[Z]),$.s)K.call(I,$)&&(I=$);else{I=$;break}return I}function he(k,K,$){for(var Z=1,I=K.length;!K[--I];K.pop());for(I=K[0];I>=10;I/=10,Z++);return($=Z+$*c-1)>W?k.c=k.e=null:$<B?k.c=[k.e=0]:(k.e=$,k.c=K),k}G=function(){var k=/^(-?)0([xbo])(?=\w[\w.]*$)/i,K=/^([^.]+)\.$/,$=/^\.([^.]+)$/,Z=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(U,V,D,Q){var ee,J=D?V:V.replace(I,"");if(Z.test(J))U.s=isNaN(J)?null:J<0?-1:1;else{if(!D&&(J=J.replace(k,function(ue,ge,me){return ee=(me=me.toLowerCase())=="x"?16:me=="b"?2:8,!Q||Q==ee?ge:ue}),Q&&(ee=Q,J=J.replace(K,"$1").replace($,"0.$1")),V!=J))return new X(J,ee);if(X.DEBUG)throw Error(s+"Not a"+(Q?" base "+Q:"")+" number: "+V);U.s=null}U.c=U.e=null}}();function pe(k,K,$,Z){var I,U,V,D,Q,ee,J,ue=k.c,ge=l;if(ue){e:{for(I=1,D=ue[0];D>=10;D/=10,I++);if(U=K-I,U<0)U+=c,V=K,Q=ue[ee=0],J=Q/ge[I-V-1]%10|0;else if(ee=i((U+1)/c),ee>=ue.length)if(Z){for(;ue.length<=ee;ue.push(0));Q=J=0,I=1,U%=c,V=U-c+1}else break e;else{for(Q=D=ue[ee],I=1;D>=10;D/=10,I++);U%=c,V=U-c+I,J=V<0?0:Q/ge[I-V-1]%10|0}if(Z=Z||K<0||ue[ee+1]!=null||(V<0?Q:Q%ge[I-V-1]),Z=$<4?(J||Z)&&($==0||$==(k.s<0?3:2)):J>5||J==5&&($==4||Z||$==6&&(U>0?V>0?Q/ge[I-V]:0:ue[ee-1])%10&1||$==(k.s<0?8:7)),K<1||!ue[0])return ue.length=0,Z?(K-=k.e+1,ue[0]=ge[(c-K%c)%c],k.e=-K||0):ue[0]=k.e=0,k;if(U==0?(ue.length=ee,D=1,ee--):(ue.length=ee+1,D=ge[c-U],ue[ee]=V>0?n(Q/ge[I-V]%ge[V])*D:0),Z)for(;;)if(ee==0){for(U=1,V=ue[0];V>=10;V/=10,U++);for(V=ue[0]+=D,D=1;V>=10;V/=10,D++);U!=D&&(k.e++,ue[0]==a&&(ue[0]=1));break}else{if(ue[ee]+=D,ue[ee]!=a)break;ue[ee--]=0,D=1}for(U=ue.length;ue[--U]===0;ue.pop());}k.e>W?k.c=k.e=null:k.e<B&&(k.c=[k.e=0])}return k}function _e(k){var K,$=k.e;return $===null?k.toString():(K=b(k.c),K=$<=S||$>=P?R(K,$):F(K,$,"0"),k.s<0?"-"+K:K)}return Y.absoluteValue=Y.abs=function(){var k=new X(this);return k.s<0&&(k.s=1),k},Y.comparedTo=function(k,K){return E(this,new X(k,K))},Y.decimalPlaces=Y.dp=function(k,K){var $,Z,I,U=this;if(k!=null)return v(k,0,h),K==null?K=w:v(K,0,8),pe(new X(U),k+U.e+1,K);if(!($=U.c))return null;if(Z=((I=$.length-1)-g(this.e/c))*c,I=$[I])for(;I%10==0;I/=10,Z--);return Z<0&&(Z=0),Z},Y.dividedBy=Y.div=function(k,K){return N(this,new X(k,K),m,w)},Y.dividedToIntegerBy=Y.idiv=function(k,K){return N(this,new X(k,K),0,1)},Y.exponentiatedBy=Y.pow=function(k,K){var $,Z,I,U,V,D,Q,ee,J,ue=this;if(k=new X(k),k.c&&!k.isInteger())throw Error(s+"Exponent not an integer: "+_e(k));if(K!=null&&(K=new X(K)),D=k.e>14,!ue.c||!ue.c[0]||ue.c[0]==1&&!ue.e&&ue.c.length==1||!k.c||!k.c[0])return J=new X(Math.pow(+_e(ue),D?2-A(k):+_e(k))),K?J.mod(K):J;if(Q=k.s<0,K){if(K.c?!K.c[0]:!K.s)return new X(NaN);Z=!Q&&ue.isInteger()&&K.isInteger(),Z&&(ue=ue.mod(K))}else{if(k.e>9&&(ue.e>0||ue.e<-1||(ue.e==0?ue.c[0]>1||D&&ue.c[1]>=24e7:ue.c[0]<8e13||D&&ue.c[0]<=9999975e7)))return U=ue.s<0&&A(k)?-0:0,ue.e>-1&&(U=1/U),new X(Q?1/U:U);_&&(U=i(_/c+2))}for(D?($=new X(.5),Q&&(k.s=1),ee=A(k)):(I=Math.abs(+_e(k)),ee=I%2),J=new X(C);;){if(ee){if(J=J.times(ue),!J.c)break;U?J.c.length>U&&(J.c.length=U):Z&&(J=J.mod(K))}if(I){if(I=n(I/2),I===0)break;ee=I%2}else if(k=k.times($),pe(k,k.e+1,1),k.e>14)ee=A(k);else{if(I=+_e(k),I===0)break;ee=I%2}ue=ue.times(ue),U?ue.c&&ue.c.length>U&&(ue.c.length=U):Z&&(ue=ue.mod(K))}return Z?J:(Q&&(J=C.div(J)),K?J.mod(K):U?pe(J,_,w,V):J)},Y.integerValue=function(k){var K=new X(this);return k==null?k=w:v(k,0,8),pe(K,K.e+1,k)},Y.isEqualTo=Y.eq=function(k,K){return E(this,new X(k,K))===0},Y.isFinite=function(){return!!this.c},Y.isGreaterThan=Y.gt=function(k,K){return E(this,new X(k,K))>0},Y.isGreaterThanOrEqualTo=Y.gte=function(k,K){return(K=E(this,new X(k,K)))===1||K===0},Y.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},Y.isLessThan=Y.lt=function(k,K){return E(this,new X(k,K))<0},Y.isLessThanOrEqualTo=Y.lte=function(k,K){return(K=E(this,new X(k,K)))===-1||K===0},Y.isNaN=function(){return!this.s},Y.isNegative=function(){return this.s<0},Y.isPositive=function(){return this.s>0},Y.isZero=function(){return!!this.c&&this.c[0]==0},Y.minus=function(k,K){var $,Z,I,U,V=this,D=V.s;if(k=new X(k,K),K=k.s,!D||!K)return new X(NaN);if(D!=K)return k.s=-K,V.plus(k);var Q=V.e/c,ee=k.e/c,J=V.c,ue=k.c;if(!Q||!ee){if(!J||!ue)return J?(k.s=-K,k):new X(ue?V:NaN);if(!J[0]||!ue[0])return ue[0]?(k.s=-K,k):new X(J[0]?V:w==3?-0:0)}if(Q=g(Q),ee=g(ee),J=J.slice(),D=Q-ee){for((U=D<0)?(D=-D,I=J):(ee=Q,I=ue),I.reverse(),K=D;K--;I.push(0));I.reverse()}else for(Z=(U=(D=J.length)<(K=ue.length))?D:K,D=K=0;K<Z;K++)if(J[K]!=ue[K]){U=J[K]<ue[K];break}if(U&&(I=J,J=ue,ue=I,k.s=-k.s),K=(Z=ue.length)-($=J.length),K>0)for(;K--;J[$++]=0);for(K=a-1;Z>D;){if(J[--Z]<ue[Z]){for($=Z;$&&!J[--$];J[$]=K);--J[$],J[Z]+=a}J[Z]-=ue[Z]}for(;J[0]==0;J.splice(0,1),--ee);return J[0]?he(k,J,ee):(k.s=w==3?-1:1,k.c=[k.e=0],k)},Y.modulo=Y.mod=function(k,K){var $,Z,I=this;return k=new X(k,K),!I.c||!k.s||k.c&&!k.c[0]?new X(NaN):!k.c||I.c&&!I.c[0]?new X(I):(M==9?(Z=k.s,k.s=1,$=N(I,k,0,3),k.s=Z,$.s*=Z):$=N(I,k,0,M),k=I.minus($.times(k)),!k.c[0]&&M==1&&(k.s=I.s),k)},Y.multipliedBy=Y.times=function(k,K){var $,Z,I,U,V,D,Q,ee,J,ue,ge,me,je,Re,Ve,Je=this,He=Je.c,ze=(k=new X(k,K)).c;if(!He||!ze||!He[0]||!ze[0])return!Je.s||!k.s||He&&!He[0]&&!ze||ze&&!ze[0]&&!He?k.c=k.e=k.s=null:(k.s*=Je.s,!He||!ze?k.c=k.e=null:(k.c=[0],k.e=0)),k;for(Z=g(Je.e/c)+g(k.e/c),k.s*=Je.s,Q=He.length,ue=ze.length,Q<ue&&(je=He,He=ze,ze=je,I=Q,Q=ue,ue=I),I=Q+ue,je=[];I--;je.push(0));for(Re=a,Ve=d,I=ue;--I>=0;){for($=0,ge=ze[I]%Ve,me=ze[I]/Ve|0,V=Q,U=I+V;U>I;)ee=He[--V]%Ve,J=He[V]/Ve|0,D=me*ee+J*ge,ee=ge*ee+D%Ve*Ve+je[U]+$,$=(ee/Re|0)+(D/Ve|0)+me*J,je[U--]=ee%Re;je[U]=$}return $?++Z:je.splice(0,1),he(k,je,Z)},Y.negated=function(){var k=new X(this);return k.s=-k.s||null,k},Y.plus=function(k,K){var $,Z=this,I=Z.s;if(k=new X(k,K),K=k.s,!I||!K)return new X(NaN);if(I!=K)return k.s=-K,Z.minus(k);var U=Z.e/c,V=k.e/c,D=Z.c,Q=k.c;if(!U||!V){if(!D||!Q)return new X(I/0);if(!D[0]||!Q[0])return Q[0]?k:new X(D[0]?Z:I*0)}if(U=g(U),V=g(V),D=D.slice(),I=U-V){for(I>0?(V=U,$=Q):(I=-I,$=D),$.reverse();I--;$.push(0));$.reverse()}for(I=D.length,K=Q.length,I-K<0&&($=Q,Q=D,D=$,K=I),I=0;K;)I=(D[--K]=D[K]+Q[K]+I)/a|0,D[K]=a===D[K]?0:D[K]%a;return I&&(D=[I].concat(D),++V),he(k,D,V)},Y.precision=Y.sd=function(k,K){var $,Z,I,U=this;if(k!=null&&k!==!!k)return v(k,1,h),K==null?K=w:v(K,0,8),pe(new X(U),k,K);if(!($=U.c))return null;if(I=$.length-1,Z=I*c+1,I=$[I]){for(;I%10==0;I/=10,Z--);for(I=$[0];I>=10;I/=10,Z++);}return k&&U.e+1>Z&&(Z=U.e+1),Z},Y.shiftedBy=function(k){return v(k,-u,u),this.times("1e"+k)},Y.squareRoot=Y.sqrt=function(){var k,K,$,Z,I,U=this,V=U.c,D=U.s,Q=U.e,ee=m+4,J=new X("0.5");if(D!==1||!V||!V[0])return new X(!D||D<0&&(!V||V[0])?NaN:V?U:1/0);if(D=Math.sqrt(+_e(U)),D==0||D==1/0?(K=b(V),(K.length+Q)%2==0&&(K+="0"),D=Math.sqrt(+K),Q=g((Q+1)/2)-(Q<0||Q%2),D==1/0?K="5e"+Q:(K=D.toExponential(),K=K.slice(0,K.indexOf("e")+1)+Q),$=new X(K)):$=new X(D+""),$.c[0]){for(Q=$.e,D=Q+ee,D<3&&(D=0);;)if(I=$,$=J.times(I.plus(N(U,I,ee,1))),b(I.c).slice(0,D)===(K=b($.c)).slice(0,D))if($.e<Q&&--D,K=K.slice(D-3,D+1),K=="9999"||!Z&&K=="4999"){if(!Z&&(pe(I,I.e+m+2,0),I.times(I).eq(U))){$=I;break}ee+=4,D+=4,Z=1}else{(!+K||!+K.slice(1)&&K.charAt(0)=="5")&&(pe($,$.e+m+2,1),k=!$.times($).eq(U));break}}return pe($,$.e+m+1,w,k)},Y.toExponential=function(k,K){return k!=null&&(v(k,0,h),k++),ne(this,k,K,1)},Y.toFixed=function(k,K){return k!=null&&(v(k,0,h),k=k+this.e+1),ne(this,k,K)},Y.toFormat=function(k,K,$){var Z,I=this;if($==null)k!=null&&K&&typeof K=="object"?($=K,K=null):k&&typeof k=="object"?($=k,k=K=null):$=L;else if(typeof $!="object")throw Error(s+"Argument not an object: "+$);if(Z=I.toFixed(k,K),I.c){var U,V=Z.split("."),D=+$.groupSize,Q=+$.secondaryGroupSize,ee=$.groupSeparator||"",J=V[0],ue=V[1],ge=I.s<0,me=ge?J.slice(1):J,je=me.length;if(Q&&(U=D,D=Q,Q=U,je-=U),D>0&&je>0){for(U=je%D||D,J=me.substr(0,U);U<je;U+=D)J+=ee+me.substr(U,D);Q>0&&(J+=ee+me.slice(U)),ge&&(J="-"+J)}Z=ue?J+($.decimalSeparator||"")+((Q=+$.fractionGroupSize)?ue.replace(new RegExp("\\d{"+Q+"}\\B","g"),"$&"+($.fractionGroupSeparator||"")):ue):J}return($.prefix||"")+Z+($.suffix||"")},Y.toFraction=function(k){var K,$,Z,I,U,V,D,Q,ee,J,ue,ge,me=this,je=me.c;if(k!=null&&(D=new X(k),!D.isInteger()&&(D.c||D.s!==1)||D.lt(C)))throw Error(s+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+_e(D));if(!je)return new X(me);for(K=new X(C),ee=$=new X(C),Z=Q=new X(C),ge=b(je),U=K.e=ge.length-me.e-1,K.c[0]=l[(V=U%c)<0?c+V:V],k=!k||D.comparedTo(K)>0?U>0?K:ee:D,V=W,W=1/0,D=new X(ge),Q.c[0]=0;J=N(D,K,0,1),I=$.plus(J.times(Z)),I.comparedTo(k)!=1;)$=Z,Z=I,ee=Q.plus(J.times(I=ee)),Q=I,K=D.minus(J.times(I=K)),D=I;return I=N(k.minus($),Z,0,1),Q=Q.plus(I.times(ee)),$=$.plus(I.times(Z)),Q.s=ee.s=me.s,U=U*2,ue=N(ee,Z,U,w).minus(me).abs().comparedTo(N(Q,$,U,w).minus(me).abs())<1?[ee,Z]:[Q,$],W=V,ue},Y.toNumber=function(){return+_e(this)},Y.toPrecision=function(k,K){return k!=null&&v(k,1,h),ne(this,k,K,2)},Y.toString=function(k){var K,$=this,Z=$.s,I=$.e;return I===null?Z?(K="Infinity",Z<0&&(K="-"+K)):K="NaN":(k==null?K=I<=S||I>=P?R(b($.c),I):F(b($.c),I,"0"):k===10?($=pe(new X($),m+I+1,w),K=F(b($.c),$.e,"0")):(v(k,2,ce.length,"Base"),K=z(F(b($.c),I,"0"),10,k,Z,!0)),Z<0&&$.c[0]&&(K="-"+K)),K},Y.valueOf=Y.toJSON=function(){return _e(this)},Y._isBigNumber=!0,q!=null&&X.set(q),X}function g(q){var N=q|0;return q>0||q===N?N:N-1}function b(q){for(var N,z,G=1,Y=q.length,C=q[0]+"";G<Y;){for(N=q[G++]+"",z=c-N.length;z--;N="0"+N);C+=N}for(Y=C.length;C.charCodeAt(--Y)===48;);return C.slice(0,Y+1||1)}function E(q,N){var z,G,Y=q.c,C=N.c,m=q.s,w=N.s,S=q.e,P=N.e;if(!m||!w)return null;if(z=Y&&!Y[0],G=C&&!C[0],z||G)return z?G?0:-w:m;if(m!=w)return m;if(z=m<0,G=S==P,!Y||!C)return G?0:!Y^z?1:-1;if(!G)return S>P^z?1:-1;for(w=(S=Y.length)<(P=C.length)?S:P,m=0;m<w;m++)if(Y[m]!=C[m])return Y[m]>C[m]^z?1:-1;return S==P?0:S>P^z?1:-1}function v(q,N,z,G){if(q<N||q>z||q!==n(q))throw Error(s+(G||"Argument")+(typeof q=="number"?q<N||q>z?" out of range: ":" not an integer: ":" not a primitive number: ")+String(q))}function A(q){var N=q.c.length-1;return g(q.e/c)==N&&q.c[N]%2!=0}function R(q,N){return(q.length>1?q.charAt(0)+"."+q.slice(1):q)+(N<0?"e":"e+")+N}function F(q,N,z){var G,Y;if(N<0){for(Y=z+".";++N;Y+=z);q=Y+q}else if(G=q.length,++N>G){for(Y=z,N-=G;--N;Y+=z);q+=Y}else N<G&&(q=q.slice(0,N)+"."+q.slice(N));return q}e=p(),e.default=e.BigNumber=e,typeof define=="function"&&define.amd?define(function(){return e}):typeof i3!="undefined"&&i3.exports?i3.exports=e:(r||(r=typeof self!="undefined"&&self?self:window),r.BigNumber=e)})(Q1e)});var ZP=y((J1e,eve)=>{f();"use strict";var gyt=Math.exp;J1e=eve.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let t,i=0,n=0,s=0,o,a={};function c(u,l){return 1-gyt(-(u-l)/e)}return a.push=function(l,d){if(o){let h=c(l,o),p=d-t,g=h*p;t=h*d+(1-h)*t,i=(1-h)*(i+p*g),n=Math.sqrt(i),s=t+h*p}else t=d;o=l},a.movingAverage=function(){return t},a.variance=function(){return i},a.deviation=function(){return n},a.forecast=function(){return s},a}});var nve=y((aUt,ive)=>{f();"use strict";var{EventEmitter:myt}=yr(),{BigNumber:n3}=Z1e(),tve=ZP(),byt=OP(),rve=class extends myt{constructor(e,t){super();this._options=t,this._queue=[],this._stats={dataReceived:n3(0),dataSent:n3(0)},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this);let i=this._options.movingAverageIntervals;for(let n=0;n<e.length;n++){let s=e[n];this._stats[s]=n3(0),this._movingAverages[s]={};for(let o=0;o<i.length;o++){let a=i[o];(this._movingAverages[s][a]=tve(a)).push(this._frequencyLastTime,0)}}}start(){this._queue.length&&this._resetComputeTimeout()}stop(){this._timeout&&(this._timeout.clear(),this._timeout=null)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}toJSON(){let e=this.snapshot,t=this.movingAverages,i={dataReceived:e.dataReceived.toString(),dataSent:e.dataSent.toString(),movingAverages:{}},n=Object.keys(t);for(let s of n){i.movingAverages[s]={};for(let o of Object.keys(t[s]))i.movingAverages[s][o]=t[s][o].movingAverage()}return i}push(e,t){this._queue.push([e,t,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this._timeout=byt(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(e of this._queue)this._applyOp(e);this._queue=[],this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=n/(t||1)*1e3,a=this._movingAverages[e];a||(a=this._movingAverages[e]={});let c=this._options.movingAverageIntervals;for(let u=0;u<c.length;u++){let l=c[u],d=a[l];d||(d=a[l]=tve(l)),d.push(i,o)}}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);let n;Object.prototype.hasOwnProperty.call(this._stats,t)?n=this._stats[t]:n=this._stats[t]=n3(0),this._stats[t]=n.plus(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};ive.exports=rve});var ave=y((cUt,ove)=>{f();"use strict";var vyt=gr(),{pipe:wyt}=Ar(),{tap:sve}=jp(),_yt=X1e(),{METRICS:Eyt}=jS(),JP=nve(),eO=["dataReceived","dataSent"],Syt={in:"dataReceived",out:"dataSent"},s3=class{constructor(e){this._options=vyt(Eyt,e),this._globalStats=new JP(eO,this._options),this._peerStats=new Map,this._protocolStats=new Map,this._oldPeers=_yt(this._options.maxOldPeersRetention),this._running=!1,this._onMessage=this._onMessage.bind(this),this._connectionManager=e.connectionManager,this._connectionManager.on("peer:disconnect",t=>{this.onPeerDisconnected(t.remotePeer)})}start(){this._running=!0}stop(){this._running=!1,this._globalStats.stop();for(let e of this._peerStats.values())e.stop();for(let e of this._protocolStats.values())e.stop()}get global(){return this._globalStats}get peers(){return Array.from(this._peerStats.keys())}forPeer(e){let t=e.toB58String();return this._peerStats.get(t)||this._oldPeers.get(t)}get protocols(){return Array.from(this._protocolStats.keys())}forProtocol(e){return this._protocolStats.get(e)}onPeerDisconnected(e){let t=e.toB58String(),i=this._peerStats.get(t);i&&(i.stop(),this._peerStats.delete(t),this._oldPeers.set(t,i))}_onMessage({remotePeer:e,protocol:t,direction:i,dataLength:n}){if(!this._running)return;let s=Syt[i],o=this.forPeer(e);if(o||(o=new JP(eO,this._options),this._peerStats.set(e.toB58String(),o)),o.push(s,n),this._globalStats.push(s,n),t){let a=this.forProtocol(t);a||(a=new JP(eO,this._options),this._protocolStats.set(t,a)),a.push(s,n)}}updatePlaceholder(e,t){if(!this._running)return;let i=this.forPeer(e),n=t.toB58String(),s=this.forPeer(t),o=i;s&&(o=s3.mergeStats(s,o),this._oldPeers.delete(n)),this._peerStats.delete(e.toB58String()),this._peerStats.set(n,o),o.start()}trackStream({stream:e,remotePeer:t,protocol:i}){let n=this,s=e.source;e.source=sve(a=>n._onMessage({remotePeer:t,protocol:i,direction:"in",dataLength:a.length}))(s);let o=e.sink;return e.sink=a=>wyt(a,sve(c=>n._onMessage({remotePeer:t,protocol:i,direction:"out",dataLength:c.length})),o),e}static mergeStats(e,t){return e.stop(),t.stop(),e._queue=[...e._queue,...t._queue],e}};ove.exports=s3});var o3=y($d=>{f();"use strict";var cve=bn(),uve=ia(),xyt=Ar(),Ayt=ae(),{fromString:Iyt}=(ft(),ht),Tyt=zf(),lve=Iyt(`
`);$d.encode=r=>uve.encode.single(new cve([r,lve]));$d.write=(r,e)=>r.push($d.encode(e));$d.writeAll=(r,e)=>{r.push(e.reduce((t,i)=>t.append($d.encode(i)),new cve))};$d.read=async r=>{let e=1,t={[Symbol.asyncIterator](){return this},next:()=>r.next(e)},i=s=>{e=s},n=await xyt(t,uve.decode({onLength:i}),Tyt);if(n.get(n.length-1)!==lve[0])throw Ayt(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return n.shallowSlice(0,-1)}});var dve=y((lUt,fve)=>{f();"use strict";var $0=be()("mss:select"),Ryt=ae(),G0=o3(),Cyt=F0();fve.exports=async(r,e,t)=>{e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:n,rest:s,stream:o}=Cyt(r),a=e.shift();t?($0('select: write ["%s", "%s"]',t,a),G0.writeAll(n,[t,a])):($0('select: write "%s"',a),G0.write(n,a));let c=(await G0.read(i)).toString();if($0('select: read "%s"',c),c===t&&(c=(await G0.read(i)).toString(),$0('select: read "%s"',c)),c===a)return s(),{stream:o,protocol:a};for(let u of e){$0('select: write "%s"',u),G0.write(n,u);let l=(await G0.read(i)).toString();if($0('select: read "%s" for "%s"',l,u),l===u)return s(),{stream:o,protocol:u}}throw s(),Ryt(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}});var tO=y(hve=>{f();"use strict";hve.PROTOCOL_ID="/multistream/1.0.0"});var yve=y((dUt,pve)=>{f();"use strict";var u1=be()("mss:handle"),Pyt=bn(),W0=o3(),Oyt=F0(),{PROTOCOL_ID:rO}=tO();pve.exports=async(r,e)=>{e=Array.isArray(e)?e:[e];let{writer:t,reader:i,rest:n,stream:s}=Oyt(r);for(;;){let o=(await W0.read(i)).toString();if(u1('read "%s"',o),o===rO){u1('respond with "%s" for "%s"',rO,o),W0.write(t,rO);continue}if(e.includes(o))return W0.write(t,o),u1('respond with "%s" for "%s"',o,o),n(),{stream:s,protocol:o};if(o==="ls"){W0.write(t,new Pyt(e.map(a=>W0.encode(a)))),u1('respond with "%s" for %s',e,o);continue}W0.write(t,"na"),u1('respond with "na" for "%s"',o)}}});var bve=y((hUt,mve)=>{f();"use strict";var kyt=I2(),qyt=be()("it-multistream-select:ls"),gve=o3(),Nyt=F0(),Dyt=ia(),Byt=Ar();mve.exports=async r=>{let{reader:e,writer:t,rest:i,stream:n}=Nyt(r);qyt('write "ls"'),gve.write(t,"ls"),i();let s=await gve.read(e),o=kyt([s]),a=[];return await Byt(o,Dyt.decode(),async c=>{for await(let u of c)a.push(u.shallowSlice(0,-1).toString())}),{stream:n,protocols:a}}});var Eve=y(a3=>{f();"use strict";var vve=dve(),Myt=yve(),Lyt=bve(),{PROTOCOL_ID:iO}=tO();a3.PROTOCOL_ID=iO;var nO=class{constructor(e){this._stream=e,this._shaken=!1}async _handshake(){if(this._shaken)return;let{stream:e}=await vve(this._stream,iO);this._stream=e,this._shaken=!0}},wve=class extends nO{select(e){return vve(this._stream,e,this._shaken?null:iO)}async ls(){await this._handshake();let{stream:e,protocols:t}=await Lyt(this._stream);return this._stream=e,t}};a3.Dialer=wve;var _ve=class extends nO{handle(e){return Myt(this._stream,e)}};a3.Listener=_ve});var xve=y((yUt,Sve)=>{f();"use strict";var Uyt={OPEN:"open",CLOSING:"closing",CLOSED:"closed"};Sve.exports=Uyt});var Pve=y((gUt,Cve)=>{f();"use strict";var Ave=rt(),{Multiaddr:Fyt}=it(),Ts=ae(),{OPEN:Kyt,CLOSING:Ive,CLOSED:sO}=xve(),Tve=Symbol.for("@libp2p/interface-connection/connection"),Rve=class{constructor({localAddr:e,remoteAddr:t,localPeer:i,remotePeer:n,newStream:s,close:o,getStreams:a,stat:c}){jyt(e,i,n,s,o,a,c),this.id=parseInt(String(Math.random()*1e9)).toString(36)+Date.now(),this.localAddr=e,this.remoteAddr=t,this.localPeer=i,this.remotePeer=n,this._stat={...c,status:Kyt},this._newStream=s,this._close=o,this._getStreams=a,this.registry=new Map,this.tags=[]}get[Symbol.toStringTag](){return"Connection"}get[Tve](){return!0}static isConnection(e){return Boolean(e&&e[Tve])}get stat(){return this._stat}get streams(){return this._getStreams()}async newStream(e){if(this.stat.status===Ive)throw Ts(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===sO)throw Ts(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:t,protocol:i}=await this._newStream(e);return this.addStream(t,{protocol:i}),{stream:t,protocol:i}}addStream(e,{protocol:t,metadata:i={}}){this.registry.set(e.id,{protocol:t,...i})}removeStream(e){this.registry.delete(e)}async close(){if(this.stat.status!==sO){if(this._closing)return this._closing;this.stat.status=Ive,this._closing=await this._close(),this._stat.timeline.close=Date.now(),this.stat.status=sO}}};Cve.exports=Rve;function jyt(r,e,t,i,n,s,o){if(r&&!Fyt.isMultiaddr(r))throw Ts(new Error("localAddr must be an instance of multiaddr"),"ERR_INVALID_PARAMETERS");if(!Ave.isPeerId(e))throw Ts(new Error("localPeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(!Ave.isPeerId(t))throw Ts(new Error("remotePeer must be an instance of peer-id"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw Ts(new Error("new stream must be a function"),"ERR_INVALID_PARAMETERS");if(typeof n!="function")throw Ts(new Error("close must be a function"),"ERR_INVALID_PARAMETERS");if(typeof s!="function")throw Ts(new Error("getStreams must be a function"),"ERR_INVALID_PARAMETERS");if(!o)throw Ts(new Error("connection metadata object must be provided"),"ERR_INVALID_PARAMETERS");if(o.direction!=="inbound"&&o.direction!=="outbound")throw Ts(new Error('direction must be "inbound" or "outbound"'),"ERR_INVALID_PARAMETERS");if(!o.timeline)throw Ts(new Error("connection timeline object must be provided in the stat object"),"ERR_INVALID_PARAMETERS");if(!o.timeline.open)throw Ts(new Error("connection open timestamp must be provided"),"ERR_INVALID_PARAMETERS");if(!o.timeline.upgraded)throw Ts(new Error("connection upgraded timestamp must be provided"),"ERR_INVALID_PARAMETERS")}});var kve=y(Ove=>{f();"use strict";Ove.Connection=Pve()});var Nve=y((bUt,qve)=>{f();"use strict";function Vyt(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}else return Array.from(r)}qve.exports=function(e){var t=void 0,i=void 0;function n(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');i=a}function s(a){Object.keys(a).forEach(function(c){var u=a[c];if(typeof u!="function")throw new Error('Trap "'+c+": "+u+'" is not a function');if(!Reflect[c])throw new Error('Trap "'+c+": "+u+'" is not a valid trap')}),t=a}n(function(){}),e&&n(e),s(Reflect);var o=new Proxy({},{get:function(c,u){return function(){for(var l=arguments.length,d=Array(l),h=0;h<l;h++)d[h]=arguments[h];return t[u].apply(null,[i].concat(Vyt(d.slice(1))))}}});return{setTarget:n,setHandler:s,getTarget:function(){return i},getHandler:function(){return t},proxy:new Proxy(i,o)}}});var Uve=y((vUt,Lve)=>{f();"use strict";var Dve=be(),Ai=Object.assign(Dve("libp2p:upgrader"),{error:Dve("libp2p:upgrader:err")}),Gd=ae(),Y0=Eve(),{Connection:zyt}=kve(),Hyt=rt(),{pipe:$yt}=Ar(),Bve=Nve(),{codes:X0}=yi(),Mve=class{constructor({localPeer:e,metrics:t,cryptos:i=new Map,muxers:n=new Map,onConnectionEnd:s=()=>{},onConnection:o=()=>{}}){this.localPeer=e,this.metrics=t,this.cryptos=i,this.muxers=n,this.protector=null,this.protocols=new Map,this.onConnection=o,this.onConnectionEnd=s}async upgradeInbound(e){let t,i,n,s,o,a,c;if(this.metrics){({setTarget:a,proxy:c}=Bve());let l=(Math.random()*1e9).toString(36)+Date.now();a({toB58String:()=>l}),e=this.metrics.trackStream({stream:e,remotePeer:c})}Ai("Starting the inbound connection upgrade");let u=e;this.protector&&(u=await this.protector.protect(e));try{({conn:t,remotePeer:i,protocol:o}=await this._encryptInbound(this.localPeer,u,this.cryptos)),this.muxers.size?{stream:n,Muxer:s}=await this._multiplexInbound(t,this.muxers):n=t}catch(l){throw Ai.error("Failed to upgrade inbound connection",l),await e.close(l),l}return this.metrics&&(this.metrics.updatePlaceholder(c,i),a(i)),Ai("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:o,direction:"inbound",maConn:e,upgradedConn:n,Muxer:s,remotePeer:i})}async upgradeOutbound(e){let t=e.remoteAddr.getPeerId();if(!t)throw Gd(new Error("outbound connection must have a peer id"),X0.ERR_INVALID_MULTIADDR);let i=Hyt.createFromB58String(t),n,s,o,a,c,u,l;if(this.metrics){({setTarget:u,proxy:l}=Bve());let h=(Math.random()*1e9).toString(36)+Date.now();u({toB58String:()=>h}),e=this.metrics.trackStream({stream:e,remotePeer:l})}Ai("Starting the outbound connection upgrade");let d=e;this.protector&&(d=await this.protector.protect(e));try{({conn:n,remotePeer:s,protocol:a}=await this._encryptOutbound(this.localPeer,d,i,this.cryptos)),this.muxers.size?{stream:o,Muxer:c}=await this._multiplexOutbound(n,this.muxers):o=n}catch(h){throw Ai.error("Failed to upgrade outbound connection",h),await e.close(h),h}return this.metrics&&(this.metrics.updatePlaceholder(l,s),u(s)),Ai("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:o,Muxer:c,remotePeer:s})}_createConnection({cryptoProtocol:e,direction:t,maConn:i,upgradedConn:n,Muxer:s,remotePeer:o}){let a,c,u;s&&(a=new s({onStream:async h=>{if(!u)return;let p=new Y0.Listener(h);try{let{stream:g,protocol:b}=await p.handle(Array.from(this.protocols.keys()));Ai("%s: incoming stream opened on %s",t,b),this.metrics&&this.metrics.trackStream({stream:g,remotePeer:o,protocol:b}),u.addStream(h,{protocol:b}),this._onStream({connection:u,stream:{...h,...g},protocol:b})}catch(g){Ai.error(g)}},onStreamEnd:h=>{u.removeStream(h.id)}}),c=async h=>{Ai("%s: starting new stream on %s",t,h);let p=a.newStream(),g=new Y0.Dialer(p);try{let{stream:b,protocol:E}=await g.select(h);return this.metrics&&this.metrics.trackStream({stream:b,remotePeer:o,protocol:E}),{stream:{...p,...b},protocol:E}}catch(b){throw Ai.error("could not create new stream",b),Gd(b,X0.ERR_UNSUPPORTED_PROTOCOL)}},$yt(n,a,n).catch(Ai.error));let l=i.timeline;i.timeline=new Proxy(l,{set:(...h)=>(u&&h[1]==="close"&&h[2]&&!l.close&&(async()=>{try{u.stat.status==="open"&&await u.close()}catch(p){Ai.error(p)}finally{this.onConnectionEnd(u)}})(),Reflect.set(...h))}),i.timeline.upgraded=Date.now();let d=()=>{throw Gd(new Error("connection is not multiplexed"),"ERR_CONNECTION_NOT_MULTIPLEXED")};return u=new zyt({localAddr:i.localAddr,remoteAddr:i.remoteAddr,localPeer:this.localPeer,remotePeer:o,stat:{direction:t,timeline:i.timeline,multiplexer:s&&s.multicodec,encryption:e},newStream:c||d,getStreams:()=>a?a.streams:d(),close:async()=>{await i.close(),a&&a.streams.map(h=>h.abort())}}),this.onConnection(u),u}_onStream({connection:e,stream:t,protocol:i}){this.protocols.get(i)({connection:e,stream:t,protocol:i})}async _encryptInbound(e,t,i){let n=new Y0.Listener(t),s=Array.from(i.keys());Ai("handling inbound crypto protocol selection",s);try{let{stream:o,protocol:a}=await n.handle(s),c=i.get(a);if(Ai("encrypting inbound connection..."),!c)throw new Error(`no crypto module found for ${a}`);return{...await c.secureInbound(e,o),protocol:a}}catch(o){throw Gd(o,X0.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,t,i,n){let s=new Y0.Dialer(t),o=Array.from(n.keys());Ai("selecting outbound crypto protocol",o);try{let{stream:a,protocol:c}=await s.select(o),u=n.get(c);if(Ai("encrypting outbound connection to %j",i),!u)throw new Error(`no crypto module found for ${c}`);return{...await u.secureOutbound(e,a,i),protocol:c}}catch(a){throw Gd(a,X0.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,t){let i=new Y0.Dialer(e),n=Array.from(t.keys());Ai("outbound selecting muxer %s",n);try{let{stream:s,protocol:o}=await i.select(n);Ai("%s selected as muxer protocol",o);let a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Gd(s,X0.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,t){let i=new Y0.Listener(e),n=Array.from(t.keys());Ai("inbound handling muxers %s",n);try{let{stream:s,protocol:o}=await i.handle(n),a=t.get(o);return{stream:s,Muxer:a}}catch(s){throw Gd(s,X0.ERR_MUXER_UNAVAILABLE)}}};Lve.exports=Mve});var l1=y((wUt,Vve)=>{f();"use strict";var oO=ae(),Fve=rt(),{codes:{ERR_INVALID_PARAMETERS:Kve}}=yi(),Gyt=r=>r,jve=class{constructor({peerStore:e,eventName:t,eventProperty:i,eventTransformer:n=Gyt}){this._ps=e,this.eventName=t,this.eventProperty=i,this.eventTransformer=n,this.data=new Map}set(e,t){throw oO(new Error("set must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}_setData(e,t,{emit:i=!0}={}){let n=e.toB58String();this.data.set(n,t),i&&this._emit(e,t)}_emit(e,t){this._ps.emit(this.eventName,{peerId:e,[this.eventProperty]:this.eventTransformer(t)})}get(e){if(!Fve.isPeerId(e))throw oO(new Error("peerId must be an instance of peer-id"),Kve);let t=this.data.get(e.toB58String());return t?[...t]:void 0}delete(e){if(!Fve.isPeerId(e))throw oO(new Error("peerId must be an instance of peer-id"),Kve);return this.data.delete(e.toB58String())?(this._emit(e,[]),!0):!1}};Vve.exports=jve});var Gve=y((_Ut,$ve)=>{f();"use strict";var zve=be(),ua=Object.assign(zve("libp2p:peer-store:address-book"),{error:zve("libp2p:peer-store:address-book:err")}),Q0=ae(),{Multiaddr:Wyt}=it(),c3=rt(),Yyt=l1(),Xyt=HS(),{codes:{ERR_INVALID_PARAMETERS:Z0}}=yi(),Qyt=Yb(),Hve=class extends Yyt{constructor(e){super({peerStore:e,eventName:"change:multiaddrs",eventProperty:"multiaddrs",eventTransformer:t=>t.addresses?t.addresses.map(i=>i.multiaddr):[]});this.data=new Map}consumePeerRecord(e){let t;try{t=Xyt.createFromProtobuf(e.payload)}catch(c){return ua.error("invalid peer record received"),!1}if(!t.peerId.equals(e.peerId))return ua("signing key does not match PeerId in the PeerRecord"),!1;if(!t.multiaddrs||!t.multiaddrs.length)return!1;let i=t.peerId,n=i.toB58String(),o=(this.data.get(n)||{record:void 0}).record;if(o&&o.seqNumber>=t.seqNumber)return!1;let a=this._toAddresses(t.multiaddrs,!0);return this._setData(i,{addresses:a,record:{raw:e.marshal(),seqNumber:t.seqNumber}}),ua(`stored provided peer record for ${n}`),!0}getRawEnvelope(e){let t=this.data.get(e.toB58String());if(!(!t||!t.record||!t.record.raw))return t.record.raw}getPeerRecord(e){let t=this.getRawEnvelope(e);if(!!t)return Qyt.createFromProtobuf(t)}set(e,t){if(!c3.isPeerId(e))throw ua.error("peerId must be an instance of peer-id to store data"),Q0(new Error("peerId must be an instance of peer-id"),Z0);let i=this._toAddresses(t);if(!i.length)return this;let n=e.toB58String(),s=this.data.get(n);return s&&s.addresses&&s.addresses.length===i.length&&s.addresses.filter(a=>i.some(c=>a.multiaddr.equals(c.multiaddr))).length===s.addresses.length?(ua(`the addresses provided to store are equal to the already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ua(`stored provided multiaddrs for ${n}`),s||this._ps.emit("peer",e),this)}add(e,t){if(!c3.isPeerId(e))throw ua.error("peerId must be an instance of peer-id to store data"),Q0(new Error("peerId must be an instance of peer-id"),Z0);let i=this._toAddresses(t),n=e.toB58String();if(!i.length)return this;let s=this.data.get(n);return s&&s.addresses&&(s.addresses.forEach(o=>{i.find(a=>a.multiaddr.equals(o.multiaddr))||i.push(o)}),s.addresses.length===i.length)?(ua(`the addresses provided to store are already stored for ${n}`),this):(this._setData(e,{addresses:i,record:s&&s.record}),ua(`added provided multiaddrs for ${n}`),s&&s.addresses||this._ps.emit("peer",e),this)}get(e){if(!c3.isPeerId(e))throw Q0(new Error("peerId must be an instance of peer-id"),Z0);let t=this.data.get(e.toB58String());return t&&t.addresses?[...t.addresses]:void 0}_toAddresses(e,t=!1){if(!e)throw ua.error("multiaddrs must be provided to store data"),Q0(new Error("multiaddrs must be provided"),Z0);let i=[];return e.forEach(n=>{if(!Wyt.isMultiaddr(n))throw ua.error(`multiaddr ${n} must be an instance of multiaddr`),Q0(new Error(`multiaddr ${n} must be an instance of multiaddr`),Z0);i.find(s=>s.multiaddr.equals(n))||i.push({multiaddr:n,isCertified:t})}),i}getMultiaddrsForPeer(e,t=i=>i){if(!c3.isPeerId(e))throw Q0(new Error("peerId must be an instance of peer-id"),Z0);let i=this.data.get(e.toB58String());if(!(!i||!i.addresses))return t(i.addresses||[]).map(n=>{let s=n.multiaddr,o=s.getPeerId();return o&&o===e.toB58String()?s:s.encapsulate(`/p2p/${e.toB58String()}`)})}};$ve.exports=Hve});var twe=y((EUt,ewe)=>{f();"use strict";var Wve=be(),Yve=Object.assign(Wve("libp2p:peer-store:key-book"),{error:Wve("libp2p:peer-store:key-book:err")}),Xve=ae(),Qve=rt(),Zyt=l1(),{codes:{ERR_INVALID_PARAMETERS:Zve}}=yi(),Jve=class extends Zyt{constructor(e){super({peerStore:e,eventName:"change:pubkey",eventProperty:"pubkey",eventTransformer:t=>t.pubKey});this.data=new Map}set(e,t){if(!Qve.isPeerId(e))throw Yve.error("peerId must be an instance of peer-id to store data"),Xve(new Error("peerId must be an instance of peer-id"),Zve);let i=e.toB58String();return!this.data.get(i)&&t&&(e.pubKey=t,this._setData(e,e),Yve(`stored provided public key for ${i}`)),this}get(e){if(!Qve.isPeerId(e))throw Xve(new Error("peerId must be an instance of peer-id"),Zve);let t=this.data.get(e.toB58String());return t?t.pubKey:void 0}};ewe.exports=Jve});var swe=y((SUt,nwe)=>{f();"use strict";var rwe=be(),aO=Object.assign(rwe("libp2p:peer-store:proto-book"),{error:rwe("libp2p:peer-store:proto-book:err")}),J0=ae(),{equals:Jyt}=(di(),fi),f1=rt(),egt=l1(),{codes:{ERR_INVALID_PARAMETERS:ey}}=yi(),iwe=class extends egt{constructor(e){super({peerStore:e,eventName:"change:metadata",eventProperty:"metadata"});this.data=new Map}set(e,t,i){if(!f1.isPeerId(e))throw aO.error("peerId must be an instance of peer-id to store data"),J0(new Error("peerId must be an instance of peer-id"),ey);if(typeof t!="string"||!(i instanceof Uint8Array))throw aO.error("valid key and value must be provided to store data"),J0(new Error("valid key and value must be provided"),ey);return this._setValue(e,t,i),this}_setValue(e,t,i,{emit:n=!0}={}){let s=e.toB58String(),o=this.data.get(s)||new Map,a=o.get(t);if(a&&Jyt(i,a)){aO(`the metadata provided to store is equal to the already stored for ${s} on ${t}`);return}o.set(t,i),this.data.set(s,o),n&&this._emit(e,t)}get(e){if(!f1.isPeerId(e))throw J0(new Error("peerId must be an instance of peer-id"),ey);return this.data.get(e.toB58String())}getValue(e,t){if(!f1.isPeerId(e))throw J0(new Error("peerId must be an instance of peer-id"),ey);let i=this.data.get(e.toB58String());return i&&i.get(t)}delete(e){if(!f1.isPeerId(e))throw J0(new Error("peerId must be an instance of peer-id"),ey);return this.data.delete(e.toB58String())?(this._emit(e),!0):!1}deleteValue(e,t){if(!f1.isPeerId(e))throw J0(new Error("peerId must be an instance of peer-id"),ey);let i=this.data.get(e.toB58String());return!i||!i.delete(t)?!1:(this._emit(e,t),!0)}};nwe.exports=iwe});var uwe=y((xUt,cwe)=>{f();"use strict";var owe=be(),la=Object.assign(owe("libp2p:peer-store:proto-book"),{error:owe("libp2p:peer-store:proto-book:err")}),ty=ae(),cO=rt(),tgt=l1(),{codes:{ERR_INVALID_PARAMETERS:ry}}=yi(),awe=class extends tgt{constructor(e){super({peerStore:e,eventName:"change:protocols",eventProperty:"protocols",eventTransformer:t=>Array.from(t)});this.data=new Map}set(e,t){if(!cO.isPeerId(e))throw la.error("peerId must be an instance of peer-id to store data"),ty(new Error("peerId must be an instance of peer-id"),ry);if(!t)throw la.error("protocols must be provided to store data"),ty(new Error("protocols must be provided"),ry);let i=e.toB58String(),n=this.data.get(i),s=new Set(t);return n&&((a,c)=>a.size===c.size&&[...a].every(u=>c.has(u)))(n,s)?(la(`the protocols provided to store are equal to the already stored for ${i}`),this):(this._setData(e,s),la(`stored provided protocols for ${i}`),this)}add(e,t){if(!cO.isPeerId(e))throw la.error("peerId must be an instance of peer-id to store data"),ty(new Error("peerId must be an instance of peer-id"),ry);if(!t)throw la.error("protocols must be provided to store data"),ty(new Error("protocols must be provided"),ry);let i=e.toB58String(),n=this.data.get(i)||new Set,s=new Set([...n,...t]);return n.size===s.size?(la(`the protocols provided to store are already stored for ${i}`),this):(this._setData(e,s),la(`added provided protocols for ${i}`),this)}remove(e,t){if(!cO.isPeerId(e))throw la.error("peerId must be an instance of peer-id to store data"),ty(new Error("peerId must be an instance of peer-id"),ry);if(!t)throw la.error("protocols must be provided to store data"),ty(new Error("protocols must be provided"),ry);let i=e.toB58String(),n=this.data.get(i);if(n){let s=new Set([...n].filter(o=>!t.includes(o)));if(n.size===s.size)return this;this._setData(e,s),la(`removed provided protocols for ${i}`)}return this}};cwe.exports=awe});var uO=y((AUt,dwe)=>{f();"use strict";var rgt=ae(),{EventEmitter:igt}=yr(),lwe=rt(),ngt=Gve(),sgt=twe(),ogt=swe(),agt=uwe(),{codes:{ERR_INVALID_PARAMETERS:cgt}}=yi(),fwe=class extends igt{constructor({peerId:e}){super();this._peerId=e,this.addressBook=new ngt(this),this.keyBook=new sgt(this),this.metadataBook=new ogt(this),this.protoBook=new agt(this)}start(){}stop(){}get peers(){let e=new Set([...this.addressBook.data.keys(),...this.keyBook.data.keys(),...this.protoBook.data.keys(),...this.metadataBook.data.keys()]);this._peerId&&e.delete(this._peerId.toB58String());let t=new Map;return e.forEach(i=>{t.set(i,this.get(lwe.createFromB58String(i)))}),t}delete(e){let t=this.addressBook.delete(e),i=this.keyBook.delete(e),n=this.protoBook.delete(e),s=this.metadataBook.delete(e);return t||i||n||s}get(e){if(!lwe.isPeerId(e))throw rgt(new Error("peerId must be an instance of peer-id"),cgt);let t=this.keyBook.data.get(e.toB58String()),i=this.addressBook.get(e),n=this.metadataBook.get(e),s=this.protoBook.get(e);if(!(!t&&!i&&!n&&!s))return{id:t||e,addresses:i||[],protocols:s||[],metadata:n}}};dwe.exports=fwe});var pwe=y((IUt,hwe)=>{f();"use strict";function ugt(r,e,t){let i=new r(e,t);i._subscribeAdapter=i.subscribe,i._unsubscribeAdapter=i.unsubscribe;function n(o,a){a&&i.on(o,a),i._subscribeAdapter(o)}function s(o,a){a?i.removeListener(o,a):i.removeAllListeners(o),i.listenerCount(o)===0&&i._unsubscribeAdapter(o)}return i.subscribe=n,i.unsubscribe=s,i}hwe.exports=ugt});var ywe=y((TUt,iy)=>{f();"use strict";iy.exports.NAMESPACE_COMMON="/peers/";iy.exports.NAMESPACE_ADDRESS="/peers/addrs/";iy.exports.NAMESPACE_KEYS="/peers/keys/";iy.exports.NAMESPACE_METADATA="/peers/metadata/";iy.exports.NAMESPACE_PROTOCOL="/peers/protos/"});var mwe=y((RUt,gwe)=>{f();"use strict";var Ql=ki(),ny=Ql.Reader,lO=Ql.Writer,Wr=Ql.util,Ii=Ql.roots["libp2p-address-book"]||(Ql.roots["libp2p-address-book"]={});Ii.Addresses=function(){function r(e){if(this.addrs=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.addrs=Wr.emptyArray,r.prototype.certifiedRecord=null,r.encode=function(t,i){if(i||(i=lO.create()),t.addrs!=null&&t.addrs.length)for(var n=0;n<t.addrs.length;++n)Ii.Addresses.Address.encode(t.addrs[n],i.uint32(10).fork()).ldelim();return t.certifiedRecord!=null&&Object.hasOwnProperty.call(t,"certifiedRecord")&&Ii.Addresses.CertifiedRecord.encode(t.certifiedRecord,i.uint32(18).fork()).ldelim(),i},r.decode=function(t,i){t instanceof ny||(t=ny.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Ii.Addresses;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.addrs&&s.addrs.length||(s.addrs=[]),s.addrs.push(Ii.Addresses.Address.decode(t,t.uint32()));break;case 2:s.certifiedRecord=Ii.Addresses.CertifiedRecord.decode(t,t.uint32());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Ii.Addresses)return t;var i=new Ii.Addresses;if(t.addrs){if(!Array.isArray(t.addrs))throw TypeError(".Addresses.addrs: array expected");i.addrs=[];for(var n=0;n<t.addrs.length;++n){if(typeof t.addrs[n]!="object")throw TypeError(".Addresses.addrs: object expected");i.addrs[n]=Ii.Addresses.Address.fromObject(t.addrs[n])}}if(t.certifiedRecord!=null){if(typeof t.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");i.certifiedRecord=Ii.Addresses.CertifiedRecord.fromObject(t.certifiedRecord)}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.addrs=[]),i.defaults&&(n.certifiedRecord=null),t.addrs&&t.addrs.length){n.addrs=[];for(var s=0;s<t.addrs.length;++s)n.addrs[s]=Ii.Addresses.Address.toObject(t.addrs[s],i)}return t.certifiedRecord!=null&&t.hasOwnProperty("certifiedRecord")&&(n.certifiedRecord=Ii.Addresses.CertifiedRecord.toObject(t.certifiedRecord,i)),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ql.util.toJSONOptions)},r.Address=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.multiaddr=Wr.newBuffer([]),e.prototype.isCertified=!1,e.encode=function(i,n){return n||(n=lO.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&n.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&n.uint32(16).bool(i.isCertified),n},e.decode=function(i,n){i instanceof ny||(i=ny.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Addresses.Address;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.multiaddr=i.bytes();break;case 2:o.isCertified=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ii.Addresses.Address)return i;var n=new Ii.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Wr.base64.decode(i.multiaddr,n.multiaddr=Wr.newBuffer(Wr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(n.multiaddr=i.multiaddr)),i.isCertified!=null&&(n.isCertified=Boolean(i.isCertified)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.multiaddr="":(s.multiaddr=[],n.bytes!==Array&&(s.multiaddr=Wr.newBuffer(s.multiaddr))),s.isCertified=!1),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=n.bytes===String?Wr.base64.encode(i.multiaddr,0,i.multiaddr.length):n.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ql.util.toJSONOptions)},e}(),r.CertifiedRecord=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.seq=Wr.Long?Wr.Long.fromBits(0,0,!0):0,e.prototype.raw=Wr.newBuffer([]),e.encode=function(i,n){return n||(n=lO.create()),i.seq!=null&&Object.hasOwnProperty.call(i,"seq")&&n.uint32(8).uint64(i.seq),i.raw!=null&&Object.hasOwnProperty.call(i,"raw")&&n.uint32(18).bytes(i.raw),n},e.decode=function(i,n){i instanceof ny||(i=ny.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Ii.Addresses.CertifiedRecord;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.seq=i.uint64();break;case 2:o.raw=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Ii.Addresses.CertifiedRecord)return i;var n=new Ii.Addresses.CertifiedRecord;return i.seq!=null&&(Wr.Long?(n.seq=Wr.Long.fromValue(i.seq)).unsigned=!0:typeof i.seq=="string"?n.seq=parseInt(i.seq,10):typeof i.seq=="number"?n.seq=i.seq:typeof i.seq=="object"&&(n.seq=new Wr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0))),i.raw!=null&&(typeof i.raw=="string"?Wr.base64.decode(i.raw,n.raw=Wr.newBuffer(Wr.base64.length(i.raw)),0):i.raw.length&&(n.raw=i.raw)),n},e.toObject=function(i,n){n||(n={});var s={};if(n.defaults){if(Wr.Long){var o=new Wr.Long(0,0,!0);s.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else s.seq=n.longs===String?"0":0;n.bytes===String?s.raw="":(s.raw=[],n.bytes!==Array&&(s.raw=Wr.newBuffer(s.raw)))}return i.seq!=null&&i.hasOwnProperty("seq")&&(typeof i.seq=="number"?s.seq=n.longs===String?String(i.seq):i.seq:s.seq=n.longs===String?Wr.Long.prototype.toString.call(i.seq):n.longs===Number?new Wr.LongBits(i.seq.low>>>0,i.seq.high>>>0).toNumber(!0):i.seq),i.raw!=null&&i.hasOwnProperty("raw")&&(s.raw=n.bytes===String?Wr.base64.encode(i.raw,0,i.raw.length):n.bytes===Array?Array.prototype.slice.call(i.raw):i.raw),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ql.util.toJSONOptions)},e}(),r}();gwe.exports=Ii});var wwe=y((CUt,vwe)=>{f();"use strict";var sy=ki(),bwe=sy.Reader,lgt=sy.Writer,fgt=sy.util,d1=sy.roots["libp2p-proto-book"]||(sy.roots["libp2p-proto-book"]={});d1.Protocols=function(){function r(e){if(this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocols=fgt.emptyArray,r.encode=function(t,i){if(i||(i=lgt.create()),t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(10).string(t.protocols[n]);return i},r.decode=function(t,i){t instanceof bwe||(t=bwe.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new d1.Protocols;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof d1.Protocols)return t;var i=new d1.Protocols;if(t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Protocols.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.protocols=[]),t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return n},r.prototype.toJSON=function(){return this.constructor.toObject(this,sy.util.toJSONOptions)},r}();vwe.exports=d1});var Iwe=y((PUt,Awe)=>{f();"use strict";var _we=be(),zi=Object.assign(_we("libp2p:persistent-peer-store"),{error:_we("libp2p:persistent-peer-store:err")}),{Key:u3}=Ut(),{Multiaddr:dgt}=it(),fO=rt(),{base32:hgt}=(sn(),nn),pgt=uO(),{NAMESPACE_ADDRESS:ygt,NAMESPACE_COMMON:ggt,NAMESPACE_KEYS:mgt,NAMESPACE_METADATA:bgt,NAMESPACE_PROTOCOL:vgt}=ywe(),{Addresses:Ewe}=mwe(),{Protocols:Swe}=wwe(),xwe=class extends pgt{constructor({peerId:e,datastore:t,threshold:i=5}){super({peerId:e});this._datastore=t,this._dirtyPeers=new Set,this._dirtyMetadata=new Map,this.threshold=i,this._addDirtyPeer=this._addDirtyPeer.bind(this)}async start(){zi("PeerStore is starting"),this.on("change:protocols",this._addDirtyPeer),this.on("change:multiaddrs",this._addDirtyPeer),this.on("change:pubkey",this._addDirtyPeerKey),this.on("change:metadata",this._addDirtyPeerMetadata);for await(let e of this._datastore.query({prefix:ggt}))await this._processDatastoreEntry(e);zi("PeerStore started")}async stop(){zi("PeerStore is stopping"),this.removeAllListeners(),await this._commitData(),zi("PeerStore stopped")}_addDirtyPeer({peerId:e}){let t=e.toB58String();zi("add dirty peer",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{zi.error("error committing data",i)})}_addDirtyPeerKey({peerId:e}){if(e.hasInlinePublicKey())return;let t=e.toB58String();zi("add dirty peer key",t),this._dirtyPeers.add(t),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(i=>{zi.error("error committing data",i)})}_addDirtyPeerMetadata({peerId:e,metadata:t}){let i=e.toB58String();zi("add dirty metadata peer",i),this._dirtyPeers.add(i);let n=this._dirtyMetadata.get(i)||new Set;n.add(t),this._dirtyMetadata.set(i,n),this._dirtyPeers.size>=this.threshold&&this._commitData().catch(s=>{zi.error("error committing data",s)})}async _commitData(){let e=Array.from(this._dirtyPeers);if(!e.length)return;this._dirtyPeers.clear(),zi("create batch commit");let t=this._datastore.batch();for(let i of e){let n=this.keyBook.data.get(i)||fO.createFromB58String(i);this._batchAddressBook(n,t),!n.hasInlinePublicKey()&&this._batchKeyBook(n,t),this._batchMetadataBook(n,t),this._batchProtoBook(n,t)}await t.commit(),zi("batch committed")}_batchAddressBook(e,t){let i=e.toString(),n=new u3(`${ygt}${i}`),s=this.addressBook.data.get(e.toB58String());try{if(!s){t.delete(n);return}let o=Ewe.encode({addrs:s.addresses.map(a=>({multiaddr:a.multiaddr.bytes,isCertified:a.isCertified})),certifiedRecord:s.record?{seq:s.record.seqNumber,raw:s.record.raw}:void 0}).finish();t.put(n,o)}catch(o){zi.error(o)}}_batchKeyBook(e,t){let i=e.toString(),n=new u3(`${mgt}${i}`);try{if(!e.pubKey){t.delete(n);return}let s=e.marshalPubKey();t.put(n,s)}catch(s){zi.error(s)}}_batchMetadataBook(e,t){let i=e.toString(),n=this._dirtyMetadata.get(e.toB58String())||[];try{n.forEach(s=>{let o=new u3(`${bgt}${i}/${s}`),a=this.metadataBook.getValue(e,s);a?t.put(o,a):t.delete(o)})}catch(s){zi.error(s)}}_batchProtoBook(e,t){let i=e.toString(),n=new u3(`${vgt}${i}`),s=this.protoBook.get(e);try{if(!s){t.delete(n);return}let o=Swe.encode({protocols:s}).finish();t.put(n,o)}catch(o){zi.error(o)}}async _processDatastoreEntry({key:e,value:t}){try{let i=e.toString().split("/"),n=fO.createFromBytes(hgt.decode(i[3])),s;switch(i[2]){case"addrs":s=Ewe.decode(t),this.addressBook._setData(n,{addresses:s.addrs.map(o=>({multiaddr:new dgt(o.multiaddr),isCertified:Boolean(o.isCertified)})),record:s.certifiedRecord?{raw:s.certifiedRecord.raw,seqNumber:s.certifiedRecord.seq}:void 0},{emit:!1});break;case"keys":s=await fO.createFromPubKey(t),this.keyBook._setData(s,s,{emit:!1});break;case"metadata":this.metadataBook._setValue(n,i[4],t,{emit:!1});break;case"protos":s=Swe.decode(t),this.protoBook._setData(n,new Set(s.protocols),{emit:!1});break;default:zi("invalid data persisted for: ",e.toString())}}catch(i){zi.error(i)}}};Awe.exports=xwe});var Pwe=y((OUt,Cwe)=>{f();"use strict";var Twe=be(),wgt=Object.assign(Twe("libp2p:registrar"),{error:Twe("libp2p:registrar:err")}),_gt=ae(),{codes:{ERR_INVALID_PARAMETERS:Egt}}=yi(),Sgt=aC(),Rwe=class{constructor({peerStore:e,connectionManager:t}){this.peerStore=e,this.connectionManager=t,this.topologies=new Map,this._handle=void 0,this._onDisconnect=this._onDisconnect.bind(this),this.connectionManager.on("peer:disconnect",this._onDisconnect)}get handle(){return this._handle}set handle(e){this._handle=e}getConnection(e){return this.connectionManager.get(e)}register(e){if(!Sgt.isTopology(e))throw wgt.error("topology must be an instance of interfaces/topology"),_gt(new Error("topology must be an instance of interfaces/topology"),Egt);let t=(Math.random()*1e9).toString(36)+Date.now();return this.topologies.set(t,e),e.registrar=this,t}unregister(e){return this.topologies.delete(e)}_onDisconnect(e){for(let[,t]of this.topologies)t.disconnect(e.remotePeer)}};Cwe.exports=Rwe});var d3=y((kUt,h1)=>{f();"use strict";var{Buffer:l3}=Vt(),f3=bn();h1.exports=async function*(r){for await(let e of r)l3.isBuffer(e)?yield e:f3.isBufferList(e)?yield e.slice():yield l3.from(e)};h1.exports.toBuffer=h1.exports;h1.exports.toList=async function*(r){for await(let e of r)l3.isBuffer(e)?yield new f3().append(e):f3.isBufferList(e)?yield e:yield new f3().append(l3.from(e))}});var kwe=y((qUt,Owe)=>{f();"use strict";Owe.exports={PROTOCOL:"/ipfs/ping/1.0.0",PING_LENGTH:32,PROTOCOL_VERSION:"1.0.0",PROTOCOL_NAME:"ping"}});var Bwe=y((h3,Dwe)=>{f();"use strict";var qwe=be(),xgt=Object.assign(qwe("libp2p:ping"),{error:qwe("libp2p:ping:err")}),Agt=ae(),Igt=za(),{pipe:Nwe}=Ar(),{toBuffer:Tgt}=d3(),{collect:Rgt,take:Cgt}=jp(),{equals:Pgt}=(di(),fi),{PROTOCOL_NAME:dO,PING_LENGTH:Ogt,PROTOCOL_VERSION:hO}=kwe();async function kgt(r,e){let t=`/${r._config.protocolPrefix}/${dO}/${hO}`;xgt("dialing %s to %s",t,e.toB58String?e.toB58String():e);let i=await r.dial(e),{stream:n}=await i.newStream(t),s=Date.now(),o=Igt.randomBytes(Ogt),[a]=await Nwe([o],n,u=>Cgt(1,u),Tgt,Rgt),c=Date.now();if(!Pgt(o,a))throw Agt(new Error("Received wrong ping ack"),"ERR_WRONG_PING_ACK");return c-s}function qgt(r){r.handle(`/${r._config.protocolPrefix}/${dO}/${hO}`,({stream:e})=>Nwe(e,e))}function Ngt(r){r.unhandle(`/${r._config.protocolPrefix}/${dO}/${hO}`)}h3=Dwe.exports=kgt;h3.mount=qgt;h3.unmount=Ngt});var Uwe=y((NUt,Lwe)=>{f();"use strict";var oy=ki(),Mwe=oy.Reader,Dgt=oy.Writer,Sr=oy.util,p1=oy.roots["libp2p-identify"]||(oy.roots["libp2p-identify"]={});p1.Identify=function(){function r(e){if(this.listenAddrs=[],this.protocols=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.protocolVersion="",r.prototype.agentVersion="",r.prototype.publicKey=Sr.newBuffer([]),r.prototype.listenAddrs=Sr.emptyArray,r.prototype.observedAddr=Sr.newBuffer([]),r.prototype.protocols=Sr.emptyArray,r.prototype.signedPeerRecord=Sr.newBuffer([]),r.encode=function(t,i){if(i||(i=Dgt.create()),t.publicKey!=null&&Object.hasOwnProperty.call(t,"publicKey")&&i.uint32(10).bytes(t.publicKey),t.listenAddrs!=null&&t.listenAddrs.length)for(var n=0;n<t.listenAddrs.length;++n)i.uint32(18).bytes(t.listenAddrs[n]);if(t.protocols!=null&&t.protocols.length)for(var n=0;n<t.protocols.length;++n)i.uint32(26).string(t.protocols[n]);return t.observedAddr!=null&&Object.hasOwnProperty.call(t,"observedAddr")&&i.uint32(34).bytes(t.observedAddr),t.protocolVersion!=null&&Object.hasOwnProperty.call(t,"protocolVersion")&&i.uint32(42).string(t.protocolVersion),t.agentVersion!=null&&Object.hasOwnProperty.call(t,"agentVersion")&&i.uint32(50).string(t.agentVersion),t.signedPeerRecord!=null&&Object.hasOwnProperty.call(t,"signedPeerRecord")&&i.uint32(66).bytes(t.signedPeerRecord),i},r.decode=function(t,i){t instanceof Mwe||(t=Mwe.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new p1.Identify;t.pos<n;){var o=t.uint32();switch(o>>>3){case 5:s.protocolVersion=t.string();break;case 6:s.agentVersion=t.string();break;case 1:s.publicKey=t.bytes();break;case 2:s.listenAddrs&&s.listenAddrs.length||(s.listenAddrs=[]),s.listenAddrs.push(t.bytes());break;case 4:s.observedAddr=t.bytes();break;case 3:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(t.string());break;case 8:s.signedPeerRecord=t.bytes();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof p1.Identify)return t;var i=new p1.Identify;if(t.protocolVersion!=null&&(i.protocolVersion=String(t.protocolVersion)),t.agentVersion!=null&&(i.agentVersion=String(t.agentVersion)),t.publicKey!=null&&(typeof t.publicKey=="string"?Sr.base64.decode(t.publicKey,i.publicKey=Sr.newBuffer(Sr.base64.length(t.publicKey)),0):t.publicKey.length&&(i.publicKey=t.publicKey)),t.listenAddrs){if(!Array.isArray(t.listenAddrs))throw TypeError(".Identify.listenAddrs: array expected");i.listenAddrs=[];for(var n=0;n<t.listenAddrs.length;++n)typeof t.listenAddrs[n]=="string"?Sr.base64.decode(t.listenAddrs[n],i.listenAddrs[n]=Sr.newBuffer(Sr.base64.length(t.listenAddrs[n])),0):t.listenAddrs[n].length&&(i.listenAddrs[n]=t.listenAddrs[n])}if(t.observedAddr!=null&&(typeof t.observedAddr=="string"?Sr.base64.decode(t.observedAddr,i.observedAddr=Sr.newBuffer(Sr.base64.length(t.observedAddr)),0):t.observedAddr.length&&(i.observedAddr=t.observedAddr)),t.protocols){if(!Array.isArray(t.protocols))throw TypeError(".Identify.protocols: array expected");i.protocols=[];for(var n=0;n<t.protocols.length;++n)i.protocols[n]=String(t.protocols[n])}return t.signedPeerRecord!=null&&(typeof t.signedPeerRecord=="string"?Sr.base64.decode(t.signedPeerRecord,i.signedPeerRecord=Sr.newBuffer(Sr.base64.length(t.signedPeerRecord)),0):t.signedPeerRecord.length&&(i.signedPeerRecord=t.signedPeerRecord)),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.listenAddrs=[],n.protocols=[]),i.defaults&&(i.bytes===String?n.publicKey="":(n.publicKey=[],i.bytes!==Array&&(n.publicKey=Sr.newBuffer(n.publicKey))),i.bytes===String?n.observedAddr="":(n.observedAddr=[],i.bytes!==Array&&(n.observedAddr=Sr.newBuffer(n.observedAddr))),n.protocolVersion="",n.agentVersion="",i.bytes===String?n.signedPeerRecord="":(n.signedPeerRecord=[],i.bytes!==Array&&(n.signedPeerRecord=Sr.newBuffer(n.signedPeerRecord)))),t.publicKey!=null&&t.hasOwnProperty("publicKey")&&(n.publicKey=i.bytes===String?Sr.base64.encode(t.publicKey,0,t.publicKey.length):i.bytes===Array?Array.prototype.slice.call(t.publicKey):t.publicKey),t.listenAddrs&&t.listenAddrs.length){n.listenAddrs=[];for(var s=0;s<t.listenAddrs.length;++s)n.listenAddrs[s]=i.bytes===String?Sr.base64.encode(t.listenAddrs[s],0,t.listenAddrs[s].length):i.bytes===Array?Array.prototype.slice.call(t.listenAddrs[s]):t.listenAddrs[s]}if(t.protocols&&t.protocols.length){n.protocols=[];for(var s=0;s<t.protocols.length;++s)n.protocols[s]=t.protocols[s]}return t.observedAddr!=null&&t.hasOwnProperty("observedAddr")&&(n.observedAddr=i.bytes===String?Sr.base64.encode(t.observedAddr,0,t.observedAddr.length):i.bytes===Array?Array.prototype.slice.call(t.observedAddr):t.observedAddr),t.protocolVersion!=null&&t.hasOwnProperty("protocolVersion")&&(n.protocolVersion=t.protocolVersion),t.agentVersion!=null&&t.hasOwnProperty("agentVersion")&&(n.agentVersion=t.agentVersion),t.signedPeerRecord!=null&&t.hasOwnProperty("signedPeerRecord")&&(n.signedPeerRecord=i.bytes===String?Sr.base64.encode(t.signedPeerRecord,0,t.signedPeerRecord.length):i.bytes===Array?Array.prototype.slice.call(t.signedPeerRecord):t.signedPeerRecord),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,oy.util.toJSONOptions)},r}();Lwe.exports=p1});var Wwe=y((DUt,Gwe)=>{f();"use strict";var Fwe=be(),gc=Object.assign(Fwe("libp2p:identify"),{error:Fwe("libp2p:identify:err")}),pO=ae(),p3=ia(),{pipe:y3}=Ar(),{collect:Kwe,take:jwe,consume:Vwe}=jp(),{fromString:ay}=(ft(),ht),Bgt=rt(),{Multiaddr:yO}=it(),{toBuffer:zwe}=d3(),y1=Uwe(),Hwe=Yb(),$we=HS(),{MULTICODEC_IDENTIFY:Mgt,MULTICODEC_IDENTIFY_PUSH:Lgt,IDENTIFY_PROTOCOL_VERSION:Ugt,MULTICODEC_IDENTIFY_PROTOCOL_NAME:Fgt,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME:Kgt,MULTICODEC_IDENTIFY_PROTOCOL_VERSION:jgt,MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION:Vgt}=vP(),{codes:gO}=yi(),Wd=class{static getProtocolStr(e){return{identifyProtocolStr:`/${e._config.protocolPrefix}/${Fgt}/${jgt}`,identifyPushProtocolStr:`/${e._config.protocolPrefix}/${Kgt}/${Vgt}`}}constructor({libp2p:e}){this._libp2p=e,this.peerStore=e.peerStore,this.addressManager=e.addressManager,this.connectionManager=e.connectionManager,this.peerId=e.peerId,this.handleMessage=this.handleMessage.bind(this);let t=Wd.getProtocolStr(e);this.identifyProtocolStr=t.identifyProtocolStr,this.identifyPushProtocolStr=t.identifyPushProtocolStr,this._host={protocolVersion:`${e._config.protocolPrefix}/${Ugt}`,...e._options.host},this.peerStore.metadataBook.set(this.peerId,"AgentVersion",ay(this._host.agentVersion)),this.peerStore.metadataBook.set(this.peerId,"ProtocolVersion",ay(this._host.protocolVersion)),this.connectionManager.on("peer:connect",i=>{this.identify(i).catch(gc.error)}),this.peerStore.on("change:multiaddrs",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()}),this.peerStore.on("change:protocols",({peerId:i})=>{i.toString()===this.peerId.toString()&&this.pushToPeerStore()})}async push(e){let t=await this.peerStore.addressBook.getRawEnvelope(this.peerId),i=this._libp2p.multiaddrs.map(o=>o.bytes),n=this.peerStore.protoBook.get(this.peerId)||[],s=e.map(async o=>{try{let{stream:a}=await o.newStream(this.identifyPushProtocolStr);await y3([y1.Identify.encode({listenAddrs:i,signedPeerRecord:t,protocols:n}).finish()],p3.encode(),a,Vwe)}catch(a){gc.error("could not push identify update to peer",a)}});return Promise.all(s)}pushToPeerStore(){if(!this._libp2p.isStarted())return;let e=[],t;for(let i of this.peerStore.peers.values())i.protocols.includes(this.identifyPushProtocolStr)&&(t=this.connectionManager.get(i.id))&&e.push(t);this.push(e)}async identify(e){let{stream:t}=await e.newStream(this.identifyProtocolStr),[i]=await y3([],t,p3.decode(),jwe(1),zwe,Kwe);if(!i)throw pO(new Error("No data could be retrieved"),gO.ERR_CONNECTION_ENDED);let n;try{n=y1.Identify.decode(i)}catch(h){throw pO(h,gO.ERR_INVALID_MESSAGE)}let{publicKey:s,listenAddrs:o,protocols:a,observedAddr:c,signedPeerRecord:u}=n,l=await Bgt.createFromPubKey(s);if(e.remotePeer.toB58String()!==l.toB58String())throw pO(new Error("identified peer does not match the expected peer"),gO.ERR_INVALID_PEER);let d=Wd.getCleanMultiaddr(c);try{let h=await Hwe.openAndCertify(u,$we.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(h)){this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",ay(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",ay(n.protocolVersion));return}}catch(h){gc("received invalid envelope, discard it and fallback to listenAddrs is available",h)}try{this.peerStore.addressBook.set(l,o.map(h=>new yO(h)))}catch(h){gc.error("received invalid addrs",h)}this.peerStore.protoBook.set(l,a),this.peerStore.metadataBook.set(l,"AgentVersion",ay(n.agentVersion)),this.peerStore.metadataBook.set(l,"ProtocolVersion",ay(n.protocolVersion)),gc("received observed address of %s",d)}handleMessage({connection:e,stream:t,protocol:i}){switch(i){case this.identifyProtocolStr:return this._handleIdentify({connection:e,stream:t});case this.identifyPushProtocolStr:return this._handlePush({connection:e,stream:t});default:gc.error("cannot handle unknown protocol %s",i)}}async _handleIdentify({connection:e,stream:t}){let i=new Uint8Array(0);this.peerId.pubKey&&(i=this.peerId.pubKey.bytes);let n=await this.peerStore.addressBook.getRawEnvelope(this.peerId),s=this.peerStore.protoBook.get(this.peerId)||[],o=y1.Identify.encode({protocolVersion:this._host.protocolVersion,agentVersion:this._host.agentVersion,publicKey:i,listenAddrs:this._libp2p.multiaddrs.map(a=>a.bytes),signedPeerRecord:n,observedAddr:e.remoteAddr.bytes,protocols:s}).finish();try{await y3([o],p3.encode(),t,Vwe)}catch(a){gc.error("could not respond to identify request",a)}}async _handlePush({connection:e,stream:t}){let i;try{let[s]=await y3([],t,p3.decode(),jwe(1),zwe,Kwe);i=y1.Identify.decode(s)}catch(s){return gc.error("received invalid message",s)}let n=e.remotePeer;try{let s=await Hwe.openAndCertify(i.signedPeerRecord,$we.DOMAIN);if(this.peerStore.addressBook.consumePeerRecord(s)){this.peerStore.protoBook.set(n,i.protocols);return}}catch(s){gc("received invalid envelope, discard it and fallback to listenAddrs is available",s)}try{this.peerStore.addressBook.set(n,i.listenAddrs.map(s=>new yO(s)))}catch(s){gc.error("received invalid addrs",s)}this.peerStore.protoBook.set(n,i.protocols)}static getCleanMultiaddr(e){if(e&&e.length>0)try{return new yO(e)}catch(t){return null}return null}},zgt={IDENTIFY:Mgt,IDENTIFY_PUSH:Lgt};Wd.multicodecs=zgt;Wd.Messsage=y1;Gwe.exports=Wd});var Ywe=y(()=>{f()});var Qwe=y(mO=>{f();"use strict";Object.defineProperty(mO,"__esModule",{value:!0});mO.promisify=g3;var Xwe="__ES6-PROMISIFY--CUSTOM-ARGUMENTS__";function g3(r){if(typeof r!="function")throw new TypeError("Argument to promisify must be a function");var e=r[Xwe],t=g3.Promise||Promise;if(typeof t!="function")throw new Error("No Promise implementation found; do you need a polyfill?");return function(){for(var i=this,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return new t(function(a,c){s.push(function(l){if(l)return c(l);for(var d=arguments.length,h=new Array(d>1?d-1:0),p=1;p<d;p++)h[p-1]=arguments[p];if(h.length===1||!e)return a(h[0]);var g={};h.forEach(function(b,E){var v=e[E];v&&(g[v]=b)}),a(g)}),r.apply(i,s)})}}g3.argumentNames=Xwe;g3.Promise=void 0});var Jwe=y((UUt,Zwe)=>{f();"use strict";var Hgt=u6(),m3=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,g1=Hgt(),$gt=m3&&!g1,Ggt=g1&&!m3,Wgt=g1&&m3,Ygt=typeof ya=="function"&&typeof process!="undefined"&&typeof process.release!="undefined"&&process.release.name==="node"&&!g1,Xgt=typeof importScripts=="function"&&typeof self!="undefined"&&typeof WorkerGlobalScope!="undefined"&&self instanceof WorkerGlobalScope,Qgt=typeof process!="undefined"&&typeof process.env!="undefined"&&!1;Zwe.exports={isTest:Qgt,isElectron:g1,isElectronMain:Ggt,isElectronRenderer:Wgt,isNode:Ygt,isBrowser:$gt,isWebWorker:Xgt,isEnvWithDom:m3}});var t_e=y((FUt,e_e)=>{f();function ho(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e_e.exports=ho;ho.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};ho.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};ho.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var i=this;return this._timer=setTimeout(function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout(function(){i._operationTimeoutCb(i._attempts)},i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)},t),this._options.unref&&this._timer.unref(),!0};ho.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};ho.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};ho.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};ho.prototype.start=ho.prototype.try;ho.prototype.errors=function(){return this._errors};ho.prototype.attempts=function(){return this._attempts};ho.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,i=0;i<this._errors.length;i++){var n=this._errors[i],s=n.message,o=(r[s]||0)+1;r[s]=o,o>=t&&(e=n,t=o)}return e}});var r_e=y(Yd=>{f();var Zgt=t_e();Yd.operation=function(r){var e=Yd.timeouts(r);return new Zgt(e,{forever:r&&(r.forever||r.retries===1/0),unref:r&&r.unref,maxRetryTime:r&&r.maxRetryTime})};Yd.timeouts=function(r){if(r instanceof Array)return[].concat(r);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var t in r)e[t]=r[t];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],n=0;n<e.retries;n++)i.push(this.createTimeout(n,e));return r&&r.forever&&!i.length&&i.push(this.createTimeout(n,e)),i.sort(function(s,o){return s-o}),i};Yd.createTimeout=function(r,e){var t=e.randomize?Math.random()+1:1,i=Math.round(t*Math.max(e.minTimeout,1)*Math.pow(e.factor,r));return i=Math.min(i,e.maxTimeout),i};Yd.wrap=function(r,e,t){if(e instanceof Array&&(t=e,e=null),!t){t=[];for(var i in r)typeof r[i]=="function"&&t.push(i)}for(var n=0;n<t.length;n++){var s=t[n],o=r[s];r[s]=function(c){var u=Yd.operation(e),l=Array.prototype.slice.call(arguments,1),d=l.pop();l.push(function(h){u.retry(h)||(h&&(arguments[0]=u.mainError()),d.apply(this,arguments))}),u.attempt(function(){c.apply(r,l)})}.bind(r,o),r[s].options=e}}});var n_e=y((jUt,i_e)=>{f();i_e.exports=r_e()});var o_e=y((VUt,b3)=>{f();"use strict";var Jgt=n_e(),emt=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],bO=class extends Error{constructor(e){super();e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},tmt=(r,e,t)=>{let i=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=i,r},rmt=r=>emt.includes(r),s_e=(r,e)=>new Promise((t,i)=>{e={onFailedAttempt:()=>{},retries:10,...e};let n=Jgt.operation(e);n.attempt(async s=>{try{t(await r(s))}catch(o){if(!(o instanceof Error)){i(new TypeError(`Non-error was thrown: "${o}". You should only throw errors.`));return}if(o instanceof bO)n.stop(),i(o.originalError);else if(o instanceof TypeError&&!rmt(o.message))n.stop(),i(o);else{tmt(o,s,e);try{await e.onFailedAttempt(o)}catch(a){i(a);return}n.retry(o)||i(n.mainError())}}})});b3.exports=s_e;b3.exports.default=s_e;b3.exports.AbortError=bO});var c_e=y((zUt,a_e)=>{f();"use strict";function imt(r){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(r)||/^::1$/.test(r)}a_e.exports=imt});var l_e=y((HUt,u_e)=>{f();"use strict";var nmt=c_e();function smt(r){let{address:e}=r.nodeAddress();return nmt(e)}u_e.exports=smt});var g_e=y(($Ut,y_e)=>{f();"use strict";var omt=Ywe(),f_e=be(),{promisify:vO}=Qwe(),{Multiaddr:amt}=it(),cy=Object.assign(f_e("libp2p:nat"),{error:f_e("libp2p:nat:err")}),{isBrowser:d_e}=Jwe(),wO=o_e(),cmt=wP(),h_e=bP(),umt=ae(),{codes:{ERR_INVALID_PARAMETERS:lmt}}=yi(),fmt=l_e(),_O=7200;function dmt(r=1024,e=65535){return Math.floor(Math.random()*(e-r+1)+r)}var p_e=class{constructor({peerId:e,addressManager:t,transportManager:i,...n}){if(this._peerId=e,this._addressManager=t,this._transportManager=i,this._enabled=n.enabled,this._externalIp=n.externalIp,this._options={description:n.description||`${h_e.name}@${h_e.version} ${this._peerId}`,ttl:n.ttl||_O,autoUpdate:n.keepAlive||!0,gateway:n.gateway,enablePMP:Boolean(n.pmp&&n.pmp.enabled)},this._options.ttl<_O)throw umt(new Error(`NatManager ttl should be at least ${_O} seconds`),lmt)}start(){d_e||!this._enabled||this._start().catch(e=>{cy.error(e)})}async _start(){let e=this._transportManager.getAddrs();for(let t of e){let{family:i,host:n,port:s,transport:o}=t.toOptions();if(!t.isThinWaistAddress()||o!=="tcp"||fmt(t)||i!==4)continue;let a=this._getClient(),c=this._externalIp||await a.externalIp();if(cmt(c))throw new Error(`${c} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=dmt();cy(`opening uPnP connection from ${c}:${u} to ${n}:${s}`),await a.map({publicPort:u,privatePort:s,protocol:o.toUpperCase()}),this._addressManager.addObservedAddr(amt.fromNodeAddress({family:4,address:c,port:u},o))}}_getClient(){if(this._client)return this._client;let e=new omt(this._options),t=vO(e.map.bind(e)),i=vO(e.destroy.bind(e)),n=vO(e.externalIp.bind(e));return this._client={map:(...s)=>wO(()=>t(...s),{onFailedAttempt:cy.error,unref:!0}),destroy:(...s)=>wO(()=>i(...s),{onFailedAttempt:cy.error,unref:!0}),externalIp:(...s)=>wO(()=>n(...s),{onFailedAttempt:cy.error,unref:!0})},this._client}async stop(){if(!(d_e||!this._client))try{await this._client.destroy(),this._client=null}catch(e){cy.error(e)}}};y_e.exports=p_e});var E_e=y((GUt,__e)=>{f();"use strict";var m_e=be(),Rs=Object.assign(m_e("libp2p"),{error:m_e("libp2p:err")}),{EventEmitter:hmt}=yr(),EO=ae(),pmt=rt(),{Multiaddr:ymt}=it(),gmt=Ige(),mmt=Cge(),SO=mP(),{validate:bmt}=Rme(),{codes:v3,messages:vmt}=yi(),wmt=Ome(),_mt=Gme(),b_e=Sbe(),Emt=Bbe(),Smt=c1e(),v_e=W1e(),xmt=ave(),Amt=RP(),Imt=Uve(),Tmt=uO(),Rmt=pwe(),Cmt=Iwe(),Pmt=Pwe(),w3=Bwe(),w_e=Wwe(),Omt=g_e(),{updateSelfPeerRecord:kmt}=IP(),m1=class extends hmt{static async create(e){if(e.peerId)return new m1(e);let t=await pmt.create();return e.peerId=t,new m1(e)}constructor(e){super();if(this._options=bmt(e),this.peerId=this._options.peerId,this.datastore=this._options.datastore,this.peerStore=this.datastore&&this._options.peerStore.persistence?new Cmt({peerId:this.peerId,datastore:this.datastore,...this._options.peerStore}):new Tmt({peerId:this.peerId}),this.addresses=this._options.addresses,this.addressManager=new wmt(this.peerId,this._options.addresses),this.addressManager.on("change:addresses",()=>{kmt(this).catch(i=>{Rs.error("Error updating self peer record",i)})}),this._modules=this._options.modules,this._config=this._options.config,this._transport=[],this._discovery=new Map,this.connectionManager=new _mt(this,{autoDial:this._config.peerDiscovery.autoDial,...this._options.connectionManager}),this._options.metrics.enabled&&(this.metrics=new xmt({...this._options.metrics,connectionManager:this.connectionManager})),this._options.keychain&&this._options.keychain.datastore){Rs("creating keychain");let i=v_e.generateOptions();this.keychain=new v_e(this._options.keychain.datastore,{...i,...this._options.keychain}),Rs("keychain constructed")}if(this.upgrader=new Imt({localPeer:this.peerId,metrics:this.metrics,onConnection:i=>this.connectionManager.onConnect(i),onConnectionEnd:i=>this.connectionManager.onDisconnect(i)}),this.transportManager=new Amt({libp2p:this,upgrader:this.upgrader,faultTolerance:this._options.transportManager.faultTolerance}),this.natManager=new Omt({peerId:this.peerId,addressManager:this.addressManager,transportManager:this.transportManager,...this._options.config.nat}),this.registrar=new Pmt({peerStore:this.peerStore,connectionManager:this.connectionManager}),this.handle=this.handle.bind(this),this.registrar.handle=this.handle,!this._modules.connEncryption||!this._modules.connEncryption.length)throw EO(new Error(vmt.CONN_ENCRYPTION_REQUIRED),v3.CONN_ENCRYPTION_REQUIRED);if(this._modules.connEncryption.forEach(i=>{this.upgrader.cryptos.set(i.protocol,i)}),this.dialer=new Smt({transportManager:this.transportManager,peerStore:this.peerStore,...this._options.dialer}),this._modules.transport.forEach(i=>{let n=i.prototype[Symbol.toStringTag],s=this._config.transport[n];this.transportManager.add(n,i,s)}),this._config.relay.enabled&&(this.transportManager.add(b_e.prototype[Symbol.toStringTag],b_e),this.relay=new Emt(this)),this._modules.streamMuxer&&(this._modules.streamMuxer.forEach(n=>{this.upgrader.muxers.set(n.multicodec,n)}),this.identifyService=new w_e({libp2p:this}),this.handle(Object.values(w_e.getProtocolStr(this)),this.identifyService.handleMessage)),this._modules.connProtector)this.upgrader.protector=this._modules.connProtector;else if(globalThis.process!==void 0&&globalThis.process.env&&globalThis.process.env.LIBP2P_FORCE_PNET)throw new Error("Private network is enforced, but no protector was provided");if(this._modules.dht){let i=this._modules.dht;this._dht=new i({libp2p:this,dialer:this.dialer,peerId:this.peerId,peerStore:this.peerStore,registrar:this.registrar,datastore:this.datastore,...this._config.dht})}if(this._modules.pubsub){let i=this._modules.pubsub;this.pubsub=Rmt(i,this,this._config.pubsub)}this.peerRouting=new gmt(this),this.contentRouting=new mmt(this),w3.mount(this),this._onDiscoveryPeer=this._onDiscoveryPeer.bind(this)}emit(e,...t){return e==="error"&&!this._events.error?(Rs.error(t),!1):super.emit(e,...t)}async start(){Rs("libp2p is starting");try{await this._onStarting(),await this._onDidStart(),Rs("libp2p has started")}catch(e){throw this.emit("error",e),Rs.error("An error occurred starting libp2p",e),await this.stop(),e}}async stop(){Rs("libp2p is stopping");try{this._isStarted=!1,this.relay&&this.relay.stop(),this.peerRouting.stop();for(let e of this._discovery.values())e.removeListener("peer",this._onDiscoveryPeer);await Promise.all(Array.from(this._discovery.values(),e=>e.stop())),this._discovery=new Map,await this.peerStore.stop(),await this.connectionManager.stop(),await Promise.all([this.pubsub&&this.pubsub.stop(),this._dht&&this._dht.stop(),this.metrics&&this.metrics.stop()]),await this.natManager.stop(),await this.transportManager.close(),w3.unmount(this),this.dialer.destroy()}catch(e){e&&(Rs.error(e),this.emit("error",e))}Rs("libp2p has stopped")}async loadKeychain(){if(!!this.keychain)try{await this.keychain.findKeyByName("self")}catch(e){await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this._isStarted}get connections(){return this.connectionManager.connections}dial(e,t){return this._dial(e,t)}async dialProtocol(e,t,i){if(!t||!t.length)throw EO(new Error("no protocols were provided to open a stream"),v3.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this._dial(e,i)).newStream(t)}async _dial(e,t){let{id:i,multiaddrs:n}=SO(e);if(i.equals(this.peerId))throw EO(new Error("Cannot dial self"),v3.ERR_DIALED_SELF);let s=this.connectionManager.get(i);return s?n&&this.peerStore.addressBook.add(i,n):s=await this.dialer.connectToPeer(e,t),s}get multiaddrs(){let e=this.addressManager.getAnnounceAddrs().map(n=>n.toString());e.length||(e=this.transportManager.getAddrs().map(n=>n.toString())),e=e.concat(this.addressManager.getObservedAddrs().map(n=>n.toString()));let t=this._options.addresses.announceFilter,i=new Set(e);return t(Array.from(i).map(n=>new ymt(n)))}async hangUp(e){let{id:t}=SO(e),i=this.connectionManager.connections.get(t.toB58String());!i||await Promise.all(i.map(n=>n.close()))}ping(e){let{id:t,multiaddrs:i}=SO(e);return i?w3(this,i[0]):w3(this,t)}handle(e,t){e=Array.isArray(e)?e:[e],e.forEach(i=>{this.upgrader.protocols.set(i,t)}),this.peerStore.protoBook.add(this.peerId,e)}unhandle(e){e=Array.isArray(e)?e:[e],e.forEach(t=>{this.upgrader.protocols.delete(t)}),this.peerStore.protoBook.remove(this.peerId,e)}async _onStarting(){let e=this.addressManager.getListenAddrs();await this.transportManager.listen(e),this.natManager.start(),await this.peerStore.start(),this._config.pubsub.enabled&&this.pubsub&&this.pubsub.start(),this._config.dht.enabled&&(this._dht&&this._dht.start(),this._dht.on("peer",this._onDiscoveryPeer)),this.metrics&&this.metrics.start()}async _onDidStart(){this._isStarted=!0,this.peerStore.on("peer",e=>{this.emit("peer:discovery",e),this._maybeConnect(e)});for(let e of this.peerStore.peers.values())this.emit("peer:discovery",e.id);this.connectionManager.start(),await this._setupPeerDiscovery(),this.relay&&this.relay.start(),this.peerRouting.start()}_onDiscoveryPeer(e){if(e.id.toB58String()===this.peerId.toB58String()){Rs.error(new Error(v3.ERR_DISCOVERED_SELF));return}e.multiaddrs&&this.peerStore.addressBook.add(e.id,e.multiaddrs),e.protocols&&this.peerStore.protoBook.set(e.id,e.protocols)}async _maybeConnect(e){if(this._config.peerDiscovery.autoDial===!0&&!this.connectionManager.get(e)&&(this._options.connectionManager.minConnections||0)>this.connectionManager.size){Rs("connecting to discovered peer %s",e.toB58String());try{await this.dialer.connectToPeer(e)}catch(i){Rs.error(`could not connect to discovered peer ${e.toB58String()} with ${i}`)}}}async _setupPeerDiscovery(){let e=t=>{let i={enabled:!0};if(t.tag&&this._config.peerDiscovery&&this._config.peerDiscovery[t.tag]&&(i={...i,...this._config.peerDiscovery[t.tag]}),i.enabled&&!this._discovery.has(t.tag)){let n;typeof t=="function"?n=new t(Object.assign({},i,{peerId:this.peerId,libp2p:this})):n=t,n.on("peer",this._onDiscoveryPeer),this._discovery.set(t.tag,n)}};for(let t of this._modules.peerDiscovery||[])e(t);for(let t of this.transportManager.getTransports())t.discovery&&e(t.discovery);await Promise.all(Array.from(this._discovery.values(),t=>t.start()))}};__e.exports=m1});var S_e=y(()=>{f()});var A_e=y((XUt,x_e)=>{f();x_e.exports=typeof WebSocket=="undefined"?S_e():WebSocket});var T_e=y(_3=>{f();"use strict";Object.defineProperty(_3,"__esModule",{value:!0});var I_e=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let t={value:e,done:!1};if(this.pullQueue.length){let i=this.pullQueue.shift();i&&i.resolve(t)}else this.pushQueue.push(Promise.resolve(t)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let t of this.pullQueue)t.reject(e);this.pullQueue.length=0}else{let t=Promise.reject(e);t.catch(()=>{}),this.pushQueue.push(t)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let t=this.pushQueue.shift();return t?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),t):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((i,n)=>{this.pullQueue.push({resolve:i,reject:n})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},xO=class{constructor(e,{highWaterMark:t=100,lowWaterMark:i=1}={}){let n=new I_e;n.highWaterMark=t,n.lowWaterMark=i,n.removeCallback=e({push:s=>n.push(s),stop:()=>n.stop(),fail:s=>n.fail(s),on:(s,o)=>{n.eventHandlers[s]=o}})||(()=>{}),this[Symbol.asyncIterator]=()=>n[Symbol.asyncIterator](),Object.freeze(this)}};_3.EventIterator=xO;_3.default=xO});var R_e=y(b1=>{f();"use strict";Object.defineProperty(b1,"__esModule",{value:!0});var AO=T_e();b1.EventIterator=AO.EventIterator;function qmt(r,e,t){return new AO.EventIterator(({push:i})=>(this.addEventListener(r,i,e),()=>this.removeEventListener(r,i,e)),t)}b1.subscribe=qmt;b1.default=AO.EventIterator});var P_e=y((JUt,C_e)=>{f();var{Buffer:Nmt}=Vt(),{EventIterator:Dmt}=R_e();function Bmt(r){return r instanceof ArrayBuffer||r!=null&&r.constructor!=null&&r.constructor.name==="ArrayBuffer"&&typeof r.byteLength=="number"}C_e.exports=r=>{let e=r.removeEventListener||r.removeListener,t=async function*(){let s=new Dmt(({push:o,stop:a,fail:c})=>(r.addEventListener("message",o),r.addEventListener("error",c),r.addEventListener("close",a),()=>{e.call(r,"message",o),e.call(r,"error",c),e.call(r,"close",a)}),{highWaterMark:1/0});for await(let{data:o}of s)yield Bmt(o)?Nmt.from(o):o}(),i=r.readyState===1,n;return r.addEventListener("open",()=>{i=!0,n=null}),r.addEventListener("close",()=>{i=!1,n=null}),r.addEventListener("error",s=>{i||(n=s)}),t.connected=()=>new Promise((s,o)=>{if(i)return s();if(n)return o(n);let a=l=>{e.call(r,"open",c),e.call(r,"error",u),l()},c=()=>a(s),u=l=>a(()=>o(l));r.addEventListener("open",c),r.addEventListener("error",u)}),t}});var k_e=y((eFt,O_e)=>{f();O_e.exports=async r=>{if(r.readyState>=2)throw new Error("socket closed");if(r.readyState!==1)return new Promise((e,t)=>{let i=r&&(r.removeEventListener||r.removeListener);function n(){typeof i=="function"&&(i.call(r,"open",s),i.call(r,"error",o))}function s(){n(),e()}function o(a){n(),t(a)}r.addEventListener("open",s),r.addEventListener("error",o)})}});var N_e=y((tFt,q_e)=>{f();var Mmt=k_e();q_e.exports=(r,e)=>(e=e||{},e.closeOnEnd=e.closeOnEnd!==!1,async t=>{for await(let i of t){try{await Mmt(r)}catch(n){if(n.message==="socket closed")break;throw n}r.send(i)}if(e.closeOnEnd&&r.readyState<=1)return new Promise((i,n)=>{r.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let o=Object.assign(new Error("ws error"),{event:s});n(o)}}),setTimeout(()=>r.close())})})});var B_e=y((rFt,D_e)=>{f();var Lmt=P_e(),Umt=N_e();D_e.exports=(r,e)=>{e=e||{},e.binaryType?r.binaryType=e.binaryType:e.binary&&(r.binaryType="arraybuffer");let t={sink:Umt(r,e),source:Lmt(r,e),connected:()=>t.source.connected()};return t}});var L_e=y((iFt,M_e)=>{f();var{relative:Fmt}=Ev(),Kmt={http:"ws",https:"wss"},jmt="ws";M_e.exports=(r,e)=>Fmt(r,e,Kmt,jmt)});var U_e=y((nFt,E3)=>{f();"use strict";var Vmt=A_e(),zmt=B_e(),Hmt=L_e();E3.exports=function(r,e={}){let t=typeof window=="undefined"?{}:window.location,i=Hmt(r,t),n=new Vmt(i,e.websocket),s=zmt(n,e);return s.remoteAddress=i,s.close=()=>new Promise((o,a)=>{n.addEventListener("close",o),n.close()}),s.destroy=()=>{n.terminate?n.terminate():n.close()},s.socket=n,s};E3.exports.connect=E3.exports});var K_e=y((sFt,F_e)=>{f();"use strict";F_e.exports=function(){throw new Error("WebSocket Servers can not be created in the browser!")}});var IO=y(Xd=>{f();"use strict";Xd.CODE_P2P=421;Xd.CODE_CIRCUIT=290;Xd.CODE_TCP=6;Xd.CODE_WS=477;Xd.CODE_WSS=478;Xd.CLOSE_TIMEOUT=2e3});var TO=y(uy=>{f();"use strict";Object.defineProperty(uy,"__esModule",{value:!0});uy.isCorrect=uy.isInSubnet=void 0;function $mt(r){return this.subnetMask<r.subnetMask?!1:this.mask(r.subnetMask)===r.mask()}uy.isInSubnet=$mt;function Gmt(r){return function(){return this.addressMinusSuffix!==this.correctForm()?!1:this.subnetMask===r&&!this.parsedSubnet?!0:this.parsedSubnet===String(this.subnetMask)}}uy.isCorrect=Gmt});var RO=y(mc=>{f();"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.RE_SUBNET_STRING=mc.RE_ADDRESS=mc.GROUPS=mc.BITS=void 0;mc.BITS=32;mc.GROUPS=4;mc.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;mc.RE_SUBNET_STRING=/\/\d{1,2}$/});var S3=y(ly=>{f();"use strict";var Wmt=ly&&ly.__extends||function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=n[s])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();Object.defineProperty(ly,"__esModule",{value:!0});ly.AddressError=void 0;var Ymt=function(r){Wmt(e,r);function e(t,i){var n=r.call(this,t)||this;return n.name="AddressError",i!==null&&(n.parseMessage=i),n}return e}(Error);ly.AddressError=Ymt});var CO=y((x3,j_e)=>{f();(function(){var r,e=244837814094590,t=(e&16777215)==15715070;function i(x,T,H){x!=null&&(typeof x=="number"?this.fromNumber(x,T,H):T==null&&typeof x!="string"?this.fromString(x,256):this.fromString(x,T))}function n(){return new i(null)}function s(x,T,H,ie,ye,Ee){for(;--Ee>=0;){var Be=T*this[x++]+H[ie]+ye;ye=Math.floor(Be/67108864),H[ie++]=Be&67108863}return ye}function o(x,T,H,ie,ye,Ee){for(var Be=T&32767,Ke=T>>15;--Ee>=0;){var hr=this[x]&32767,Ci=this[x++]>>15,ks=Ke*hr+Ci*Be;hr=Be*hr+((ks&32767)<<15)+H[ie]+(ye&1073741823),ye=(hr>>>30)+(ks>>>15)+Ke*Ci+(ye>>>30),H[ie++]=hr&1073741823}return ye}function a(x,T,H,ie,ye,Ee){for(var Be=T&16383,Ke=T>>14;--Ee>=0;){var hr=this[x]&16383,Ci=this[x++]>>14,ks=Ke*hr+Ci*Be;hr=Be*hr+((ks&16383)<<14)+H[ie]+ye,ye=(hr>>28)+(ks>>14)+Ke*Ci,H[ie++]=hr&268435455}return ye}var c=typeof navigator!="undefined";c&&t&&navigator.appName=="Microsoft Internet Explorer"?(i.prototype.am=o,r=30):c&&t&&navigator.appName!="Netscape"?(i.prototype.am=s,r=26):(i.prototype.am=a,r=28),i.prototype.DB=r,i.prototype.DM=(1<<r)-1,i.prototype.DV=1<<r;var u=52;i.prototype.FV=Math.pow(2,u),i.prototype.F1=u-r,i.prototype.F2=2*r-u;var l="0123456789abcdefghijklmnopqrstuvwxyz",d=new Array,h,p;for(h="0".charCodeAt(0),p=0;p<=9;++p)d[h++]=p;for(h="a".charCodeAt(0),p=10;p<36;++p)d[h++]=p;for(h="A".charCodeAt(0),p=10;p<36;++p)d[h++]=p;function g(x){return l.charAt(x)}function b(x,T){var H=d[x.charCodeAt(T)];return H??-1}function E(x){for(var T=this.t-1;T>=0;--T)x[T]=this[T];x.t=this.t,x.s=this.s}function v(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0}function A(x){var T=n();return T.fromInt(x),T}function R(x,T){var H;if(T==16)H=4;else if(T==8)H=3;else if(T==256)H=8;else if(T==2)H=1;else if(T==32)H=5;else if(T==4)H=2;else{this.fromRadix(x,T);return}this.t=0,this.s=0;for(var ie=x.length,ye=!1,Ee=0;--ie>=0;){var Be=H==8?x[ie]&255:b(x,ie);if(Be<0){x.charAt(ie)=="-"&&(ye=!0);continue}ye=!1,Ee==0?this[this.t++]=Be:Ee+H>this.DB?(this[this.t-1]|=(Be&(1<<this.DB-Ee)-1)<<Ee,this[this.t++]=Be>>this.DB-Ee):this[this.t-1]|=Be<<Ee,Ee+=H,Ee>=this.DB&&(Ee-=this.DB)}H==8&&(x[0]&128)!=0&&(this.s=-1,Ee>0&&(this[this.t-1]|=(1<<this.DB-Ee)-1<<Ee)),this.clamp(),ye&&i.ZERO.subTo(this,this)}function F(){for(var x=this.s&this.DM;this.t>0&&this[this.t-1]==x;)--this.t}function q(x){if(this.s<0)return"-"+this.negate().toString(x);var T;if(x==16)T=4;else if(x==8)T=3;else if(x==2)T=1;else if(x==32)T=5;else if(x==4)T=2;else return this.toRadix(x);var H=(1<<T)-1,ie,ye=!1,Ee="",Be=this.t,Ke=this.DB-Be*this.DB%T;if(Be-- >0)for(Ke<this.DB&&(ie=this[Be]>>Ke)>0&&(ye=!0,Ee=g(ie));Be>=0;)Ke<T?(ie=(this[Be]&(1<<Ke)-1)<<T-Ke,ie|=this[--Be]>>(Ke+=this.DB-T)):(ie=this[Be]>>(Ke-=T)&H,Ke<=0&&(Ke+=this.DB,--Be)),ie>0&&(ye=!0),ye&&(Ee+=g(ie));return ye?Ee:"0"}function N(){var x=n();return i.ZERO.subTo(this,x),x}function z(){return this.s<0?this.negate():this}function G(x){var T=this.s-x.s;if(T!=0)return T;var H=this.t;if(T=H-x.t,T!=0)return this.s<0?-T:T;for(;--H>=0;)if((T=this[H]-x[H])!=0)return T;return 0}function Y(x){var T=1,H;return(H=x>>>16)!=0&&(x=H,T+=16),(H=x>>8)!=0&&(x=H,T+=8),(H=x>>4)!=0&&(x=H,T+=4),(H=x>>2)!=0&&(x=H,T+=2),(H=x>>1)!=0&&(x=H,T+=1),T}function C(){return this.t<=0?0:this.DB*(this.t-1)+Y(this[this.t-1]^this.s&this.DM)}function m(x,T){var H;for(H=this.t-1;H>=0;--H)T[H+x]=this[H];for(H=x-1;H>=0;--H)T[H]=0;T.t=this.t+x,T.s=this.s}function w(x,T){for(var H=x;H<this.t;++H)T[H-x]=this[H];T.t=Math.max(this.t-x,0),T.s=this.s}function S(x,T){var H=x%this.DB,ie=this.DB-H,ye=(1<<ie)-1,Ee=Math.floor(x/this.DB),Be=this.s<<H&this.DM,Ke;for(Ke=this.t-1;Ke>=0;--Ke)T[Ke+Ee+1]=this[Ke]>>ie|Be,Be=(this[Ke]&ye)<<H;for(Ke=Ee-1;Ke>=0;--Ke)T[Ke]=0;T[Ee]=Be,T.t=this.t+Ee+1,T.s=this.s,T.clamp()}function P(x,T){T.s=this.s;var H=Math.floor(x/this.DB);if(H>=this.t){T.t=0;return}var ie=x%this.DB,ye=this.DB-ie,Ee=(1<<ie)-1;T[0]=this[H]>>ie;for(var Be=H+1;Be<this.t;++Be)T[Be-H-1]|=(this[Be]&Ee)<<ye,T[Be-H]=this[Be]>>ie;ie>0&&(T[this.t-H-1]|=(this.s&Ee)<<ye),T.t=this.t-H,T.clamp()}function B(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]-x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie-=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie-=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie-=x.s}T.s=ie<0?-1:0,ie<-1?T[H++]=this.DV+ie:ie>0&&(T[H++]=ie),T.t=H,T.clamp()}function W(x,T){var H=this.abs(),ie=x.abs(),ye=H.t;for(T.t=ye+ie.t;--ye>=0;)T[ye]=0;for(ye=0;ye<ie.t;++ye)T[ye+H.t]=H.am(0,ie[ye],T,ye,0,H.t);T.s=0,T.clamp(),this.s!=x.s&&i.ZERO.subTo(T,T)}function j(x){for(var T=this.abs(),H=x.t=2*T.t;--H>=0;)x[H]=0;for(H=0;H<T.t-1;++H){var ie=T.am(H,T[H],x,2*H,0,1);(x[H+T.t]+=T.am(H+1,2*T[H],x,2*H+1,ie,T.t-H-1))>=T.DV&&(x[H+T.t]-=T.DV,x[H+T.t+1]=1)}x.t>0&&(x[x.t-1]+=T.am(H,T[H],x,2*H,0,1)),x.s=0,x.clamp()}function M(x,T,H){var ie=x.abs();if(!(ie.t<=0)){var ye=this.abs();if(ye.t<ie.t){T!=null&&T.fromInt(0),H!=null&&this.copyTo(H);return}H==null&&(H=n());var Ee=n(),Be=this.s,Ke=x.s,hr=this.DB-Y(ie[ie.t-1]);hr>0?(ie.lShiftTo(hr,Ee),ye.lShiftTo(hr,H)):(ie.copyTo(Ee),ye.copyTo(H));var Ci=Ee.t,ks=Ee[Ci-1];if(ks!=0){var hs=ks*(1<<this.F1)+(Ci>1?Ee[Ci-2]>>this.F2:0),Rc=this.FV/hs,fv=(1<<this.F1)/hs,So=1<<this.F2,xo=H.t,dv=xo-Ci,Nu=T??n();for(Ee.dlShiftTo(dv,Nu),H.compareTo(Nu)>=0&&(H[H.t++]=1,H.subTo(Nu,H)),i.ONE.dlShiftTo(Ci,Nu),Nu.subTo(Ee,Ee);Ee.t<Ci;)Ee[Ee.t++]=0;for(;--dv>=0;){var Wx=H[--xo]==ks?this.DM:Math.floor(H[xo]*Rc+(H[xo-1]+So)*fv);if((H[xo]+=Ee.am(0,Wx,H,dv,0,Ci))<Wx)for(Ee.dlShiftTo(dv,Nu),H.subTo(Nu,H);H[xo]<--Wx;)H.subTo(Nu,H)}T!=null&&(H.drShiftTo(Ci,T),Be!=Ke&&i.ZERO.subTo(T,T)),H.t=Ci,H.clamp(),hr>0&&H.rShiftTo(hr,H),Be<0&&i.ZERO.subTo(H,H)}}}function _(x){var T=n();return this.abs().divRemTo(x,null,T),this.s<0&&T.compareTo(i.ZERO)>0&&x.subTo(T,T),T}function L(x){this.m=x}function ce(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x}function X(x){return x}function ne(x){x.divRemTo(this.m,null,x)}function oe(x,T,H){x.multiplyTo(T,H),this.reduce(H)}function he(x,T){x.squareTo(T),this.reduce(T)}L.prototype.convert=ce,L.prototype.revert=X,L.prototype.reduce=ne,L.prototype.mulTo=oe,L.prototype.sqrTo=he;function pe(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var T=x&3;return T=T*(2-(x&15)*T)&15,T=T*(2-(x&255)*T)&255,T=T*(2-((x&65535)*T&65535))&65535,T=T*(2-x*T%this.DV)%this.DV,T>0?this.DV-T:-T}function _e(x){this.m=x,this.mp=x.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<x.DB-15)-1,this.mt2=2*x.t}function k(x){var T=n();return x.abs().dlShiftTo(this.m.t,T),T.divRemTo(this.m,null,T),x.s<0&&T.compareTo(i.ZERO)>0&&this.m.subTo(T,T),T}function K(x){var T=n();return x.copyTo(T),this.reduce(T),T}function $(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var T=0;T<this.m.t;++T){var H=x[T]&32767,ie=H*this.mpl+((H*this.mph+(x[T]>>15)*this.mpl&this.um)<<15)&x.DM;for(H=T+this.m.t,x[H]+=this.m.am(0,ie,x,T,0,this.m.t);x[H]>=x.DV;)x[H]-=x.DV,x[++H]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)}function Z(x,T){x.squareTo(T),this.reduce(T)}function I(x,T,H){x.multiplyTo(T,H),this.reduce(H)}_e.prototype.convert=k,_e.prototype.revert=K,_e.prototype.reduce=$,_e.prototype.mulTo=I,_e.prototype.sqrTo=Z;function U(){return(this.t>0?this[0]&1:this.s)==0}function V(x,T){if(x>4294967295||x<1)return i.ONE;var H=n(),ie=n(),ye=T.convert(this),Ee=Y(x)-1;for(ye.copyTo(H);--Ee>=0;)if(T.sqrTo(H,ie),(x&1<<Ee)>0)T.mulTo(ie,ye,H);else{var Be=H;H=ie,ie=Be}return T.revert(H)}function D(x,T){var H;return x<256||T.isEven()?H=new L(T):H=new _e(T),this.exp(x,H)}i.prototype.copyTo=E,i.prototype.fromInt=v,i.prototype.fromString=R,i.prototype.clamp=F,i.prototype.dlShiftTo=m,i.prototype.drShiftTo=w,i.prototype.lShiftTo=S,i.prototype.rShiftTo=P,i.prototype.subTo=B,i.prototype.multiplyTo=W,i.prototype.squareTo=j,i.prototype.divRemTo=M,i.prototype.invDigit=pe,i.prototype.isEven=U,i.prototype.exp=V,i.prototype.toString=q,i.prototype.negate=N,i.prototype.abs=z,i.prototype.compareTo=G,i.prototype.bitLength=C,i.prototype.mod=_,i.prototype.modPowInt=D,i.ZERO=A(0),i.ONE=A(1);function Q(){var x=n();return this.copyTo(x),x}function ee(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function J(){return this.t==0?this.s:this[0]<<24>>24}function ue(){return this.t==0?this.s:this[0]<<16>>16}function ge(x){return Math.floor(Math.LN2*this.DB/Math.log(x))}function me(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function je(x){if(x==null&&(x=10),this.signum()==0||x<2||x>36)return"0";var T=this.chunkSize(x),H=Math.pow(x,T),ie=A(H),ye=n(),Ee=n(),Be="";for(this.divRemTo(ie,ye,Ee);ye.signum()>0;)Be=(H+Ee.intValue()).toString(x).substr(1)+Be,ye.divRemTo(ie,ye,Ee);return Ee.intValue().toString(x)+Be}function Re(x,T){this.fromInt(0),T==null&&(T=10);for(var H=this.chunkSize(T),ie=Math.pow(T,H),ye=!1,Ee=0,Be=0,Ke=0;Ke<x.length;++Ke){var hr=b(x,Ke);if(hr<0){x.charAt(Ke)=="-"&&this.signum()==0&&(ye=!0);continue}Be=T*Be+hr,++Ee>=H&&(this.dMultiply(ie),this.dAddOffset(Be,0),Ee=0,Be=0)}Ee>0&&(this.dMultiply(Math.pow(T,Ee)),this.dAddOffset(Be,0)),ye&&i.ZERO.subTo(this,this)}function Ve(x,T,H){if(typeof T=="number")if(x<2)this.fromInt(1);else for(this.fromNumber(x,H),this.testBit(x-1)||this.bitwiseTo(i.ONE.shiftLeft(x-1),zt,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(T);)this.dAddOffset(2,0),this.bitLength()>x&&this.subTo(i.ONE.shiftLeft(x-1),this);else{var ie=new Array,ye=x&7;ie.length=(x>>3)+1,T.nextBytes(ie),ye>0?ie[0]&=(1<<ye)-1:ie[0]=0,this.fromString(ie,256)}}function Je(){var x=this.t,T=new Array;T[0]=this.s;var H=this.DB-x*this.DB%8,ie,ye=0;if(x-- >0)for(H<this.DB&&(ie=this[x]>>H)!=(this.s&this.DM)>>H&&(T[ye++]=ie|this.s<<this.DB-H);x>=0;)H<8?(ie=(this[x]&(1<<H)-1)<<8-H,ie|=this[--x]>>(H+=this.DB-8)):(ie=this[x]>>(H-=8)&255,H<=0&&(H+=this.DB,--x)),(ie&128)!=0&&(ie|=-256),ye==0&&(this.s&128)!=(ie&128)&&++ye,(ye>0||ie!=this.s)&&(T[ye++]=ie);return T}function He(x){return this.compareTo(x)==0}function ze(x){return this.compareTo(x)<0?this:x}function gt(x){return this.compareTo(x)>0?this:x}function Yt(x,T,H){var ie,ye,Ee=Math.min(x.t,this.t);for(ie=0;ie<Ee;++ie)H[ie]=T(this[ie],x[ie]);if(x.t<this.t){for(ye=x.s&this.DM,ie=Ee;ie<this.t;++ie)H[ie]=T(this[ie],ye);H.t=this.t}else{for(ye=this.s&this.DM,ie=Ee;ie<x.t;++ie)H[ie]=T(ye,x[ie]);H.t=x.t}H.s=T(this.s,x.s),H.clamp()}function ir(x,T){return x&T}function Tn(x){var T=n();return this.bitwiseTo(x,ir,T),T}function zt(x,T){return x|T}function At(x){var T=n();return this.bitwiseTo(x,zt,T),T}function Qr(x,T){return x^T}function nt(x){var T=n();return this.bitwiseTo(x,Qr,T),T}function xr(x,T){return x&~T}function rv(x){var T=n();return this.bitwiseTo(x,xr,T),T}function Ir(){for(var x=n(),T=0;T<this.t;++T)x[T]=this.DM&~this[T];return x.t=this.t,x.s=~this.s,x}function Tr(x){var T=n();return x<0?this.rShiftTo(-x,T):this.lShiftTo(x,T),T}function iv(x){var T=n();return x<0?this.lShiftTo(-x,T):this.rShiftTo(x,T),T}function Rr(x){if(x==0)return-1;var T=0;return(x&65535)==0&&(x>>=16,T+=16),(x&255)==0&&(x>>=8,T+=8),(x&15)==0&&(x>>=4,T+=4),(x&3)==0&&(x>>=2,T+=2),(x&1)==0&&++T,T}function Cr(){for(var x=0;x<this.t;++x)if(this[x]!=0)return x*this.DB+Rr(this[x]);return this.s<0?this.t*this.DB:-1}function nv(x){for(var T=0;x!=0;)x&=x-1,++T;return T}function Pr(){for(var x=0,T=this.s&this.DM,H=0;H<this.t;++H)x+=nv(this[H]^T);return x}function Or(x){var T=Math.floor(x/this.DB);return T>=this.t?this.s!=0:(this[T]&1<<x%this.DB)!=0}function sv(x,T){var H=i.ONE.shiftLeft(x);return this.bitwiseTo(H,T,H),H}function kr(x){return this.changeBit(x,zt)}function qr(x){return this.changeBit(x,xr)}function ov(x){return this.changeBit(x,Qr)}function Nr(x,T){for(var H=0,ie=0,ye=Math.min(x.t,this.t);H<ye;)ie+=this[H]+x[H],T[H++]=ie&this.DM,ie>>=this.DB;if(x.t<this.t){for(ie+=x.s;H<this.t;)ie+=this[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=this.s}else{for(ie+=this.s;H<x.t;)ie+=x[H],T[H++]=ie&this.DM,ie>>=this.DB;ie+=x.s}T.s=ie<0?-1:0,ie>0?T[H++]=ie:ie<-1&&(T[H++]=this.DV+ie),T.t=H,T.clamp()}function Dr(x){var T=n();return this.addTo(x,T),T}function av(x){var T=n();return this.subTo(x,T),T}function Br(x){var T=n();return this.multiplyTo(x,T),T}function Mr(){var x=n();return this.squareTo(x),x}function cv(x){var T=n();return this.divRemTo(x,T,null),T}function Lr(x){var T=n();return this.divRemTo(x,null,T),T}function Ur(x){var T=n(),H=n();return this.divRemTo(x,T,H),new Array(T,H)}function uv(x){this[this.t]=this.am(0,x-1,this,0,0,this.t),++this.t,this.clamp()}function Fr(x,T){if(x!=0){for(;this.t<=T;)this[this.t++]=0;for(this[T]+=x;this[T]>=this.DV;)this[T]-=this.DV,++T>=this.t&&(this[this.t++]=0),++this[T]}}function nr(){}function oh(x){return x}function My(x,T,H){x.multiplyTo(T,H)}function Ly(x,T){x.squareTo(T)}nr.prototype.convert=oh,nr.prototype.revert=oh,nr.prototype.mulTo=My,nr.prototype.sqrTo=Ly;function Uy(x){return this.exp(x,new nr)}function Fy(x,T,H){var ie=Math.min(this.t+x.t,T);for(H.s=0,H.t=ie;ie>0;)H[--ie]=0;var ye;for(ye=H.t-this.t;ie<ye;++ie)H[ie+this.t]=this.am(0,x[ie],H,ie,0,this.t);for(ye=Math.min(x.t,T);ie<ye;++ie)this.am(0,x[ie],H,ie,0,T-ie);H.clamp()}function Ky(x,T,H){--T;var ie=H.t=this.t+x.t-T;for(H.s=0;--ie>=0;)H[ie]=0;for(ie=Math.max(T-this.t,0);ie<x.t;++ie)H[this.t+ie-T]=this.am(T-ie,x[ie],H,0,0,this.t+ie-T);H.clamp(),H.drShiftTo(1,H)}function _o(x){this.r2=n(),this.q3=n(),i.ONE.dlShiftTo(2*x.t,this.r2),this.mu=this.r2.divide(x),this.m=x}function jy(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var T=n();return x.copyTo(T),this.reduce(T),T}function Vy(x){return x}function zy(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)}function Hy(x,T){x.squareTo(T),this.reduce(T)}function $y(x,T,H){x.multiplyTo(T,H),this.reduce(H)}_o.prototype.convert=jy,_o.prototype.revert=Vy,_o.prototype.reduce=zy,_o.prototype.mulTo=$y,_o.prototype.sqrTo=Hy;function Gy(x,T){var H=x.bitLength(),ie,ye=A(1),Ee;if(H<=0)return ye;H<18?ie=1:H<48?ie=3:H<144?ie=4:H<768?ie=5:ie=6,H<8?Ee=new L(T):T.isEven()?Ee=new _o(T):Ee=new _e(T);var Be=new Array,Ke=3,hr=ie-1,Ci=(1<<ie)-1;if(Be[1]=Ee.convert(this),ie>1){var ks=n();for(Ee.sqrTo(Be[1],ks);Ke<=Ci;)Be[Ke]=n(),Ee.mulTo(ks,Be[Ke-2],Be[Ke]),Ke+=2}var hs=x.t-1,Rc,fv=!0,So=n(),xo;for(H=Y(x[hs])-1;hs>=0;){for(H>=hr?Rc=x[hs]>>H-hr&Ci:(Rc=(x[hs]&(1<<H+1)-1)<<hr-H,hs>0&&(Rc|=x[hs-1]>>this.DB+H-hr)),Ke=ie;(Rc&1)==0;)Rc>>=1,--Ke;if((H-=Ke)<0&&(H+=this.DB,--hs),fv)Be[Rc].copyTo(ye),fv=!1;else{for(;Ke>1;)Ee.sqrTo(ye,So),Ee.sqrTo(So,ye),Ke-=2;Ke>0?Ee.sqrTo(ye,So):(xo=ye,ye=So,So=xo),Ee.mulTo(So,Be[Rc],ye)}for(;hs>=0&&(x[hs]&1<<H)==0;)Ee.sqrTo(ye,So),xo=ye,ye=So,So=xo,--H<0&&(H=this.DB-1,--hs)}return Ee.revert(ye)}function Wy(x){var T=this.s<0?this.negate():this.clone(),H=x.s<0?x.negate():x.clone();if(T.compareTo(H)<0){var ie=T;T=H,H=ie}var ye=T.getLowestSetBit(),Ee=H.getLowestSetBit();if(Ee<0)return T;for(ye<Ee&&(Ee=ye),Ee>0&&(T.rShiftTo(Ee,T),H.rShiftTo(Ee,H));T.signum()>0;)(ye=T.getLowestSetBit())>0&&T.rShiftTo(ye,T),(ye=H.getLowestSetBit())>0&&H.rShiftTo(ye,H),T.compareTo(H)>=0?(T.subTo(H,T),T.rShiftTo(1,T)):(H.subTo(T,H),H.rShiftTo(1,H));return Ee>0&&H.lShiftTo(Ee,H),H}function Yy(x){if(x<=0)return 0;var T=this.DV%x,H=this.s<0?x-1:0;if(this.t>0)if(T==0)H=this[0]%x;else for(var ie=this.t-1;ie>=0;--ie)H=(T*H+this[ie])%x;return H}function Xy(x){var T=x.isEven();if(this.isEven()&&T||x.signum()==0)return i.ZERO;for(var H=x.clone(),ie=this.clone(),ye=A(1),Ee=A(0),Be=A(0),Ke=A(1);H.signum()!=0;){for(;H.isEven();)H.rShiftTo(1,H),T?((!ye.isEven()||!Ee.isEven())&&(ye.addTo(this,ye),Ee.subTo(x,Ee)),ye.rShiftTo(1,ye)):Ee.isEven()||Ee.subTo(x,Ee),Ee.rShiftTo(1,Ee);for(;ie.isEven();)ie.rShiftTo(1,ie),T?((!Be.isEven()||!Ke.isEven())&&(Be.addTo(this,Be),Ke.subTo(x,Ke)),Be.rShiftTo(1,Be)):Ke.isEven()||Ke.subTo(x,Ke),Ke.rShiftTo(1,Ke);H.compareTo(ie)>=0?(H.subTo(ie,H),T&&ye.subTo(Be,ye),Ee.subTo(Ke,Ee)):(ie.subTo(H,ie),T&&Be.subTo(ye,Be),Ke.subTo(Ee,Ke))}if(ie.compareTo(i.ONE)!=0)return i.ZERO;if(Ke.compareTo(x)>=0)return Ke.subtract(x);if(Ke.signum()<0)Ke.addTo(x,Ke);else return Ke;return Ke.signum()<0?Ke.add(x):Ke}var bi=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Qy=(1<<26)/bi[bi.length-1];function Zy(x){var T,H=this.abs();if(H.t==1&&H[0]<=bi[bi.length-1]){for(T=0;T<bi.length;++T)if(H[0]==bi[T])return!0;return!1}if(H.isEven())return!1;for(T=1;T<bi.length;){for(var ie=bi[T],ye=T+1;ye<bi.length&&ie<Qy;)ie*=bi[ye++];for(ie=H.modInt(ie);T<ye;)if(ie%bi[T++]==0)return!1}return H.millerRabin(x)}function m4e(x){var T=this.subtract(i.ONE),H=T.getLowestSetBit();if(H<=0)return!1;var ie=T.shiftRight(H);x=x+1>>1,x>bi.length&&(x=bi.length);for(var ye=n(),Ee=0;Ee<x;++Ee){ye.fromInt(bi[Math.floor(Math.random()*bi.length)]);var Be=ye.modPow(ie,this);if(Be.compareTo(i.ONE)!=0&&Be.compareTo(T)!=0){for(var Ke=1;Ke++<H&&Be.compareTo(T)!=0;)if(Be=Be.modPowInt(2,this),Be.compareTo(i.ONE)==0)return!1;if(Be.compareTo(T)!=0)return!1}}return!0}i.prototype.chunkSize=ge,i.prototype.toRadix=je,i.prototype.fromRadix=Re,i.prototype.fromNumber=Ve,i.prototype.bitwiseTo=Yt,i.prototype.changeBit=sv,i.prototype.addTo=Nr,i.prototype.dMultiply=uv,i.prototype.dAddOffset=Fr,i.prototype.multiplyLowerTo=Fy,i.prototype.multiplyUpperTo=Ky,i.prototype.modInt=Yy,i.prototype.millerRabin=m4e,i.prototype.clone=Q,i.prototype.intValue=ee,i.prototype.byteValue=J,i.prototype.shortValue=ue,i.prototype.signum=me,i.prototype.toByteArray=Je,i.prototype.equals=He,i.prototype.min=ze,i.prototype.max=gt,i.prototype.and=Tn,i.prototype.or=At,i.prototype.xor=nt,i.prototype.andNot=rv,i.prototype.not=Ir,i.prototype.shiftLeft=Tr,i.prototype.shiftRight=iv,i.prototype.getLowestSetBit=Cr,i.prototype.bitCount=Pr,i.prototype.testBit=Or,i.prototype.setBit=kr,i.prototype.clearBit=qr,i.prototype.flipBit=ov,i.prototype.add=Dr,i.prototype.subtract=av,i.prototype.multiply=Br,i.prototype.divide=cv,i.prototype.remainder=Lr,i.prototype.divideAndRemainder=Ur,i.prototype.modPow=Gy,i.prototype.modInverse=Xy,i.prototype.pow=Uy,i.prototype.gcd=Wy,i.prototype.isProbablePrime=Zy,i.prototype.square=Mr,i.prototype.Barrett=_o;var lv,ds,Ri;function b4e(x){ds[Ri++]^=x&255,ds[Ri++]^=x>>8&255,ds[Ri++]^=x>>16&255,ds[Ri++]^=x>>24&255,Ri>=Gx&&(Ri-=Gx)}function zq(){b4e(new Date().getTime())}if(ds==null){ds=new Array,Ri=0;var Eo;if(typeof window!="undefined"&&window.crypto){if(window.crypto.getRandomValues){var Hq=new Uint8Array(32);for(window.crypto.getRandomValues(Hq),Eo=0;Eo<32;++Eo)ds[Ri++]=Hq[Eo]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var $q=window.crypto.random(32);for(Eo=0;Eo<$q.length;++Eo)ds[Ri++]=$q.charCodeAt(Eo)&255}}for(;Ri<Gx;)Eo=Math.floor(65536*Math.random()),ds[Ri++]=Eo>>>8,ds[Ri++]=Eo&255;Ri=0,zq()}function v4e(){if(lv==null){for(zq(),lv=S4e(),lv.init(ds),Ri=0;Ri<ds.length;++Ri)ds[Ri]=0;Ri=0}return lv.next()}function w4e(x){var T;for(T=0;T<x.length;++T)x[T]=v4e()}function Hx(){}Hx.prototype.nextBytes=w4e;function $x(){this.i=0,this.j=0,this.S=new Array}function _4e(x){var T,H,ie;for(T=0;T<256;++T)this.S[T]=T;for(H=0,T=0;T<256;++T)H=H+this.S[T]+x[T%x.length]&255,ie=this.S[T],this.S[T]=this.S[H],this.S[H]=ie;this.i=0,this.j=0}function E4e(){var x;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,x=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=x,this.S[x+this.S[this.i]&255]}$x.prototype.init=_4e,$x.prototype.next=E4e;function S4e(){return new $x}var Gx=256;typeof x3!="undefined"?x3=j_e.exports={default:i,BigInteger:i,SecureRandom:Hx}:this.jsbn={BigInteger:i,SecureRandom:Hx}}).call(x3)});var v1=y(A3=>{f();(function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function e(o){return i(s(o),arguments)}function t(o,a){return e.apply(null,[o].concat(a||[]))}function i(o,a){var c=1,u=o.length,l,d="",h,p,g,b,E,v,A,R;for(h=0;h<u;h++)if(typeof o[h]=="string")d+=o[h];else if(typeof o[h]=="object"){if(g=o[h],g.keys)for(l=a[c],p=0;p<g.keys.length;p++){if(l==null)throw new Error(e('[sprintf] Cannot access property "%s" of undefined value "%s"',g.keys[p],g.keys[p-1]));l=l[g.keys[p]]}else g.param_no?l=a[g.param_no]:l=a[c++];if(r.not_type.test(g.type)&&r.not_primitive.test(g.type)&&l instanceof Function&&(l=l()),r.numeric_arg.test(g.type)&&typeof l!="number"&&isNaN(l))throw new TypeError(e("[sprintf] expecting number but found %T",l));switch(r.number.test(g.type)&&(A=l>=0),g.type){case"b":l=parseInt(l,10).toString(2);break;case"c":l=String.fromCharCode(parseInt(l,10));break;case"d":case"i":l=parseInt(l,10);break;case"j":l=JSON.stringify(l,null,g.width?parseInt(g.width):0);break;case"e":l=g.precision?parseFloat(l).toExponential(g.precision):parseFloat(l).toExponential();break;case"f":l=g.precision?parseFloat(l).toFixed(g.precision):parseFloat(l);break;case"g":l=g.precision?String(Number(l.toPrecision(g.precision))):parseFloat(l);break;case"o":l=(parseInt(l,10)>>>0).toString(8);break;case"s":l=String(l),l=g.precision?l.substring(0,g.precision):l;break;case"t":l=String(!!l),l=g.precision?l.substring(0,g.precision):l;break;case"T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase(),l=g.precision?l.substring(0,g.precision):l;break;case"u":l=parseInt(l,10)>>>0;break;case"v":l=l.valueOf(),l=g.precision?l.substring(0,g.precision):l;break;case"x":l=(parseInt(l,10)>>>0).toString(16);break;case"X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase();break}r.json.test(g.type)?d+=l:(r.number.test(g.type)&&(!A||g.sign)?(R=A?"+":"-",l=l.toString().replace(r.sign,"")):R="",E=g.pad_char?g.pad_char==="0"?"0":g.pad_char.charAt(1):" ",v=g.width-(R+l).length,b=g.width&&v>0?E.repeat(v):"",d+=g.align?R+l+b:E==="0"?R+b+l:b+R+l)}return d}var n=Object.create(null);function s(o){if(n[o])return n[o];for(var a=o,c,u=[],l=0;a;){if((c=r.text.exec(a))!==null)u.push(c[0]);else if((c=r.modulo.exec(a))!==null)u.push("%");else if((c=r.placeholder.exec(a))!==null){if(c[2]){l|=1;var d=[],h=c[2],p=[];if((p=r.key.exec(h))!==null)for(d.push(p[1]);(h=h.substring(p[0].length))!=="";)if((p=r.key_access.exec(h))!==null)d.push(p[1]);else if((p=r.index_access.exec(h))!==null)d.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");c[2]=d}else l|=2;if(l===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");u.push({placeholder:c[0],param_no:c[1],keys:c[2],sign:c[3],pad_char:c[4],align:c[5],width:c[6],precision:c[7],type:c[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");a=a.substring(c[0].length)}return n[o]=u}typeof A3!="undefined"&&(A3.sprintf=e,A3.vsprintf=t),typeof window!="undefined"&&(window.sprintf=e,window.vsprintf=t,typeof define=="function"&&define.amd&&define(function(){return{sprintf:e,vsprintf:t}}))})()});var PO=y(bc=>{f();"use strict";var Xmt=bc&&bc.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),Qmt=bc&&bc.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),V_e=bc&&bc.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Xmt(e,r,t);return Qmt(e,r),e};Object.defineProperty(bc,"__esModule",{value:!0});bc.Address4=void 0;var z_e=V_e(TO()),fa=V_e(RO()),H_e=S3(),w1=CO(),fy=v1(),Zmt=function(){function r(e){this.groups=fa.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=z_e.isCorrect(fa.BITS),this.isInSubnet=z_e.isInSubnet,this.address=e;var t=fa.RE_SUBNET_STRING.exec(e);if(t){if(this.parsedSubnet=t[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,this.subnetMask<0||this.subnetMask>fa.BITS)throw new H_e.AddressError("Invalid subnet mask.");e=e.replace(fa.RE_SUBNET_STRING,"")}this.addressMinusSuffix=e,this.parsedAddress=this.parse(e)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.prototype.parse=function(e){var t=e.split(".");if(!e.match(fa.RE_ADDRESS))throw new H_e.AddressError("Invalid IPv4 address.");return t},r.prototype.correctForm=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)}).join(".")},r.fromHex=function(e){var t=e.replace(/:/g,"").padStart(8,"0"),i=[],n;for(n=0;n<8;n+=2){var s=t.slice(n,n+2);i.push(parseInt(s,16))}return new r(i.join("."))},r.fromInteger=function(e){return r.fromHex(e.toString(16))},r.fromArpa=function(e){var t=e.replace(/(\.in-addr\.arpa)?\.$/,""),i=t.split(".").reverse().join(".");return new r(i)},r.prototype.toHex=function(){return this.parsedAddress.map(function(e){return fy.sprintf("%02x",parseInt(e,10))}).join(":")},r.prototype.toArray=function(){return this.parsedAddress.map(function(e){return parseInt(e,10)})},r.prototype.toGroup6=function(){var e=[],t;for(t=0;t<fa.GROUPS;t+=2){var i=fy.sprintf("%02x%02x",parseInt(this.parsedAddress[t],10),parseInt(this.parsedAddress[t+1],10));e.push(fy.sprintf("%x",parseInt(i,16)))}return e.join(":")},r.prototype.bigInteger=function(){return new w1.BigInteger(this.parsedAddress.map(function(e){return fy.sprintf("%02x",parseInt(e,10))}).join(""),16)},r.prototype._startAddress=function(){return new w1.BigInteger(this.mask()+"0".repeat(fa.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new w1.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new w1.BigInteger(this.mask()+"1".repeat(fa.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new w1.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.fromBigInteger=function(e){return r.fromInteger(parseInt(e.toString(),10))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.reverseForm=function(e){e||(e={});var t=this.correctForm().split(".").reverse().join(".");return e.omitSuffix?t:fy.sprintf("%s.in-addr.arpa.",t)},r.prototype.isMulticast=function(){return this.isInSubnet(new r("224.0.0.0/4"))},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(fa.BITS,"0")},r.prototype.groupForV6=function(){var e=this.parsedAddress;return this.address.replace(fa.RE_ADDRESS,fy.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',e.slice(0,2).join("."),e.slice(2,4).join(".")))},r}();bc.Address4=Zmt});var OO=y(Yr=>{f();"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.RE_URL_WITH_PORT=Yr.RE_URL=Yr.RE_ZONE_STRING=Yr.RE_SUBNET_STRING=Yr.RE_BAD_ADDRESS=Yr.RE_BAD_CHARACTERS=Yr.TYPES=Yr.SCOPES=Yr.GROUPS=Yr.BITS=void 0;Yr.BITS=128;Yr.GROUPS=8;Yr.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};Yr.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};Yr.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;Yr.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;Yr.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;Yr.RE_ZONE_STRING=/%.*$/;Yr.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);Yr.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var kO=y(vc=>{f();"use strict";Object.defineProperty(vc,"__esModule",{value:!0});vc.simpleGroup=vc.spanLeadingZeroes=vc.spanAll=vc.spanAllZeroes=void 0;var $_e=v1();function G_e(r){return r.replace(/(0+)/g,'<span class="zero">$1</span>')}vc.spanAllZeroes=G_e;function Jmt(r,e){e===void 0&&(e=0);var t=r.split("");return t.map(function(i,n){return $_e.sprintf('<span class="digit value-%s position-%d">%s</span>',i,n+e,G_e(i))}).join("")}vc.spanAll=Jmt;function W_e(r){return r.replace(/^(0+)/,'<span class="zero">$1</span>')}function ebt(r){var e=r.split(":");return e.map(function(t){return W_e(t)}).join(":")}vc.spanLeadingZeroes=ebt;function tbt(r,e){e===void 0&&(e=0);var t=r.split(":");return t.map(function(i,n){return/group-v4/.test(i)?i:$_e.sprintf('<span class="hover-group group-%d">%s</span>',n+e,W_e(i))})}vc.simpleGroup=tbt});var Y_e=y(Hi=>{f();"use strict";var rbt=Hi&&Hi.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),ibt=Hi&&Hi.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),nbt=Hi&&Hi.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rbt(e,r,t);return ibt(e,r),e};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.possibleElisions=Hi.simpleRegularExpression=Hi.ADDRESS_BOUNDARY=Hi.padGroup=Hi.groupPossibilities=void 0;var sbt=nbt(OO()),dy=v1();function I3(r){return dy.sprintf("(%s)",r.join("|"))}Hi.groupPossibilities=I3;function T3(r){return r.length<4?dy.sprintf("0{0,%d}%s",4-r.length,r):r}Hi.padGroup=T3;Hi.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function obt(r){var e=[];r.forEach(function(i,n){var s=parseInt(i,16);s===0&&e.push(n)});var t=e.map(function(i){return r.map(function(n,s){if(s===i){var o=s===0||s===sbt.GROUPS-1?":":"";return I3([T3(n),o])}return T3(n)}).join(":")});return t.push(r.map(T3).join(":")),I3(t)}Hi.simpleRegularExpression=obt;function abt(r,e,t){var i=e?"":":",n=t?"":":",s=[];!e&&!t&&s.push("::"),e&&t&&s.push(""),(t&&!e||!t&&e)&&s.push(":"),s.push(dy.sprintf("%s(:0{1,4}){1,%d}",i,r-1)),s.push(dy.sprintf("(0{1,4}:){1,%d}%s",r-1,n)),s.push(dy.sprintf("(0{1,4}:){%d}0{1,4}",r-1));for(var o=1;o<r-1;o++)for(var a=1;a<r-o;a++)s.push(dy.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",a,r-a-o-1));return I3(s)}Hi.possibleElisions=abt});var e2e=y(po=>{f();"use strict";var cbt=po&&po.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),ubt=po&&po.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),R3=po&&po.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cbt(e,r,t);return ubt(e,r),e},X_e=po&&po.__spreadArray||function(r,e){for(var t=0,i=e.length,n=r.length;t<i;t++,n++)r[n]=e[t];return r};Object.defineProperty(po,"__esModule",{value:!0});po.Address6=void 0;var Q_e=R3(TO()),qO=R3(RO()),fr=R3(OO()),NO=R3(kO()),Qd=PO(),Zd=Y_e(),xu=S3(),Vn=CO(),zn=v1();function C3(r){if(!r)throw new Error("Assertion failed.")}function lbt(r){for(var e=/(\d+)(\d{3})/;e.test(r);)r=r.replace(e,"$1,$2");return r}function fbt(r){return r=r.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),r=r.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),r}function dbt(r,e){var t=[],i=[],n;for(n=0;n<r.length;n++)n<e[0]?t.push(r[n]):n>e[1]&&i.push(r[n]);return t.concat(["compact"]).concat(i)}function Z_e(r){return zn.sprintf("%04x",parseInt(r,16))}function J_e(r){return r&255}var hbt=function(){function r(e,t){this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=Q_e.isInSubnet,this.isCorrect=Q_e.isCorrect(fr.BITS),t===void 0?this.groups=fr.GROUPS:this.groups=t,this.address=e;var i=fr.RE_SUBNET_STRING.exec(e);if(i){if(this.parsedSubnet=i[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet="/"+this.subnetMask,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>fr.BITS)throw new xu.AddressError("Invalid subnet mask.");e=e.replace(fr.RE_SUBNET_STRING,"")}else if(/\//.test(e))throw new xu.AddressError("Invalid subnet mask.");var n=fr.RE_ZONE_STRING.exec(e);n&&(this.zone=n[0],e=e.replace(fr.RE_ZONE_STRING,"")),this.addressMinusSuffix=e,this.parsedAddress=this.parse(this.addressMinusSuffix)}return r.isValid=function(e){try{return new r(e),!0}catch(t){return!1}},r.fromBigInteger=function(e){var t=e.toString(16).padStart(32,"0"),i=[],n;for(n=0;n<fr.GROUPS;n++)i.push(t.slice(n*4,(n+1)*4));return new r(i.join(":"))},r.fromURL=function(e){var t,i=null,n;if(e.indexOf("[")!==-1&&e.indexOf("]:")!==-1){if(n=fr.RE_URL_WITH_PORT.exec(e),n===null)return{error:"failed to parse address with port",address:null,port:null};t=n[1],i=n[2]}else if(e.indexOf("/")!==-1){if(e=e.replace(/^[a-z0-9]+:\/\//,""),n=fr.RE_URL.exec(e),n===null)return{error:"failed to parse address from URL",address:null,port:null};t=n[1]}else t=e;return i?(i=parseInt(i,10),(i<0||i>65536)&&(i=null)):i=null,{address:new r(t),port:i}},r.fromAddress4=function(e){var t=new Qd.Address4(e),i=fr.BITS-(qO.BITS-t.subnetMask);return new r("::ffff:"+t.correctForm()+"/"+i)},r.fromArpa=function(e){var t=e.replace(/(\.ip6\.arpa)?\.$/,""),i=7;if(t.length!==63)throw new xu.AddressError("Invalid 'ip6.arpa' form.");for(var n=t.split(".").reverse(),s=i;s>0;s--){var o=s*4;n.splice(o,0,":")}return t=n.join(""),new r(t)},r.prototype.microsoftTranscription=function(){return zn.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))},r.prototype.mask=function(e){return e===void 0&&(e=this.subnetMask),this.getBitsBase2(0,e)},r.prototype.possibleSubnets=function(e){e===void 0&&(e=128);var t=fr.BITS-this.subnetMask,i=Math.abs(e-fr.BITS),n=t-i;return n<0?"0":lbt(new Vn.BigInteger("2",10).pow(n).toString(10))},r.prototype._startAddress=function(){return new Vn.BigInteger(this.mask()+"0".repeat(fr.BITS-this.subnetMask),2)},r.prototype.startAddress=function(){return r.fromBigInteger(this._startAddress())},r.prototype.startAddressExclusive=function(){var e=new Vn.BigInteger("1");return r.fromBigInteger(this._startAddress().add(e))},r.prototype._endAddress=function(){return new Vn.BigInteger(this.mask()+"1".repeat(fr.BITS-this.subnetMask),2)},r.prototype.endAddress=function(){return r.fromBigInteger(this._endAddress())},r.prototype.endAddressExclusive=function(){var e=new Vn.BigInteger("1");return r.fromBigInteger(this._endAddress().subtract(e))},r.prototype.getScope=function(){var e=fr.SCOPES[this.getBits(12,16).intValue()];return this.getType()==="Global unicast"&&e!=="Link local"&&(e="Global"),e||"Unknown"},r.prototype.getType=function(){for(var e=0,t=Object.keys(fr.TYPES);e<t.length;e++){var i=t[e];if(this.isInSubnet(new r(i)))return fr.TYPES[i]}return"Global unicast"},r.prototype.getBits=function(e,t){return new Vn.BigInteger(this.getBitsBase2(e,t),2)},r.prototype.getBitsBase2=function(e,t){return this.binaryZeroPad().slice(e,t)},r.prototype.getBitsBase16=function(e,t){var i=t-e;if(i%4!=0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(e,t).toString(16).padStart(i/4,"0")},r.prototype.getBitsPastSubnet=function(){return this.getBitsBase2(this.subnetMask,fr.BITS)},r.prototype.reverseForm=function(e){e||(e={});var t=Math.floor(this.subnetMask/4),i=this.canonicalForm().replace(/:/g,"").split("").slice(0,t).reverse().join(".");return t>0?e.omitSuffix?i:zn.sprintf("%s.ip6.arpa.",i):e.omitSuffix?"":"ip6.arpa."},r.prototype.correctForm=function(){var e,t=[],i=0,n=[];for(e=0;e<this.parsedAddress.length;e++){var s=parseInt(this.parsedAddress[e],16);s===0&&i++,s!==0&&i>0&&(i>1&&n.push([e-i,e-1]),i=0)}i>1&&n.push([this.parsedAddress.length-i,this.parsedAddress.length-1]);var o=n.map(function(u){return u[1]-u[0]+1});if(n.length>0){var a=o.indexOf(Math.max.apply(Math,o));t=dbt(this.parsedAddress,n[a])}else t=this.parsedAddress;for(e=0;e<t.length;e++)t[e]!=="compact"&&(t[e]=parseInt(t[e],16).toString(16));var c=t.join(":");return c=c.replace(/^compact$/,"::"),c=c.replace(/^compact|compact$/,":"),c=c.replace(/compact/,""),c},r.prototype.binaryZeroPad=function(){return this.bigInteger().toString(2).padStart(fr.BITS,"0")},r.prototype.parse4in6=function(e){var t=e.split(":"),i=t.slice(-1)[0],n=i.match(qO.RE_ADDRESS);if(n){this.parsedAddress4=n[0],this.address4=new Qd.Address4(this.parsedAddress4);for(var s=0;s<this.address4.groups;s++)if(/^0[0-9]+/.test(this.address4.parsedAddress[s]))throw new xu.AddressError("IPv4 addresses can't have leading zeroes.",e.replace(qO.RE_ADDRESS,this.address4.parsedAddress.map(fbt).join(".")));this.v4=!0,t[t.length-1]=this.address4.toGroup6(),e=t.join(":")}return e},r.prototype.parse=function(e){e=this.parse4in6(e);var t=e.match(fr.RE_BAD_CHARACTERS);if(t)throw new xu.AddressError(zn.sprintf("Bad character%s detected in address: %s",t.length>1?"s":"",t.join("")),e.replace(fr.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));var i=e.match(fr.RE_BAD_ADDRESS);if(i)throw new xu.AddressError(zn.sprintf("Address failed regex: %s",i.join("")),e.replace(fr.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));var n=[],s=e.split("::");if(s.length===2){var o=s[0].split(":"),a=s[1].split(":");o.length===1&&o[0]===""&&(o=[]),a.length===1&&a[0]===""&&(a=[]);var c=this.groups-(o.length+a.length);if(!c)throw new xu.AddressError("Error parsing groups");this.elidedGroups=c,this.elisionBegin=o.length,this.elisionEnd=o.length+this.elidedGroups,n=n.concat(o);for(var u=0;u<c;u++)n.push("0");n=n.concat(a)}else if(s.length===1)n=e.split(":"),this.elidedGroups=0;else throw new xu.AddressError("Too many :: groups found");if(n=n.map(function(l){return zn.sprintf("%x",parseInt(l,16))}),n.length!==this.groups)throw new xu.AddressError("Incorrect number of groups found");return n},r.prototype.canonicalForm=function(){return this.parsedAddress.map(Z_e).join(":")},r.prototype.decimal=function(){return this.parsedAddress.map(function(e){return zn.sprintf("%05d",parseInt(e,16))}).join(":")},r.prototype.bigInteger=function(){return new Vn.BigInteger(this.parsedAddress.map(Z_e).join(""),16)},r.prototype.to4=function(){var e=this.binaryZeroPad().split("");return Qd.Address4.fromHex(new Vn.BigInteger(e.slice(96,128).join(""),2).toString(16))},r.prototype.to4in6=function(){var e=this.to4(),t=new r(this.parsedAddress.slice(0,6).join(":"),6),i=t.correctForm(),n="";return/:$/.test(i)||(n=":"),i+n+e.address},r.prototype.inspectTeredo=function(){var e=this.getBitsBase16(0,32),t=this.getBits(80,96).xor(new Vn.BigInteger("ffff",16)).toString(),i=Qd.Address4.fromHex(this.getBitsBase16(32,64)),n=Qd.Address4.fromHex(this.getBits(96,128).xor(new Vn.BigInteger("ffffffff",16)).toString(16)),s=this.getBits(64,80),o=this.getBitsBase2(64,80),a=s.testBit(15),c=s.testBit(14),u=s.testBit(8),l=s.testBit(9),d=new Vn.BigInteger(o.slice(2,6)+o.slice(8,16),2).toString(10);return{prefix:zn.sprintf("%s:%s",e.slice(0,4),e.slice(4,8)),server4:i.address,client4:n.address,flags:o,coneNat:a,microsoft:{reserved:c,universalLocal:l,groupIndividual:u,nonce:d},udpPort:t}},r.prototype.inspect6to4=function(){var e=this.getBitsBase16(0,16),t=Qd.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:zn.sprintf("%s",e.slice(0,4)),gateway:t.address}},r.prototype.to6to4=function(){if(!this.is4())return null;var e=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new r(e)},r.prototype.toByteArray=function(){var e=this.bigInteger().toByteArray();return e.length===17&&e[0]===0?e.slice(1):e},r.prototype.toUnsignedByteArray=function(){return this.toByteArray().map(J_e)},r.fromByteArray=function(e){return this.fromUnsignedByteArray(e.map(J_e))},r.fromUnsignedByteArray=function(e){for(var t=new Vn.BigInteger("256",10),i=new Vn.BigInteger("0",10),n=new Vn.BigInteger("1",10),s=e.length-1;s>=0;s--)i=i.add(n.multiply(new Vn.BigInteger(e[s].toString(10),10))),n=n.multiply(t);return r.fromBigInteger(i)},r.prototype.isCanonical=function(){return this.addressMinusSuffix===this.canonicalForm()},r.prototype.isLinkLocal=function(){return this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000"},r.prototype.isMulticast=function(){return this.getType()==="Multicast"},r.prototype.is4=function(){return this.v4},r.prototype.isTeredo=function(){return this.isInSubnet(new r("2001::/32"))},r.prototype.is6to4=function(){return this.isInSubnet(new r("2002::/16"))},r.prototype.isLoopback=function(){return this.getType()==="Loopback"},r.prototype.href=function(e){return e===void 0?e="":e=zn.sprintf(":%s",e),zn.sprintf("http://[%s]%s/",this.correctForm(),e)},r.prototype.link=function(e){e||(e={}),e.className===void 0&&(e.className=""),e.prefix===void 0&&(e.prefix="/#address="),e.v4===void 0&&(e.v4=!1);var t=this.correctForm;return e.v4&&(t=this.to4in6),e.className?zn.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',e.prefix,t.call(this),e.className):zn.sprintf('<a href="%1$s%2$s">%2$s</a>',e.prefix,t.call(this))},r.prototype.group=function(){if(this.elidedGroups===0)return NO.simpleGroup(this.address).join(":");C3(typeof this.elidedGroups=="number"),C3(typeof this.elisionBegin=="number");var e=[],t=this.address.split("::"),i=t[0],n=t[1];i.length?e.push.apply(e,NO.simpleGroup(i)):e.push("");for(var s=["hover-group"],o=this.elisionBegin;o<this.elisionBegin+this.elidedGroups;o++)s.push(zn.sprintf("group-%d",o));return e.push(zn.sprintf('<span class="%s"></span>',s.join(" "))),n.length?e.push.apply(e,NO.simpleGroup(n,this.elisionEnd)):e.push(""),this.is4()&&(C3(this.address4 instanceof Qd.Address4),e.pop(),e.push(this.address4.groupForV6())),e.join(":")},r.prototype.regularExpressionString=function(e){e===void 0&&(e=!1);var t=[],i=new r(this.correctForm());if(i.elidedGroups===0)t.push(Zd.simpleRegularExpression(i.parsedAddress));else if(i.elidedGroups===fr.GROUPS)t.push(Zd.possibleElisions(fr.GROUPS));else{var n=i.address.split("::");n[0].length&&t.push(Zd.simpleRegularExpression(n[0].split(":"))),C3(typeof i.elidedGroups=="number"),t.push(Zd.possibleElisions(i.elidedGroups,n[0].length!==0,n[1].length!==0)),n[1].length&&t.push(Zd.simpleRegularExpression(n[1].split(":"))),t=[t.join(":")]}return e||(t=X_e(X_e(["(?=^|",Zd.ADDRESS_BOUNDARY,"|[^\\w\\:])("],t),[")(?=[^\\w\\:]|",Zd.ADDRESS_BOUNDARY,"|$)"])),t.join("")},r.prototype.regularExpression=function(e){return e===void 0&&(e=!1),new RegExp(this.regularExpressionString(e),"i")},r}();po.Address6=hbt});var t2e=y(Sn=>{f();"use strict";var pbt=Sn&&Sn.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),ybt=Sn&&Sn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),gbt=Sn&&Sn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&pbt(e,r,t);return ybt(e,r),e};Object.defineProperty(Sn,"__esModule",{value:!0});Sn.v6=Sn.AddressError=Sn.Address6=Sn.Address4=void 0;var mbt=PO();Object.defineProperty(Sn,"Address4",{enumerable:!0,get:function(){return mbt.Address4}});var bbt=e2e();Object.defineProperty(Sn,"Address6",{enumerable:!0,get:function(){return bbt.Address6}});var vbt=S3();Object.defineProperty(Sn,"AddressError",{enumerable:!0,get:function(){return vbt.AddressError}});var wbt=gbt(kO());Sn.v6={helpers:wbt}});var LO=y((mFt,MO)=>{f();"use strict";var r2e=be(),_bt=Object.assign(r2e("libp2p:ip-port-to-multiaddr"),{error:r2e("libp2p:ip-port-to-multiaddr:err")}),{Multiaddr:DO}=it(),BO=ae(),{Address4:Ebt,Address6:Sbt}=t2e(),P3={ERR_INVALID_IP_PARAMETER:"ERR_INVALID_IP_PARAMETER",ERR_INVALID_PORT_PARAMETER:"ERR_INVALID_PORT_PARAMETER",ERR_INVALID_IP:"ERR_INVALID_IP"};function xbt(r,e){if(typeof r!="string")throw BO(new Error(`invalid ip provided: ${r}`),P3.ERR_INVALID_IP_PARAMETER);if(typeof e=="string"&&(e=parseInt(e)),isNaN(e))throw BO(new Error(`invalid port provided: ${e}`),P3.ERR_INVALID_PORT_PARAMETER);try{return new Ebt(r),new DO(`/ip4/${r}/tcp/${e}`)}catch{}try{let t=new Sbt(r);return t.is4()?new DO(`/ip4/${t.to4().correctForm()}/tcp/${e}`):new DO(`/ip6/${r}/tcp/${e}`)}catch(t){let i=`invalid ip:port for creating a multiaddr: ${r}:${e}`;throw _bt.error(i),BO(new Error(i),P3.ERR_INVALID_IP)}}MO.exports=xbt;MO.exports.Errors=P3});var Jd=y((bFt,O3)=>{f();"use strict";var UO=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},i2e=(r,e,t,i)=>{let n,s=new Promise((o,a)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){o(r);return}i={customTimers:{setTimeout,clearTimeout},...i},n=i.customTimers.setTimeout.call(void 0,()=>{if(typeof t=="function"){try{o(t())}catch(l){a(l)}return}let c=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,u=t instanceof Error?t:new UO(c);typeof r.cancel=="function"&&r.cancel(),a(u)},e),(async()=>{try{o(await r)}catch(c){a(c)}finally{i.customTimers.clearTimeout.call(void 0,n)}})()});return s.clear=()=>{clearTimeout(n),n=void 0},s};O3.exports=i2e;O3.exports.default=i2e;O3.exports.TimeoutError=UO});var c2e=y((vFt,a2e)=>{f();"use strict";var n2e=fc(),{CLOSE_TIMEOUT:Abt}=IO(),s2e=LO(),Ibt=Jd(),o2e=be(),FO=o2e("libp2p:websockets:socket");FO.error=o2e("libp2p:websockets:socket:error");a2e.exports=(r,e={})=>{let t={async sink(i){e.signal&&(i=n2e(i,e.signal));try{await r.sink(async function*(){for await(let n of i)yield n instanceof Uint8Array?n:n.slice()}())}catch(n){n.type!=="aborted"&&FO.error(n)}},source:e.signal?n2e(r.source,e.signal):r.source,conn:r,localAddr:e.localAddr||(r.localAddress&&r.localPort?s2e(r.localAddress,r.localPort):void 0),remoteAddr:e.remoteAddr||s2e(r.remoteAddress,r.remotePort),timeline:{open:Date.now()},async close(){let i=Date.now();try{await Ibt(r.close(),Abt)}catch(n){let{host:s,port:o}=t.remoteAddr.toOptions();FO("timeout closing stream to %s:%s after %dms, destroying it manually",s,o,Date.now()-i),r.destroy()}finally{t.timeline.close=Date.now()}}};return r.socket.once&&r.socket.once("close",()=>{t.timeline.close||(t.timeline.close=Date.now())}),t}});var f2e=y((wFt,l2e)=>{f();"use strict";var Zl=Bf(),{CODE_CIRCUIT:KO,CODE_P2P:jO,CODE_TCP:VO,CODE_WS:Tbt,CODE_WSS:u2e}=IO();l2e.exports={all:r=>r.filter(e=>{if(e.protoCodes().includes(KO))return!1;let t=e.decapsulateCode(jO);return Zl.WebSockets.matches(t)||Zl.WebSocketsSecure.matches(t)}),dnsWss:r=>r.filter(e=>{if(e.protoCodes().includes(KO))return!1;let t=e.decapsulateCode(jO);return Zl.WebSocketsSecure.matches(t)&&Zl.DNS.matches(t.decapsulateCode(VO).decapsulateCode(u2e))}),dnsWsOrWss:r=>r.filter(e=>{if(e.protoCodes().includes(KO))return!1;let t=e.decapsulateCode(jO);return Zl.WebSockets.matches(t)?Zl.DNS.matches(t.decapsulateCode(VO).decapsulateCode(Tbt)):Zl.WebSocketsSecure.matches(t)&&Zl.DNS.matches(t.decapsulateCode(VO).decapsulateCode(u2e))})}});var b2e=y((_Ft,m2e)=>{f();"use strict";var Rbt=U_e(),Cbt=Nw(),Pbt=J2(),{AbortError:d2e}=fc(),Obt=ml(),h2e=be(),Jl=h2e("libp2p:websockets");Jl.error=h2e("libp2p:websockets:error");var p2e=tg(),kbt=K_e(),qbt=c2e(),y2e=f2e(),g2e=class{constructor({upgrader:e,filter:t}){if(!e)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e,this._filter=t}async dial(e,t={}){Jl("dialing %s",e);let i=await this._connect(e,t),n=qbt(i,{remoteAddr:e,signal:t.signal});Jl("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Jl("outbound connection %s upgraded",n.remoteAddr),s}async _connect(e,t={}){if(t.signal&&t.signal.aborted)throw new d2e;let i=e.toOptions();Jl("dialing %s:%s",i.host,i.port);let n=Obt(),s=u=>{let l=`connection error: ${u.message}`;Jl.error(l),n.reject(u)},o=Rbt(Pbt(e),Object.assign({binary:!0},t));if(o.socket.on?o.socket.on("error",s):o.socket.onerror=s,!t.signal)return await Promise.race([o.connected(),n.promise]),Jl("connected %s",e),o;let a,c=new Promise((u,l)=>{if(a=()=>{l(new d2e),setTimeout(()=>{o.close()})},t.signal.aborted)return a();t.signal.addEventListener("abort",a)});try{await Promise.race([c,n.promise,o.connected()])}finally{t.signal.removeEventListener("abort",a)}return Jl("connected %s",e),o}createListener(e={},t){return typeof e=="function"&&(t=e,e={}),kbt({handler:t,upgrader:this._upgrader},e)}filter(e){return e=Array.isArray(e)?e:[e],this._filter?this._filter(e):p2e.isBrowser||p2e.isWebWorker?y2e.dnsWss(e):y2e.all(e)}};m2e.exports=Cbt(g2e,{className:"WebSockets",symbolName:"@libp2p/js-libp2p-websockets/websockets"})});var w2e=y((EFt,v2e)=>{f();v2e.exports=function(){if(typeof globalThis=="undefined")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null}});var $O=y((SFt,HO)=>{f();"use strict";var zO=65536,Nbt=4294967295;function Dbt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Bbt=I8().Buffer,k3=globalThis.crypto||globalThis.msCrypto;k3&&k3.getRandomValues?HO.exports=Mbt:HO.exports=Dbt;function Mbt(r,e){if(r>Nbt)throw new RangeError("requested too many random bytes");var t=Bbt.allocUnsafe(r);if(r>0)if(r>zO)for(var i=0;i<r;i+=zO)k3.getRandomValues(t.slice(i,i+zO));else k3.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}});var S2e=y((xFt,E2e)=>{f();"use strict";function _2e(r,e){for(let t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function Lbt(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=void 0),e!=null&&(t.code=e);try{return _2e(r,t)}catch(i){t.message=r.message,t.stack=r.stack;let n=function(){};return n.prototype=Object.create(Object.getPrototypeOf(r)),_2e(new n,t)}}E2e.exports=Lbt});var YO=y((AFt,T2e)=>{f();var Ubt=be()("simple-peer"),x2e=w2e(),A2e=$O(),Fbt=j8(),GO=DE(),dr=S2e(),WO=64*1024,Kbt=5*1e3,jbt=5*1e3;function I2e(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function Vbt(r){console.warn(r)}var ef=class extends Fbt.Duplex{constructor(e){e=Object.assign({allowHalfOpen:!1},e);super(e);if(this._id=A2e(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||A2e(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||ef.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},ef.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||Kbt,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:x2e(),!this._wrtc)throw typeof window=="undefined"?dr(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):dr(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=this.negotiated?!1:!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){GO(()=>this.destroy(dr(t,"ERR_PC_CONSTRUCTOR")));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw dr(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if(typeof e=="string")try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(dr(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(i=>{!t.address||t.address.endsWith(".local")?Vbt("Ignoring unsupported ICE candidate."):this.destroy(dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,n=i.get(t);if(!n)n=this._pc.addTrack(e,t),i.set(t,n),this._senderMap.set(e,i),this._needsNegotiation();else throw n.removed?dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,i){this._debug("replaceTrack()");var n=this._senderMap.get(e),s=n?n.get(i):null;if(!s)throw dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,n),s.replaceTrack!=null?s.replaceTrack(t):this.destroy(dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),n=i?i.get(t):null;if(!n)throw dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{n.removed=!0,this._pc.removeTrack(n)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(n):this.destroy(dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,GO(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}_destroy(e,t){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(i){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(i){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,t(e)}_setupData(e){if(!e.channel)return this.destroy(dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=WO),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{this.destroy(dr(i,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},jbt)}_read(){}_write(e,t,i){if(this.destroyed)return i(dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(n){return this.destroy(dr(n,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>WO?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;let e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=I2e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})}},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=I2e(e.sdp)),e.sdp=this.sdpTransform(e.sdp);let t=()=>{if(!this.destroyed){var s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()}},i=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},n=s=>{this.destroy(dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(n)}).catch(e=>{this.destroy(dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){let t=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(n=>{Object.assign(i,n)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var n=[];i.forEach(s=>{n.push(t(s))}),e(null,n)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var n=[];i.result().forEach(s=>{var o={};s.names().forEach(a=>{o[a]=s.stat(a)}),o.id=s.id,o.type=s.type,o.timestamp=s.timestamp,n.push(t(o))}),e(null,n)}},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;let e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var n={},s={},o={},a=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(n[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(o[l.id]=l)});let c=l=>{a=!0;var d=s[l.localCandidateId];d&&(d.ip||d.address)?(this.localAddress=d.ip||d.address,this.localPort=Number(d.port)):d&&d.ipAddress?(this.localAddress=d.ipAddress,this.localPort=Number(d.portNumber)):typeof l.googLocalAddress=="string"&&(d=l.googLocalAddress.split(":"),this.localAddress=d[0],this.localPort=Number(d[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var h=n[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(o[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!a&&(!Object.keys(o).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(l){return this.destroy(dr(l,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');var u=this._cb;this._cb=null,u(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>WO||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&!this._firstStable&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=new Uint8Array(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!(this.destroyed||!this._cb)){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(i=>i.id===t.id)&&(this._remoteStreams.push(t),GO(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Ubt.apply(null,e)}};ef.WEBRTC_SUPPORT=!!x2e();ef.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};ef.channelConfig={};T2e.exports=ef});var C2e=y((IFt,R2e)=>{f();"use strict";R2e.exports={supportsFileReader:typeof self!="undefined"&&"FileReader"in self,supportsWebRTC:"RTCPeerConnection"in globalThis&&typeof navigator!="undefined"&&typeof navigator.mediaDevices!="undefined"&&"getUserMedia"in navigator.mediaDevices,supportsWebRTCDataChannels:"RTCPeerConnection"in globalThis}});var N3=y(q3=>{f();"use strict";q3.CODE_P2P=421;q3.CODE_CIRCUIT=290;q3.CLOSE_TIMEOUT=2e3});var XO=y((RFt,P2e)=>{f();var zbt=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Hbt=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];P2e.exports=function(e){var t=e,i=e.indexOf("["),n=e.indexOf("]");i!=-1&&n!=-1&&(e=e.substring(0,i)+e.substring(i,n).replace(/:/g,";")+e.substring(n,e.length));for(var s=zbt.exec(e||""),o={},a=14;a--;)o[Hbt[a]]=s[a]||"";return i!=-1&&n!=-1&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=$bt(o,o.path),o.queryKey=Gbt(o,o.query),o};function $bt(r,e){var t=/\/{2,9}/g,i=e.replace(t,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&i.splice(0,1),e.substr(e.length-1,1)=="/"&&i.splice(i.length-1,1),i}function Gbt(r,e){var t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(i,n,s){n&&(t[n]=s)}),t}});var k2e=y(D3=>{f();"use strict";Object.defineProperty(D3,"__esModule",{value:!0});D3.url=void 0;var Wbt=XO(),O2e=be()("socket.io-client:url");function Ybt(r,e="",t){let i=r;t=t||typeof location!="undefined"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(O2e("protocol-less url %s",r),typeof t!="undefined"?r=t.protocol+"//"+r:r="https://"+r),O2e("parse %s",r),i=Wbt(r)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";let s=i.host.indexOf(":")!==-1?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port+e,i.href=i.protocol+"://"+s+(t&&t.port===i.port?"":":"+i.port),i}D3.url=Ybt});var q2e=y((PFt,QO)=>{f();try{QO.exports=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(r){QO.exports=!1}});var _1=y((OFt,N2e)=>{f();N2e.exports=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())()});var ZO=y((kFt,D2e)=>{f();var Xbt=q2e(),Qbt=_1();D2e.exports=function(r){let e=r.xdomain,t=r.xscheme,i=r.enablesXDR;try{if(typeof XMLHttpRequest!="undefined"&&(!e||Xbt))return new XMLHttpRequest}catch(n){}try{if(typeof XDomainRequest!="undefined"&&!t&&i)return new XDomainRequest}catch(n){}if(!e)try{return new Qbt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(n){}}});var JO=y((qFt,M2e)=>{f();var wc=Object.create(null);wc.open="0";wc.close="1";wc.ping="2";wc.pong="3";wc.message="4";wc.upgrade="5";wc.noop="6";var B2e=Object.create(null);Object.keys(wc).forEach(r=>{B2e[wc[r]]=r});var Zbt={type:"error",data:"parser error"};M2e.exports={PACKET_TYPES:wc,PACKET_TYPES_REVERSE:B2e,ERROR_PACKET:Zbt}});var F2e=y((NFt,U2e)=>{f();var{PACKET_TYPES:Jbt}=JO(),e1t=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",t1t=typeof ArrayBuffer=="function",r1t=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,i1t=({type:r,data:e},t,i)=>e1t&&e instanceof Blob?t?i(e):L2e(e,i):t1t&&(e instanceof ArrayBuffer||r1t(e))?t?i(e instanceof ArrayBuffer?e:e.buffer):L2e(new Blob([e]),i):i(Jbt[r]+(e||"")),L2e=(r,e)=>{let t=new FileReader;return t.onload=function(){let i=t.result.split(",")[1];e("b"+i)},t.readAsDataURL(r)};U2e.exports=i1t});var K2e=y(ek=>{f();(function(r){"use strict";ek.encode=function(e){var t=new Uint8Array(e),i,n=t.length,s="";for(i=0;i<n;i+=3)s+=r[t[i]>>2],s+=r[(t[i]&3)<<4|t[i+1]>>4],s+=r[(t[i+1]&15)<<2|t[i+2]>>6],s+=r[t[i+2]&63];return n%3==2?s=s.substring(0,s.length-1)+"=":n%3==1&&(s=s.substring(0,s.length-2)+"=="),s},ek.decode=function(e){var t=e.length*.75,i=e.length,n,s=0,o,a,c,u;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);var l=new ArrayBuffer(t),d=new Uint8Array(l);for(n=0;n<i;n+=4)o=r.indexOf(e[n]),a=r.indexOf(e[n+1]),c=r.indexOf(e[n+2]),u=r.indexOf(e[n+3]),d[s++]=o<<2|a>>4,d[s++]=(a&15)<<4|c>>2,d[s++]=(c&3)<<6|u&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")});var z2e=y((BFt,V2e)=>{f();var{PACKET_TYPES_REVERSE:tk,ERROR_PACKET:n1t}=JO(),s1t=typeof ArrayBuffer=="function",rk;s1t&&(rk=K2e());var o1t=(r,e)=>{if(typeof r!="string")return{type:"message",data:j2e(r,e)};let t=r.charAt(0);return t==="b"?{type:"message",data:a1t(r.substring(1),e)}:tk[t]?r.length>1?{type:tk[t],data:r.substring(1)}:{type:tk[t]}:n1t},a1t=(r,e)=>{if(rk){let t=rk.decode(r);return j2e(t,e)}else return{base64:!0,data:r}},j2e=(r,e)=>{switch(e){case"blob":return r instanceof ArrayBuffer?new Blob([r]):r;case"arraybuffer":default:return r}};V2e.exports=o1t});var hy=y((MFt,W2e)=>{f();var H2e=F2e(),$2e=z2e(),G2e=String.fromCharCode(30),c1t=(r,e)=>{let t=r.length,i=new Array(t),n=0;r.forEach((s,o)=>{H2e(s,!1,a=>{i[o]=a,++n===t&&e(i.join(G2e))})})},u1t=(r,e)=>{let t=r.split(G2e),i=[];for(let n=0;n<t.length;n++){let s=$2e(t[n],e);if(i.push(s),s.type==="error")break}return i};W2e.exports={protocol:4,encodePacket:H2e,encodePayload:c1t,decodePacket:$2e,decodePayload:u1t}});var py=y((LFt,ik)=>{f();typeof ik!="undefined"&&(ik.exports=Cs);function Cs(r){if(r)return l1t(r)}function l1t(r){for(var e in Cs.prototype)r[e]=Cs.prototype[e];return r}Cs.prototype.on=Cs.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};Cs.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};Cs.prototype.off=Cs.prototype.removeListener=Cs.prototype.removeAllListeners=Cs.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var i,n=0;n<t.length;n++)if(i=t[n],i===e||i.fn===e){t.splice(n,1);break}return t.length===0&&delete this._callbacks["$"+r],this};Cs.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){t=t.slice(0);for(var i=0,n=t.length;i<n;++i)t[i].apply(this,e)}return this};Cs.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};Cs.prototype.hasListeners=function(r){return!!this.listeners(r).length}});var B3=y((UFt,X2e)=>{f();var f1t=hy(),d1t=py(),h1t=be()("engine.io-client:transport"),Y2e=class extends d1t{constructor(e){super();this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){let i=new Error(e);return i.type="TransportError",i.description=t,this.emit("error",i),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"?this.write(e):h1t("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){let t=f1t.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}};X2e.exports=Y2e});var M3=y(nk=>{f();nk.encode=function(r){var e="";for(var t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e};nk.decode=function(r){for(var e={},t=r.split("&"),i=0,n=t.length;i<n;i++){var s=t[i].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}});var ak=y((KFt,tEe)=>{f();"use strict";var Q2e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),L3=64,Z2e={},J2e=0,tf=0,eEe;function sk(r){var e="";do e=Q2e[r%L3]+e,r=Math.floor(r/L3);while(r>0);return e}function p1t(r){var e=0;for(tf=0;tf<r.length;tf++)e=e*L3+Z2e[r.charAt(tf)];return e}function ok(){var r=sk(+new Date);return r!==eEe?(J2e=0,eEe=r):r+"."+sk(J2e++)}for(;tf<L3;tf++)Z2e[Q2e[tf]]=tf;ok.encode=sk;ok.decode=p1t;tEe.exports=ok});var ck=y((jFt,nEe)=>{f();var y1t=B3(),g1t=M3(),rEe=hy(),m1t=ak(),da=be()("engine.io-client:polling"),iEe=class extends y1t{get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{da("paused"),this.readyState="paused",e()};if(this.polling||!this.writable){let i=0;this.polling&&(da("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){da("pre-pause polling complete"),--i||t()})),this.writable||(da("we are currently writing - waiting to pause"),i++,this.once("drain",function(){da("pre-pause writing complete"),--i||t()}))}else t()}poll(){da("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){da("polling got data %s",e);let t=i=>{if(this.readyState==="opening"&&i.type==="open"&&this.onOpen(),i.type==="close")return this.onClose(),!1;this.onPacket(i)};rEe.decodePayload(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emit("pollComplete"),this.readyState==="open"?this.poll():da('ignoring poll - transport state "%s"',this.readyState))}doClose(){let e=()=>{da("writing close packet"),this.write([{type:"close"}])};this.readyState==="open"?(da("transport open - closing"),e()):(da("transport not open - deferring close"),this.once("open",e))}write(e){this.writable=!1,rEe.encodePayload(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{},t=this.opts.secure?"https":"http",i="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=m1t()),!this.supportsBinary&&!e.sid&&(e.b64=1),e=g1t.encode(e),this.opts.port&&(t==="https"&&Number(this.opts.port)!==443||t==="http"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}};nEe.exports=iEe});var uk=y((VFt,sEe)=>{f();sEe.exports.pick=(r,...e)=>e.reduce((t,i)=>(r.hasOwnProperty(i)&&(t[i]=r[i]),t),{})});var lEe=y((zFt,fk)=>{f();var oEe=ZO(),b1t=ck(),v1t=py(),{pick:w1t}=uk(),_1t=_1(),lk=be()("engine.io-client:polling-xhr");function aEe(){}var E1t=function(){return new oEe({xdomain:!1}).responseType!=null}(),cEe=class extends b1t{constructor(e){super(e);if(typeof location!="undefined"){let i=location.protocol==="https:",n=location.port;n||(n=i?443:80),this.xd=typeof location!="undefined"&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==i}let t=e&&e.forceBase64;this.supportsBinary=E1t&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new yo(this.uri(),e)}doWrite(e,t){let i=this.request({method:"POST",data:e});i.on("success",t),i.on("error",n=>{this.onError("xhr post error",n)})}doPoll(){lk("xhr poll");let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",t=>{this.onError("xhr poll error",t)}),this.pollXhr=e}},yo=class extends v1t{constructor(e,t){super();this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=t.async!==!1,this.data=t.data!==void 0?t.data:null,this.create()}create(){let e=w1t(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let t=this.xhr=new oEe(e);try{lk("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.opts.extraHeaders[i])}}catch(i){}if(this.method==="POST")try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{t.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=()=>{this.onLoad()},t.onerror=()=>{this.onError(t.responseText)}):t.onreadystatechange=()=>{t.readyState===4&&(t.status===200||t.status===1223?this.onLoad():setTimeout(()=>{this.onError(typeof t.status=="number"?t.status:0)},0))},lk("xhr data %s",this.data),t.send(this.data)}catch(i){setTimeout(()=>{this.onError(i)},0);return}typeof document!="undefined"&&(this.index=yo.requestsCount++,yo.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=aEe:this.xhr.onreadystatechange=aEe,e)try{this.xhr.abort()}catch(t){}typeof document!="undefined"&&delete yo.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&this.onData(e)}hasXDR(){return typeof XDomainRequest!="undefined"&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}};yo.requestsCount=0;yo.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",uEe);else if(typeof addEventListener=="function"){let r="onpagehide"in _1t?"pagehide":"unload";addEventListener(r,uEe,!1)}}function uEe(){for(let r in yo.requests)yo.requests.hasOwnProperty(r)&&yo.requests[r].abort()}fk.exports=cEe;fk.exports.Request=yo});var pEe=y((HFt,hEe)=>{f();var S1t=ck(),fEe=_1(),x1t=/\n/g,A1t=/\\n/g,U3,dEe=class extends S1t{constructor(e){super(e);this.query=this.query||{},U3||(U3=fEe.___eio=fEe.___eio||[]),this.index=U3.length,U3.push(this.onData.bind(this)),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){let e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=n=>{this.onError("jsonp poll error",n)};let t=document.getElementsByTagName("script")[0];t?t.parentNode.insertBefore(e,t):(document.head||document.body).appendChild(e),this.script=e,typeof navigator!="undefined"&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){let n=document.createElement("iframe");document.body.appendChild(n),document.body.removeChild(n)},100)}doWrite(e,t){let i;if(!this.form){let o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri();function n(){s(),t()}let s=()=>{if(this.iframe)try{this.form.removeChild(this.iframe)}catch(o){this.onError("jsonp polling iframe removal error",o)}try{let o='<iframe src="javascript:0" name="'+this.iframeId+'">';i=document.createElement(o)}catch(o){i=document.createElement("iframe"),i.name=this.iframeId,i.src="javascript:0"}i.id=this.iframeId,this.form.appendChild(i),this.iframe=i};s(),e=e.replace(A1t,`\\
`),this.area.value=e.replace(x1t,"\\n");try{this.form.submit()}catch(o){}this.iframe.attachEvent?this.iframe.onreadystatechange=()=>{this.iframe.readyState==="complete"&&n()}:this.iframe.onload=n}};hEe.exports=dEe});var mEe=y(($Ft,gEe)=>{f();var yEe=_1(),I1t=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):e=>setTimeout(e,0))();gEe.exports={WebSocket:yEe.WebSocket||yEe.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer",nextTick:I1t}});var _Ee=y((GFt,wEe)=>{f();var bEe=B3(),T1t=hy(),R1t=M3(),C1t=ak(),{pick:P1t}=uk(),{WebSocket:E1,usingBrowserWebSocket:dk,defaultBinaryType:O1t,nextTick:k1t}=mEe(),q1t=be()("engine.io-client:websocket"),vEe=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",F3=class extends bEe{constructor(e){super(e);this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,i=vEe?{}:P1t(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=dk&&!vEe?t?new E1(e,t):new E1(e):new E1(e,t,i)}catch(n){return this.emit("error",n)}this.ws.binaryType=this.socket.binaryType||O1t,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let i=e[t],n=t===e.length-1;T1t.encodePacket(i,this.supportsBinary,s=>{let o={};dk||(i.options&&(o.compress=i.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{dk?this.ws.send(s):this.ws.send(s,o)}catch(a){q1t("websocket closed before onclose event")}n&&k1t(()=>{this.writable=!0,this.emit("drain")})})}}onClose(){bEe.prototype.onClose.call(this)}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},t=this.opts.secure?"wss":"ws",i="";this.opts.port&&(t==="wss"&&Number(this.opts.port)!==443||t==="ws"&&Number(this.opts.port)!==80)&&(i=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=C1t()),this.supportsBinary||(e.b64=1),e=R1t.encode(e),e.length&&(e="?"+e);let n=this.opts.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.opts.hostname+"]":this.opts.hostname)+i+this.opts.path+e}check(){return!!E1&&!("__initialize"in E1&&this.name===F3.prototype.name)}};wEe.exports=F3});var pk=y(hk=>{f();var N1t=ZO(),D1t=lEe(),B1t=pEe(),M1t=_Ee();hk.polling=L1t;hk.websocket=M1t;function L1t(r){let e,t=!1,i=!1,n=r.jsonp!==!1;if(typeof location!="undefined"){let s=location.protocol==="https:",o=location.port;o||(o=s?443:80),t=r.hostname!==location.hostname||o!==r.port,i=r.secure!==s}if(r.xdomain=t,r.xscheme=i,e=new N1t(r),"open"in e&&!r.forceJSONP)return new D1t(r);if(!n)throw new Error("JSONP disabled");return new B1t(r)}});var AEe=y((YFt,xEe)=>{f();var U1t=pk(),F1t=py(),oi=be()("engine.io-client:socket"),EEe=hy(),SEe=XO(),K1t=M3(),_c=class extends F1t{constructor(e,t={}){super();e&&typeof e=="object"&&(t=e,e=null),e?(e=SEe(e),t.hostname=e.host,t.secure=e.protocol==="https"||e.protocol==="wss",t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=SEe(t.host).host),this.secure=t.secure!=null?t.secure:typeof location!="undefined"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=t.port||(typeof location!="undefined"&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=K1t.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){oi('creating transport "%s"',e);let t=j1t(this.opts.query);t.EIO=EEe.protocol,t.transport=e,this.id&&(t.sid=this.id);let i=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return oi("options: %j",i),new U1t[e](i)}open(){let e;if(this.opts.rememberUpgrade&&_c.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){setTimeout(()=>{this.emit("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch(t){oi("error while creating transport: %s",t),this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){oi("setting transport %s",e.name),this.transport&&(oi("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",()=>{this.onClose("transport close")})}probe(e){oi('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),i=!1;_c.priorWebsocketSuccess=!1;let n=()=>{i||(oi('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",d=>{if(!i)if(d.type==="pong"&&d.data==="probe"){if(oi('probe transport "%s" pong',e),this.upgrading=!0,this.emit("upgrading",t),!t)return;_c.priorWebsocketSuccess=t.name==="websocket",oi('pausing current transport "%s"',this.transport.name),this.transport.pause(()=>{i||this.readyState!=="closed"&&(oi("changing transport and sending upgrade packet"),l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emit("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{oi('probe transport "%s" failed',e);let h=new Error("probe error");h.transport=t.name,this.emit("upgradeError",h)}}))};function s(){i||(i=!0,l(),t.close(),t=null)}let o=d=>{let h=new Error("probe error: "+d);h.transport=t.name,s(),oi('probe transport "%s" failed because of error: %s',e,d),this.emit("upgradeError",h)};function a(){o("transport closed")}function c(){o("socket closed")}function u(d){t&&d.name!==t.name&&(oi('"%s" works - aborting "%s"',d.name,t.name),s())}let l=()=>{t.removeListener("open",n),t.removeListener("error",o),t.removeListener("close",a),this.removeListener("close",c),this.removeListener("upgrading",u)};t.once("open",n),t.once("error",o),t.once("close",a),this.once("close",c),this.once("upgrading",u),t.open()}onOpen(){if(oi("socket open"),this.readyState="open",_c.priorWebsocketSuccess=this.transport.name==="websocket",this.emit("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){oi("starting upgrade probes");let e=0,t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(oi('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("ping"),this.emit("pong");break;case"error":let t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data);break}else oi('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emit("drain"):this.flush()}flush(){this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(oi("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,i){return this.sendPacket("message",e,t,i),this}send(e,t,i){return this.sendPacket("message",e,t,i),this}sendPacket(e,t,i,n){if(typeof t=="function"&&(n=t,t=void 0),typeof i=="function"&&(n=i,i=null),this.readyState==="closing"||this.readyState==="closed")return;i=i||{},i.compress=i.compress!==!1;let s={type:e,data:t,options:i};this.emit("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let e=()=>{this.onClose("forced close"),oi("socket closing - telling transport to close"),this.transport.close()},t=()=>{this.removeListener("upgrade",t),this.removeListener("upgradeError",t),e()},i=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?i():e()}):this.upgrading?i():e()),this}onError(e){oi("socket error %j",e),_c.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(oi('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let t=[],i=0,n=e.length;for(;i<n;i++)~this.transports.indexOf(e[i])&&t.push(e[i]);return t}};_c.priorWebsocketSuccess=!1;_c.protocol=EEe.protocol;function j1t(r){let e={};for(let t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}xEe.exports=_c});var IEe=y((XFt,eh)=>{f();var yk=AEe();eh.exports=(r,e)=>new yk(r,e);eh.exports.Socket=yk;eh.exports.protocol=yk.protocol;eh.exports.Transport=B3();eh.exports.transports=pk();eh.exports.parser=hy()});var gk=y(yy=>{f();"use strict";Object.defineProperty(yy,"__esModule",{value:!0});yy.hasBinary=yy.isBinary=void 0;var V1t=typeof ArrayBuffer=="function",z1t=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,TEe=Object.prototype.toString,H1t=typeof Blob=="function"||typeof Blob!="undefined"&&TEe.call(Blob)==="[object BlobConstructor]",$1t=typeof File=="function"||typeof File!="undefined"&&TEe.call(File)==="[object FileConstructor]";function REe(r){return V1t&&(r instanceof ArrayBuffer||z1t(r))||H1t&&r instanceof Blob||$1t&&r instanceof File}yy.isBinary=REe;function K3(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,i=r.length;t<i;t++)if(K3(r[t]))return!0;return!1}if(REe(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return K3(r.toJSON(),!0);for(let t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&K3(r[t]))return!0;return!1}yy.hasBinary=K3});var CEe=y(gy=>{f();"use strict";Object.defineProperty(gy,"__esModule",{value:!0});gy.reconstructPacket=gy.deconstructPacket=void 0;var G1t=gk();function W1t(r){let e=[],t=r.data,i=r;return i.data=mk(t,e),i.attachments=e.length,{packet:i,buffers:e}}gy.deconstructPacket=W1t;function mk(r,e){if(!r)return r;if(G1t.isBinary(r)){let t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){let t=new Array(r.length);for(let i=0;i<r.length;i++)t[i]=mk(r[i],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){let t={};for(let i in r)r.hasOwnProperty(i)&&(t[i]=mk(r[i],e));return t}return r}function Y1t(r,e){return r.data=bk(r.data,e),r.attachments=void 0,r}gy.reconstructPacket=Y1t;function bk(r,e){if(!r)return r;if(r&&r._placeholder)return e[r.num];if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=bk(r[t],e);else if(typeof r=="object")for(let t in r)r.hasOwnProperty(t)&&(r[t]=bk(r[t],e));return r}});var V3=y(ha=>{f();"use strict";Object.defineProperty(ha,"__esModule",{value:!0});ha.Decoder=ha.Encoder=ha.PacketType=ha.protocol=void 0;var X1t=py(),PEe=CEe(),OEe=gk(),vk=be()("socket.io-parser");ha.protocol=5;var gi;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(gi=ha.PacketType||(ha.PacketType={}));var kEe=class{encode(e){return vk("encoding packet %j",e),(e.type===gi.EVENT||e.type===gi.ACK)&&OEe.hasBinary(e)?(e.type=e.type===gi.EVENT?gi.BINARY_EVENT:gi.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===gi.BINARY_EVENT||e.type===gi.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data)),vk("encoded %j as %s",e,t),t}encodeAsBinary(e){let t=PEe.deconstructPacket(e),i=this.encodeAsString(t.packet),n=t.buffers;return n.unshift(i),n}};ha.Encoder=kEe;var j3=class extends X1t{constructor(){super()}add(e){let t;if(typeof e=="string")t=this.decodeString(e),t.type===gi.BINARY_EVENT||t.type===gi.BINARY_ACK?(this.reconstructor=new qEe(t),t.attachments===0&&super.emit("decoded",t)):super.emit("decoded",t);else if(OEe.isBinary(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,i={type:Number(e.charAt(0))};if(gi[i.type]===void 0)throw new Error("unknown packet type "+i.type);if(i.type===gi.BINARY_EVENT||i.type===gi.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");i.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););i.nsp=e.substring(s,t)}else i.nsp="/";let n=e.charAt(t+1);if(n!==""&&Number(n)==n){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}i.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=Q1t(e.substr(t));if(j3.isPayloadValid(i.type,s))i.data=s;else throw new Error("invalid payload")}return vk("decoded %s as %j",e,i),i}static isPayloadValid(e,t){switch(e){case gi.CONNECT:return typeof t=="object";case gi.DISCONNECT:return t===void 0;case gi.CONNECT_ERROR:return typeof t=="string"||typeof t=="object";case gi.EVENT:case gi.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case gi.ACK:case gi.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}};ha.Decoder=j3;function Q1t(r){try{return JSON.parse(r)}catch(e){return!1}}var qEe=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=PEe.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}});var wk=y(z3=>{f();"use strict";Object.defineProperty(z3,"__esModule",{value:!0});z3.on=void 0;function Z1t(r,e,t){return r.on(e,t),function(){r.off(e,t)}}z3.on=Z1t});var _k=y(H3=>{f();"use strict";Object.defineProperty(H3,"__esModule",{value:!0});H3.StrictEventEmitter=void 0;var J1t=py(),NEe=class extends J1t{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t),this}emitReserved(e,...t){return super.emit(e,...t),this}listeners(e){return super.listeners(e)}};H3.StrictEventEmitter=NEe});var Ek=y(G3=>{f();"use strict";Object.defineProperty(G3,"__esModule",{value:!0});G3.Socket=void 0;var go=V3(),$3=wk(),evt=_k(),mo=be()("socket.io-client:socket"),tvt=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),DEe=class extends evt.StrictEventEmitter{constructor(e,t,i){super();this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.auth&&(this.auth=i.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;let e=this.io;this.subs=[$3.on(e,"open",this.onopen.bind(this)),$3.on(e,"packet",this.onpacket.bind(this)),$3.on(e,"error",this.onerror.bind(this)),$3.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(tvt.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);let i={type:go.PacketType.EVENT,data:t};i.options={},i.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"&&(mo("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++);let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)?mo("discard packet as the transport is not currently writable"):this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){mo("transport is open - connecting"),typeof this.auth=="function"?this.auth(e=>{this.packet({type:go.PacketType.CONNECT,data:e})}):this.packet({type:go.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){mo("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case go.PacketType.CONNECT:if(e.data&&e.data.sid){let n=e.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case go.PacketType.EVENT:this.onevent(e);break;case go.PacketType.BINARY_EVENT:this.onevent(e);break;case go.PacketType.ACK:this.onack(e);break;case go.PacketType.BINARY_ACK:this.onack(e);break;case go.PacketType.DISCONNECT:this.ondisconnect();break;case go.PacketType.CONNECT_ERROR:let i=new Error(e.data.message);i.data=e.data.data,this.emitReserved("connect_error",i);break}}onevent(e){let t=e.data||[];mo("emitting event %j",t),e.id!=null&&(mo("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let i of t)i.apply(this,e)}super.emit.apply(this,e)}ack(e){let t=this,i=!1;return function(...n){i||(i=!0,mo("sending ack %j",n),t.packet({type:go.PacketType.ACK,id:e,data:n}))}}onack(e){let t=this.acks[e.id];typeof t=="function"?(mo("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):mo("bad ack %s",e.id)}onconnect(e){mo("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){mo("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(mo("performing disconnect (%s)",this.nsp),this.packet({type:go.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let i=0;i<t.length;i++)if(e===t[i])return t.splice(i,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}};G3.Socket=DEe});var MEe=y((iKt,BEe)=>{f();BEe.exports=my;function my(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}my.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=(Math.floor(e*10)&1)==0?r-t:r+t}return Math.min(r,this.max)|0};my.prototype.reset=function(){this.attempts=0};my.prototype.setMin=function(r){this.ms=r};my.prototype.setMax=function(r){this.max=r};my.prototype.setJitter=function(r){this.jitter=r}});var Sk=y(W3=>{f();"use strict";Object.defineProperty(W3,"__esModule",{value:!0});W3.Manager=void 0;var rvt=IEe(),ivt=Ek(),nvt=V3(),th=wk(),svt=MEe(),ovt=_k(),Ji=be()("socket.io-client:manager"),LEe=class extends ovt.StrictEventEmitter{constructor(e,t){super();this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new svt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let i=t.parser||nvt;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(Ji("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;Ji("opening %s",this.uri),this.engine=rvt(this.uri,this.opts);let t=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let n=th.on(t,"open",function(){i.onopen(),e&&e()}),s=th.on(t,"error",o=>{Ji("error"),i.cleanup(),i._readyState="closed",this.emitReserved("error",o),e?e(o):i.maybeReconnectOnOpen()});if(this._timeout!==!1){let o=this._timeout;Ji("connect attempt will timeout after %d",o),o===0&&n();let a=setTimeout(()=>{Ji("connect attempt timed out after %d",o),n(),t.close(),t.emit("error",new Error("timeout"))},o);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(n),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){Ji("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(th.on(e,"ping",this.onping.bind(this)),th.on(e,"data",this.ondata.bind(this)),th.on(e,"error",this.onerror.bind(this)),th.on(e,"close",this.onclose.bind(this)),th.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){Ji("error",e),this.emitReserved("error",e)}socket(e,t){let i=this.nsps[e];return i||(i=new ivt.Socket(this,e,t),this.nsps[e]=i),i}_destroy(e){let t=Object.keys(this.nsps);for(let i of t)if(this.nsps[i].active){Ji("socket %s is still active, skipping close",i);return}this._close()}_packet(e){Ji("writing packet %j",e);let t=this.encoder.encode(e);for(let i=0;i<t.length;i++)this.engine.write(t[i],e.options)}cleanup(){Ji("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){Ji("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,this._readyState==="opening"&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){Ji("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)Ji("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();Ji("will wait %dms before reconnect attempt",t),this._reconnecting=!0;let i=setTimeout(()=>{e.skipReconnect||(Ji("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(n=>{n?(Ji("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",n)):(Ji("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&i.unref(),this.subs.push(function(){clearTimeout(i)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};W3.Manager=LEe});var jEe=y((us,KEe)=>{f();"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.io=us.Socket=us.Manager=us.protocol=void 0;var avt=k2e(),UEe=Sk(),FEe=be()("socket.io-client");KEe.exports=us=Y3;var S1=us.managers={};function Y3(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};let t=avt.url(r,e.path||"/socket.io"),i=t.source,n=t.id,s=t.path,o=S1[n]&&s in S1[n].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,c;return a?(FEe("ignoring socket cache for %s",i),c=new UEe.Manager(i,e)):(S1[n]||(FEe("new io instance for %s",i),S1[n]=new UEe.Manager(i,e)),c=S1[n]),t.query&&!e.query&&(e.query=t.queryKey),c.socket(t.path,e)}us.io=Y3;var cvt=V3();Object.defineProperty(us,"protocol",{enumerable:!0,get:function(){return cvt.protocol}});us.connect=Y3;var uvt=Sk();Object.defineProperty(us,"Manager",{enumerable:!0,get:function(){return uvt.Manager}});var lvt=Ek();Object.defineProperty(us,"Socket",{enumerable:!0,get:function(){return lvt.Socket}});us.default=Y3});var xk=y((sKt,VEe)=>{f();var fvt=pS();VEe.exports=r=>async e=>{e=fvt(e);let t=v=>{typeof v.return=="function"&&v.return()},i=null,n=null,s=v=>{i=v,n&&n(v),t(e)},o=null,a=!1,c=()=>{a=!0,o&&o()},u=null,l=!1,d=()=>{l=!0,u&&u()},h=null,p=()=>{h&&h()},g=()=>new Promise((v,A)=>{o=h=v,n=A,r.once("drain",p)}),b=()=>(t(e),new Promise((v,A)=>{if(a||l||i)return v();u=o=v,n=A})),E=()=>{r.removeListener("error",s),r.removeListener("close",c),r.removeListener("finish",d),r.removeListener("drain",p)};r.once("error",s),r.once("close",c),r.once("finish",d);try{for await(let v of e){if(!r.writable||r.destroyed||i)break;r.write(v)===!1&&await g()}}catch(v){i||r.destroy(),i=v}try{if(r.writable&&r.end(),await b(),i)throw i}finally{E()}}});var Ak=y((oKt,zEe)=>{f();var dvt=xk(),hvt=Zb();zEe.exports=r=>({sink:dvt(r),source:hvt(r)})});var $Ee=y((aKt,HEe)=>{f();var pvt=Ak();HEe.exports=r=>async function*(e){let t=pvt(r),i;if(t.sink(e).catch(n=>{i=n}),yield*t.source,i)throw i}});var GEe=y((cKt,by)=>{f();by.exports=Zb();by.exports.source=Zb();by.exports.sink=xk();by.exports.transform=$Ee();by.exports.duplex=Ak()});var Ik=y((uKt,ZEe)=>{f();"use strict";var WEe=fc(),yvt=GEe(),{CLOSE_TIMEOUT:gvt}=N3(),YEe=LO(),XEe=be(),X3=XEe("libp2p:webrtc-star:socket");X3.error=XEe("libp2p:webrtc-star:socket:error");var QEe=(r,e)=>{if(!(!r||!e))try{return YEe(r,e)}catch(t){return X3.error(t),YEe("0.0.0.0",e)}};ZEe.exports=(r,e={})=>{let{sink:t,source:i}=yvt.duplex(r),n=e.remoteAddr||QEe(r.remoteAddress,r.remotePort),s=QEe(r.localAddress,r.localPort),o={async sink(a){e.signal&&(a=WEe(a,e.signal));try{await t(async function*(){for await(let c of a)yield c instanceof Uint8Array?c:c.slice()}())}catch(c){c.type!=="aborted"&&X3.error(c)}},source:e.signal?WEe(i,e.signal):i,conn:r,localAddr:s,remoteAddr:n,timeline:{open:Date.now()},close(){if(!r.destroyed)return new Promise((a,c)=>{let u=Date.now(),l=setTimeout(()=>{if(o.remoteAddr){let{host:d,port:h}=o.remoteAddr.toOptions();X3("timeout closing socket to %s:%s after %dms, destroying it manually",d,h,Date.now()-u)}r.destroyed||r.destroy()},gvt);r.once("close",()=>{a()}),r.end(d=>{if(clearTimeout(l),o.timeline.close=Date.now(),d)return c(d)})})}};return r.once("close",()=>{o.timeline.close||(o.timeline.close=Date.now())}),o}});var Tk=y((lKt,eSe)=>{f();"use strict";var{Multiaddr:JEe}=it();function mvt(r){let e=r.toString().split("/"),t=r.protos()[1].name,i=r.protos()[2].name,n=r.stringTuples()[1][1];if(t!=="tcp"||i!=="ws"&&i!=="wss")throw new Error("invalid multiaddr: "+r.toString());if(!JEe.isName(r))return"http://"+e[2]+":"+e[4];if(i==="ws")return"http://"+e[2]+(n==="80"?"":":"+n);if(i==="wss")return"https://"+e[2]+(n==="443"?"":":"+n)}function bvt(r){let e="/libp2p-webrtc-star";if(r.indexOf(e)!==-1){r=r.substring(e.length,r.length);let t=new JEe(r),i=t.stringTuples().filter(n=>n[0]===421)[0];t=t.decapsulate("p2p"),t=t.encapsulate("/p2p-webrtc-star"),t=t.encapsulate(`/p2p/${i[1]}`),r=t.toString()}return r}eSe.exports={cleanUrlSIO:mvt,cleanMultiaddr:bvt}});var nSe=y((fKt,iSe)=>{f();"use strict";var vvt=yr(),tSe=be(),rh=tSe("libp2p:webrtc-star:listener");rh.error=tSe("libp2p:webrtc-star:listener:error");var wvt=ae(),_vt=jEe(),Evt=YO(),Svt=ml(),xvt=Ik(),{cleanUrlSIO:Avt}=Tk(),{CODE_P2P:rSe}=N3(),Ivt={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"};iSe.exports=({handler:r,upgrader:e},t,i={})=>{let n=new vvt,s,o;return n.__connections=[],n.__spChannels=new Map,n.__pendingIntents=new Map,n.listen=a=>{if(s)throw wvt(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let c=Svt();s=a;let u;!a.protoCodes().includes(rSe)&&e.localPeer?u=a.encapsulate(`/p2p/${e.localPeer.toB58String()}`):u=a,n.on("error",()=>c.reject()),o=Avt(a),rh("Dialing to Signalling Server on: "+o),n.io=_vt.connect(o,Ivt);let l=d=>{if(d.answer||d.err||!d.intentId)return;let h=d.intentId,p=n.__pendingIntents.get(h);p||(p=[],n.__pendingIntents.set(h,p));let g=n.__spChannels.get(h);if(g){g.signal(d.signal);return}else if(d.signal.type!=="offer"){p.push(d);return}let b={trickle:!1,...i};t.wrtc&&(b.wrtc=t.wrtc),g=new Evt(b);let E=v=>{rh.error("incoming connection errored",v)};g.on("error",E),g.once("close",(...v)=>{g.removeListener("error",E)}),g.on("signal",v=>{d.signal=v,d.answer=!0,n.io.emit("ss-handshake",d)}),g.signal(d.signal);for(let v of p)g.signal(v.signal);n.__pendingIntents.set(h,[]),g.once("connect",async()=>{let v=xvt(g);rh("new inbound connection %s",v.remoteAddr);let A;try{A=await e.upgradeInbound(v)}catch(R){return rh.error("inbound connection failed to upgrade",R),v.close()}if(!A.remoteAddr)try{A.remoteAddr=a.decapsulateCode(rSe).encapsulate(`/p2p/${A.remotePeer.toB58String()}`)}catch(R){rh.error("could not determine remote address",R)}rh("inbound connection %s upgraded",v.remoteAddr),Tvt(n,v,h),n.emit("connection",A),r(A)}),n.__spChannels.set(h,g)};return n.io.once("connect_error",d=>c.reject(d)),n.io.once("error",d=>{n.emit("error",d),n.emit("close")}),n.io.on("ws-handshake",l),n.io.on("ws-peer",t._peerDiscovered),n.io.on("connect",()=>{n.io.emit("ss-join",u.toString())}),n.io.once("connect",()=>{n.emit("listening"),c.resolve()}),t.sigReferences.set(o,{listener:n,signallingAddr:u}),c.promise},n.close=async()=>{let a=t.sigReferences.get(o);a&&a.listener.io&&(a.listener.io.emit("ss-leave"),a.listener.io.close()),await Promise.all(n.__connections.map(c=>c.close())),n.emit("close"),n.removeAllListeners(),s=void 0,t.sigReferences.delete(o)},n.getAddrs=()=>[s],n};function Tvt(r,e,t){r.__connections.push(e);let i=()=>{r.__connections=r.__connections.filter(n=>n!==e),r.__spChannels.delete(t),r.__pendingIntents.delete(t)};e.conn.once("close",i)}});var uSe=y((dKt,cSe)=>{f();"use strict";var sSe=be(),Au=sSe("libp2p:webrtc-star");Au.error=sSe("libp2p:webrtc-star:error");var{EventEmitter:Rvt}=yr(),Q3=ae(),Cvt=Nw(),{AbortError:oSe}=fc(),Pvt=YO(),{supportsWebRTCDataChannels:Ovt}=C2e(),{Multiaddr:kvt}=it(),qvt=Bf(),Nvt=rt(),{CODE_CIRCUIT:Dvt}=N3(),Bvt=nSe(),Mvt=Ik(),{cleanMultiaddr:Lvt,cleanUrlSIO:Uvt}=Tk();function Fvt(){}var aSe=class{constructor(e={}){if(!e.upgrader)throw new Error("An upgrader must be provided. See https://github.com/libp2p/interface-transport#upgrader.");this._upgrader=e.upgrader,this.sioOptions={transports:["websocket"],"force new connection":!0},e.wrtc&&(this.wrtc=e.wrtc),this.sigReferences=new Map,this.discovery=new Rvt,this.discovery.tag="webRTCStar",this.discovery._isStarted=!1,this.discovery.start=()=>{this.discovery._isStarted=!0},this.discovery.stop=()=>{this.discovery._isStarted=!1},this._peerDiscovered=this._peerDiscovered.bind(this)}async dial(e,t={}){let i=await this._connect(e,t),n=Mvt(i,{remoteAddr:e,signal:t.signal});Au("new outbound connection %s",n.remoteAddr);let s=await this._upgrader.upgradeOutbound(n);return Au("outbound connection %s upgraded",n.remoteAddr),s}_connect(e,t={}){if(t.signal&&t.signal.aborted)throw new oSe;let i={initiator:!0,trickle:!1,...t.spOptions||{}};this.wrtc&&(i.wrtc=this.wrtc);let n=e.toOptions(),s=(~~(Math.random()*1e9)).toString(36)+Date.now();return new Promise((o,a)=>{let c=this.sigReferences.get(Uvt(e));if(!c||!c.listener)return a(Q3(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=c.listener.io,l=Date.now(),d;Au("dialing %s:%s",n.host,n.port);let h=new Pvt(i),p=A=>{if(!d){let R=`connection error ${n.host}:${n.port}: ${A.message}`;Au.error(R),v(A)}},g=()=>{Au("connnection timeout %s:%s",n.host,n.port);let A=Q3(new Error(`connection timeout after ${Date.now()-l}ms`),"ERR_CONNECT_TIMEOUT");h.emit("error",A)},b=()=>{d=!0,Au("connection opened %s:%s",n.host,n.port),v(null)},E=()=>{Au.error("connection aborted %s:%s",n.host,n.port),h.destroy(),v(new oSe)},v=A=>{h.removeListener("timeout",g),h.removeListener("connect",b),t.signal&&t.signal.removeEventListener("abort",E),A?a(A):o(h)};h.on("error",p),h.once("timeout",g),h.once("connect",b),h.on("close",()=>{h.removeListener("error",p)}),t.signal&&t.signal.addEventListener("abort",E),h.on("signal",A=>{u.emit("ss-handshake",{intentId:s,srcMultiaddr:c.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:A})}),u.on("ws-handshake",A=>{A.intentId===s&&A.err&&(h.destroy(),a(Q3(A.err instanceof Error?A.err:new Error(A.err),"ERR_SIGNALLING_FAILED"))),!(A.intentId!==s||!A.answer||h.destroyed)&&h.signal(A.signal)})})}createListener(e={},t){if(!Ovt&&!this.wrtc)throw Q3(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return typeof e=="function"&&(t=e,e={}),t=t||Fvt,Bvt({handler:t,upgrader:this._upgrader},this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(t=>t.protoCodes().includes(Dvt)?!1:qvt.WebRTCStar.matches(t))}_peerDiscovered(e){if(!this.discovery._isStarted)return;Au("Peer Discovered:",e),e=Lvt(e);let t=new kvt(e),i=Nvt.createFromB58String(t.getPeerId());this.discovery.emit("peer",{id:i,multiaddrs:[t]})}};cSe.exports=Cvt(aSe,{className:"WebRTCStar",symbolName:"@libp2p/js-libp2p-webrtc-star/webrtcstar"})});var pSe=y((hKt,hSe)=>{f();"use strict";var Z3=ys(),lSe=bn(),Rk=10*1024,fSe=class{constructor(){this._pool=new Uint8Array(Rk),this._poolOffset=0}write(e){let t=this._pool,i=this._poolOffset;Z3.encode(e.id<<3|e.type,t,i),i+=Z3.encode.bytes,Z3.encode(e.data?e.data.length:0,t,i),i+=Z3.encode.bytes;let n=t.subarray(this._poolOffset,i);return Rk-i<100?(this._pool=new Uint8Array(Rk),this._poolOffset=0):this._poolOffset=i,e.data?[n,e.data]:n}},dSe=new fSe;hSe.exports=r=>async function*(){for await(let t of r)Array.isArray(t)?yield new lSe(t.map(i=>dSe.write(i))):yield new lSe(dSe.write(t))}()});var mSe=y((pKt,gSe)=>{f();"use strict";var J3=ys(),Kvt=bn();gSe.exports=r=>async function*(){let t=new ySe;for await(let i of r){let n=t.write(i);n.length&&(yield n)}}();var ySe=class{constructor(){this._buffer=new Kvt,this._bufferProxy=new Proxy({},{get:(e,t)=>t[0]==="l"?this._buffer[t]:this._buffer.get(parseInt(t))}),this._headerInfo=null}write(e){if(!e||!e.length)return[];this._buffer.append(e);let t=[];for(;;){if(!this._headerInfo)try{this._headerInfo=this._decodeHeader(this._bufferProxy)}catch(c){break}let{id:i,type:n,length:s,offset:o}=this._headerInfo;if(this._buffer.length-o<s)break;t.push({id:i,type:n,data:this._buffer.shallowSlice(o,o+s)}),this._buffer.consume(o+s),this._headerInfo=null}return t}_decodeHeader(e){let t=J3.decode(e),i=J3.decode.bytes,n=J3.decode(e,i);return i+=J3.decode.bytes,{id:t>>3,type:t&7,offset:i,length:n}}}});var bSe=y(Ck=>{f();"use strict";Ck.encode=pSe();Ck.decode=mSe()});var Ok=y((gKt,Pk)=>{f();"use strict";var vSe=1<<20;Pk.exports=r=>{r=r||vSe;let e=t=>{if(t.data&&t.data.length>r)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return t=>async function*(){for await(let n of t)Array.isArray(n)?n.forEach(e):e(n),yield n}()};Pk.exports.MAX_MSG_SIZE=vSe});var kk=y(x1=>{f();"use strict";var Iu=Object.freeze({NEW_STREAM:0,MESSAGE_RECEIVER:1,MESSAGE_INITIATOR:2,CLOSE_RECEIVER:3,CLOSE_INITIATOR:4,RESET_RECEIVER:5,RESET_INITIATOR:6});x1.MessageTypes=Iu;x1.InitiatorMessageTypes=Object.freeze({NEW_STREAM:Iu.NEW_STREAM,MESSAGE:Iu.MESSAGE_INITIATOR,CLOSE:Iu.CLOSE_INITIATOR,RESET:Iu.RESET_INITIATOR});x1.ReceiverMessageTypes=Object.freeze({MESSAGE:Iu.MESSAGE_RECEIVER,CLOSE:Iu.CLOSE_RECEIVER,RESET:Iu.RESET_RECEIVER});x1.MessageTypeNames=Object.freeze(Object.entries(Iu).reduce((r,e)=>(r[e[1]]=e[0],r),{}))});var SSe=y((bKt,ESe)=>{f();"use strict";var jvt=fc(),wSe=df(),A1=be()("libp2p:mplex:stream"),Vvt=Qa(),_Se=bn(),zvt=ae(),{MAX_MSG_SIZE:Hvt}=Ok(),{InitiatorMessageTypes:$vt,ReceiverMessageTypes:Gvt}=kk(),qk="ERR_MPLEX_STREAM_RESET",Wvt="ERR_MPLEX_STREAM_ABORT";ESe.exports=({id:r,name:e,send:t,onEnd:i=()=>{},type:n="initiator",maxMsgSize:s=Hvt})=>{let o=new wSe,a=new wSe,c=n==="initiator"?$vt:Gvt,u=n==="initiator"?`i${r}`:`r${r}`;e=String(e??r);let l=!1,d=!1,h,p=E=>{l||(l=!0,A1("%s stream %s source end",n,e,E),E&&!h&&(h=E),d&&(b.timeline.close=Date.now(),i(h)))},g=E=>{d||(d=!0,A1("%s stream %s sink end",n,e,E),E&&!h&&(h=E),l&&(b.timeline.close=Date.now(),i(h)))},b={close:()=>b.source.end(),abort:E=>{A1("%s stream %s abort",n,e,E),b.source.end(E),o.abort(),g(E)},reset:()=>{let E=zvt(new Error("stream reset"),qk);a.abort(),b.source.end(E),g(E)},sink:async E=>{E=jvt(E,[{signal:o.signal,options:{abortMessage:"stream aborted",abortCode:Wvt}},{signal:a.signal,options:{abortMessage:"stream reset",abortCode:qk}}]),n==="initiator"&&t({id:r,type:c.NEW_STREAM,data:e});try{for await(let v of E)for(;v.length;){if(v.length<=s){t({id:r,type:c.MESSAGE,data:v});break}v=_Se.isBufferList(v)?v:new _Se(v),t({id:r,type:c.MESSAGE,data:v.shallowSlice(0,s)}),v.consume(s)}}catch(v){return v.code===qk?A1("%s stream %s reset",n,e):(A1("%s stream %s error",n,e,v),t({id:r,type:c.RESET})),b.source.end(v),g(v)}t({id:r,type:c.CLOSE}),g()},source:Vvt(p),timeline:{open:Date.now(),close:null},id:u};return b}});var TSe=y((vKt,ISe)=>{f();"use strict";var Yvt=Ar(),Xvt=Qa(),Tu=be()("libp2p:mplex"),Qvt=fc(),xSe=bSe(),Zvt=Ok(),{MessageTypes:ih,MessageTypeNames:ASe}=kk(),Jvt=SSe(),Nk=class{constructor(e){e=e||{},e=typeof e=="function"?{onStream:e}:e,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._options=e,this.sink=this._createSink(),this.source=this._createSource(),this.onStream=e.onStream,this.onStreamEnd=e.onStreamEnd}get streams(){let e=[];return this._streams.initiators.forEach(t=>{e.push(t)}),this._streams.receivers.forEach(t=>{e.push(t)}),e}newStream(e){let t=this._streamId++;e=e==null?t.toString():String(e);let i=this._streams.initiators;return this._newStream({id:t,name:e,type:"initiator",registry:i})}_newReceiverStream({id:e,name:t}){let i=this._streams.receivers;return this._newStream({id:e,name:t,type:"receiver",registry:i})}_newStream({id:e,name:t,type:i,registry:n}){if(n.has(e))throw new Error(`${i} stream ${e} already exists!`);Tu("new %s stream %s %s",i,e,t);let a=Jvt({id:e,name:t,send:c=>(Tu.enabled&&Tu("%s stream %s %s send",i,e,t,{...c,type:ASe[c.type],data:c.data&&c.data.slice()}),this.source.push(c)),type:i,onEnd:()=>{Tu("%s stream %s %s ended",i,e,t),n.delete(e),this.onStreamEnd&&this.onStreamEnd(a)},maxMsgSize:this._options.maxMsgSize});return n.set(e,a),a}_createSink(){return async e=>{this._options.signal&&(e=Qvt(e,this._options.signal));try{await Yvt(e,xSe.decode,Zvt(this._options.maxMsgSize),async t=>{for await(let i of t)for(let n of i)this._handleIncoming(n)})}catch(t){return Tu("error in sink",t),this.source.end(t)}this.source.end()}}_createSource(){let t=Xvt({onEnd:i=>{let{initiators:n,receivers:s}=this._streams;for(let o of n.values())o.abort(i);for(let o of s.values())o.abort(i)},writev:!0});return Object.assign(xSe.encode(t),{push:t.push,end:t.end,return:t.return})}_handleIncoming({id:e,type:t,data:i}){if(Tu.enabled&&Tu("incoming message",{id:e,type:ASe[t],data:i.slice()}),t===ih.NEW_STREAM&&this.onStream){let o=this._newReceiverStream({id:e,name:i.toString()});return this.onStream(o)}let s=(t&1?this._streams.initiators:this._streams.receivers).get(e);if(!s)return Tu("missing stream %s",e);switch(t){case ih.MESSAGE_INITIATOR:case ih.MESSAGE_RECEIVER:s.source.push(i);break;case ih.CLOSE_INITIATOR:case ih.CLOSE_RECEIVER:s.close();break;case ih.RESET_INITIATOR:case ih.RESET_RECEIVER:s.reset();break;default:Tu("unknown message type %s",t)}}};Nk.multicodec="/mplex/6.7.0";ISe.exports=Nk});var CSe=y((wKt,RSe)=>{f();"use strict";RSe.exports=TSe()});var OSe=y(Dk=>{f();"use strict";Object.defineProperty(Dk,"__esModule",{value:!0});var PSe=65536,ewt=function(){function r(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),i=0;i<t.length;i+=PSe)this._crypto.getRandomValues(t.subarray(i,i+Math.min(t.length-i,PSe)));return t},r}();Dk.BrowserRandomSource=ewt});var Ec=y(Bk=>{f();"use strict";Object.defineProperty(Bk,"__esModule",{value:!0});function twt(r){for(var e=0;e<r.length;e++)r[e]=0;return r}Bk.wipe=twt});var kSe=y(Mk=>{f();"use strict";Object.defineProperty(Mk,"__esModule",{value:!0});var rwt=Ec(),iwt=function(){function r(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof ya!="undefined"){var e=xh();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return r.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=t[n];return rwt.wipe(t),i},r}();Mk.NodeRandomSource=iwt});var qSe=y(Lk=>{f();"use strict";Object.defineProperty(Lk,"__esModule",{value:!0});var nwt=OSe(),swt=kSe(),owt=function(){function r(){if(this.isAvailable=!1,this.name="",this._source=new nwt.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new swt.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return r.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},r}();Lk.SystemRandomSource=owt});var NSe=y(Ps=>{f();"use strict";Object.defineProperty(Ps,"__esModule",{value:!0});function awt(r,e){var t=r>>>16&65535,i=r&65535,n=e>>>16&65535,s=e&65535;return i*s+(t*s+i*n<<16>>>0)|0}Ps.mul=Math.imul||awt;function cwt(r,e){return r+e|0}Ps.add=cwt;function uwt(r,e){return r-e|0}Ps.sub=uwt;function lwt(r,e){return r<<e|r>>>32-e}Ps.rotl=lwt;function fwt(r,e){return r<<32-e|r>>>e}Ps.rotr=fwt;function dwt(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}Ps.isInteger=Number.isInteger||dwt;Ps.MAX_SAFE_INTEGER=9007199254740991;Ps.isSafeInteger=function(r){return Ps.isInteger(r)&&r>=-Ps.MAX_SAFE_INTEGER&&r<=Ps.MAX_SAFE_INTEGER}});var I1=y(bt=>{f();"use strict";Object.defineProperty(bt,"__esModule",{value:!0});var DSe=NSe();function hwt(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])<<16>>16}bt.readInt16BE=hwt;function pwt(r,e){return e===void 0&&(e=0),(r[e+0]<<8|r[e+1])>>>0}bt.readUint16BE=pwt;function ywt(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])<<16>>16}bt.readInt16LE=ywt;function gwt(r,e){return e===void 0&&(e=0),(r[e+1]<<8|r[e])>>>0}bt.readUint16LE=gwt;function BSe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>8,e[t+1]=r>>>0,e}bt.writeUint16BE=BSe;bt.writeInt16BE=BSe;function MSe(r,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e}bt.writeUint16LE=MSe;bt.writeInt16LE=MSe;function Uk(r,e){return e===void 0&&(e=0),r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3]}bt.readInt32BE=Uk;function Fk(r,e){return e===void 0&&(e=0),(r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3])>>>0}bt.readUint32BE=Fk;function Kk(r,e){return e===void 0&&(e=0),r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e]}bt.readInt32LE=Kk;function jk(r,e){return e===void 0&&(e=0),(r[e+3]<<24|r[e+2]<<16|r[e+1]<<8|r[e])>>>0}bt.readUint32LE=jk;function ex(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r>>>0,e}bt.writeUint32BE=ex;bt.writeInt32BE=ex;function tx(r,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=r>>>0,e[t+1]=r>>>8,e[t+2]=r>>>16,e[t+3]=r>>>24,e}bt.writeUint32LE=tx;bt.writeInt32LE=tx;function mwt(r,e){e===void 0&&(e=0);var t=Uk(r,e),i=Uk(r,e+4);return t*4294967296+i-(i>>31)*4294967296}bt.readInt64BE=mwt;function bwt(r,e){e===void 0&&(e=0);var t=Fk(r,e),i=Fk(r,e+4);return t*4294967296+i}bt.readUint64BE=bwt;function vwt(r,e){e===void 0&&(e=0);var t=Kk(r,e),i=Kk(r,e+4);return i*4294967296+t-(t>>31)*4294967296}bt.readInt64LE=vwt;function wwt(r,e){e===void 0&&(e=0);var t=jk(r,e),i=jk(r,e+4);return i*4294967296+t}bt.readUint64LE=wwt;function LSe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ex(r/4294967296>>>0,e,t),ex(r>>>0,e,t+4),e}bt.writeUint64BE=LSe;bt.writeInt64BE=LSe;function USe(r,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),tx(r>>>0,e,t),tx(r/4294967296>>>0,e,t+4),e}bt.writeUint64LE=USe;bt.writeInt64LE=USe;function _wt(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=r/8+t-1;s>=t;s--)i+=e[s]*n,n*=256;return i}bt.readUintBE=_wt;function Ewt(r,e,t){if(t===void 0&&(t=0),r%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(r/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=t;s<t+r/8;s++)i+=e[s]*n,n*=256;return i}bt.readUintLE=Ewt;function Swt(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!DSe.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=r/8+i-1;s>=i;s--)t[s]=e/n&255,n*=256;return t}bt.writeUintBE=Swt;function xwt(r,e,t,i){if(t===void 0&&(t=new Uint8Array(r/8)),i===void 0&&(i=0),r%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!DSe.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+r/8;s++)t[s]=e/n&255,n*=256;return t}bt.writeUintLE=xwt;function Awt(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e)}bt.readFloat32BE=Awt;function Iwt(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat32(e,!0)}bt.readFloat32LE=Iwt;function Twt(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e)}bt.readFloat64BE=Twt;function Rwt(r,e){e===void 0&&(e=0);var t=new DataView(r.buffer,r.byteOffset,r.byteLength);return t.getFloat64(e,!0)}bt.readFloat64LE=Rwt;function Cwt(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r),e}bt.writeFloat32BE=Cwt;function Pwt(r,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(t,r,!0),e}bt.writeFloat32LE=Pwt;function Owt(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r),e}bt.writeFloat64BE=Owt;function kwt(r,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(t,r,!0),e}bt.writeFloat64LE=kwt});var VSe=y(pa=>{f();"use strict";Object.defineProperty(pa,"__esModule",{value:!0});var qwt=qSe(),Nwt=I1(),FSe=Ec();pa.defaultRandomSource=new qwt.SystemRandomSource;function Vk(r,e){return e===void 0&&(e=pa.defaultRandomSource),e.randomBytes(r)}pa.randomBytes=Vk;function Dwt(r){r===void 0&&(r=pa.defaultRandomSource);var e=Vk(4,r),t=Nwt.readUint32LE(e);return FSe.wipe(e),t}pa.randomUint32=Dwt;var KSe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function jSe(r,e,t){if(e===void 0&&(e=KSe),t===void 0&&(t=pa.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var i="",n=e.length,s=256-256%n;r>0;){for(var o=Vk(Math.ceil(r*256/s),t),a=0;a<o.length&&r>0;a++){var c=o[a];c<s&&(i+=e.charAt(c%n),r--)}FSe.wipe(o)}return i}pa.randomString=jSe;function Bwt(r,e,t){e===void 0&&(e=KSe),t===void 0&&(t=pa.defaultRandomSource);var i=Math.ceil(r/(Math.log(e.length)/Math.LN2));return jSe(i,e,t)}pa.randomStringForEntropy=Bwt});var nx=y(ls=>{f();"use strict";Object.defineProperty(ls,"__esModule",{value:!0});var Mwt=VSe(),Lwt=Ec();ls.PUBLIC_KEY_LENGTH=32;ls.SECRET_KEY_LENGTH=32;ls.SHARED_KEY_LENGTH=32;function Sc(r){var e=new Float64Array(16);if(r)for(var t=0;t<r.length;t++)e[t]=r[t];return e}var zSe=new Uint8Array(32);zSe[0]=9;var Uwt=Sc([56129,1]);function zk(r){for(var e=1,t=0;t<16;t++){var i=r[t]+e+65535;e=Math.floor(i/65536),r[t]=i-e*65536}r[0]+=e-1+37*(e-1)}function T1(r,e,t){for(var i=~(t-1),n=0;n<16;n++){var s=i&(r[n]^e[n]);r[n]^=s,e[n]^=s}}function Fwt(r,e){for(var t=Sc(),i=Sc(),n=0;n<16;n++)i[n]=e[n];zk(i),zk(i),zk(i);for(var s=0;s<2;s++){t[0]=i[0]-65517;for(var n=1;n<15;n++)t[n]=i[n]-65535-(t[n-1]>>16&1),t[n-1]&=65535;t[15]=i[15]-32767-(t[14]>>16&1);var o=t[15]>>16&1;t[14]&=65535,T1(i,t,1-o)}for(var n=0;n<16;n++)r[2*n]=i[n]&255,r[2*n+1]=i[n]>>8}function Kwt(r,e){for(var t=0;t<16;t++)r[t]=e[2*t]+(e[2*t+1]<<8);r[15]&=32767}function rx(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]+t[i]}function ix(r,e,t){for(var i=0;i<16;i++)r[i]=e[i]-t[i]}function Ru(r,e,t){var i,n,s=0,o=0,a=0,c=0,u=0,l=0,d=0,h=0,p=0,g=0,b=0,E=0,v=0,A=0,R=0,F=0,q=0,N=0,z=0,G=0,Y=0,C=0,m=0,w=0,S=0,P=0,B=0,W=0,j=0,M=0,_=0,L=t[0],ce=t[1],X=t[2],ne=t[3],oe=t[4],he=t[5],pe=t[6],_e=t[7],k=t[8],K=t[9],$=t[10],Z=t[11],I=t[12],U=t[13],V=t[14],D=t[15];i=e[0],s+=i*L,o+=i*ce,a+=i*X,c+=i*ne,u+=i*oe,l+=i*he,d+=i*pe,h+=i*_e,p+=i*k,g+=i*K,b+=i*$,E+=i*Z,v+=i*I,A+=i*U,R+=i*V,F+=i*D,i=e[1],o+=i*L,a+=i*ce,c+=i*X,u+=i*ne,l+=i*oe,d+=i*he,h+=i*pe,p+=i*_e,g+=i*k,b+=i*K,E+=i*$,v+=i*Z,A+=i*I,R+=i*U,F+=i*V,q+=i*D,i=e[2],a+=i*L,c+=i*ce,u+=i*X,l+=i*ne,d+=i*oe,h+=i*he,p+=i*pe,g+=i*_e,b+=i*k,E+=i*K,v+=i*$,A+=i*Z,R+=i*I,F+=i*U,q+=i*V,N+=i*D,i=e[3],c+=i*L,u+=i*ce,l+=i*X,d+=i*ne,h+=i*oe,p+=i*he,g+=i*pe,b+=i*_e,E+=i*k,v+=i*K,A+=i*$,R+=i*Z,F+=i*I,q+=i*U,N+=i*V,z+=i*D,i=e[4],u+=i*L,l+=i*ce,d+=i*X,h+=i*ne,p+=i*oe,g+=i*he,b+=i*pe,E+=i*_e,v+=i*k,A+=i*K,R+=i*$,F+=i*Z,q+=i*I,N+=i*U,z+=i*V,G+=i*D,i=e[5],l+=i*L,d+=i*ce,h+=i*X,p+=i*ne,g+=i*oe,b+=i*he,E+=i*pe,v+=i*_e,A+=i*k,R+=i*K,F+=i*$,q+=i*Z,N+=i*I,z+=i*U,G+=i*V,Y+=i*D,i=e[6],d+=i*L,h+=i*ce,p+=i*X,g+=i*ne,b+=i*oe,E+=i*he,v+=i*pe,A+=i*_e,R+=i*k,F+=i*K,q+=i*$,N+=i*Z,z+=i*I,G+=i*U,Y+=i*V,C+=i*D,i=e[7],h+=i*L,p+=i*ce,g+=i*X,b+=i*ne,E+=i*oe,v+=i*he,A+=i*pe,R+=i*_e,F+=i*k,q+=i*K,N+=i*$,z+=i*Z,G+=i*I,Y+=i*U,C+=i*V,m+=i*D,i=e[8],p+=i*L,g+=i*ce,b+=i*X,E+=i*ne,v+=i*oe,A+=i*he,R+=i*pe,F+=i*_e,q+=i*k,N+=i*K,z+=i*$,G+=i*Z,Y+=i*I,C+=i*U,m+=i*V,w+=i*D,i=e[9],g+=i*L,b+=i*ce,E+=i*X,v+=i*ne,A+=i*oe,R+=i*he,F+=i*pe,q+=i*_e,N+=i*k,z+=i*K,G+=i*$,Y+=i*Z,C+=i*I,m+=i*U,w+=i*V,S+=i*D,i=e[10],b+=i*L,E+=i*ce,v+=i*X,A+=i*ne,R+=i*oe,F+=i*he,q+=i*pe,N+=i*_e,z+=i*k,G+=i*K,Y+=i*$,C+=i*Z,m+=i*I,w+=i*U,S+=i*V,P+=i*D,i=e[11],E+=i*L,v+=i*ce,A+=i*X,R+=i*ne,F+=i*oe,q+=i*he,N+=i*pe,z+=i*_e,G+=i*k,Y+=i*K,C+=i*$,m+=i*Z,w+=i*I,S+=i*U,P+=i*V,B+=i*D,i=e[12],v+=i*L,A+=i*ce,R+=i*X,F+=i*ne,q+=i*oe,N+=i*he,z+=i*pe,G+=i*_e,Y+=i*k,C+=i*K,m+=i*$,w+=i*Z,S+=i*I,P+=i*U,B+=i*V,W+=i*D,i=e[13],A+=i*L,R+=i*ce,F+=i*X,q+=i*ne,N+=i*oe,z+=i*he,G+=i*pe,Y+=i*_e,C+=i*k,m+=i*K,w+=i*$,S+=i*Z,P+=i*I,B+=i*U,W+=i*V,j+=i*D,i=e[14],R+=i*L,F+=i*ce,q+=i*X,N+=i*ne,z+=i*oe,G+=i*he,Y+=i*pe,C+=i*_e,m+=i*k,w+=i*K,S+=i*$,P+=i*Z,B+=i*I,W+=i*U,j+=i*V,M+=i*D,i=e[15],F+=i*L,q+=i*ce,N+=i*X,z+=i*ne,G+=i*oe,Y+=i*he,C+=i*pe,m+=i*_e,w+=i*k,S+=i*K,P+=i*$,B+=i*Z,W+=i*I,j+=i*U,M+=i*V,_+=i*D,s+=38*q,o+=38*N,a+=38*z,c+=38*G,u+=38*Y,l+=38*C,d+=38*m,h+=38*w,p+=38*S,g+=38*P,b+=38*B,E+=38*W,v+=38*j,A+=38*M,R+=38*_,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=g+n+65535,n=Math.floor(i/65536),g=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=E+n+65535,n=Math.floor(i/65536),E=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=A+n+65535,n=Math.floor(i/65536),A=i-n*65536,i=R+n+65535,n=Math.floor(i/65536),R=i-n*65536,i=F+n+65535,n=Math.floor(i/65536),F=i-n*65536,s+=n-1+37*(n-1),r[0]=s,r[1]=o,r[2]=a,r[3]=c,r[4]=u,r[5]=l,r[6]=d,r[7]=h,r[8]=p,r[9]=g,r[10]=b,r[11]=E,r[12]=v,r[13]=A,r[14]=R,r[15]=F}function R1(r,e){Ru(r,e,e)}function jwt(r,e){for(var t=Sc(),i=0;i<16;i++)t[i]=e[i];for(var i=253;i>=0;i--)R1(t,t),i!==2&&i!==4&&Ru(t,t,e);for(var i=0;i<16;i++)r[i]=t[i]}function Hk(r,e){for(var t=new Uint8Array(32),i=new Float64Array(80),n=Sc(),s=Sc(),o=Sc(),a=Sc(),c=Sc(),u=Sc(),l=0;l<31;l++)t[l]=r[l];t[31]=r[31]&127|64,t[0]&=248,Kwt(i,e);for(var l=0;l<16;l++)s[l]=i[l];n[0]=a[0]=1;for(var l=254;l>=0;--l){var d=t[l>>>3]>>>(l&7)&1;T1(n,s,d),T1(o,a,d),rx(c,n,o),ix(n,n,o),rx(o,s,a),ix(s,s,a),R1(a,c),R1(u,n),Ru(n,o,n),Ru(o,s,c),rx(c,n,o),ix(n,n,o),R1(s,n),ix(o,a,u),Ru(n,o,Uwt),rx(n,n,a),Ru(o,o,n),Ru(n,a,u),Ru(a,s,i),R1(s,c),T1(n,s,d),T1(o,a,d)}for(var l=0;l<16;l++)i[l+16]=n[l],i[l+32]=o[l],i[l+48]=s[l],i[l+64]=a[l];var h=i.subarray(32),p=i.subarray(16);jwt(h,h),Ru(p,p,h);var g=new Uint8Array(32);return Fwt(g,p),g}ls.scalarMult=Hk;function HSe(r){return Hk(r,zSe)}ls.scalarMultBase=HSe;function $Se(r){if(r.length!==ls.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+ls.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(r),t=HSe(e);return{publicKey:t,secretKey:e}}ls.generateKeyPairFromSeed=$Se;function Vwt(r){var e=Mwt.randomBytes(32,r),t=$Se(e);return Lwt.wipe(e),t}ls.generateKeyPair=Vwt;function zwt(r,e,t){if(t===void 0&&(t=!1),r.length!==ls.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==ls.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var i=Hk(r,e);if(t){for(var n=0,s=0;s<i.length;s++)n|=i[s];if(n===0)throw new Error("X25519: invalid shared key")}return i}ls.sharedKey=zwt});var YSe=y((CKt,WSe)=>{f();"use strict";var Hwt=c8(),$wt=F0(),GSe=ia();WSe.exports=(r,e={})=>{let t=$wt(r),i=GSe.decode.fromReader(t.reader,e),n=!1,s={read:async o=>{let{value:a,done:c}=await t.reader.next(o);if(c&&a.length<o)throw new Error("Couldn't read enough bytes");if(n=c,!a)throw new Error("Value is null");return a},readLP:async()=>{let{value:o,done:a}=await i.next();if(n=a,!o)throw new Error("Value is null");return o},readPB:async o=>{let a=await s.readLP();if(!a)throw new Error("Value is null");let c=Hwt(a)?a:a.slice();return o.decode(c)},write:o=>{t.writer.push(o)},writeLP:o=>{s.write(GSe.encode.single(o,e))},writePB:(o,a)=>{s.writeLP(a.encode(o))},pb:o=>({read:()=>s.readPB(o),write:a=>s.writePB(a,o)}),unwrap:()=>(t.rest(),t.stream)};return s}});var QSe=y((PKt,XSe)=>{f();"use strict";var Gwt=pS();XSe.exports=function(){let e,t,i=async s=>{if(e)throw new Error("already piped");e=Gwt(s),t&&t(e)},n={[Symbol.asyncIterator](){return this},next(){return e?e.next():new Promise(s=>{t=o=>{t=null,s(o.next())}})}};return{sink:i,source:n}}});var e3e=y((OKt,JSe)=>{f();var ZSe=QSe();JSe.exports=function(){var r=ZSe(),e=ZSe();return[{source:r.source,sink:e.sink},{source:e.source,sink:r.sink}]}});var t3e=y($k=>{f();"use strict";Object.defineProperty($k,"__esModule",{value:!0});function Wwt(r){return typeof r.saveState!="undefined"&&typeof r.restoreState!="undefined"&&typeof r.cleanSavedState!="undefined"}$k.isSerializableHash=Wwt});var sx=y(vy=>{f();"use strict";Object.defineProperty(vy,"__esModule",{value:!0});function Ywt(r,e,t){return~(r-1)&e|r-1&t}vy.select=Ywt;function Xwt(r,e){return(r|0)-(e|0)-1>>>31&1}vy.lessOrEqual=Xwt;function r3e(r,e){if(r.length!==e.length)return 0;for(var t=0,i=0;i<r.length;i++)t|=r[i]^e[i];return 1&t-1>>>8}vy.compare=r3e;function Qwt(r,e){return r.length===0||e.length===0?!1:r3e(r,e)!==0}vy.equal=Qwt});var n3e=y(C1=>{f();"use strict";Object.defineProperty(C1,"__esModule",{value:!0});var xc=t3e(),Zwt=sx(),Jwt=Ec(),i3e=function(){function r(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(i).clean():i.set(t);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=54^92;this._outer.update(i),xc.isSerializableHash(this._inner)&&xc.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Jwt.wipe(i)}return r.prototype.reset=function(){if(!xc.isSerializableHash(this._inner)||!xc.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.clean=function(){xc.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),xc.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},r.prototype.update=function(e){return this._inner.update(e),this},r.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(!xc.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},r.prototype.restoreState=function(e){if(!xc.isSerializableHash(this._inner)||!xc.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},r.prototype.cleanSavedState=function(e){if(!xc.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},r}();C1.HMAC=i3e;function e_t(r,e,t){var i=new i3e(r,e);i.update(t);var n=i.digest();return i.clean(),n}C1.hmac=e_t;C1.equal=Zwt.equal});var a3e=y(Gk=>{f();"use strict";Object.defineProperty(Gk,"__esModule",{value:!0});var s3e=n3e(),o3e=Ec(),t_t=function(){function r(e,t,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=s3e.hmac(this._hash,i,t);this._hmac=new s3e.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return r.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},r.prototype.expand=function(e){for(var t=new Uint8Array(e),i=0;i<t.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[i]=this._buffer[this._bufpos++];return t},r.prototype.clean=function(){this._hmac.clean(),o3e.wipe(this._buffer),o3e.wipe(this._counter),this._bufpos=0},r}();Gk.HKDF=t_t});var Yk=y(rf=>{f();"use strict";Object.defineProperty(rf,"__esModule",{value:!0});var ox=I1(),ax=Ec();rf.DIGEST_LENGTH=32;rf.BLOCK_SIZE=64;var c3e=function(){function r(){this.digestLength=rf.DIGEST_LENGTH,this.blockSize=rf.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return r.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},r.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},r.prototype.clean=function(){ax.wipe(this._buffer),ax.wipe(this._temp),this.reset()},r.prototype.update=function(e,t){if(t===void 0&&(t=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var i=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[i++],t--;this._bufferLength===this.blockSize&&(Wk(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(i=Wk(this._temp,this._state,e,i,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[i++],t--;return this},r.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,i=this._bufferLength,n=t/536870912|0,s=t<<3,o=t%64<56?64:128;this._buffer[i]=128;for(var a=i+1;a<o-8;a++)this._buffer[a]=0;ox.writeUint32BE(n,this._buffer,o-8),ox.writeUint32BE(s,this._buffer,o-4),Wk(this._temp,this._state,this._buffer,0,o),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)ox.writeUint32BE(this._state[a],e,a*4);return this},r.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},r.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},r.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},r.prototype.cleanSavedState=function(e){ax.wipe(e.state),e.buffer&&ax.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},r}();rf.SHA256=c3e;var r_t=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Wk(r,e,t,i,n){for(;n>=64;){for(var s=e[0],o=e[1],a=e[2],c=e[3],u=e[4],l=e[5],d=e[6],h=e[7],p=0;p<16;p++){var g=i+p*4;r[p]=ox.readUint32BE(t,g)}for(var p=16;p<64;p++){var b=r[p-2],E=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=r[p-15];var v=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;r[p]=(E+r[p-7]|0)+(v+r[p-16]|0)}for(var p=0;p<64;p++){var E=(((u>>>6|u<<32-6)^(u>>>11|u<<32-11)^(u>>>25|u<<32-25))+(u&l^~u&d)|0)+(h+(r_t[p]+r[p]|0)|0)|0,v=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&o^s&a^o&a)|0;h=d,d=l,l=u,u=c+E|0,c=a,a=o,o=s,s=E+v|0}e[0]+=s,e[1]+=o,e[2]+=a,e[3]+=c,e[4]+=u,e[5]+=l,e[6]+=d,e[7]+=h,i+=64,n-=64}return i}function i_t(r){var e=new c3e;e.update(r);var t=e.digest();return e.clean(),t}rf.hash=i_t});var l3e=y((u3e,P1)=>{f();"use strict";(function(r,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof ya=="function"&&typeof P1=="object"&&P1&&P1.exports&&(P1.exports=e(ki()))})(u3e,function(r){"use strict";var e=r.Reader,t=r.Writer,i=r.util,n=r.roots["libp2p-noise"]||(r.roots["libp2p-noise"]={});return n.pb=function(){var s={};return s.NoiseHandshakePayload=function(){function o(a){if(a)for(var c=Object.keys(a),u=0;u<c.length;++u)a[c[u]]!=null&&(this[c[u]]=a[c[u]])}return o.prototype.identityKey=i.newBuffer([]),o.prototype.identitySig=i.newBuffer([]),o.prototype.data=i.newBuffer([]),o.create=function(c){return new o(c)},o.encode=function(c,u){return u||(u=t.create()),c.identityKey!=null&&Object.hasOwnProperty.call(c,"identityKey")&&u.uint32(10).bytes(c.identityKey),c.identitySig!=null&&Object.hasOwnProperty.call(c,"identitySig")&&u.uint32(18).bytes(c.identitySig),c.data!=null&&Object.hasOwnProperty.call(c,"data")&&u.uint32(26).bytes(c.data),u},o.encodeDelimited=function(c,u){return this.encode(c,u).ldelim()},o.decode=function(c,u){c instanceof e||(c=e.create(c));for(var l=u===void 0?c.len:c.pos+u,d=new n.pb.NoiseHandshakePayload;c.pos<l;){var h=c.uint32();switch(h>>>3){case 1:d.identityKey=c.bytes();break;case 2:d.identitySig=c.bytes();break;case 3:d.data=c.bytes();break;default:c.skipType(h&7);break}}return d},o.decodeDelimited=function(c){return c instanceof e||(c=new e(c)),this.decode(c,c.uint32())},o.verify=function(c){return typeof c!="object"||c===null?"object expected":c.identityKey!=null&&c.hasOwnProperty("identityKey")&&!(c.identityKey&&typeof c.identityKey.length=="number"||i.isString(c.identityKey))?"identityKey: buffer expected":c.identitySig!=null&&c.hasOwnProperty("identitySig")&&!(c.identitySig&&typeof c.identitySig.length=="number"||i.isString(c.identitySig))?"identitySig: buffer expected":c.data!=null&&c.hasOwnProperty("data")&&!(c.data&&typeof c.data.length=="number"||i.isString(c.data))?"data: buffer expected":null},o.fromObject=function(c){if(c instanceof n.pb.NoiseHandshakePayload)return c;var u=new n.pb.NoiseHandshakePayload;return c.identityKey!=null&&(typeof c.identityKey=="string"?i.base64.decode(c.identityKey,u.identityKey=i.newBuffer(i.base64.length(c.identityKey)),0):c.identityKey.length&&(u.identityKey=c.identityKey)),c.identitySig!=null&&(typeof c.identitySig=="string"?i.base64.decode(c.identitySig,u.identitySig=i.newBuffer(i.base64.length(c.identitySig)),0):c.identitySig.length&&(u.identitySig=c.identitySig)),c.data!=null&&(typeof c.data=="string"?i.base64.decode(c.data,u.data=i.newBuffer(i.base64.length(c.data)),0):c.data.length&&(u.data=c.data)),u},o.toObject=function(c,u){u||(u={});var l={};return u.defaults&&(u.bytes===String?l.identityKey="":(l.identityKey=[],u.bytes!==Array&&(l.identityKey=i.newBuffer(l.identityKey))),u.bytes===String?l.identitySig="":(l.identitySig=[],u.bytes!==Array&&(l.identitySig=i.newBuffer(l.identitySig))),u.bytes===String?l.data="":(l.data=[],u.bytes!==Array&&(l.data=i.newBuffer(l.data)))),c.identityKey!=null&&c.hasOwnProperty("identityKey")&&(l.identityKey=u.bytes===String?i.base64.encode(c.identityKey,0,c.identityKey.length):u.bytes===Array?Array.prototype.slice.call(c.identityKey):c.identityKey),c.identitySig!=null&&c.hasOwnProperty("identitySig")&&(l.identitySig=u.bytes===String?i.base64.encode(c.identitySig,0,c.identitySig.length):u.bytes===Array?Array.prototype.slice.call(c.identitySig):c.identitySig),c.data!=null&&c.hasOwnProperty("data")&&(l.data=u.bytes===String?i.base64.encode(c.data,0,c.data.length):u.bytes===Array?Array.prototype.slice.call(c.data):c.data),l},o.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},o}(),s}(),n})});var nf=y(Gt=>{f();"use strict";var n_t=Gt&&Gt.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),s_t=Gt&&Gt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),o_t=Gt&&Gt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&n_t(e,r,t);return s_t(e,r),e},a_t=Gt&&Gt.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.isValidPublicKey=Gt.getHkdf=Gt.verifySignedPayload=Gt.getHandshakePayload=Gt.decodePayload=Gt.getPeerIdFromPayload=Gt.signPayload=Gt.createHandshakePayload=Gt.getPayload=Gt.generateKeypair=void 0;var c_t=a3e(),u_t=Yk(),l_t=o_t(nx()),fs=Vt(),Xk=a_t(rt()),f_t=za(),d_t=l3e(),h_t=(di(),fi),cx=d_t.pb.NoiseHandshakePayload;function p_t(){let r=l_t.generateKeyPair();return{publicKey:fs.Buffer.from(r.publicKey.buffer,r.publicKey.byteOffset,r.publicKey.length),privateKey:fs.Buffer.from(r.secretKey.buffer,r.secretKey.byteOffset,r.secretKey.length)}}Gt.generateKeypair=p_t;async function y_t(r,e,t){let i=await d3e(r,Qk(e)),n=t??fs.Buffer.alloc(0);return f3e(r.marshalPubKey(),i,n)}Gt.getPayload=y_t;function f3e(r,e,t){let i=cx.create({identityKey:fs.Buffer.from(r),identitySig:e,data:t??null});return fs.Buffer.from(cx.encode(i).finish())}Gt.createHandshakePayload=f3e;async function d3e(r,e){return fs.Buffer.from(await r.privKey.sign(e))}Gt.signPayload=d3e;async function g_t(r){return await Xk.default.createFromPubKey(fs.Buffer.from(r.identityKey))}Gt.getPeerIdFromPayload=g_t;function m_t(r){return cx.toObject(cx.decode(fs.Buffer.from(r)))}Gt.decodePayload=m_t;function Qk(r){return fs.Buffer.concat([fs.Buffer.from("noise-libp2p-static-key:"),r])}Gt.getHandshakePayload=Qk;async function b_t(r,e){let t=await Xk.default.createFromPubKey(e);return h_t.equals(t.id,r)}async function v_t(r,e,t){let i=fs.Buffer.from(e.identityKey);if(!await b_t(t.id,i))throw new Error("Peer ID doesn't match libp2p public key.");let n=Qk(r),s=f_t.keys.unmarshalPublicKey(i);if(!e.identitySig||!s.verify(n,fs.Buffer.from(e.identitySig)))throw new Error("Static key doesn't match to peer that signed payload!");return await Xk.default.createFromPubKey(i)}Gt.verifySignedPayload=v_t;function w_t(r,e){let i=new c_t.HKDF(u_t.SHA256,e,r).expand(96),n=fs.Buffer.from(i.buffer,i.byteOffset,i.length),s=n.slice(0,32),o=n.slice(32,64),a=n.slice(64,96);return[s,o,a]}Gt.getHkdf=w_t;function __t(r){return!(!fs.Buffer.isBuffer(r)||r.length!==32)}Gt.isValidPublicKey=__t});var p3e=y(ux=>{f();"use strict";Object.defineProperty(ux,"__esModule",{value:!0});var xn=I1(),Zk=Ec(),E_t=20;function S_t(r,e,t){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=t[3]<<24|t[2]<<16|t[1]<<8|t[0],c=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],l=t[15]<<24|t[14]<<16|t[13]<<8|t[12],d=t[19]<<24|t[18]<<16|t[17]<<8|t[16],h=t[23]<<24|t[22]<<16|t[21]<<8|t[20],p=t[27]<<24|t[26]<<16|t[25]<<8|t[24],g=t[31]<<24|t[30]<<16|t[29]<<8|t[28],b=e[3]<<24|e[2]<<16|e[1]<<8|e[0],E=e[7]<<24|e[6]<<16|e[5]<<8|e[4],v=e[11]<<24|e[10]<<16|e[9]<<8|e[8],A=e[15]<<24|e[14]<<16|e[13]<<8|e[12],R=i,F=n,q=s,N=o,z=a,G=c,Y=u,C=l,m=d,w=h,S=p,P=g,B=b,W=E,j=v,M=A,_=0;_<E_t;_+=2)R=R+z|0,B^=R,B=B>>>32-16|B<<16,m=m+B|0,z^=m,z=z>>>32-12|z<<12,F=F+G|0,W^=F,W=W>>>32-16|W<<16,w=w+W|0,G^=w,G=G>>>32-12|G<<12,q=q+Y|0,j^=q,j=j>>>32-16|j<<16,S=S+j|0,Y^=S,Y=Y>>>32-12|Y<<12,N=N+C|0,M^=N,M=M>>>32-16|M<<16,P=P+M|0,C^=P,C=C>>>32-12|C<<12,q=q+Y|0,j^=q,j=j>>>32-8|j<<8,S=S+j|0,Y^=S,Y=Y>>>32-7|Y<<7,N=N+C|0,M^=N,M=M>>>32-8|M<<8,P=P+M|0,C^=P,C=C>>>32-7|C<<7,F=F+G|0,W^=F,W=W>>>32-8|W<<8,w=w+W|0,G^=w,G=G>>>32-7|G<<7,R=R+z|0,B^=R,B=B>>>32-8|B<<8,m=m+B|0,z^=m,z=z>>>32-7|z<<7,R=R+G|0,M^=R,M=M>>>32-16|M<<16,S=S+M|0,G^=S,G=G>>>32-12|G<<12,F=F+Y|0,B^=F,B=B>>>32-16|B<<16,P=P+B|0,Y^=P,Y=Y>>>32-12|Y<<12,q=q+C|0,W^=q,W=W>>>32-16|W<<16,m=m+W|0,C^=m,C=C>>>32-12|C<<12,N=N+z|0,j^=N,j=j>>>32-16|j<<16,w=w+j|0,z^=w,z=z>>>32-12|z<<12,q=q+C|0,W^=q,W=W>>>32-8|W<<8,m=m+W|0,C^=m,C=C>>>32-7|C<<7,N=N+z|0,j^=N,j=j>>>32-8|j<<8,w=w+j|0,z^=w,z=z>>>32-7|z<<7,F=F+Y|0,B^=F,B=B>>>32-8|B<<8,P=P+B|0,Y^=P,Y=Y>>>32-7|Y<<7,R=R+G|0,M^=R,M=M>>>32-8|M<<8,S=S+M|0,G^=S,G=G>>>32-7|G<<7;xn.writeUint32LE(R+i|0,r,0),xn.writeUint32LE(F+n|0,r,4),xn.writeUint32LE(q+s|0,r,8),xn.writeUint32LE(N+o|0,r,12),xn.writeUint32LE(z+a|0,r,16),xn.writeUint32LE(G+c|0,r,20),xn.writeUint32LE(Y+u|0,r,24),xn.writeUint32LE(C+l|0,r,28),xn.writeUint32LE(m+d|0,r,32),xn.writeUint32LE(w+h|0,r,36),xn.writeUint32LE(S+p|0,r,40),xn.writeUint32LE(P+g|0,r,44),xn.writeUint32LE(B+b|0,r,48),xn.writeUint32LE(W+E|0,r,52),xn.writeUint32LE(j+v|0,r,56),xn.writeUint32LE(M+A|0,r,60)}function h3e(r,e,t,i,n){if(n===void 0&&(n=0),r.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<t.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<t.length;c+=64){S_t(a,s,r);for(var u=c;u<c+64&&u<t.length;u++)i[u]=t[u]^a[u-c];A_t(s,0,o)}return Zk.wipe(a),n===0&&Zk.wipe(s),i}ux.streamXOR=h3e;function x_t(r,e,t,i){return i===void 0&&(i=0),Zk.wipe(t),h3e(r,e,t,t,i)}ux.stream=x_t;function A_t(r,e,t){for(var i=1;t--;)i=i+(r[e]&255)|0,r[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}});var g3e=y(Cu=>{f();"use strict";Object.defineProperty(Cu,"__esModule",{value:!0});var I_t=sx(),lx=Ec();Cu.DIGEST_LENGTH=16;var y3e=function(){function r(e){this.digestLength=Cu.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var i=e[2]|e[3]<<8;this._r[1]=(t>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(c>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return r.prototype._blocks=function(e,t,i){for(var n=this._fin?0:1<<11,s=this._h[0],o=this._h[1],a=this._h[2],c=this._h[3],u=this._h[4],l=this._h[5],d=this._h[6],h=this._h[7],p=this._h[8],g=this._h[9],b=this._r[0],E=this._r[1],v=this._r[2],A=this._r[3],R=this._r[4],F=this._r[5],q=this._r[6],N=this._r[7],z=this._r[8],G=this._r[9];i>=16;){var Y=e[t+0]|e[t+1]<<8;s+=Y&8191;var C=e[t+2]|e[t+3]<<8;o+=(Y>>>13|C<<3)&8191;var m=e[t+4]|e[t+5]<<8;a+=(C>>>10|m<<6)&8191;var w=e[t+6]|e[t+7]<<8;c+=(m>>>7|w<<9)&8191;var S=e[t+8]|e[t+9]<<8;u+=(w>>>4|S<<12)&8191,l+=S>>>1&8191;var P=e[t+10]|e[t+11]<<8;d+=(S>>>14|P<<2)&8191;var B=e[t+12]|e[t+13]<<8;h+=(P>>>11|B<<5)&8191;var W=e[t+14]|e[t+15]<<8;p+=(B>>>8|W<<8)&8191,g+=W>>>5|n;var j=0,M=j;M+=s*b,M+=o*(5*G),M+=a*(5*z),M+=c*(5*N),M+=u*(5*q),j=M>>>13,M&=8191,M+=l*(5*F),M+=d*(5*R),M+=h*(5*A),M+=p*(5*v),M+=g*(5*E),j+=M>>>13,M&=8191;var _=j;_+=s*E,_+=o*b,_+=a*(5*G),_+=c*(5*z),_+=u*(5*N),j=_>>>13,_&=8191,_+=l*(5*q),_+=d*(5*F),_+=h*(5*R),_+=p*(5*A),_+=g*(5*v),j+=_>>>13,_&=8191;var L=j;L+=s*v,L+=o*E,L+=a*b,L+=c*(5*G),L+=u*(5*z),j=L>>>13,L&=8191,L+=l*(5*N),L+=d*(5*q),L+=h*(5*F),L+=p*(5*R),L+=g*(5*A),j+=L>>>13,L&=8191;var ce=j;ce+=s*A,ce+=o*v,ce+=a*E,ce+=c*b,ce+=u*(5*G),j=ce>>>13,ce&=8191,ce+=l*(5*z),ce+=d*(5*N),ce+=h*(5*q),ce+=p*(5*F),ce+=g*(5*R),j+=ce>>>13,ce&=8191;var X=j;X+=s*R,X+=o*A,X+=a*v,X+=c*E,X+=u*b,j=X>>>13,X&=8191,X+=l*(5*G),X+=d*(5*z),X+=h*(5*N),X+=p*(5*q),X+=g*(5*F),j+=X>>>13,X&=8191;var ne=j;ne+=s*F,ne+=o*R,ne+=a*A,ne+=c*v,ne+=u*E,j=ne>>>13,ne&=8191,ne+=l*b,ne+=d*(5*G),ne+=h*(5*z),ne+=p*(5*N),ne+=g*(5*q),j+=ne>>>13,ne&=8191;var oe=j;oe+=s*q,oe+=o*F,oe+=a*R,oe+=c*A,oe+=u*v,j=oe>>>13,oe&=8191,oe+=l*E,oe+=d*b,oe+=h*(5*G),oe+=p*(5*z),oe+=g*(5*N),j+=oe>>>13,oe&=8191;var he=j;he+=s*N,he+=o*q,he+=a*F,he+=c*R,he+=u*A,j=he>>>13,he&=8191,he+=l*v,he+=d*E,he+=h*b,he+=p*(5*G),he+=g*(5*z),j+=he>>>13,he&=8191;var pe=j;pe+=s*z,pe+=o*N,pe+=a*q,pe+=c*F,pe+=u*R,j=pe>>>13,pe&=8191,pe+=l*A,pe+=d*v,pe+=h*E,pe+=p*b,pe+=g*(5*G),j+=pe>>>13,pe&=8191;var _e=j;_e+=s*G,_e+=o*z,_e+=a*N,_e+=c*q,_e+=u*F,j=_e>>>13,_e&=8191,_e+=l*R,_e+=d*A,_e+=h*v,_e+=p*E,_e+=g*b,j+=_e>>>13,_e&=8191,j=(j<<2)+j|0,j=j+M|0,M=j&8191,j=j>>>13,_+=j,s=M,o=_,a=L,c=ce,u=X,l=ne,d=oe,h=he,p=pe,g=_e,t+=16,i-=16}this._h[0]=s,this._h[1]=o,this._h[2]=a,this._h[3]=c,this._h[4]=u,this._h[5]=l,this._h[6]=d,this._h[7]=h,this._h[8]=p,this._h[9]=g},r.prototype.finish=function(e,t){t===void 0&&(t=0);var i=new Uint16Array(10),n,s,o,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(n=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=n,n=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=n*5,n=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=n,n=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=n,i[0]=this._h[0]+5,n=i[0]>>>13,i[0]&=8191,a=1;a<10;a++)i[a]=this._h[a]+n,n=i[a]>>>13,i[a]&=8191;for(i[9]-=1<<13,s=(n^1)-1,a=0;a<10;a++)i[a]&=s;for(s=~s,a=0;a<10;a++)this._h[a]=this._h[a]&s|i[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,o=this._h[0]+this._pad[0],this._h[0]=o&65535,a=1;a<8;a++)o=(this._h[a]+this._pad[a]|0)+(o>>>16)|0,this._h[a]=o&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},r.prototype.update=function(e){var t=0,i=e.length,n;if(this._leftover){n=16-this._leftover,n>i&&(n=i);for(var s=0;s<n;s++)this._buffer[this._leftover+s]=e[t+s];if(i-=n,t+=n,this._leftover+=n,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(n=i-i%16,this._blocks(e,t,n),t+=n,i-=n),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[t+s];this._leftover+=i}return this},r.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},r.prototype.clean=function(){return lx.wipe(this._buffer),lx.wipe(this._r),lx.wipe(this._h),lx.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},r}();Cu.Poly1305=y3e;function T_t(r,e){var t=new y3e(r);t.update(e);var i=t.digest();return t.clean(),i}Cu.oneTimeAuth=T_t;function R_t(r,e){return r.length!==Cu.DIGEST_LENGTH||e.length!==Cu.DIGEST_LENGTH?!1:I_t.equal(r,e)}Cu.equal=R_t});var v3e=y(Pu=>{f();"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});var fx=p3e(),C_t=g3e(),O1=Ec(),m3e=I1(),P_t=sx();Pu.KEY_LENGTH=32;Pu.NONCE_LENGTH=12;Pu.TAG_LENGTH=16;var b3e=new Uint8Array(16),O_t=function(){function r(e){if(this.nonceLength=Pu.NONCE_LENGTH,this.tagLength=Pu.TAG_LENGTH,e.length!==Pu.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return r.prototype.seal=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);fx.stream(this._key,s,o,4);var a=t.length+this.tagLength,c;if(n){if(n.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");c=n}else c=new Uint8Array(a);return fx.streamXOR(this._key,s,t,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),o,c.subarray(0,c.length-this.tagLength),i),O1.wipe(s),c},r.prototype.open=function(e,t,i,n){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(e,s.length-e.length);var o=new Uint8Array(32);fx.stream(this._key,s,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),i),!P_t.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength,u;if(n){if(n.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");u=n}else u=new Uint8Array(c);return fx.streamXOR(this._key,s,t.subarray(0,t.length-this.tagLength),u,4),O1.wipe(s),u},r.prototype.clean=function(){return O1.wipe(this._key),this},r.prototype._authenticate=function(e,t,i,n){var s=new C_t.Poly1305(t);n&&(s.update(n),n.length%16>0&&s.update(b3e.subarray(n.length%16))),s.update(i),i.length%16>0&&s.update(b3e.subarray(i.length%16));var o=new Uint8Array(8);n&&m3e.writeUint64LE(n.length,o),s.update(o),m3e.writeUint64LE(i.length,o),s.update(o);for(var a=s.digest(),c=0;c<a.length;c++)e[c]=a[c];s.clean(),O1.wipe(a),O1.wipe(o)},r}();Pu.ChaCha20Poly1305=O_t});var dx=y(Ou=>{f();"use strict";Object.defineProperty(Ou,"__esModule",{value:!0});Ou.DUMP_SESSION_KEYS=Ou.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Ou.NOISE_MSG_MAX_LENGTH_BYTES=void 0;Ou.NOISE_MSG_MAX_LENGTH_BYTES=65535;Ou.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=Ou.NOISE_MSG_MAX_LENGTH_BYTES-16;Ou.DUMP_SESSION_KEYS=process.env.DUMP_SESSION_KEYS});var wy=y(en=>{f();"use strict";var k_t=en&&en.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(en,"__esModule",{value:!0});en.logCipherState=en.logRemoteEphemeralKey=en.logRemoteStaticKey=en.logLocalEphemeralKeys=en.logLocalStaticKeys=en.logger=void 0;var q_t=k_t(be()),N_t=dx();en.logger=q_t.default("libp2p:noise");var bo;N_t.DUMP_SESSION_KEYS?bo=en.logger:bo=()=>{};function D_t(r){bo(`LOCAL_STATIC_PUBLIC_KEY ${r.publicKey.toString("hex")}`),bo(`LOCAL_STATIC_PRIVATE_KEY ${r.privateKey.toString("hex")}`)}en.logLocalStaticKeys=D_t;function B_t(r){r?(bo(`LOCAL_PUBLIC_EPHEMERAL_KEY ${r.publicKey.toString("hex")}`),bo(`LOCAL_PRIVATE_EPHEMERAL_KEY ${r.privateKey.toString("hex")}`)):bo("Missing local ephemeral keys.")}en.logLocalEphemeralKeys=B_t;function M_t(r){bo(`REMOTE_STATIC_PUBLIC_KEY ${r.toString("hex")}`)}en.logRemoteStaticKey=M_t;function L_t(r){bo(`REMOTE_EPHEMERAL_PUBLIC_KEY ${r.toString("hex")}`)}en.logRemoteEphemeralKey=L_t;function U_t(r){r.cs1&&r.cs2?(bo(`CIPHER_STATE_1 ${r.cs1.n} ${r.cs1.k.toString("hex")}`),bo(`CIPHER_STATE_2 ${r.cs2.n} ${r.cs2.k.toString("hex")}`)):bo("Missing cipher state.")}en.logCipherState=U_t});var Jk=y(Os=>{f();"use strict";var F_t=Os&&Os.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),K_t=Os&&Os.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),w3e=Os&&Os.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&F_t(e,r,t);return K_t(e,r),e};Object.defineProperty(Os,"__esModule",{value:!0});Os.AbstractHandshake=Os.MIN_NONCE=void 0;var tn=Vt(),j_t=w3e(nx()),V_t=w3e(Yk()),_3e=v3e(),E3e=nf(),z_t=wy();Os.MIN_NONCE=0;var S3e=class{encryptWithAd(e,t,i){let n=this.encrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),n}decryptWithAd(e,t,i){let{plaintext:n,valid:s}=this.decrypt(e.k,e.n,t,i);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:n,valid:s}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,t){e.n=t}createEmptyKey(){return tn.Buffer.alloc(32)}isEmptyKey(e){return this.createEmptyKey().equals(e)}incrementNonce(e){return e+1}nonceToBytes(e){let t=tn.Buffer.alloc(12);return t.writeUInt32LE(e,4),t}encrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new _3e.ChaCha20Poly1305(e).seal(s,n,i);return tn.Buffer.from(a.buffer,a.byteOffset,a.length)}encryptAndHash(e,t){let i;return this.hasKey(e.cs)?i=this.encryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,i),i}decrypt(e,t,i,n){let s=this.nonceToBytes(t),a=new _3e.ChaCha20Poly1305(e).open(s,n,i);return a?{plaintext:tn.Buffer.from(a.buffer,a.byteOffset,a.length),valid:!0}:{plaintext:tn.Buffer.from(""),valid:!1}}decryptAndHash(e,t){let i,n=!0;return this.hasKey(e.cs)?{plaintext:i,valid:n}=this.decryptWithAd(e.cs,e.h,t):i=t,this.mixHash(e,t),{plaintext:i,valid:n}}dh(e,t){try{let i=j_t.sharedKey(e,t),n=tn.Buffer.from(i.buffer,i.byteOffset,i.length),s=tn.Buffer.alloc(32);return n.copy(s),s}catch(i){return z_t.logger(i.message),tn.Buffer.alloc(32)}}mixHash(e,t){e.h=this.getHash(e.h,t)}getHash(e,t){let i=V_t.hash(tn.Buffer.from([...e,...t]));return tn.Buffer.from(i.buffer,i.byteOffset,i.length)}mixKey(e,t){let[i,n]=E3e.getHkdf(e.ck,t);e.cs=this.initializeKey(n),e.ck=i}initializeKey(e){let t=Os.MIN_NONCE;return{k:e,n:t}}initializeSymmetric(e){let t=tn.Buffer.from(e,"utf-8"),i=this.hashProtocolName(t),n=i,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:n,h:i}}hashProtocolName(e){if(e.length<=32){let t=tn.Buffer.alloc(32);return e.copy(t),t}else return this.getHash(e,tn.Buffer.alloc(0))}split(e){let[t,i]=E3e.getHkdf(e.ck,tn.Buffer.alloc(0)),n=this.initializeKey(t),s=this.initializeKey(i);return{cs1:n,cs2:s}}writeMessageRegular(e,t){let i=this.encryptWithAd(e,tn.Buffer.alloc(0),t),n=this.createEmptyKey(),s=tn.Buffer.alloc(0);return{ne:n,ns:s,ciphertext:i}}readMessageRegular(e,t){return this.decryptWithAd(e,tn.Buffer.alloc(0),t.ciphertext)}};Os.AbstractHandshake=S3e});var A3e=y(hx=>{f();"use strict";Object.defineProperty(hx,"__esModule",{value:!0});hx.XX=void 0;var nh=Vt(),_y=nf(),H_t=Jk(),x3e=class extends H_t.AbstractHandshake{initializeInitiator(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=nh.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}initializeResponder(e,t,i,n){let s="Noise_XX_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e);let a=nh.Buffer.alloc(32);return{ss:o,s:t,rs:i,psk:n,re:a}}writeMessageA(e,t,i){let n=nh.Buffer.alloc(0);i!==void 0?e.e=i:e.e=_y.generateKeypair();let s=e.e.publicKey;this.mixHash(e.ss,s);let o=this.encryptAndHash(e.ss,t);return{ne:s,ns:n,ciphertext:o}}writeMessageB(e,t){e.e=_y.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let n=nh.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageC(e,t){let i=nh.Buffer.from(e.s.publicKey),n=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,t),a={ne:this.createEmptyKey(),ns:n,ciphertext:s},{cs1:c,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:c,cs2:u}}readMessageA(e,t){return _y.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,t.ciphertext)}readMessageB(e,t){if(_y.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&_y.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageC(e,t){let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);if(n&&i.length===32&&_y.isValidPublicKey(i)&&(e.rs=i),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:a,cs2:c}=this.split(e.ss);return{h:e.ss.h,plaintext:s,valid:n&&o,cs1:a,cs2:c}}initSession(e,t,i){let n=this.createEmptyKey(),s=nh.Buffer.alloc(32),o;return e?o=this.initializeInitiator(t,i,s,n):o=this.initializeResponder(t,i,s,n),{hs:o,i:e,mc:0}}sendMessage(e,t,i){let n;if(e.mc===0)n=this.writeMessageA(e.hs,t,i);else if(e.mc===1)n=this.writeMessageB(e.hs,t);else if(e.mc===2){let{h:s,messageBuffer:o,cs1:a,cs2:c}=this.writeMessageC(e.hs,t);n=o,e.h=s,e.cs1=a,e.cs2=c}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,t){let i=nh.Buffer.alloc(0),n=!1;if(e.mc===0)({plaintext:i,valid:n}=this.readMessageA(e.hs,t));else if(e.mc===1)({plaintext:i,valid:n}=this.readMessageB(e.hs,t));else if(e.mc===2){let{h:s,plaintext:o,valid:a,cs1:c,cs2:u}=this.readMessageC(e.hs,t);i=o,n=a,e.h=s,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}};hx.XX=x3e});var k1=y(mi=>{f();"use strict";Object.defineProperty(mi,"__esModule",{value:!0});mi.decode2=mi.decode1=mi.decode0=mi.encode2=mi.encode1=mi.encode0=mi.uint16BEDecode=mi.uint16BEEncode=void 0;var Ey=Vt(),$_t=(r,e,t)=>(e=e||Ey.Buffer.allocUnsafe(2),e.writeUInt16BE(r,t),e);mi.uint16BEEncode=$_t;mi.uint16BEEncode.bytes=2;var G_t=r=>{if(r.length<2)throw RangeError("Could not decode int16BE");return r.readUInt16BE(0)};mi.uint16BEDecode=G_t;mi.uint16BEDecode.bytes=2;function W_t(r){return Ey.Buffer.concat([r.ne,r.ciphertext])}mi.encode0=W_t;function Y_t(r){return Ey.Buffer.concat([r.ne,r.ns,r.ciphertext])}mi.encode1=Y_t;function X_t(r){return Ey.Buffer.concat([r.ns,r.ciphertext])}mi.encode2=X_t;function Q_t(r){if(r.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:r.slice(0,32),ciphertext:r.slice(32,r.length),ns:Ey.Buffer.alloc(0)}}mi.decode0=Q_t;function Z_t(r){if(r.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:r.slice(0,32),ns:r.slice(32,80),ciphertext:r.slice(80,r.length)}}mi.decode1=Z_t;function J_t(r){if(r.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:Ey.Buffer.alloc(0),ns:r.slice(0,48),ciphertext:r.slice(48,r.length)}}mi.decode2=J_t});var eq=y(px=>{f();"use strict";Object.defineProperty(px,"__esModule",{value:!0});px.XXHandshake=void 0;var q1=Vt(),e2t=A3e(),Sy=nf(),ai=wy(),xy=k1(),I3e=class{constructor(e,t,i,n,s,o,a){this.isInitiator=e,this.payload=t,this.prologue=i,this.staticKeypair=n,this.connection=s,o&&(this.remotePeer=o),this.xx=a??new e2t.XX,this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=q1.Buffer.alloc(0)}async propose(){if(ai.logLocalStaticKeys(this.session.hs.s),this.isInitiator){ai.logger("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,q1.Buffer.alloc(0));this.connection.writeLP(xy.encode0(e)),ai.logger("Stage 0 - Initiator finished sending first message."),ai.logLocalEphemeralKeys(this.session.hs.e)}else{ai.logger("Stage 0 - Responder waiting to receive first message...");let e=xy.decode0((await this.connection.readLP()).slice()),{valid:t}=this.xx.recvMessage(this.session,e);if(!t)throw new Error("xx handshake stage 0 validation fail");ai.logger("Stage 0 - Responder received first message."),ai.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){ai.logger("Stage 1 - Initiator waiting to receive first message from responder...");let e=xy.decode1((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 1 validation fail");ai.logger("Stage 1 - Initiator received the message."),ai.logRemoteEphemeralKey(this.session.hs.re),ai.logRemoteStaticKey(this.session.hs.rs),ai.logger("Initiator going to check remote's signature...");try{let n=await Sy.decodePayload(t);this.remotePeer=this.remotePeer||await Sy.getPeerIdFromPayload(n),this.remotePeer=await Sy.verifySignedPayload(e.ns,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}ai.logger("All good with the signature!")}else{ai.logger("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(xy.encode1(e)),ai.logger("Stage 1 - Responder sent the second handshake message with signed payload."),ai.logLocalEphemeralKeys(this.session.hs.e)}}async finish(){if(this.isInitiator){ai.logger("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(xy.encode2(e)),ai.logger("Stage 2 - Initiator sent message with signed payload.")}else{ai.logger("Stage 2 - Responder waiting for third handshake message...");let e=xy.decode2((await this.connection.readLP()).slice()),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx handshake stage 2 validation fail");ai.logger("Stage 2 - Responder received the message, finished handshake.");try{let n=await Sy.decodePayload(t);this.remotePeer=this.remotePeer||await Sy.getPeerIdFromPayload(n),await Sy.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload: ${s.message}`)}}ai.logCipherState(this.session)}encrypt(e,t){let i=this.getCS(t);return this.xx.encryptWithAd(i,q1.Buffer.alloc(0),e)}decrypt(e,t){let i=this.getCS(t,!1);return this.xx.decryptWithAd(i,q1.Buffer.alloc(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=q1.Buffer.from(e.buffer,e.byteOffset,e.length))}};px.XXHandshake=I3e});var R3e=y(gx=>{f();"use strict";Object.defineProperty(gx,"__esModule",{value:!0});gx.IK=void 0;var yx=Vt(),N1=nf(),t2t=Jk(),T3e=class extends t2t.AbstractHandshake{initSession(e,t,i,n){let s=this.createEmptyKey(),o;return e?o=this.initializeInitiator(t,i,n,s):o=this.initializeResponder(t,i,n,s),{hs:o,i:e,mc:0}}sendMessage(e,t){let i;if(e.mc===0)i=this.writeMessageA(e.hs,t);else if(e.mc===1){let{messageBuffer:n,h:s,cs1:o,cs2:a}=this.writeMessageB(e.hs,t);i=n,e.h=s,e.cs1=o,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,t)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,t)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,t){let i=yx.Buffer.alloc(0),n=!1;if(e.mc===0&&({plaintext:i,valid:n}=this.readMessageA(e.hs,t)),e.mc===1){let{plaintext:s,valid:o,h:a,cs1:c,cs2:u}=this.readMessageB(e.hs,t);i=s,n=o,e.h=a,e.cs1=c,e.cs2=u}return e.mc++,{plaintext:i,valid:n}}writeMessageA(e,t){e.e=N1.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=yx.Buffer.from(e.s.publicKey),s=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let o=this.encryptAndHash(e.ss,t);return{ne:i,ns:s,ciphertext:o}}writeMessageB(e,t){e.e=N1.generateKeypair();let i=e.e.publicKey;this.mixHash(e.ss,i),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let n=this.encryptAndHash(e.ss,t),s=this.createEmptyKey(),o={ne:i,ns:s,ciphertext:n},{cs1:a,cs2:c}=this.split(e.ss);return{messageBuffer:o,cs1:a,cs2:c,h:e.ss.h}}readMessageA(e,t){N1.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ns);n&&i.length===32&&N1.isValidPublicKey(i)&&(e.rs=i),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:s,valid:o}=this.decryptAndHash(e.ss,t.ciphertext);return{plaintext:s,valid:n&&o}}readMessageB(e,t){if(N1.isValidPublicKey(t.ne)&&(e.re=t.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:i,valid:n}=this.decryptAndHash(e.ss,t.ciphertext),{cs1:s,cs2:o}=this.split(e.ss);return{h:e.ss.h,valid:n,plaintext:i,cs1:s,cs2:o}}initializeInitiator(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,i);let a=yx.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}initializeResponder(e,t,i,n){let s="Noise_IK_25519_ChaChaPoly_SHA256",o=this.initializeSymmetric(s);this.mixHash(o,e),this.mixHash(o,t.publicKey);let a=yx.Buffer.alloc(32);return{ss:o,s:t,rs:i,re:a,psk:n}}};gx.IK=T3e});var P3e=y(mx=>{f();"use strict";Object.defineProperty(mx,"__esModule",{value:!0});mx.FailedIKError=void 0;var C3e=class extends Error{constructor(e,t){super(t);this.initialMsg=e,this.name="FailedIKhandshake"}};mx.FailedIKError=C3e});var q3e=y(vx=>{f();"use strict";Object.defineProperty(vx,"__esModule",{value:!0});vx.IKHandshake=void 0;var r2t=R3e(),Ay=Vt(),bx=k1(),Iy=nf(),O3e=P3e(),Ti=wy(),k3e=class{constructor(e,t,i,n,s,o,a,c){this.isInitiator=e,this.payload=Ay.Buffer.from(t),this.prologue=i,this.staticKeypair=n,this.connection=s,a&&(this.remotePeer=a),this.ik=c??new r2t.IK,this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,o),this.remoteEarlyData=Ay.Buffer.alloc(0)}async stage0(){if(Ti.logLocalStaticKeys(this.session.hs.s),Ti.logRemoteStaticKey(this.session.hs.rs),this.isInitiator){Ti.logger("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(bx.encode1(e)),Ti.logger("IK Stage 0 - Initiator sent message."),Ti.logLocalEphemeralKeys(this.session.hs.e)}else{Ti.logger("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let t=bx.decode1(e.slice()),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);if(!n)throw new Error("ik handshake stage 0 decryption validation fail");Ti.logger("IK Stage 0 - Responder got message, going to verify payload.");let s=await Iy.decodePayload(i);this.remotePeer=this.remotePeer||await Iy.getPeerIdFromPayload(s),await Iy.verifySignedPayload(this.session.hs.rs,s,this.remotePeer),this.setRemoteEarlyData(s.data),Ti.logger("IK Stage 0 - Responder successfully verified payload!"),Ti.logRemoteEphemeralKey(this.session.hs.re)}catch(t){let i=t;throw Ti.logger("Responder breaking up with IK handshake in stage 0."),new O3e.FailedIKError(e,`Error occurred while verifying initiator's signed payload: ${i.message}`)}}}async stage1(){if(this.isInitiator){Ti.logger("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),t=bx.decode0(Ay.Buffer.from(e)),{plaintext:i,valid:n}=this.ik.recvMessage(this.session,t);Ti.logger("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!n)throw new Error("ik stage 1 decryption validation fail");let s=await Iy.decodePayload(i);this.remotePeer=this.remotePeer||await Iy.getPeerIdFromPayload(s),await Iy.verifySignedPayload(t.ns.slice(0,32),s,this.remotePeer),this.setRemoteEarlyData(s.data),Ti.logger("IK Stage 1 - Initiator successfully verified payload!"),Ti.logRemoteEphemeralKey(this.session.hs.re)}catch(s){let o=s;throw Ti.logger("Initiator breaking up with IK handshake in stage 1."),new O3e.FailedIKError(e,`Error occurred while verifying responder's signed payload: ${o.message}`)}}else{Ti.logger("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(bx.encode0(e)),Ti.logger("IK Stage 1 - Responder sent message..."),Ti.logLocalEphemeralKeys(this.session.hs.e)}Ti.logCipherState(this.session)}decrypt(e,t){let i=this.getCS(t,!1);return this.ik.decryptWithAd(i,Ay.Buffer.alloc(0),e)}encrypt(e,t){let i=this.getCS(t);return this.ik.encryptWithAd(i,Ay.Buffer.alloc(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,t=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?t?e.cs1:e.cs2:t?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=Ay.Buffer.from(e.buffer,e.byteOffset,e.length))}};vx.IKHandshake=k3e});var B3e=y(wx=>{f();"use strict";Object.defineProperty(wx,"__esModule",{value:!0});wx.XXFallbackHandshake=void 0;var tq=Vt(),i2t=eq(),rq=nf(),vo=wy(),N3e=k1(),D3e=class extends i2t.XXHandshake{constructor(e,t,i,n,s,o,a,c,u){super(e,t,i,n,s,a,u);c&&(this.ephemeralKeys=c),this.initialMsg=o}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,tq.Buffer.alloc(0),this.ephemeralKeys),vo.logger("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),vo.logLocalEphemeralKeys(this.session.hs.e);else{vo.logger("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=N3e.decode0(this.initialMsg),{valid:t}=this.xx.recvMessage(this.session,{ne:e.ne,ns:tq.Buffer.alloc(0),ciphertext:tq.Buffer.alloc(0)});if(!t)throw new Error("xx fallback stage 0 decryption validation fail");vo.logger("XX Fallback Stage 0 - Responder used received message from IK."),vo.logRemoteEphemeralKey(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=N3e.decode1(this.initialMsg),{plaintext:t,valid:i}=this.xx.recvMessage(this.session,e);if(!i)throw new Error("xx fallback stage 1 decryption validation fail");vo.logger("XX Fallback Stage 1 - Initiator used received message from IK."),vo.logRemoteEphemeralKey(this.session.hs.re),vo.logRemoteStaticKey(this.session.hs.rs),vo.logger("Initiator going to check remote's signature...");try{let n=await rq.decodePayload(t);this.remotePeer=this.remotePeer||await rq.getPeerIdFromPayload(n),await rq.verifySignedPayload(this.session.hs.rs,n,this.remotePeer),this.setRemoteEarlyData(n.data)}catch(n){let s=n;throw new Error(`Error occurred while verifying signed payload from responder: ${s.message}`)}vo.logger("All good with the signature!")}else vo.logger("XX Fallback Stage 1 - Responder start"),await super.exchange(),vo.logger("XX Fallback Stage 1 - Responder end")}};wx.XXFallbackHandshake=D3e});var L3e=y(Ty=>{f();"use strict";Object.defineProperty(Ty,"__esModule",{value:!0});Ty.decryptStream=Ty.encryptStream=void 0;var M3e=Vt(),_x=dx();function n2t(r){return async function*(e){for await(let t of e){let i=M3e.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=_x.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let s=n+_x.NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;s>i.length&&(s=i.length),yield r.encrypt(i.slice(n,s),r.session)}}}}Ty.encryptStream=n2t;function s2t(r){return async function*(e){for await(let t of e){let i=M3e.Buffer.from(t.buffer,t.byteOffset,t.length);for(let n=0;n<i.length;n+=_x.NOISE_MSG_MAX_LENGTH_BYTES){let s=n+_x.NOISE_MSG_MAX_LENGTH_BYTES;s>i.length&&(s=i.length);let o=i.slice(n,s),{plaintext:a,valid:c}=await r.decrypt(o,r.session);if(!c)throw new Error("Failed to validate decrypted chunk");yield a}}}}Ty.decryptStream=s2t});var F3e=y(Ex=>{f();"use strict";Object.defineProperty(Ex,"__esModule",{value:!0});Ex.KeyCache=void 0;var U3e=class{constructor(){this.storage=new Map}store(e,t){this.storage.set(e.id,t)}load(e){var t;return e&&(t=this.storage.get(e.id))!==null&&t!==void 0?t:null}resetStorage(){this.storage.clear()}},o2t=new U3e;Ex.KeyCache=o2t});var nq=y(wo=>{f();"use strict";var a2t=wo&&wo.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),c2t=wo&&wo.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),u2t=wo&&wo.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&a2t(e,r,t);return c2t(e,r),e},Sx=wo&&wo.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(wo,"__esModule",{value:!0});wo.Noise=void 0;var l2t=u2t(nx()),D1=Vt(),K3e=Sx(YSe()),f2t=Sx(e3e()),j3e=Sx(d3()),d2t=Sx(Ar()),V3e=ia(),h2t=eq(),p2t=q3e(),y2t=B3e(),z3e=nf(),Ry=k1(),H3e=L3e(),iq=F3e(),g2t=wy(),$3e=dx(),G3e=class{constructor(e,t){if(this.protocol="/noise",this.prologue=D1.Buffer.alloc(0),this.earlyData=t??D1.Buffer.alloc(0),this.useNoisePipes=!1,e){let i=l2t.generateKeyPairFromSeed(e);this.staticKeys={privateKey:D1.Buffer.from(i.secretKey.buffer,i.secretKey.byteOffset,i.secretKey.length),publicKey:D1.Buffer.from(i.publicKey.buffer,i.publicKey.byteOffset,i.publicKey.length)}}else this.staticKeys=z3e.generateKeypair()}async secureOutbound(e,t,i){let n=K3e.default(t,{lengthEncoder:Ry.uint16BEEncode,lengthDecoder:Ry.uint16BEDecode,maxDataLength:$3e.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!0,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async secureInbound(e,t,i){let n=K3e.default(t,{lengthEncoder:Ry.uint16BEEncode,lengthDecoder:Ry.uint16BEDecode,maxDataLength:$3e.NOISE_MSG_MAX_LENGTH_BYTES}),s=await this.performHandshake({connection:n,isInitiator:!1,localPeer:e,remotePeer:i});return{conn:await this.createSecureConnection(n,s),remoteEarlyData:s.remoteEarlyData,remotePeer:s.remotePeer}}async performHandshake(e){var t;let i=await z3e.getPayload(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&iq.KeyCache.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:s,connection:o,isInitiator:a}=e,c=new p2t.IKHandshake(a,i,this.prologue,this.staticKeys,o,(t=iq.KeyCache.load(e.remotePeer))!==null&&t!==void 0?t:D1.Buffer.alloc(32),s);try{return await this.performIKHandshake(c)}catch(u){let l;return e.isInitiator&&(l=c.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,i,u.initialMsg,l)}}else return await this.performXXHandshake(e,i)}async performXXFallbackHandshake(e,t,i,n){let{isInitiator:s,remotePeer:o,connection:a}=e,c=new y2t.XXFallbackHandshake(s,t,this.prologue,this.staticKeys,a,i,o,n);try{await c.propose(),await c.exchange(),await c.finish()}catch(u){g2t.logger(u);let l=u;throw new Error(`Error occurred during XX Fallback handshake: ${l.message}`)}return c}async performXXHandshake(e,t){let{isInitiator:i,remotePeer:n,connection:s}=e,o=new h2t.XXHandshake(i,t,this.prologue,this.staticKeys,s,n);try{await o.propose(),await o.exchange(),await o.finish(),this.useNoisePipes&&o.remotePeer&&iq.KeyCache.store(o.remotePeer,o.getRemoteStaticKey())}catch(a){let c=a;throw new Error(`Error occurred during XX handshake: ${c.message}`)}return o}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,t){let[i,n]=f2t.default(),s=e.unwrap();return await d2t.default(i,j3e.default,H3e.encryptStream(t),V3e.encode({lengthEncoder:Ry.uint16BEEncode}),s,V3e.decode({lengthDecoder:Ry.uint16BEDecode}),j3e.default,H3e.decryptStream(t),i),n}};wo.Noise=G3e});var W3e=y(ku=>{f();"use strict";var m2t=ku&&ku.__createBinding||(Object.create?function(r,e,t,i){i===void 0&&(i=t),Object.defineProperty(r,i,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}),b2t=ku&&ku.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&m2t(e,r,t)};Object.defineProperty(ku,"__esModule",{value:!0});ku.NOISE=void 0;var v2t=nq();b2t(nq(),ku);ku.NOISE=new v2t.Noise});var Q3e=y((tjt,X3e)=>{f();"use strict";var w2t=$O(),{EventEmitter:_2t}=yr();function Y3e(r,e){if(r===e)return!0;if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;++t)if(r[t]!==e[t])return!1;return!0}function sq(){return{contacts:[],dontSplit:!1,left:null,right:null}}function B1(r,e){if(!(e instanceof Uint8Array))throw new TypeError(r+" is not a Uint8Array")}var M1=class extends _2t{constructor(e={}){super();this.localNodeId=e.localNodeId||w2t(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||M1.distance,this.arbiter=e.arbiter||M1.arbiter,this.metadata=Object.assign({},e.metadata),B1("option.localNodeId as parameter 1",this.localNodeId),this.root=sq()}static arbiter(e,t){return e.vectorClock>t.vectorClock?e:t}static distance(e,t){let i=0,n=0,s=Math.min(e.length,t.length),o=Math.max(e.length,t.length);for(;n<s;++n)i=i*256+(e[n]^t[n]);for(;n<o;++n)i=i*256+255;return i}add(e){B1("contact.id",(e||{}).id);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e.id,t++);let n=this._indexOf(i,e.id);return n>=0?(this._update(i,n,e),this):i.contacts.length<this.numberOfNodesPerKBucket?(i.contacts.push(e),this.emit("added",e),this):i.dontSplit?(this.emit("ping",i.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(i,t),this.add(e))}closest(e,t=1/0){if(B1("id",e),!Number.isInteger(t)&&t!==1/0||t<=0)throw new TypeError("n is not positive number");let i=[];for(let n=[this.root],s=0;n.length>0&&i.length<t;){let o=n.pop();if(o.contacts===null){let a=this._determineNode(o,e,s++);n.push(o.left===a?o.right:o.left),n.push(a)}else i=i.concat(o.contacts)}return i.map(n=>[this.distance(n.id,e),n]).sort((n,s)=>n[0]-s[0]).slice(0,t).map(n=>n[1])}count(){let e=0;for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e+=i.contacts.length}return e}_determineNode(e,t,i){let n=i>>3,s=i%8;return t.length<=n&&s!==0?e.left:t[n]&1<<7-s?e.right:e.left}get(e){B1("id",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);return n>=0?i.contacts[n]:null}_indexOf(e,t){for(let i=0;i<e.contacts.length;++i)if(Y3e(e.contacts[i].id,t))return i;return-1}remove(e){B1("the id as parameter 1",e);let t=0,i=this.root;for(;i.contacts===null;)i=this._determineNode(i,e,t++);let n=this._indexOf(i,e);if(n>=0){let s=i.contacts.splice(n,1)[0];this.emit("removed",s)}return this}_split(e,t){e.left=sq(),e.right=sq();for(let s of e.contacts)this._determineNode(e,s.id,t).contacts.push(s);e.contacts=null;let i=this._determineNode(e,this.localNodeId,t),n=e.left===i?e.right:e.left;n.dontSplit=!0}toArray(){let e=[];for(let t=[this.root];t.length>0;){let i=t.pop();i.contacts===null?t.push(i.right,i.left):e=e.concat(i.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let t=e.pop();t.contacts===null?e.push(t.right,t.left):yield*t.contacts}}_update(e,t,i){if(!Y3e(e.contacts[t].id,i.id))throw new Error("wrong index for _update");let n=e.contacts[t],s=this.arbiter(n,i);s===n&&n!==i||(e.contacts.splice(t,1),e.contacts.push(s),this.emit("updated",n,s))}};X3e.exports=M1});var xx=y((rjt,Z3e)=>{f();Z3e.exports=sf;function sf(r,e){if(r.length!==e.length)throw new Error("Inputs should have the same length");for(var t=Buffer.allocUnsafe(r.length),i=0;i<r.length;i++)t[i]=r[i]^e[i];return t}sf.compare=function(e,t){if(e.length!==t.length)throw new Error("Inputs should have the same length");for(var i=0;i<e.length;i++)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return 0};sf.gt=function(e,t){return sf.compare(e,t)===1};sf.lt=function(e,t){return sf.compare(e,t)===-1};sf.eq=function(e,t){return sf.compare(e,t)===0}});var oq=y((ijt,J3e)=>{f();"use strict";var E2t=ZS();J3e.exports=async(r,e,{concurrency:t=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),u=!1,l=!1,d=0,h=0,p=()=>{if(u)return;let g=c.next(),b=h;if(h++,g.done){l=!0,d===0&&(!i&&a.length!==0?s(new E2t(a)):n(o));return}d++,(async()=>{try{let E=await g.value;o[b]=await e(E,b),d--,p()}catch(E){i?(u=!0,s(E)):(a.push(E),d--,p())}})()};for(let g=0;g<t&&(p(),!l);g++);})});var ui=y(ci=>{f();"use strict";var aq=be(),{sha256:exe}=(ri(),li),{base58btc:S2t}=(ei(),Jr),{Key:x2t}=Ut(),txe=xx(),A2t=oq(),{Record:I2t}=Zf(),T2t=rt(),R2t=ae(),{fromString:rxe}=(ft(),ht),{toString:ixe}=(tt(),et),{concat:C2t}=(cn(),an),nxe=Jd();ci.convertBuffer=async r=>(await exe.digest(r)).digest;ci.convertPeerId=async r=>(await exe.digest(r.id)).digest;ci.bufferToKey=r=>new x2t("/"+ci.encodeBase32(r),!1);ci.keyForPublicKey=r=>C2t([rxe("/pk/"),r.id]);ci.isPublicKeyKey=r=>ixe(r.slice(0,4))==="/pk/";ci.fromPublicKeyKey=r=>new T2t(r.slice(4));ci.now=()=>Date.now();ci.encodeBase32=r=>ixe(r,"base32");ci.decodeBase32=r=>rxe(r,"base32");ci.sortClosestPeers=async(r,e)=>(await A2t(r,async i=>{let n=await ci.convertPeerId(i);return{peer:i,distance:txe(n,e)}})).sort(ci.xorCompare).map(i=>i.peer);ci.xorCompare=(r,e)=>txe.compare(r.distance,e.distance);ci.pathSize=(r,e)=>Math.ceil(r/e);ci.createPutRecord=(r,e)=>{let t=new Date;return new I2t(r,e,t).serialize()};ci.logger=(r,e)=>{let t=["libp2p","dht"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),aq.formatters.b=n=>S2t.baseEncode(n),Object.assign(aq(t.join(":")),{error:aq(t.concat(["error"]).join(":"))})};ci.TimeoutError=class extends Error{get code(){return"ETIMEDOUT"}};ci.withTimeout=(r,e)=>{async function t(...i){if(!e)return r(...i);let n;try{n=await nxe(r(...i),e)}catch(s){throw s instanceof nxe.TimeoutError?R2t(s,"ETIMEDOUT"):s}return n}return t};ci.mapParallel=async function(r,e){let t=[];for await(let i of r)t.push(e(i));return Promise.all(t)}});var axe=y((ojt,oxe)=>{f();"use strict";var P2t=Q3e(),Ax=ui(),sxe=class{constructor(e,t){this.self=e,this._onPing=this._onPing.bind(this),this._onInit(t)}async _onInit(e){let t=await Ax.convertPeerId(this.self);this.kb=new P2t({localNodeId:t,numberOfNodesPerKBucket:e,numberOfNodesToPing:1}),this.kb.on("ping",this._onPing)}_onPing(e,t){let i=e[0];i&&this.kb.remove(i.id),this.kb.add(t)}get size(){return this.kb.count()}async find(e){let t=await Ax.convertPeerId(e),i=this.closestPeer(t);if(i&&e.equals(i))return i}closestPeer(e){let t=this.closestPeers(e,1);if(t.length>0)return t[0]}closestPeers(e,t){return this.kb.closest(e,t).map(n=>n.peer)}async add(e){let t=await Ax.convertPeerId(e);this.kb.add({id:t,peer:e})}async remove(e){let t=await Ax.convertPeerId(e);this.kb.remove(t)}};oxe.exports=sxe});var of=y(Hn=>{f();"use strict";var Ix=Hn.second=1e3,cxe=Hn.minute=60*Ix,cq=Hn.hour=60*cxe;Hn.MAX_RECORD_AGE=36*cq;Hn.PROTOCOL_DHT="/kad/1.0.0";Hn.PROVIDERS_KEY_PREFIX="/providers/";Hn.PROVIDERS_LRU_CACHE_SIZE=256;Hn.PROVIDERS_VALIDITY=24*cq;Hn.PROVIDERS_CLEANUP_INTERVAL=cq;Hn.READ_MESSAGE_TIMEOUT=10*Ix;Hn.GET_MANY_RECORD_COUNT=16;Hn.K=20;Hn.ALPHA=3;Hn.defaultRandomWalk={enabled:!0,queriesPerPeriod:1,interval:5*cxe,timeout:10*Ix,delay:10*Ix}});var lxe=y((cjt,uxe)=>{f();"use strict";var af=ki(),Cy=af.Reader,uq=af.Writer,Ge=af.util,Xr=af.roots["libp2p-dht-message"]||(af.roots["libp2p-dht-message"]={});Xr.Record=function(){function r(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.key=null,r.prototype.value=null,r.prototype.author=null,r.prototype.signature=null,r.prototype.timeReceived=null;var e;return Object.defineProperty(r.prototype,"_key",{get:Ge.oneOfGetter(e=["key"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_value",{get:Ge.oneOfGetter(e=["value"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_author",{get:Ge.oneOfGetter(e=["author"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_signature",{get:Ge.oneOfGetter(e=["signature"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_timeReceived",{get:Ge.oneOfGetter(e=["timeReceived"]),set:Ge.oneOfSetter(e)}),r.encode=function(i,n){return n||(n=uq.create()),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(10).bytes(i.key),i.value!=null&&Object.hasOwnProperty.call(i,"value")&&n.uint32(18).bytes(i.value),i.author!=null&&Object.hasOwnProperty.call(i,"author")&&n.uint32(26).bytes(i.author),i.signature!=null&&Object.hasOwnProperty.call(i,"signature")&&n.uint32(34).bytes(i.signature),i.timeReceived!=null&&Object.hasOwnProperty.call(i,"timeReceived")&&n.uint32(42).string(i.timeReceived),n},r.decode=function(i,n){i instanceof Cy||(i=Cy.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Xr.Record;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.key=i.bytes();break;case 2:o.value=i.bytes();break;case 3:o.author=i.bytes();break;case 4:o.signature=i.bytes();break;case 5:o.timeReceived=i.string();break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Xr.Record)return i;var n=new Xr.Record;return i.key!=null&&(typeof i.key=="string"?Ge.base64.decode(i.key,n.key=Ge.newBuffer(Ge.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.value!=null&&(typeof i.value=="string"?Ge.base64.decode(i.value,n.value=Ge.newBuffer(Ge.base64.length(i.value)),0):i.value.length&&(n.value=i.value)),i.author!=null&&(typeof i.author=="string"?Ge.base64.decode(i.author,n.author=Ge.newBuffer(Ge.base64.length(i.author)),0):i.author.length&&(n.author=i.author)),i.signature!=null&&(typeof i.signature=="string"?Ge.base64.decode(i.signature,n.signature=Ge.newBuffer(Ge.base64.length(i.signature)),0):i.signature.length&&(n.signature=i.signature)),i.timeReceived!=null&&(n.timeReceived=String(i.timeReceived)),n},r.toObject=function(i,n){n||(n={});var s={};return i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?Ge.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.value!=null&&i.hasOwnProperty("value")&&(s.value=n.bytes===String?Ge.base64.encode(i.value,0,i.value.length):n.bytes===Array?Array.prototype.slice.call(i.value):i.value,n.oneofs&&(s._value="value")),i.author!=null&&i.hasOwnProperty("author")&&(s.author=n.bytes===String?Ge.base64.encode(i.author,0,i.author.length):n.bytes===Array?Array.prototype.slice.call(i.author):i.author,n.oneofs&&(s._author="author")),i.signature!=null&&i.hasOwnProperty("signature")&&(s.signature=n.bytes===String?Ge.base64.encode(i.signature,0,i.signature.length):n.bytes===Array?Array.prototype.slice.call(i.signature):i.signature,n.oneofs&&(s._signature="signature")),i.timeReceived!=null&&i.hasOwnProperty("timeReceived")&&(s.timeReceived=i.timeReceived,n.oneofs&&(s._timeReceived="timeReceived")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,af.util.toJSONOptions)},r}();Xr.Message=function(){function r(t){if(this.closerPeers=[],this.providerPeers=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}r.prototype.type=null,r.prototype.clusterLevelRaw=null,r.prototype.key=null,r.prototype.record=null,r.prototype.closerPeers=Ge.emptyArray,r.prototype.providerPeers=Ge.emptyArray;var e;return Object.defineProperty(r.prototype,"_type",{get:Ge.oneOfGetter(e=["type"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_clusterLevelRaw",{get:Ge.oneOfGetter(e=["clusterLevelRaw"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_key",{get:Ge.oneOfGetter(e=["key"]),set:Ge.oneOfSetter(e)}),Object.defineProperty(r.prototype,"_record",{get:Ge.oneOfGetter(e=["record"]),set:Ge.oneOfSetter(e)}),r.encode=function(i,n){if(n||(n=uq.create()),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(8).int32(i.type),i.key!=null&&Object.hasOwnProperty.call(i,"key")&&n.uint32(18).bytes(i.key),i.record!=null&&Object.hasOwnProperty.call(i,"record")&&n.uint32(26).bytes(i.record),i.closerPeers!=null&&i.closerPeers.length)for(var s=0;s<i.closerPeers.length;++s)Xr.Message.Peer.encode(i.closerPeers[s],n.uint32(66).fork()).ldelim();if(i.providerPeers!=null&&i.providerPeers.length)for(var s=0;s<i.providerPeers.length;++s)Xr.Message.Peer.encode(i.providerPeers[s],n.uint32(74).fork()).ldelim();return i.clusterLevelRaw!=null&&Object.hasOwnProperty.call(i,"clusterLevelRaw")&&n.uint32(80).int32(i.clusterLevelRaw),n},r.decode=function(i,n){i instanceof Cy||(i=Cy.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Xr.Message;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.type=i.int32();break;case 10:o.clusterLevelRaw=i.int32();break;case 2:o.key=i.bytes();break;case 3:o.record=i.bytes();break;case 8:o.closerPeers&&o.closerPeers.length||(o.closerPeers=[]),o.closerPeers.push(Xr.Message.Peer.decode(i,i.uint32()));break;case 9:o.providerPeers&&o.providerPeers.length||(o.providerPeers=[]),o.providerPeers.push(Xr.Message.Peer.decode(i,i.uint32()));break;default:i.skipType(a&7);break}}return o},r.fromObject=function(i){if(i instanceof Xr.Message)return i;var n=new Xr.Message;switch(i.type){case"PUT_VALUE":case 0:n.type=0;break;case"GET_VALUE":case 1:n.type=1;break;case"ADD_PROVIDER":case 2:n.type=2;break;case"GET_PROVIDERS":case 3:n.type=3;break;case"FIND_NODE":case 4:n.type=4;break;case"PING":case 5:n.type=5;break}if(i.clusterLevelRaw!=null&&(n.clusterLevelRaw=i.clusterLevelRaw|0),i.key!=null&&(typeof i.key=="string"?Ge.base64.decode(i.key,n.key=Ge.newBuffer(Ge.base64.length(i.key)),0):i.key.length&&(n.key=i.key)),i.record!=null&&(typeof i.record=="string"?Ge.base64.decode(i.record,n.record=Ge.newBuffer(Ge.base64.length(i.record)),0):i.record.length&&(n.record=i.record)),i.closerPeers){if(!Array.isArray(i.closerPeers))throw TypeError(".Message.closerPeers: array expected");n.closerPeers=[];for(var s=0;s<i.closerPeers.length;++s){if(typeof i.closerPeers[s]!="object")throw TypeError(".Message.closerPeers: object expected");n.closerPeers[s]=Xr.Message.Peer.fromObject(i.closerPeers[s])}}if(i.providerPeers){if(!Array.isArray(i.providerPeers))throw TypeError(".Message.providerPeers: array expected");n.providerPeers=[];for(var s=0;s<i.providerPeers.length;++s){if(typeof i.providerPeers[s]!="object")throw TypeError(".Message.providerPeers: object expected");n.providerPeers[s]=Xr.Message.Peer.fromObject(i.providerPeers[s])}}return n},r.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.closerPeers=[],s.providerPeers=[]),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Xr.Message.MessageType[i.type]:i.type,n.oneofs&&(s._type="type")),i.key!=null&&i.hasOwnProperty("key")&&(s.key=n.bytes===String?Ge.base64.encode(i.key,0,i.key.length):n.bytes===Array?Array.prototype.slice.call(i.key):i.key,n.oneofs&&(s._key="key")),i.record!=null&&i.hasOwnProperty("record")&&(s.record=n.bytes===String?Ge.base64.encode(i.record,0,i.record.length):n.bytes===Array?Array.prototype.slice.call(i.record):i.record,n.oneofs&&(s._record="record")),i.closerPeers&&i.closerPeers.length){s.closerPeers=[];for(var o=0;o<i.closerPeers.length;++o)s.closerPeers[o]=Xr.Message.Peer.toObject(i.closerPeers[o],n)}if(i.providerPeers&&i.providerPeers.length){s.providerPeers=[];for(var o=0;o<i.providerPeers.length;++o)s.providerPeers[o]=Xr.Message.Peer.toObject(i.providerPeers[o],n)}return i.clusterLevelRaw!=null&&i.hasOwnProperty("clusterLevelRaw")&&(s.clusterLevelRaw=i.clusterLevelRaw,n.oneofs&&(s._clusterLevelRaw="clusterLevelRaw")),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,af.util.toJSONOptions)},r.MessageType=function(){var t={},i=Object.create(t);return i[t[0]="PUT_VALUE"]=0,i[t[1]="GET_VALUE"]=1,i[t[2]="ADD_PROVIDER"]=2,i[t[3]="GET_PROVIDERS"]=3,i[t[4]="FIND_NODE"]=4,i[t[5]="PING"]=5,i}(),r.ConnectionType=function(){var t={},i=Object.create(t);return i[t[0]="NOT_CONNECTED"]=0,i[t[1]="CONNECTED"]=1,i[t[2]="CAN_CONNECT"]=2,i[t[3]="CANNOT_CONNECT"]=3,i}(),r.Peer=function(){function t(n){if(this.addrs=[],n)for(var s=Object.keys(n),o=0;o<s.length;++o)n[s[o]]!=null&&(this[s[o]]=n[s[o]])}t.prototype.id=null,t.prototype.addrs=Ge.emptyArray,t.prototype.connection=null;var i;return Object.defineProperty(t.prototype,"_id",{get:Ge.oneOfGetter(i=["id"]),set:Ge.oneOfSetter(i)}),Object.defineProperty(t.prototype,"_connection",{get:Ge.oneOfGetter(i=["connection"]),set:Ge.oneOfSetter(i)}),t.encode=function(s,o){if(o||(o=uq.create()),s.id!=null&&Object.hasOwnProperty.call(s,"id")&&o.uint32(10).bytes(s.id),s.addrs!=null&&s.addrs.length)for(var a=0;a<s.addrs.length;++a)o.uint32(18).bytes(s.addrs[a]);return s.connection!=null&&Object.hasOwnProperty.call(s,"connection")&&o.uint32(24).int32(s.connection),o},t.decode=function(s,o){s instanceof Cy||(s=Cy.create(s));for(var a=o===void 0?s.len:s.pos+o,c=new Xr.Message.Peer;s.pos<a;){var u=s.uint32();switch(u>>>3){case 1:c.id=s.bytes();break;case 2:c.addrs&&c.addrs.length||(c.addrs=[]),c.addrs.push(s.bytes());break;case 3:c.connection=s.int32();break;default:s.skipType(u&7);break}}return c},t.fromObject=function(s){if(s instanceof Xr.Message.Peer)return s;var o=new Xr.Message.Peer;if(s.id!=null&&(typeof s.id=="string"?Ge.base64.decode(s.id,o.id=Ge.newBuffer(Ge.base64.length(s.id)),0):s.id.length&&(o.id=s.id)),s.addrs){if(!Array.isArray(s.addrs))throw TypeError(".Message.Peer.addrs: array expected");o.addrs=[];for(var a=0;a<s.addrs.length;++a)typeof s.addrs[a]=="string"?Ge.base64.decode(s.addrs[a],o.addrs[a]=Ge.newBuffer(Ge.base64.length(s.addrs[a])),0):s.addrs[a].length&&(o.addrs[a]=s.addrs[a])}switch(s.connection){case"NOT_CONNECTED":case 0:o.connection=0;break;case"CONNECTED":case 1:o.connection=1;break;case"CAN_CONNECT":case 2:o.connection=2;break;case"CANNOT_CONNECT":case 3:o.connection=3;break}return o},t.toObject=function(s,o){o||(o={});var a={};if((o.arrays||o.defaults)&&(a.addrs=[]),s.id!=null&&s.hasOwnProperty("id")&&(a.id=o.bytes===String?Ge.base64.encode(s.id,0,s.id.length):o.bytes===Array?Array.prototype.slice.call(s.id):s.id,o.oneofs&&(a._id="id")),s.addrs&&s.addrs.length){a.addrs=[];for(var c=0;c<s.addrs.length;++c)a.addrs[c]=o.bytes===String?Ge.base64.encode(s.addrs[c],0,s.addrs[c].length):o.bytes===Array?Array.prototype.slice.call(s.addrs[c]):s.addrs[c]}return s.connection!=null&&s.hasOwnProperty("connection")&&(a.connection=o.enums===String?Xr.Message.ConnectionType[s.connection]:s.connection,o.oneofs&&(a._connection="connection")),a},t.prototype.toJSON=function(){return this.constructor.toObject(this,af.util.toJSONOptions)},t}(),r}();uxe.exports=Xr});var Ac=y((ujt,pxe)=>{f();"use strict";var O2t=rt(),{Multiaddr:k2t}=it(),{Record:q2t}=Zf(),Tx=lxe(),N2t=Tx.Message.MessageType,fxe=Tx.Message.ConnectionType,Py=class{constructor(e,t,i){if(t&&!(t instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=t,this._clusterLevelRaw=i,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this._clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this._clusterLevelRaw=e}serialize(){let e={key:this.key,type:this.type,clusterLevelRaw:this._clusterLevelRaw,closerPeers:this.closerPeers.map(dxe),providerPeers:this.providerPeers.map(dxe),record:void 0};return this.record&&(this.record instanceof Uint8Array?e.record=this.record:e.record=this.record.serialize()),Tx.Message.encode(e).finish()}static deserialize(e){let t=Tx.Message.decode(e),i=new Py(t.type||0,t.key||Uint8Array.from([]),t.clusterLevelRaw||0);return i.closerPeers=t.closerPeers.map(hxe),i.providerPeers=t.providerPeers.map(hxe),t.record&&t.record.length&&(i.record=q2t.deserialize(t.record)),i}};Py.TYPES=N2t;Py.CONNECTION_TYPES=fxe;function dxe(r){return{id:r.id.id,addrs:(r.multiaddrs||[]).map(t=>t.bytes),connection:fxe.CONNECTED}}function hxe(r){return{id:new O2t(r.id),multiaddrs:(r.addrs||[]).map(e=>new k2t(e))}}pxe.exports=Py});var mxe=y((ljt,gxe)=>{f();"use strict";var{Record:D2t}=Zf(),B2t=ae(),yxe=Ac(),lq=ui();gxe.exports=r=>{let e=lq.logger(r.peerId,"rpc:get-value");async function t(i,n){let s=n.key;if(e("key: %b",s),!s||s.length===0)throw B2t(new Error("Invalid key"),"ERR_INVALID_KEY");let o=new yxe(yxe.TYPES.GET_VALUE,s,n.clusterLevel);if(lq.isPublicKeyKey(s)){e("is public key");let u=lq.fromPublicKeyKey(s),l;if(r._isSelf(u))l=r.peerId;else{let d=r.peerStore.get(u);l=d&&d.id}if(l&&l.pubKey)return e("returning found public key"),o.record=new D2t(s,l.pubKey.bytes),o}let[a,c]=await Promise.all([r._checkLocalDatastore(s),r._betterPeersToQuery(n,i)]);return a&&(e("got record"),o.record=a),c.length>0&&(e("got closer %s",c.length),o.closerPeers=c),o}return t}});var wxe=y((fjt,vxe)=>{f();"use strict";var bxe=ui(),M2t=ae();vxe.exports=r=>{let e=bxe.logger(r.peerId,"rpc:put-value");async function t(i,n){let s=n.key;e("key: %b",s);let o=n.record;if(!o){let c=`Empty record from: ${i.toB58String()}`;throw e.error(c),M2t(new Error(c),"ERR_EMPTY_RECORD")}await r._verifyRecordLocally(o),o.timeReceived=new Date;let a=bxe.bufferToKey(o.key);return await r.datastore.put(a,o.serialize()),r.onPut(o,i),n}return t}});var Exe=y((djt,_xe)=>{f();"use strict";var{equals:L2t}=(di(),fi),U2t=Ac(),F2t=ui();_xe.exports=r=>{let e=F2t.logger(r.peerId,"rpc:find-node");async function t(i,n){e("start");let s;L2t(n.key,r.peerId.id)?s=[{id:r.peerId,multiaddrs:r.libp2p.multiaddrs}]:s=await r._betterPeersToQuery(n,i);let o=new U2t(n.type,new Uint8Array(0),n.clusterLevel);return s.length>0?o.closerPeers=s:e("handle FindNode %s: could not find anything",i.toB58String()),o}return t}});var Axe=y((hjt,xxe)=>{f();"use strict";var{CID:K2t}=(Ie(),De),Sxe=ae(),j2t=ui();xxe.exports=r=>{let e=j2t.logger(r.peerId,"rpc:add-provider");async function t(i,n){if(e("start"),!n.key||n.key.length===0)throw Sxe(new Error("Missing key"),"ERR_MISSING_KEY");let s;try{s=K2t.decode(n.key)}catch(o){let a=`Invalid CID: ${o.message}`;throw Sxe(new Error(a),"ERR_INVALID_CID")}return n.providerPeers.forEach(o=>{if(!o.id.isEqual(i)){e("invalid provider peer %s from %s",o.id.toB58String(),i.toB58String());return}if(o.multiaddrs.length<1){e("no valid addresses for provider %s. Ignore",i.toB58String());return}if(e("received provider %s for %s (addrs %s)",i.toB58String(),s.toString(),o.multiaddrs.map(a=>a.toString())),!r._isSelf(o.id))return r.peerStore.addressBook.add(o.id,o.multiaddrs),r.providers.addProvider(s,o.id)}),r.providers.addProvider(s,i)}return t}});var Rxe=y((pjt,Txe)=>{f();"use strict";var{CID:V2t}=(Ie(),De),z2t=ae(),H2t=Ac(),Ixe=ui();Txe.exports=r=>{let e=Ixe.logger(r.peerId,"rpc:get-providers");async function t(i,n){let s;try{s=V2t.decode(n.key)}catch(p){throw z2t(new Error(`Invalid CID: ${p.message}`),"ERR_INVALID_CID")}e("%s",s.toString());let o=Ixe.bufferToKey(s.bytes),[a,c,u]=await Promise.all([r.datastore.has(o),r.providers.getProviders(s),r._betterPeersToQuery(n,i)]),l=c.map(p=>({id:p,multiaddrs:[]})),d=u.map(p=>({id:p.id,multiaddrs:[]}));a&&l.push({id:r.peerId,multiaddrs:[]});let h=new H2t(n.type,n.key,n.clusterLevel);return l.length>0&&(h.providerPeers=l),d.length>0&&(h.closerPeers=d),e("got %s providers %s closerPeers",l.length,d.length),h}return t}});var Pxe=y((yjt,Cxe)=>{f();"use strict";var $2t=ui();Cxe.exports=r=>{let e=$2t.logger(r.peerId,"rpc:ping");function t(i,n){return e("from %s",i.toB58String()),n}return t}});var kxe=y((gjt,Oxe)=>{f();"use strict";var Oy=Ac().TYPES;Oxe.exports=r=>{let e={[Oy.GET_VALUE]:mxe()(r),[Oy.PUT_VALUE]:wxe()(r),[Oy.FIND_NODE]:Exe()(r),[Oy.ADD_PROVIDER]:Axe()(r),[Oy.GET_PROVIDERS]:Rxe()(r),[Oy.PING]:Pxe()(r)};function t(i){return e[i]}return t}});var Dxe=y((mjt,Nxe)=>{f();"use strict";var{pipe:G2t}=Ar(),qxe=ia(),W2t=Ac(),Y2t=kxe(),X2t=ui();Nxe.exports=r=>{let e=X2t.logger(r.peerId,"rpc"),t=Y2t(r);async function i(s,o){let a=t(o.type);try{await r._add(s)}catch(c){e.error("Failed to update the kbucket store",c)}if(!a){e.error(`no handler found for message type: ${o.type}`);return}return a(s,o)}async function n({stream:s,connection:o}){let a=o.remotePeer;try{await r._add(a)}catch(u){e.error(u)}let c=a.toB58String();e("from: %s",c),await G2t(s.source,qxe.decode(),u=>async function*(){for await(let l of u){let d=W2t.deserialize(l.slice()),h=await i(a,d);h&&(yield h.serialize())}}(),qxe.encode(),s.sink)}return n}});var Uxe=y((bjt,Lxe)=>{f();"use strict";var Rx=ae(),{pipe:Bxe}=Ar(),fq=ia(),Q2t=Jd(),{consume:Z2t}=jp(),J2t=zf(),eEt=lS(),tEt=Dxe(),rEt=of(),iEt=Ac(),nEt=ui(),Mxe=class{constructor(e){this.dht=e,this.readMessageTimeout=rEt.READ_MESSAGE_TIMEOUT,this._log=nEt.logger(this.dht.peerId,"net"),this._rpc=tEt(this.dht),this._onPeerConnected=this._onPeerConnected.bind(this),this._running=!1}start(){if(this._running)return;if(!this.dht.isStarted)throw Rx(new Error("Can not start network"),"ERR_CANNOT_START_NETWORK");this._running=!0,this.dht._clientMode===!1&&this.dht.registrar.handle(this.dht.protocol,this._rpc);let e=new eEt({multicodecs:[this.dht.protocol],handlers:{onConnect:this._onPeerConnected,onDisconnect:()=>{}}});this._registrarId=this.dht.registrar.register(e)}stop(){!this.dht.isStarted&&!this.isStarted||(this._running=!1,this._registrarId&&this.dht.registrar.unregister(this._registrarId))}get isStarted(){return this._running}get isConnected(){return this.dht.isStarted&&this.isStarted}async _onPeerConnected(e){await this.dht._add(e),this._log("added to the routing table: %s",e.toB58String())}async sendRequest(e,t){if(!this.isConnected)throw Rx(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeReadMessage(s,t.serialize())}async sendMessage(e,t){if(!this.isConnected)throw Rx(new Error("Network is offline"),"ERR_NETWORK_OFFLINE");let i=e.toB58String();this._log("sending to: %s",i);let n=this.dht.registrar.connectionManager.get(e);n||(n=await this.dht.dialer.connectToPeer(e));let{stream:s}=await n.newStream(this.dht.protocol);return this._writeMessage(s,t.serialize())}async _writeReadMessage(e,t){return Q2t(sEt(e,t),this.readMessageTimeout)}_writeMessage(e,t){return Bxe([t],fq.encode(),e,Z2t)}};async function sEt(r,e){let t=await Bxe([e],fq.encode(),r,fq.decode(),async i=>{let n=await J2t(i);if(n)return n.slice()});if(t.length===0)throw Rx(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED");return iEt.deserialize(t)}Lxe.exports=Mxe});var Vxe=y((vjt,jxe)=>{f();"use strict";var Cx=xx(),Fxe=ui(),oEt=oq(),{equals:aEt}=(di(),fi),Kxe=class{constructor(e,t){this.originDhtKey=e,this.capacity=t,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(n=>aEt(n.peerId.id,e.id)))return;let t=await Fxe.convertPeerId(e),i={peerId:e,distance:Cx(this.originDhtKey,t)};this.peerDistances.push(i),this.peerDistances.sort((n,s)=>Cx.compare(n.distance,s.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(!e.length)return!1;if(!this.length)return!0;let t=await oEt(e,n=>Fxe.convertPeerId(n)),i=this.peerDistances[this.peerDistances.length-1].distance;for(let n of t){let s=Cx(this.originDhtKey,n);if(Cx.compare(s,i)<0)return!0}return!1}};jxe.exports=Kxe});var Hxe=y((dq,zxe)=>{f();(function(){var r,e,t,i,n,s,o,a,c,u,l,d,h,p,g;t=Math.floor,u=Math.min,e=function(b,E){return b<E?-1:b>E?1:0},c=function(b,E,v,A,R){var F;if(v==null&&(v=0),R==null&&(R=e),v<0)throw new Error("lo must be non-negative");for(A==null&&(A=b.length);v<A;)F=t((v+A)/2),R(E,b[F])<0?A=F:v=F+1;return[].splice.apply(b,[v,v-v].concat(E)),E},s=function(b,E,v){return v==null&&(v=e),b.push(E),p(b,0,b.length-1,v)},n=function(b,E){var v,A;return E==null&&(E=e),v=b.pop(),b.length?(A=b[0],b[0]=v,g(b,0,E)):A=v,A},a=function(b,E,v){var A;return v==null&&(v=e),A=b[0],b[0]=E,g(b,0,v),A},o=function(b,E,v){var A;return v==null&&(v=e),b.length&&v(b[0],E)<0&&(A=[b[0],E],E=A[0],b[0]=A[1],g(b,0,v)),E},i=function(b,E){var v,A,R,F,q,N,z,G;for(E==null&&(E=e),N=function(){G=[];for(var Y=0,C=t(b.length/2);0<=C?Y<C:Y>C;0<=C?Y++:Y--)G.push(Y);return G}.apply(this).reverse(),z=[],A=0,F=N.length;A<F;A++)v=N[A],z.push(g(b,v,E));return z},h=function(b,E,v){var A;if(v==null&&(v=e),A=b.indexOf(E),A!==-1)return p(b,0,A,v),g(b,A,v)},l=function(b,E,v){var A,R,F,q,N;if(v==null&&(v=e),R=b.slice(0,E),!R.length)return R;for(i(R,v),N=b.slice(E),F=0,q=N.length;F<q;F++)A=N[F],o(R,A,v);return R.sort(v).reverse()},d=function(b,E,v){var A,R,F,q,N,z,G,Y,C,m;if(v==null&&(v=e),E*10<=b.length){if(q=b.slice(0,E).sort(v),!q.length)return q;for(F=q[q.length-1],Y=b.slice(E),N=0,G=Y.length;N<G;N++)A=Y[N],v(A,F)<0&&(c(q,A,0,null,v),q.pop(),F=q[q.length-1]);return q}for(i(b,v),m=[],R=z=0,C=u(E,b.length);0<=C?z<C:z>C;R=0<=C?++z:--z)m.push(n(b,v));return m},p=function(b,E,v,A){var R,F,q;for(A==null&&(A=e),R=b[v];v>E;){if(q=v-1>>1,F=b[q],A(R,F)<0){b[v]=F,v=q;continue}break}return b[v]=R},g=function(b,E,v){var A,R,F,q,N;for(v==null&&(v=e),R=b.length,N=E,F=b[E],A=2*E+1;A<R;)q=A+1,q<R&&!(v(b[A],b[q])<0)&&(A=q),b[E]=b[A],E=A,A=2*E+1;return b[E]=F,p(b,N,E,v)},r=function(){b.push=s,b.pop=n,b.replace=a,b.pushpop=o,b.heapify=i,b.updateItem=h,b.nlargest=l,b.nsmallest=d;function b(E){this.cmp=E??e,this.nodes=[]}return b.prototype.push=function(E){return s(this.nodes,E,this.cmp)},b.prototype.pop=function(){return n(this.nodes,this.cmp)},b.prototype.peek=function(){return this.nodes[0]},b.prototype.contains=function(E){return this.nodes.indexOf(E)!==-1},b.prototype.replace=function(E){return a(this.nodes,E,this.cmp)},b.prototype.pushpop=function(E){return o(this.nodes,E,this.cmp)},b.prototype.heapify=function(){return i(this.nodes,this.cmp)},b.prototype.updateItem=function(E){return h(this.nodes,E,this.cmp)},b.prototype.clear=function(){return this.nodes=[]},b.prototype.empty=function(){return this.nodes.length===0},b.prototype.size=function(){return this.nodes.length},b.prototype.clone=function(){var E;return E=new b,E.nodes=this.nodes.slice(0),E},b.prototype.toArray=function(){return this.nodes.slice(0)},b.prototype.insert=b.prototype.push,b.prototype.top=b.prototype.peek,b.prototype.front=b.prototype.peek,b.prototype.has=b.prototype.contains,b.prototype.copy=b.prototype.clone,b}(),function(b,E){return typeof define=="function"&&define.amd?define([],E):typeof dq=="object"?zxe.exports=E():b.Heap=E()}(this,function(){return r})}).call(dq)});var Gxe=y((wjt,$xe)=>{f();$xe.exports=Hxe()});var Yxe=y((_jt,Wxe)=>{f();"use strict";var cEt=Gxe(),uEt=xx(),lEt=be(),Px=ui(),hq=lEt("libp2p:dht:peer-queue"),L1=class{static async fromPeerId(e){let t=await Px.convertPeerId(e);return new L1(t)}static async fromKey(e){let t=await Px.convertBuffer(e);return new L1(t)}constructor(e){hq("create: %b",e),this.from=e,this.heap=new cEt(Px.xorCompare)}async enqueue(e){hq("enqueue %s",e.toB58String());let t=await Px.convertPeerId(e),i={id:e,distance:uEt(this.from,t)};this.heap.push(i)}dequeue(){let e=this.heap.pop();return hq("dequeue %s",e.id.toB58String()),e.id}get length(){return this.heap.size()}};Wxe.exports=L1});var Zxe=y((Ejt,Qxe)=>{f();"use strict";var fEt=Yxe(),dEt=ui(),hEt=3e4,Xxe=class{constructor(e,t){if(this.run=e,this.queryFunc=dEt.withTimeout(t,hEt),!this.queryFunc)throw new Error("Path requires a `queryFn` to be specified");if(typeof this.queryFunc!="function")throw new Error("Path expected `queryFn` to be a function. Got "+typeof this.queryFunc);this.initialPeers=[],this.peersToQuery=null,this.res=null}addInitialPeer(e){this.initialPeers.push(e)}async execute(){let e=await fEt.fromKey(this.run.query.key);this.peersToQuery=e,await Promise.all(this.initialPeers.map(t=>this.addPeerToQuery(t))),await this.run.workerQueue(this)}async addPeerToQuery(e){this.run.query.dht._isSelf(e)||this.run.peersSeen.has(e.toB58String())||this.peersToQuery&&await this.peersToQuery.enqueue(e)}};Qxe.exports=Xxe});var e6e=y((Sjt,pq)=>{f();"use strict";var pEt=Object.prototype.hasOwnProperty,$n="~";function U1(){}Object.create&&(U1.prototype=Object.create(null),new U1().__proto__||($n=!1));function yEt(r,e,t){this.fn=r,this.context=e,this.once=t||!1}function Jxe(r,e,t,i,n){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new yEt(t,i||r,n),o=$n?$n+e:e;return r._events[o]?r._events[o].fn?r._events[o]=[r._events[o],s]:r._events[o].push(s):(r._events[o]=s,r._eventsCount++),r}function Ox(r,e){--r._eventsCount==0?r._events=new U1:delete r._events[e]}function An(){this._events=new U1,this._eventsCount=0}An.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)pEt.call(t,i)&&e.push($n?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};An.prototype.listeners=function(e){var t=$n?$n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,s=i.length,o=new Array(s);n<s;n++)o[n]=i[n].fn;return o};An.prototype.listenerCount=function(e){var t=$n?$n+e:e,i=this._events[t];return i?i.fn?1:i.length:0};An.prototype.emit=function(e,t,i,n,s,o){var a=$n?$n+e:e;if(!this._events[a])return!1;var c=this._events[a],u=arguments.length,l,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,i),!0;case 4:return c.fn.call(c.context,t,i,n),!0;case 5:return c.fn.call(c.context,t,i,n,s),!0;case 6:return c.fn.call(c.context,t,i,n,s,o),!0}for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c.fn.apply(c.context,l)}else{var h=c.length,p;for(d=0;d<h;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),u){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,i);break;case 4:c[d].fn.call(c[d].context,t,i,n);break;default:if(!l)for(p=1,l=new Array(u-1);p<u;p++)l[p-1]=arguments[p];c[d].fn.apply(c[d].context,l)}}return!0};An.prototype.on=function(e,t,i){return Jxe(this,e,t,i,!1)};An.prototype.once=function(e,t,i){return Jxe(this,e,t,i,!0)};An.prototype.removeListener=function(e,t,i,n){var s=$n?$n+e:e;if(!this._events[s])return this;if(!t)return Ox(this,s),this;var o=this._events[s];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&Ox(this,s);else{for(var a=0,c=[],u=o.length;a<u;a++)(o[a].fn!==t||n&&!o[a].once||i&&o[a].context!==i)&&c.push(o[a]);c.length?this._events[s]=c.length===1?c[0]:c:Ox(this,s)}return this};An.prototype.removeAllListeners=function(e){var t;return e?(t=$n?$n+e:e,this._events[t]&&Ox(this,t)):(this._events=new U1,this._eventsCount=0),this};An.prototype.off=An.prototype.removeListener;An.prototype.addListener=An.prototype.on;An.prefixed=$n;An.EventEmitter=An;typeof pq!="undefined"&&(pq.exports=An)});var r6e=y((xjt,kx)=>{f();"use strict";var gEt=Uf(),yq=class extends Error{constructor(e){super(e);this.name="TimeoutError"}},t6e=(r,e,t)=>new Promise((i,n)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){i(r);return}let s=setTimeout(()=>{if(typeof t=="function"){try{i(t())}catch(c){n(c)}return}let o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,a=t instanceof Error?t:new yq(o);typeof r.cancel=="function"&&r.cancel(),n(a)},e);gEt(r.then(i,n),()=>{clearTimeout(s)})});kx.exports=t6e;kx.exports.default=t6e;kx.exports.TimeoutError=yq});var i6e=y(gq=>{f();"use strict";Object.defineProperty(gq,"__esModule",{value:!0});function mEt(r,e,t){let i=0,n=r.length;for(;n>0;){let s=n/2|0,o=i+s;t(r[o],e)<=0?(i=++o,n-=s+1):n=s}return i}gq.default=mEt});var s6e=y(mq=>{f();"use strict";Object.defineProperty(mq,"__esModule",{value:!0});var bEt=i6e(),n6e=class{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);let i={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(i);return}let n=bEt.default(this._queue,i,(s,o)=>o.priority-s.priority);this._queue.splice(n,0,i)}dequeue(){let e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}};mq.default=n6e});var vq=y(bq=>{f();"use strict";Object.defineProperty(bq,"__esModule",{value:!0});var vEt=e6e(),o6e=r6e(),wEt=s6e(),qx=()=>{},_Et=new o6e.TimeoutError,a6e=class extends vEt{constructor(e){var t,i,n,s;super();if(this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=qx,this._resolveIdle=qx,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:wEt.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(i=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&i!==void 0?i:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(n=e.interval)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=qx,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=qx,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((i,n)=>{let s=async()=>{this._pendingCount++,this._intervalCount++;try{let o=this._timeout===void 0&&t.timeout===void 0?e():o6e.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&n(_Et)});i(await o)}catch(o){n(o)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async i=>this.add(i,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};bq.default=a6e});var l6e=y((Rjt,u6e)=>{f();"use strict";var{default:EEt}=vq(),c6e=class{constructor(e,t,i,n){this.dht=e,this.run=t,this.path=i,this.log=n,this.concurrency=this.dht.concurrency,this.queue=this.setupQueue(),this.execution=null,this.queuedPeerIds=new Set}setupQueue(){let e=new EEt({concurrency:this.concurrency});return e.on("idle",()=>{this.path.peersToQuery&&!this.path.peersToQuery.length&&(this.log("queue:drain"),this.stop())}),e.on("next",()=>{!this.running||e.pending<this.concurrency&&this.fill()}),e}stop(e){!this.running||(this.running=!1,this.queue.clear(),this.log("worker:stop, %d workers still running",this.run.workers.filter(t=>t.running).length),this.execution&&(e?this.execution.reject(e):this.execution.resolve()))}async execute(){this.running=!0,this.execution=null;let e=new Promise((t,i)=>{this.execution={resolve:t,reject:i}});this.fill(),await e}fill(){if(!!this.path.peersToQuery)for(;this.queue.pending+this.queue.size<this.concurrency&&this.path.peersToQuery.length>0;){let e=this.path.peersToQuery.dequeue();this.queuedPeerIds.add(e),this.queue.add(()=>this.processNext(e).catch(t=>{this.log.error("queue",t),this.stop(t)}).finally(()=>{this.queuedPeerIds.delete(e)}))}}async processNext(e){if(!this.running||this.run.peersSeen.has(e.toB58String()))return;let t,i;try{t=await this.run.continueQuerying(this)}catch(o){i=o}if(!this.running)return;if(i)throw i;if(!t){this.stop();return}if(this.run.peersSeen.has(e.toB58String()))return;this.run.peersSeen.add(e.toB58String()),this.log("queue:work");let n,s;try{n=await this.execQuery(e)}catch(o){s=o}if(!!this.running){if(this.log("queue:work:done",s,n),s)throw s;if(n&&n.queryComplete){this.log("query:complete"),this.run.stop();return}n&&n.pathComplete&&this.stop()}}async execQuery(e){let t,i;try{t=await this.path.queryFunc(e)}catch(n){i=n}if(!!this.running){if(i){this.run.errors.push(i);return}if(this.run.peersQueried&&await this.run.peersQueried.add(e),!!t){if(t.pathComplete||t.queryComplete)return this.path.res=t,{pathComplete:t.pathComplete,queryComplete:t.queryComplete};if(t.closerPeers&&t.closerPeers.length>0){let n=async s=>{this.dht._isSelf(s.id)||(this.dht._peerDiscovered(s.id,s.multiaddrs),await this.path.addPeerToQuery(s.id))};await Promise.all(t.closerPeers.map(n))}}}}};u6e.exports=c6e});var h6e=y((Cjt,d6e)=>{f();"use strict";var SEt=Vxe(),xEt=yr(),AEt=Zxe(),IEt=l6e(),TEt=ui(),f6e=class extends xEt{constructor(e){super();this.query=e,this.running=!1,this.workers=[],this.peersSeen=new Set,this.errors=[],this.peersQueried=null}stop(){if(!!this.running){this.running=!1;for(let e of this.workers)e.stop()}}async execute(e){let t=[],i=Math.min(this.query.dht.disjointPaths,e.length);for(let s=0;s<i;s++)t.push(new AEt(this,this.query.makePath(s,i)));e.forEach((s,o)=>{t[o%i].addInitialPeer(s)}),await this.executePaths(t);let n={finalSet:new Set(this.peersQueried&&this.peersQueried.peers),paths:[]};for(let s of t)s.res&&(s.res.pathComplete||s.res.queryComplete)&&(s.res.success=!0,n.paths.push(s.res));return n}async executePaths(e){this.running=!0,this.emit("start");try{await Promise.all(e.map(t=>t.execute()))}finally{this.stop(),this.emit("complete")}if(this.errors.length===this.peersSeen.size)throw this.errors[0]}async workerQueue(e){await this.init(),await this.startWorker(e)}async startWorker(e){let t=new IEt(this.query.dht,this,e,this.query._log);this.workers.push(t),await t.execute()}async init(){if(!this.peersQueried){if(this.peersQueriedPromise){await this.peersQueriedPromise;return}this.peersQueriedPromise=(async()=>{let e=await TEt.convertBuffer(this.query.key);this.peersQueried=new SEt(e,this.query.dht.kBucketSize)})(),await this.peersQueriedPromise,delete this.peersQueriedPromise}}async continueQuerying(e){if(this.peersQueried&&this.peersQueried.length<this.peersQueried.capacity)return!0;let t=Array.from(e.queuedPeerIds);return!!(this.peersQueried&&await this.peersQueried.anyCloser(t))}};d6e.exports=f6e});var Nx=y((Pjt,y6e)=>{f();"use strict";var{base58btc:REt}=(ei(),Jr),CEt=ui(),PEt=h6e(),p6e=class{constructor(e,t,i){this.dht=e,this.key=t,this.makePath=i,this._log=CEt.logger(this.dht.peerId,"query:"+REt.baseEncode(t)),this.running=!1,this._onStart=this._onStart.bind(this),this._onComplete=this._onComplete.bind(this)}async run(e){return this.dht._queryManager.running?e.length===0?(this._log.error("Running query with no peers"),{finalSet:new Set,paths:[]}):(this._run=new PEt(this),this._log(`query running with K=${this.dht.kBucketSize}, A=${this.dht.concurrency}, D=${Math.min(this.dht.disjointPaths,e.length)}`),this._run.once("start",this._onStart),this._run.once("complete",this._onComplete),this._run.execute(e)):(this._log.error("Attempt to run query after shutdown"),{finalSet:new Set,paths:[]})}_onStart(){this.running=!0,this._startTime=Date.now(),this._log("query:start"),this.dht._queryManager.queryStarted(this)}_onComplete(){this.stop()}stop(){this._log(`query:done in ${Date.now()-(this._startTime||0)}ms`),this._run&&this._log(`${this._run.errors.length} of ${this._run.peersSeen.size} peers errored (${this._run.errors.length/this._run.peersSeen.size*100}% fail rate)`),!!this.running&&(this.running=!1,this._run&&(this._run.removeListener("start",this._onStart),this._run.removeListener("complete",this._onComplete),this._run.stop()),this.dht._queryManager.queryCompleted(this))}};y6e.exports=p6e});var v6e=y((Ojt,b6e)=>{f();"use strict";var wq=ae(),OEt=Jd(),{equals:kEt}=(di(),fi),{toString:g6e}=(tt(),et),m6e=Zf(),_q=of(),qEt=Nx(),sh=ui(),NEt=m6e.Record;b6e.exports=r=>{let e=async(n,s)=>r.datastore.put(sh.bufferToKey(n),s),t=async n=>{r._log(`getLocal ${g6e(n,"base32")}`);let s=await r.datastore.get(sh.bufferToKey(n));r._log(`found ${g6e(n,"base32")} in local datastore`);let o=NEt.deserialize(s);return await r._verifyRecordLocally(o),o},i=async(n,s,o)=>{let a=await sh.createPutRecord(n,o);return Promise.all(s.map(async c=>{if(!kEt(c.val,o)){if(r._isSelf(c.from)){try{await r._putLocal(n,a)}catch(u){r._log.error("Failed error correcting self",u)}return}try{await r._putValueToPeer(n,a,c.from)}catch(u){r._log.error("Failed error correcting entry",u)}}}))};return{async _putLocal(n,s){return e(n,s)},async put(n,s,o={}){r._log("PutValue %b",n);let a=await sh.createPutRecord(n,s);await e(n,a);let c=0,u=0;await sh.mapParallel(r.getClosestPeers(n,{shallow:!0}),async d=>{try{c+=1,await r._putValueToPeer(n,a,d),u+=1}catch(h){r._log.error("Failed to put to peer (%b): %s",d.id,h)}});let l=o.minPeers||c;if(l>u){let d=wq(new Error(`Failed to put value to enough peers: ${u}/${l}`),"ERR_NOT_ENOUGH_PUT_PEERS");throw r._log.error(d),d}},async get(n,s={}){s.timeout=s.timeout||_q.minute,r._log("_get %b",n);let o=await r.getMany(n,_q.GET_MANY_RECORD_COUNT,s),a=o.map(l=>l.val),c=0;try{c=m6e.selection.bestRecord(r.selectors,n,a)}catch(l){if(l.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw l}let u=a[c];if(r._log("GetValue %b %s",n,u),!u)throw wq(new Error("best value was not found"),"ERR_NOT_FOUND");return await i(n,o,u),u},async getMany(n,s,o={}){o.timeout=o.timeout||_q.minute,r._log("getMany %b (%s)",n,s);let a=[],c;try{c=await t(n)}catch(g){if(s===0)throw g}if(c&&a.push({val:c.value,from:r.peerId}),a.length>=s)return a;let u=await sh.convertBuffer(n),l=r.routingTable.closestPeers(u,r.kBucketSize);if(r._log("peers in rt: %d",l.length),l.length===0){let g="Failed to lookup key! No peers from routing table!";if(r._log.error(g),a.length===0)throw wq(new Error(g),"ERR_NO_PEERS_IN_ROUTING_TABLE");return a}let d=a.length;function h(g,b){let E=sh.pathSize(s-d,b),v=0;async function A(R){let F,q,N;try{let G=await r._getValueOrPeers(R,n);F=G.record,q=G.peers}catch(G){if(G.code!=="ERR_INVALID_RECORD")throw G;N=G}let z={closerPeers:q};return F&&F.value?(a.push({val:F.value,from:R}),v++):N&&(a.push({err:N,from:R}),v++),v>=E&&(z.pathComplete=!0),z}return A}let p=new qEt(r,n,h);try{await OEt(p.run(l),o.timeout)}catch(g){if(a.length===0)throw g}finally{p.stop()}return a}}}});var E6e=y((kjt,_6e)=>{f();"use strict";var w6e=class{constructor(){this.list=[]}push(e){return this.has(e.id)?!1:(this.list.push(e),!0)}has(e){let t=this.list.find(i=>i.id.equals(e));return Boolean(t)}toArray(){return this.list.slice()}pop(){return this.list.pop()}get length(){return this.list.length}};_6e.exports=w6e});var A6e=y((qjt,x6e)=>{f();"use strict";var DEt=E6e(),S6e=class extends DEt{constructor(e){super();this.limit=e}push(e){return this.length<this.limit?super.push(e):!1}};x6e.exports=S6e});var O6e=y((Njt,P6e)=>{f();"use strict";var BEt=ae(),I6e=Jd(),T6e=of(),R6e=A6e(),Dx=Ac(),MEt=Nx(),C6e=ui();P6e.exports=r=>{let e=async(t,i)=>{let n=new Dx(Dx.TYPES.GET_PROVIDERS,i.bytes,0);return r.network.sendRequest(t,n)};return{async provide(t){r._log(`provide: ${t}`);let i=[];await r.providers.addProvider(t,r.peerId);let n=r.libp2p?r.libp2p.multiaddrs:[],s=new Dx(Dx.TYPES.ADD_PROVIDER,t.bytes,0);s.providerPeers=[{id:r.peerId,multiaddrs:n}];async function o(a){r._log(`putProvider ${t} to ${a.toB58String()}`);try{await r.network.sendMessage(a,s)}catch(c){i.push(c)}}if(await C6e.mapParallel(r.getClosestPeers(t.bytes),o),i.length)throw BEt(new Error(`Failed to provide to ${i.length} of ${r.kBucketSize} peers`),"ERR_SOME_PROVIDES_FAILED",{errors:i})},async*findProviders(t,i={timeout:6e4,maxNumProviders:5}){let n=i.timeout||T6e.minute,s=i.maxNumProviders||T6e.K;r._log(`findProviders ${t}`);let o=new R6e(s);if((await r.providers.getProviders(t)).forEach(h=>{let p=r.peerStore.get(h);p?o.push({id:p.id,multiaddrs:p.addresses.map(g=>g.multiaddr)}):o.push({id:h,multiaddrs:[]})}),o.length>=s){for(let h of o.toArray())yield h;return}let c=[];function u(h,p){let g=C6e.pathSize(s-o.length,p),b=new R6e(g);c.push(b);async function E(v){let A=await e(v,t),R=A.providerPeers;return r._log(`Found ${R.length} provider entries for ${t}`),R.forEach(F=>{b.push({...F})}),b.length>=g?{pathComplete:!0}:{closerPeers:A.closerPeers}}return E}let l=new MEt(r,t.bytes,u),d=r.routingTable.closestPeers(t.bytes,r.kBucketSize);try{await I6e(l.run(d),n)}catch(h){if(h.name!==I6e.TimeoutError.name)throw h}finally{l.stop()}c.forEach(h=>{h.toArray().forEach(p=>{o.push(p)})});for(let h of o.toArray())yield h}}}});var N6e=y((Djt,q6e)=>{f();"use strict";var F1=ae(),LEt=Jd(),Eq=rt(),UEt=za(),{toString:FEt}=(tt(),et),KEt=of(),Bx=Ac(),k6e=Nx(),K1=ui();q6e.exports=r=>{let e=async s=>{r._log(`findPeerLocal ${s.toB58String()}`);let o=await r.routingTable.find(s),a=o&&r.peerStore.get(o);if(a)return{id:a.id,multiaddrs:a.addresses.map(c=>c.multiaddr)}},t=async(s,o)=>{let a=new Bx(Bx.TYPES.GET_VALUE,o,0);return r.network.sendRequest(s,a)},i=async(s,o)=>(r._log(`closerPeersSingle ${FEt(s,"base32")} from ${o.toB58String()}`),(await r.peerRouting._findPeerSingle(o,new Eq(s))).closerPeers.filter(c=>!r._isSelf(c.id)).map(c=>(r.peerStore.addressBook.add(c.id,c.multiaddrs),c))),n=async s=>{let o=K1.keyForPublicKey(s),a=await t(s,o);if(!a.record||!a.record.value)throw F1(new Error(`Node not responding with its public key: ${s.toB58String()}`),"ERR_INVALID_RECORD");let c=await Eq.createFromPubKey(a.record.value);if(!c.equals(s))throw F1(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");return c.pubKey};return{async _findPeerSingle(s,o){r._log("findPeerSingle %s",s.toB58String());let a=new Bx(Bx.TYPES.FIND_NODE,o.id,0);return r.network.sendRequest(s,a)},async findPeer(s,o={timeout:6e4}){o.timeout=o.timeout||KEt.minute,r._log("findPeer %s",s.toB58String());let a=await e(s);if(a!=null)return r._log("found local"),a;let c=await K1.convertPeerId(s),u=r.routingTable.closestPeers(c,r.kBucketSize);if(u.length===0)throw F1(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED");if(u.find(b=>b.isEqual(s))){let b=r.peerStore.get(s);if(b)return r._log("found in peerStore"),{id:b.id,multiaddrs:b.addresses.map(E=>E.multiaddr)}}let d=new k6e(r,s.id,()=>async E=>{let v=await this._findPeerSingle(E,s),A=v.closerPeers.find(R=>R.id.isEqual(s));return A?{peer:A,queryComplete:!0}:{closerPeers:v.closerPeers}}),h;try{h=await LEt(d.run(u),o.timeout)}finally{d.stop()}let p=!1;if(h.paths.forEach(b=>{b.success&&b.peer&&(p=!0,r.peerStore.addressBook.add(b.peer.id,b.peer.multiaddrs))}),r._log("findPeer %s: %s",s.toB58String(),p),!p)throw F1(new Error("No peer found"),"ERR_NOT_FOUND");let g=r.peerStore.get(s);if(!g)throw F1(new Error("No peer found in peer store"),"ERR_NOT_FOUND");return{id:g.id,multiaddrs:g.addresses.map(b=>b.multiaddr)}},async*getClosestPeers(s,o={shallow:!1}){r._log("getClosestPeers to %b",s);let a=await K1.convertBuffer(s),c=r.routingTable.closestPeers(a,r.kBucketSize),l=await new k6e(r,s,()=>async h=>({closerPeers:await i(s,h),pathComplete:o.shallow?!0:void 0})).run(c);if(!l||!l.finalSet)return[];let d=await K1.sortClosestPeers(Array.from(l.finalSet),a);for(let h of d.slice(0,r.kBucketSize))yield h},async getPublicKey(s){r._log("getPublicKey %s",s.toB58String());let o=r.peerStore.get(s);if(o&&o.id.pubKey)return r._log("getPublicKey: found local copy"),o.id.pubKey;let a;try{a=await n(s)}catch(l){let d=K1.keyForPublicKey(s),h=await r.get(d);a=UEt.keys.unmarshalPublicKey(h)}let c=new Eq(s.id,void 0,a),u=(o&&o.addresses||[]).map(l=>l.multiaddr);return r.peerStore.addressBook.add(c,u),r.peerStore.keyBook.set(c,a),a}}}});var F6e=y((Bjt,U6e)=>{f();"use strict";var jEt=ym(),D6e=ys(),VEt=rt(),{Key:zEt}=Ut(),{default:HEt}=vq(),j1=of(),V1=ui(),B6e=class{constructor(e,t,i){this.datastore=e,this._log=V1.logger(t,"providers"),this.cleanupInterval=j1.PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=j1.PROVIDERS_VALIDITY,this.lruCacheSize=i||j1.PROVIDERS_LRU_CACHE_SIZE,this.providers=jEt(this.lruCacheSize),this.syncQueue=new HEt({concurrency:1})}start(){this._cleaner=setInterval(()=>this._cleanup(),this.cleanupInterval)}stop(){this._cleaner&&(clearInterval(this._cleaner),this._cleaner=null)}_cleanup(){return this.syncQueue.add(async()=>{this._log("start cleanup");let e=Date.now(),t=0,i=0,n=new Map,s=this.datastore.batch(),o=this.datastore.query({prefix:j1.PROVIDERS_KEY_PREFIX});for await(let a of o)try{let{cid:c,peerId:u}=M6e(a.key),l=L6e(a.value),d=Date.now(),h=d-l,p=h>this.provideValidity;if(this._log("comparing: %d - %d = %d > %d %s",d,l,h,this.provideValidity,p?"(expired)":""),p){i++,s.delete(a.key);let g=n.get(c)||new Set;g.add(u),n.set(c,g)}t++}catch(c){this._log.error(c.message)}this._log("deleting %d / %d entries",i,t),n.size&&await s.commit();for(let[a,c]of n){let u=z1(a),l=this.providers.get(u);if(l){for(let d of c)l.delete(d);l.size===0?this.providers.remove(u):this.providers.set(u,l)}}this._log("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let t=z1(e),i=this.providers.get(t);return i||(i=await GEt(this.datastore,e),this.providers.set(t,i)),i}async addProvider(e,t){return this.syncQueue.add(async()=>{this._log("addProvider %s",e.toString());let i=await this._getProvidersMap(e);this._log("loaded %s provs",i.size);let n=new Date;i.set(V1.encodeBase32(t.id),n);let s=z1(e);return this.providers.set(s,i),$Et(this.datastore,e,t,n)})}async getProviders(e){return this.syncQueue.add(async()=>(this._log("getProviders %s",e.toString()),[...(await this._getProvidersMap(e)).keys()].map(i=>new VEt(V1.decodeBase32(i)))))}};function z1(r){return r=typeof r=="string"?r:V1.encodeBase32(r.bytes),j1.PROVIDERS_KEY_PREFIX+r}async function $Et(r,e,t,i){let n=[z1(e),"/",V1.encodeBase32(t.id)].join(""),s=new zEt(n),o=Uint8Array.from(D6e.encode(i.getTime()));return r.put(s,o)}function M6e(r){let e=r.toString().split("/");if(e.length!==4)throw new Error("incorrectly formatted provider entry key in datastore: "+r);return{cid:e[2],peerId:e[3]}}async function GEt(r,e){let t=new Map,i=r.query({prefix:z1(e)});for await(let n of i){let{peerId:s}=M6e(n.key);t.set(s,L6e(n.value))}return t}function L6e(r){return D6e.decode(r)}U6e.exports=B6e});var j6e=y((Mjt,K6e)=>{f();"use strict";var WEt=ZS();K6e.exports=async(r,e,{concurrency:t=1/0,stopOnError:i=!0}={})=>new Promise((n,s)=>{if(typeof e!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(t)||t===1/0)&&t>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`);let o=[],a=[],c=r[Symbol.iterator](),u=!1,l=!1,d=0,h=0,p=()=>{if(u)return;let g=c.next(),b=h;if(h++,g.done){l=!0,d===0&&(!i&&a.length!==0?s(new WEt(a)):n(o));return}d++,(async()=>{try{let E=await g.value;o[b]=await e(E,b),d--,p()}catch(E){i?(u=!0,s(E)):(a.push(E),d--,p())}})()};for(let g=0;g<t&&(p(),!l);g++);})});var z6e=y((Ljt,Sq)=>{f();"use strict";var YEt=j6e(),V6e=async(r,e,t)=>YEt(new Array(r).fill(),(i,n)=>e(n),t);Sq.exports=V6e;Sq.exports.default=V6e});var G6e=y((Ujt,$6e)=>{f();"use strict";var XEt=za(),{sha256:QEt}=(ri(),li),ZEt=rt(),{AbortController:JEt}=df(),eSt=ae(),tSt=z6e(),rSt=of(),{logger:iSt}=ui(),H6e=class{constructor(e,t){if(!e)throw new Error("Random Walk needs an instance of the Kademlia DHT");this._kadDHT=e,this._options={...rSt.defaultRandomWalk,...t},this.log=iSt(e.peerId,"random-walk"),this._timeoutId=void 0}start(){this._running||(this._running=!0,!(this._timeoutId||!this._options.enabled)&&(this._timeoutId=setTimeout(()=>{this._runPeriodically()},this._options.delay)))}stop(){this._running=!1,this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0),this._controller&&this._controller.abort()}async _runPeriodically(){for(;this._timeoutId;){try{await this._walk(this._options.queriesPerPeriod,this._options.timeout)}catch(e){this._kadDHT._log.error("random-walk:error",e)}if(!this._running)return;await new Promise(e=>{this._timeoutId=setTimeout(e,this._options.interval)})}}async _walk(e,t){this.log("start"),this._controller=new JEt;try{await tSt(e,async i=>{this.log("running query %d",i);try{let n=await this._randomPeerId();if(!this._controller)return;await this._query(n,{timeout:t,signal:this._controller.signal})}catch(n){if(n&&n.code!=="ETIMEDOUT")throw this.log.error("query %d finished with error",i,n),n}this.log("finished query %d",i)})}finally{this._controller=null,this.log("finished queries")}}async _query(e,t){this.log("query:%s",e.toB58String());let i;try{i=await this._kadDHT.findPeer(e,t)}catch(n){if(n&&n.code==="ERR_NOT_FOUND")return;throw n}throw this.log("query:found",i),eSt(new Error(`random-walk: ACTUALLY FOUND PEER: ${i}, ${e.toB58String()}`),"ERR_FOUND_RANDOM_PEER")}async _randomPeerId(){let e=await QEt.digest(XEt.randomBytes(16));return new ZEt(e.bytes)}};$6e.exports=H6e});var X6e=y((Fjt,Y6e)=>{f();"use strict";var W6e=class{constructor(){this.queries=new Set,this.running=!1}queryStarted(e){this.queries.add(e)}queryCompleted(e){this.queries.delete(e)}start(){this.running=!0}stop(){this.running=!1;for(let e of this.queries)e.stop();this.queries.clear()}};Y6e.exports=W6e});var J6e=y((Kjt,Iq)=>{f();"use strict";var{EventEmitter:nSt}=yr(),Mx=ae(),H1=Zf(),{MemoryDatastore:sSt}=Ut(),{equals:Q6e}=(di(),fi),{toString:xq}=(tt(),et),oSt=axe(),ky=ui(),$1=of(),aSt=Uxe(),cSt=v6e(),uSt=O6e(),lSt=N6e(),Lx=Ac(),fSt=F6e(),dSt=G6e(),hSt=X6e(),Aq=H1.Record,Z6e=class extends nSt{constructor({libp2p:e,dialer:t,peerId:i,peerStore:n,registrar:s,protocolPrefix:o="/ipfs",forceProtocolLegacy:a=!1,datastore:c=new sSt,kBucketSize:u=$1.K,clientMode:l=!1,concurrency:d=$1.ALPHA,validators:h={},selectors:p={},randomWalk:g={enabled:!1,queriesPerPeriod:1,interval:3e5,timeout:3e4,delay:1e4},onPut:b=()=>{},onRemove:E=()=>{}}){super();if(!t)throw new Error("libp2p-kad-dht requires an instance of Dialer");this.libp2p=e,this.dialer=t,this.peerId=i,this.peerStore=n,this.registrar=s,this.protocol=o+(a?"":$1.PROTOCOL_DHT),this.kBucketSize=u,this._clientMode=l,this.concurrency=d,this.disjointPaths=Math.ceil(this.kBucketSize/2),this.routingTable=new oSt(this.peerId,this.kBucketSize),this.datastore=c,this.providers=new fSt(this.datastore,this.peerId),this.validators={pk:H1.validator.validators.pk,...h},this.selectors={pk:H1.selection.selectors.pk,...p},this.network=new aSt(this),this._log=ky.logger(this.peerId),this.randomWalk=new dSt(this,g),this._queryManager=new hSt,this._running=!1,this.contentFetching=cSt(this),this.contentRouting=uSt(this),this.peerRouting=lSt(this),this.onPut=b,this.onRemove=E}get isStarted(){return this._running}start(){this._running||(this._running=!0,this.providers.start(),this._queryManager.start(),this.network.start(),this.randomWalk.start())}stop(){this._running=!1,this.randomWalk.stop(),this.network.stop(),this._queryManager.stop(),this.providers.stop()}async put(e,t,i={}){return this.contentFetching.put(e,t,i)}async get(e,t={}){return this.contentFetching.get(e,t)}async getMany(e,t,i={}){return this.contentFetching.getMany(e,t,i)}async removeLocal(e){this._log(`removeLocal: ${xq(e,"base32")}`);let t=ky.bufferToKey(e);try{await this.datastore.delete(t)}catch(i){if(i.code==="ERR_NOT_FOUND")return;throw i}}async _putLocal(e,t){this._log(`_putLocal: ${xq(e,"base32")}`);let i=ky.bufferToKey(e);await this.datastore.put(i,t)}async provide(e){return this.contentRouting.provide(e)}async*findProviders(e,t={timeout:6e3,maxNumProviders:5}){for await(let i of this.contentRouting.findProviders(e,t))yield i}async findPeer(e,t={timeout:6e4}){return this.peerRouting.findPeer(e,t)}async*getClosestPeers(e,t={shallow:!1}){yield*this.peerRouting.getClosestPeers(e,t)}getPublicKey(e){return this.peerRouting.getPublicKey(e)}_peerDiscovered(e,t){this.emit("peer",{id:e,multiaddrs:t})}async _nearestPeersToQuery(e){let t=await ky.convertBuffer(e.key);return this.routingTable.closestPeers(t,this.kBucketSize).map(n=>{let s=this.peerStore.get(n);return{id:n,multiaddrs:s?s.addresses.map(o=>o.multiaddr):[]}})}async _betterPeersToQuery(e,t){return this._log("betterPeersToQuery"),(await this._nearestPeersToQuery(e)).filter(n=>this._isSelf(n.id)?(this._log.error("trying to return self as closer"),!1):!n.id.isEqual(t))}async _checkLocalDatastore(e){this._log(`checkLocalDatastore: ${xq(e)} %b`,e);let t=ky.bufferToKey(e),i;try{i=await this.datastore.get(t)}catch(s){if(s.code==="ERR_NOT_FOUND")return;throw s}let n=Aq.deserialize(i);if(!n)throw Mx(new Error("Invalid record"),"ERR_INVALID_RECORD");if(n.timeReceived==null||ky.now()-n.timeReceived.getTime()>$1.MAX_RECORD_AGE){await this.datastore.delete(t),this.onRemove(n);return}return n}async _add(e){await this.routingTable.add(e)}async _verifyRecordLocally(e){this._log("verifyRecordLocally"),await H1.validator.verifyRecord(this.validators,e)}_isSelf(e){return e&&Q6e(this.peerId.id,e.id)}async _putValueToPeer(e,t,i){let n=new Lx(Lx.TYPES.PUT_VALUE,e,0);n.record=Aq.deserialize(t);let s=await this.network.sendRequest(i,n);if(s.record&&!Q6e(s.record.value,Aq.deserialize(t).value))throw Mx(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")}async _getValueOrPeers(e,t){let i=await this._getValueSingle(e,t),n=i.closerPeers,s=i.record;if(s){try{await this._verifyRecordOnline(s)}catch(o){let a="invalid record received, discarded";throw this._log(a),Mx(new Error(a),"ERR_INVALID_RECORD")}return{record:s,peers:n}}if(n.length>0)return{peers:n};throw Mx(new Error("Not found"),"ERR_NOT_FOUND")}async _getValueSingle(e,t){let i=new Lx(Lx.TYPES.GET_VALUE,t,0);return this.network.sendRequest(e,i)}async _verifyRecordOnline(e){await H1.validator.verifyRecord(this.validators,e)}};Iq.exports=Z6e;Iq.exports.multicodec="/ipfs"+$1.PROTOCOL_DHT});var rAe=y((jjt,tAe)=>{f();"use strict";var pSt=b2e(),ySt=uSe(),gSt=CSe(),{NOISE:mSt}=W3e(),bSt=J6e(),vSt=DC(),eAe=YT();tAe.exports=()=>({dialer:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4},modules:{transport:[pSt,ySt],streamMuxer:[gSt],connEncryption:[mSt],peerDiscovery:[],dht:bSt,pubsub:vSt},config:{peerDiscovery:{autoDial:!0,bootstrap:{enabled:!0},webRTCStar:{enabled:!0}},dht:{kBucketSize:20,enabled:!1,clientMode:!0,randomWalk:{enabled:!1},validators:{ipns:eAe.validator},selectors:{ipns:eAe.selector}},pubsub:{enabled:!0,emitSelf:!0},nat:{enabled:!1}},metrics:{enabled:!0},peerStore:{persistence:!0,threshold:1}})});var oAe=y((Tq,sAe)=>{f();"use strict";var wSt=rt(),{Multiaddr:_St}=it(),ESt=Bf(),{EventEmitter:SSt}=yr(),iAe=be(),Ux=Object.assign(iAe("libp2p:bootstrap"),{error:iAe("libp2p:bootstrap:error")}),nAe=class extends SSt{constructor(e={list:[]}){if(!e.list||!e.list.length)throw new Error("Bootstrap requires a list of peer addresses");super();this._list=e.list,this._interval=e.interval||1e4,this._timer=null}start(){this._timer||(this._timer=setInterval(()=>this._discoverBootstrapPeers(),this._interval),Ux("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){!this._timer||this._list.forEach(e=>{if(!ESt.P2P.matches(e))return Ux.error("Invalid multiaddr");let t=new _St(e),i=t.getPeerId();if(!i){Ux.error("Invalid bootstrap multiaddr without peer id");return}let n=wSt.createFromB58String(i);try{this.emit("peer",{id:n,multiaddrs:[t]})}catch(s){Ux.error("Invalid bootstrap peer id",s)}})}stop(){this._timer&&clearInterval(this._timer),this._timer=null}};Tq=sAe.exports=nAe;Tq.tag="bootstrap"});var Rq=y((Vjt,cAe)=>{f();"use strict";var Kt=Bm(),xSt=gr().bind({ignoreUndefined:!0}),ASt=ae(),aAe=sfe(),ISt=_fe(),TSt=Mfe(),{create:RSt}=mge(),{Multiaddr:CSt}=it(),PSt=z2().version;cAe.exports=({options:r={},peerId:e,multiaddrs:t=[],repo:i,keychainConfig:n={},config:s={}})=>{let{datastore:o,keys:a}=i,c=OSt({options:r,config:s,datastore:o,keys:a,keychainConfig:n,peerId:e,multiaddrs:t});return typeof r.libp2p=="function"?r.libp2p({libp2pOptions:c,options:r,config:s,datastore:o,peerId:e}):E_e().create(c)};function OSt({options:r,config:e,datastore:t,keys:i,keychainConfig:n,peerId:s,multiaddrs:o}){let a=()=>{let b=Kt(e,"Pubsub.Router")||"gossipsub";if(!aAe[b])throw ASt(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${b} router.`),"ERR_NOT_SUPPORTED");return aAe[b]},c={datastore:t,peerId:s,modules:{}},u={modules:{pubsub:a(),contentRouting:[],peerRouting:[]},config:{peerDiscovery:{mdns:{enabled:Kt(r,"config.Discovery.MDNS.Enabled",Kt(e,"Discovery.MDNS.Enabled",!0))},webRTCStar:{enabled:Kt(r,"config.Discovery.webRTCStar.Enabled",Kt(e,"Discovery.webRTCStar.Enabled",!0))},bootstrap:{list:Kt(r,"config.Bootstrap",Kt(e,"Bootstrap",[]))}},relay:{enabled:Kt(r,"relay.enabled",Kt(e,"relay.enabled",!0)),hop:{enabled:Kt(r,"relay.hop.enabled",Kt(e,"relay.hop.enabled",!1)),active:Kt(r,"relay.hop.active",Kt(e,"relay.hop.active",!1))}},dht:{enabled:Kt(e,"Routing.Type","none")!=="none",clientMode:Kt(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:Kt(r,"dht.kBucketSize",20)},pubsub:{enabled:Kt(r,"config.Pubsub.Enabled",Kt(e,"Pubsub.Enabled",!0))},nat:{enabled:!Kt(e,"Swarm.DisableNatPortMap",!1)}},addresses:{listen:o.map(b=>b.toString()),announce:Kt(r,"addresses.announce",Kt(e,"Addresses.Announce",[])),noAnnounce:Kt(r,"addresses.noAnnounce",Kt(e,"Addresses.NoAnnounce",[]))},connectionManager:Kt(r,"connectionManager",{maxConnections:Kt(r,"config.Swarm.ConnMgr.HighWater",Kt(e,"Swarm.ConnMgr.HighWater")),minConnections:Kt(r,"config.Swarm.ConnMgr.LowWater",Kt(e,"Swarm.ConnMgr.LowWater"))}),keychain:{datastore:i,...n},host:{agentVersion:`js-ipfs/${PSt}`}},l=rAe(),d=Kt(r,"libp2p",void 0);typeof d=="function"&&(d=void 0);let h=xSt(c,l(),u,d);Kt(h,"config.peerDiscovery.bootstrap.list",[]).length>0&&h.modules.peerDiscovery.push(oAe());let g=Kt(r,"config.Addresses.Delegates",Kt(e,"Addresses.Delegates",[]));if(g.length>0){let b=g[Math.floor(Math.random()*g.length)],E=new CSt(b).toOptions(),v={host:E.host,protocol:parseInt(E.port)===443?"https":"http",port:E.port},A=RSt(v);u.modules.contentRouting=u.modules.contentRouting||[],u.modules.contentRouting.push(new TSt(s,A)),u.modules.peerRouting=u.modules.peerRouting||[],u.modules.peerRouting.push(new ISt(A))}return h}});var pAe=y((zjt,hAe)=>{f();"use strict";var G1=be()("ipfs:components:peer:storage"),kSt=lue(),qSt=n2(),{ERR_REPO_NOT_INITIALIZED:NSt}=$f().errors,{fromString:DSt}=(ft(),ht),{toString:BSt}=(tt(),et),Cq=rt(),uAe=gr().bind({ignoreUndefined:!0}),MSt=mR(),{NotEnabledError:LSt,NotInitializedError:USt}=ul(),lAe=Rq(),Fx=class{constructor(e,t,i,n,s){this.print=n,this.peerId=e,this.keychain=t,this.repo=i,this.print=n,this.isNew=s}static async start(e,t,i){let{repoAutoMigrate:n,repo:s,onMigrationProgress:o}=i,a=typeof s=="string"||s==null?kSt(e,t,{path:s,autoMigrate:n,onMigrationProgress:o}):s,{peerId:c,keychain:u,isNew:l}=await FSt(e,a,i);return new Fx(c,u,a,e,l)}};hAe.exports=Fx;var FSt=async(r,e,t)=>{if(!e.closed)return{...await fAe(e,t),isNew:!1};try{return await e.open(),{...await fAe(e,t),isNew:!1}}catch(i){if(i.code!==NSt)throw i;if(t.init&&t.init.allowNew===!1)throw new LSt("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await KSt(r,e,t),isNew:!0}}},KSt=async(r,e,t)=>{let i=t.init||{},n=await e.exists();if(G1("repo exists?",n),n===!0)throw new Error("repo already exists");let s=i.privateKey?await jSt(i.privateKey):await VSt(r,i),o=zSt(s);G1("peer identity: %s",o.PeerID);let a={...uAe(dAe(qSt(),i.profiles),t.config),Identity:o};await e.init(a),await e.open(),G1("repo opened");let c={pass:t.pass};try{c.dek=await e.config.get("Keychain.DEK")}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}let u=await lAe({options:void 0,multiaddrs:void 0,peerId:s,repo:e,config:a,keychainConfig:c});return u.keychain&&u.keychain.opts&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.opts.dek})),{peerId:s,keychain:u.keychain}},jSt=r=>(G1("using user-supplied private-key"),typeof r=="object"?r:Cq.createFromPrivKey(DSt(r,"base64pad"))),VSt=(r,{algorithm:e="Ed25519",bits:t=2048})=>(r("generating %s keypair...",e),Cq.create({keyType:e,bits:t})),zSt=r=>({PeerID:r.toB58String(),PrivKey:BSt(r.privKey.bytes,"base64pad")}),fAe=async(r,e)=>{let t=e.config,i=e.init&&e.init.profiles||[],n=e.pass,s=await r.config.getAll(),o=HSt(dAe(s,i),t);if(s!==o&&await r.config.replace(o),!o.Identity||!o.Identity.PrivKey)throw new USt("No private key was found in the config, please intialize the repo");let a=await Cq.createFromPrivKey(o.Identity.PrivKey),c=await lAe({options:void 0,multiaddrs:void 0,peerId:a,repo:r,config:o,keychainConfig:{pass:n,...o.Keychain}});return c.keychain&&await c.loadKeychain(),{peerId:a,keychain:c.keychain}},HSt=(r,e)=>e?uAe(r,e):r,dAe=(r,e)=>(e||[]).reduce((t,i)=>{let n=MSt.profiles[i];if(!n)throw new Error(`Could not find profile with name '${i}'`);return G1("applying profile %s",i),n.transform(t)},r)});var bAe=y((Hjt,mAe)=>{f();mAe.exports=gAe;var yAe=128,$St=127,GSt=~$St,WSt=Math.pow(2,31);function gAe(r,e,t){e=e||[],t=t||0;for(var i=t;r>=WSt;)e[t++]=r&255|yAe,r/=128;for(;r&GSt;)e[t++]=r&255|yAe,r>>>=7;return e[t]=r|0,gAe.bytes=t-i+1,e}});var _Ae=y(($jt,wAe)=>{f();wAe.exports=Pq;var YSt=128,vAe=127;function Pq(r,e){var t=0,e=e||0,i=0,n=e,s,o=r.length;do{if(n>=o)throw Pq.bytes=0,new RangeError("Could not decode varint");s=r[n++],t+=i<28?(s&vAe)<<i:(s&vAe)*Math.pow(2,i),i+=7}while(s>=YSt);return Pq.bytes=n-e,t}});var SAe=y((Gjt,EAe)=>{f();var XSt=Math.pow(2,7),QSt=Math.pow(2,14),ZSt=Math.pow(2,21),JSt=Math.pow(2,28),e3t=Math.pow(2,35),t3t=Math.pow(2,42),r3t=Math.pow(2,49),i3t=Math.pow(2,56),n3t=Math.pow(2,63);EAe.exports=function(r){return r<XSt?1:r<QSt?2:r<ZSt?3:r<JSt?4:r<e3t?5:r<t3t?6:r<r3t?7:r<i3t?8:r<n3t?9:10}});var AAe=y((Wjt,xAe)=>{f();xAe.exports={encode:bAe(),decode:_Ae(),encodingLength:SAe()}});var RAe=y((Yjt,TAe)=>{f();"use strict";var IAe=AAe();TAe.exports=r=>{if(!(r instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;r.length>0;){let t=IAe.decode(r);e.push(t),r=r.slice(IAe.decode.bytes)}return e}});var OAe=y((Xjt,PAe)=>{f();"use strict";var{base58btc:s3t}=(ei(),Jr),CAe=class{constructor(e,t,i){this._refCounter=1,this.cid=e,this.priority=t||1,this.wantType=i}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(s3t)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};PAe.exports=CAe});var W1=y((Qjt,qAe)=>{f();"use strict";var kAe=OAe(),{base58btc:Kx}=(ei(),Jr),o3t=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),Oq=class{constructor(e){this.set=new Map,this._stats=e}get length(){return this.set.size}add(e,t,i){let n=qy(),s=e.toString(Kx),o=this.set.get(s);o?(o.inc(),o.priority=t,o.wantType===n.WantType.Have&&i===n.WantType.Block&&(o.wantType=i)):(this.set.set(s,new kAe(e,t,i)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let t=e.toString(Kx),i=this.set.get(t);!i||(i.dec(),!i.hasRefs()&&(this.set.delete(t),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(o3t(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let t=e.toString(Kx);return this.set.has(t)}get(e){let t=e.toString(Kx);return this.set.get(t)}};Oq.Entry=kAe;qAe.exports=Oq});var kq=y((Jjt,NAe)=>{f();"use strict";var a3t=W1().Entry,{base58btc:c3t}=(ei(),Jr);NAe.exports=class{constructor(e,t,i,n,s){this.entry=new a3t(e,t,i),this.cancel=Boolean(n),this.sendDontHave=Boolean(s)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(c3t)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}}});var cf=y((eVt,MAe)=>{f();"use strict";var DAe=be(),{equals:u3t}=(di(),fi),BAe=kq(),l3t=(r,e)=>{let t=["bitswap"];return e&&t.push(e),r&&t.push(`${r.toB58String().slice(0,8)}`),Object.assign(DAe(t.join(":")),{error:DAe(t.concat(["error"]).join(":"))})},qq=(r,e,t)=>{let i=0,n=t.length;for(;i<n;){if(r(e,t[i]))return!0;i+=1}return!1},f3t=(r,e)=>{let t=0,i=e.length,n=[],s;for(;t<i;)s=e[t],qq(r,s,n)||(n[n.length]=s),t+=1;return n},d3t=(r,e)=>e.reduce((t,i)=>{let n=r(i);return t[n]?t[n].push(i):t[n]=[i],t},{}),h3t=(r,e,t)=>e.filter(i=>!qq(r,i,t)),p3t=(r,e)=>Array.prototype.slice.call(e,0).sort((t,i)=>{let n=r(t),s=r(i);return n<s?-1:n>s?1:0}),y3t=(r,e)=>{if(r.size!==e.size)return!1;for(let[t,i]of r){let n=e.get(t);if(n===void 0||i instanceof Uint8Array&&n instanceof Uint8Array&&!u3t(i,n)||i instanceof BAe&&n instanceof BAe&&!i.equals(n))return!1}return!0};MAe.exports={logger:l3t,includesWith:qq,uniqWith:f3t,groupBy:d3t,pullAllWith:h3t,sortBy:p3t,isMapEqual:y3t}});var UAe=y((tVt,LAe)=>{f();"use strict";var Ic=ki(),Tc=Ic.Reader,Y1=Ic.Writer,jt=Ic.util,Rt=Ic.roots["ipfs-bitswap"]||(Ic.roots["ipfs-bitswap"]={});Rt.Message=function(){function r(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var t=Object.keys(e),i=0;i<t.length;++i)e[t[i]]!=null&&(this[t[i]]=e[t[i]])}return r.prototype.wantlist=null,r.prototype.blocks=jt.emptyArray,r.prototype.payload=jt.emptyArray,r.prototype.blockPresences=jt.emptyArray,r.prototype.pendingBytes=0,r.encode=function(t,i){if(i||(i=Y1.create()),t.wantlist!=null&&Object.hasOwnProperty.call(t,"wantlist")&&Rt.Message.Wantlist.encode(t.wantlist,i.uint32(10).fork()).ldelim(),t.blocks!=null&&t.blocks.length)for(var n=0;n<t.blocks.length;++n)i.uint32(18).bytes(t.blocks[n]);if(t.payload!=null&&t.payload.length)for(var n=0;n<t.payload.length;++n)Rt.Message.Block.encode(t.payload[n],i.uint32(26).fork()).ldelim();if(t.blockPresences!=null&&t.blockPresences.length)for(var n=0;n<t.blockPresences.length;++n)Rt.Message.BlockPresence.encode(t.blockPresences[n],i.uint32(34).fork()).ldelim();return t.pendingBytes!=null&&Object.hasOwnProperty.call(t,"pendingBytes")&&i.uint32(40).int32(t.pendingBytes),i},r.decode=function(t,i){t instanceof Tc||(t=Tc.create(t));for(var n=i===void 0?t.len:t.pos+i,s=new Rt.Message;t.pos<n;){var o=t.uint32();switch(o>>>3){case 1:s.wantlist=Rt.Message.Wantlist.decode(t,t.uint32());break;case 2:s.blocks&&s.blocks.length||(s.blocks=[]),s.blocks.push(t.bytes());break;case 3:s.payload&&s.payload.length||(s.payload=[]),s.payload.push(Rt.Message.Block.decode(t,t.uint32()));break;case 4:s.blockPresences&&s.blockPresences.length||(s.blockPresences=[]),s.blockPresences.push(Rt.Message.BlockPresence.decode(t,t.uint32()));break;case 5:s.pendingBytes=t.int32();break;default:t.skipType(o&7);break}}return s},r.fromObject=function(t){if(t instanceof Rt.Message)return t;var i=new Rt.Message;if(t.wantlist!=null){if(typeof t.wantlist!="object")throw TypeError(".Message.wantlist: object expected");i.wantlist=Rt.Message.Wantlist.fromObject(t.wantlist)}if(t.blocks){if(!Array.isArray(t.blocks))throw TypeError(".Message.blocks: array expected");i.blocks=[];for(var n=0;n<t.blocks.length;++n)typeof t.blocks[n]=="string"?jt.base64.decode(t.blocks[n],i.blocks[n]=jt.newBuffer(jt.base64.length(t.blocks[n])),0):t.blocks[n].length&&(i.blocks[n]=t.blocks[n])}if(t.payload){if(!Array.isArray(t.payload))throw TypeError(".Message.payload: array expected");i.payload=[];for(var n=0;n<t.payload.length;++n){if(typeof t.payload[n]!="object")throw TypeError(".Message.payload: object expected");i.payload[n]=Rt.Message.Block.fromObject(t.payload[n])}}if(t.blockPresences){if(!Array.isArray(t.blockPresences))throw TypeError(".Message.blockPresences: array expected");i.blockPresences=[];for(var n=0;n<t.blockPresences.length;++n){if(typeof t.blockPresences[n]!="object")throw TypeError(".Message.blockPresences: object expected");i.blockPresences[n]=Rt.Message.BlockPresence.fromObject(t.blockPresences[n])}}return t.pendingBytes!=null&&(i.pendingBytes=t.pendingBytes|0),i},r.toObject=function(t,i){i||(i={});var n={};if((i.arrays||i.defaults)&&(n.blocks=[],n.payload=[],n.blockPresences=[]),i.defaults&&(n.wantlist=null,n.pendingBytes=0),t.wantlist!=null&&t.hasOwnProperty("wantlist")&&(n.wantlist=Rt.Message.Wantlist.toObject(t.wantlist,i)),t.blocks&&t.blocks.length){n.blocks=[];for(var s=0;s<t.blocks.length;++s)n.blocks[s]=i.bytes===String?jt.base64.encode(t.blocks[s],0,t.blocks[s].length):i.bytes===Array?Array.prototype.slice.call(t.blocks[s]):t.blocks[s]}if(t.payload&&t.payload.length){n.payload=[];for(var s=0;s<t.payload.length;++s)n.payload[s]=Rt.Message.Block.toObject(t.payload[s],i)}if(t.blockPresences&&t.blockPresences.length){n.blockPresences=[];for(var s=0;s<t.blockPresences.length;++s)n.blockPresences[s]=Rt.Message.BlockPresence.toObject(t.blockPresences[s],i)}return t.pendingBytes!=null&&t.hasOwnProperty("pendingBytes")&&(n.pendingBytes=t.pendingBytes),n},r.prototype.toJSON=function(){return this.constructor.toObject(this,Ic.util.toJSONOptions)},r.Wantlist=function(){function e(t){if(this.entries=[],t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.entries=jt.emptyArray,e.prototype.full=!1,e.encode=function(i,n){if(n||(n=Y1.create()),i.entries!=null&&i.entries.length)for(var s=0;s<i.entries.length;++s)Rt.Message.Wantlist.Entry.encode(i.entries[s],n.uint32(10).fork()).ldelim();return i.full!=null&&Object.hasOwnProperty.call(i,"full")&&n.uint32(16).bool(i.full),n},e.decode=function(i,n){i instanceof Tc||(i=Tc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.Wantlist;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.entries&&o.entries.length||(o.entries=[]),o.entries.push(Rt.Message.Wantlist.Entry.decode(i,i.uint32()));break;case 2:o.full=i.bool();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.Wantlist)return i;var n=new Rt.Message.Wantlist;if(i.entries){if(!Array.isArray(i.entries))throw TypeError(".Message.Wantlist.entries: array expected");n.entries=[];for(var s=0;s<i.entries.length;++s){if(typeof i.entries[s]!="object")throw TypeError(".Message.Wantlist.entries: object expected");n.entries[s]=Rt.Message.Wantlist.Entry.fromObject(i.entries[s])}}return i.full!=null&&(n.full=Boolean(i.full)),n},e.toObject=function(i,n){n||(n={});var s={};if((n.arrays||n.defaults)&&(s.entries=[]),n.defaults&&(s.full=!1),i.entries&&i.entries.length){s.entries=[];for(var o=0;o<i.entries.length;++o)s.entries[o]=Rt.Message.Wantlist.Entry.toObject(i.entries[o],n)}return i.full!=null&&i.hasOwnProperty("full")&&(s.full=i.full),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ic.util.toJSONOptions)},e.WantType=function(){var t={},i=Object.create(t);return i[t[0]="Block"]=0,i[t[1]="Have"]=1,i}(),e.Entry=function(){function t(i){if(i)for(var n=Object.keys(i),s=0;s<n.length;++s)i[n[s]]!=null&&(this[n[s]]=i[n[s]])}return t.prototype.block=jt.newBuffer([]),t.prototype.priority=0,t.prototype.cancel=!1,t.prototype.wantType=0,t.prototype.sendDontHave=!1,t.encode=function(n,s){return s||(s=Y1.create()),n.block!=null&&Object.hasOwnProperty.call(n,"block")&&s.uint32(10).bytes(n.block),n.priority!=null&&Object.hasOwnProperty.call(n,"priority")&&s.uint32(16).int32(n.priority),n.cancel!=null&&Object.hasOwnProperty.call(n,"cancel")&&s.uint32(24).bool(n.cancel),n.wantType!=null&&Object.hasOwnProperty.call(n,"wantType")&&s.uint32(32).int32(n.wantType),n.sendDontHave!=null&&Object.hasOwnProperty.call(n,"sendDontHave")&&s.uint32(40).bool(n.sendDontHave),s},t.decode=function(n,s){n instanceof Tc||(n=Tc.create(n));for(var o=s===void 0?n.len:n.pos+s,a=new Rt.Message.Wantlist.Entry;n.pos<o;){var c=n.uint32();switch(c>>>3){case 1:a.block=n.bytes();break;case 2:a.priority=n.int32();break;case 3:a.cancel=n.bool();break;case 4:a.wantType=n.int32();break;case 5:a.sendDontHave=n.bool();break;default:n.skipType(c&7);break}}return a},t.fromObject=function(n){if(n instanceof Rt.Message.Wantlist.Entry)return n;var s=new Rt.Message.Wantlist.Entry;switch(n.block!=null&&(typeof n.block=="string"?jt.base64.decode(n.block,s.block=jt.newBuffer(jt.base64.length(n.block)),0):n.block.length&&(s.block=n.block)),n.priority!=null&&(s.priority=n.priority|0),n.cancel!=null&&(s.cancel=Boolean(n.cancel)),n.wantType){case"Block":case 0:s.wantType=0;break;case"Have":case 1:s.wantType=1;break}return n.sendDontHave!=null&&(s.sendDontHave=Boolean(n.sendDontHave)),s},t.toObject=function(n,s){s||(s={});var o={};return s.defaults&&(s.bytes===String?o.block="":(o.block=[],s.bytes!==Array&&(o.block=jt.newBuffer(o.block))),o.priority=0,o.cancel=!1,o.wantType=s.enums===String?"Block":0,o.sendDontHave=!1),n.block!=null&&n.hasOwnProperty("block")&&(o.block=s.bytes===String?jt.base64.encode(n.block,0,n.block.length):s.bytes===Array?Array.prototype.slice.call(n.block):n.block),n.priority!=null&&n.hasOwnProperty("priority")&&(o.priority=n.priority),n.cancel!=null&&n.hasOwnProperty("cancel")&&(o.cancel=n.cancel),n.wantType!=null&&n.hasOwnProperty("wantType")&&(o.wantType=s.enums===String?Rt.Message.Wantlist.WantType[n.wantType]:n.wantType),n.sendDontHave!=null&&n.hasOwnProperty("sendDontHave")&&(o.sendDontHave=n.sendDontHave),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,Ic.util.toJSONOptions)},t}(),e}(),r.Block=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.prefix=jt.newBuffer([]),e.prototype.data=jt.newBuffer([]),e.encode=function(i,n){return n||(n=Y1.create()),i.prefix!=null&&Object.hasOwnProperty.call(i,"prefix")&&n.uint32(10).bytes(i.prefix),i.data!=null&&Object.hasOwnProperty.call(i,"data")&&n.uint32(18).bytes(i.data),n},e.decode=function(i,n){i instanceof Tc||(i=Tc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.Block;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.prefix=i.bytes();break;case 2:o.data=i.bytes();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.Block)return i;var n=new Rt.Message.Block;return i.prefix!=null&&(typeof i.prefix=="string"?jt.base64.decode(i.prefix,n.prefix=jt.newBuffer(jt.base64.length(i.prefix)),0):i.prefix.length&&(n.prefix=i.prefix)),i.data!=null&&(typeof i.data=="string"?jt.base64.decode(i.data,n.data=jt.newBuffer(jt.base64.length(i.data)),0):i.data.length&&(n.data=i.data)),n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.prefix="":(s.prefix=[],n.bytes!==Array&&(s.prefix=jt.newBuffer(s.prefix))),n.bytes===String?s.data="":(s.data=[],n.bytes!==Array&&(s.data=jt.newBuffer(s.data)))),i.prefix!=null&&i.hasOwnProperty("prefix")&&(s.prefix=n.bytes===String?jt.base64.encode(i.prefix,0,i.prefix.length):n.bytes===Array?Array.prototype.slice.call(i.prefix):i.prefix),i.data!=null&&i.hasOwnProperty("data")&&(s.data=n.bytes===String?jt.base64.encode(i.data,0,i.data.length):n.bytes===Array?Array.prototype.slice.call(i.data):i.data),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ic.util.toJSONOptions)},e}(),r.BlockPresenceType=function(){var e={},t=Object.create(e);return t[e[0]="Have"]=0,t[e[1]="DontHave"]=1,t}(),r.BlockPresence=function(){function e(t){if(t)for(var i=Object.keys(t),n=0;n<i.length;++n)t[i[n]]!=null&&(this[i[n]]=t[i[n]])}return e.prototype.cid=jt.newBuffer([]),e.prototype.type=0,e.encode=function(i,n){return n||(n=Y1.create()),i.cid!=null&&Object.hasOwnProperty.call(i,"cid")&&n.uint32(10).bytes(i.cid),i.type!=null&&Object.hasOwnProperty.call(i,"type")&&n.uint32(16).int32(i.type),n},e.decode=function(i,n){i instanceof Tc||(i=Tc.create(i));for(var s=n===void 0?i.len:i.pos+n,o=new Rt.Message.BlockPresence;i.pos<s;){var a=i.uint32();switch(a>>>3){case 1:o.cid=i.bytes();break;case 2:o.type=i.int32();break;default:i.skipType(a&7);break}}return o},e.fromObject=function(i){if(i instanceof Rt.Message.BlockPresence)return i;var n=new Rt.Message.BlockPresence;switch(i.cid!=null&&(typeof i.cid=="string"?jt.base64.decode(i.cid,n.cid=jt.newBuffer(jt.base64.length(i.cid)),0):i.cid.length&&(n.cid=i.cid)),i.type){case"Have":case 0:n.type=0;break;case"DontHave":case 1:n.type=1;break}return n},e.toObject=function(i,n){n||(n={});var s={};return n.defaults&&(n.bytes===String?s.cid="":(s.cid=[],n.bytes!==Array&&(s.cid=jt.newBuffer(s.cid))),s.type=n.enums===String?"Have":0),i.cid!=null&&i.hasOwnProperty("cid")&&(s.cid=n.bytes===String?jt.base64.encode(i.cid,0,i.cid.length):n.bytes===Array?Array.prototype.slice.call(i.cid):i.cid),i.type!=null&&i.hasOwnProperty("type")&&(s.type=n.enums===String?Rt.Message.BlockPresenceType[i.type]:i.type),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,Ic.util.toJSONOptions)},e}(),r}();LAe.exports=Rt});var qy=y((rVt,KAe)=>{f();"use strict";var{CID:Ny}=(jc(),Rh),{sha256:Nq}=(ri(),li),{base58btc:X1}=(ei(),Jr),g3t=RAe(),{isMapEqual:Dq}=cf(),{Message:qu}=UAe(),FAe=kq(),{concat:m3t}=(cn(),an),b3t=ae(),In=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,t,i,n,s){i==null&&(i=In.WantType.Block);let o=e.toString(X1),a=this.wantlist.get(o);a?(a.wantType===i&&(a.priority=t),n&&(a.cancel=Boolean(n)),s&&(a.sendDontHave=Boolean(s)),i===In.WantType.Block&&a.wantType===In.WantType.Have&&(a.wantType=i)):this.wantlist.set(o,new FAe(e,t,i,n,s))}addBlock(e,t){let i=e.toString(X1);this.blocks.set(i,t)}addHave(e){let t=e.toString(X1);this.blockPresences.has(t)||this.blockPresences.set(t,In.BlockPresenceType.Have)}addDontHave(e){let t=e.toString(X1);this.blockPresences.has(t)||this.blockPresences.set(t,In.BlockPresenceType.DontHave)}cancel(e){let t=e.toString(X1);this.wantlist.delete(t),this.addEntry(e,0,In.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),cancel:Boolean(t.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return qu.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(t=>({block:t.cid.bytes,priority:Number(t.priority),wantType:t.wantType,cancel:Boolean(t.cancel),sendDontHave:Boolean(t.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[t,i]of this.blocks.entries()){let n=Ny.parse(t),s=Uint8Array.from([n.code]),o=n.multihash.bytes.subarray(0,2),a=m3t([[n.version],s,o],1+s.byteLength+o.byteLength);e.payload.push(new qu.Block({prefix:a,data:i}))}for(let[t,i]of this.blockPresences)e.blockPresences.push(new qu.BlockPresence({cid:Ny.parse(t).bytes,type:i}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),qu.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!Dq(this.wantlist,e.wantlist)||!Dq(this.blocks,e.blocks)||!Dq(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),t=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${t}>`}};In.deserialize=async(r,e={})=>{let t=qu.decode(r),i=t.wantlist&&t.wantlist.full||!1,n=new In(i);return t.wantlist&&t.wantlist.entries&&t.wantlist.entries.forEach(s=>{if(!s.block)return;let o=Ny.decode(s.block);n.addEntry(o,s.priority||0,s.wantType,Boolean(s.cancel),Boolean(s.sendDontHave))}),t.blockPresences&&t.blockPresences.forEach(s=>{if(!s.cid)return;let o=Ny.decode(s.cid);s.type===In.BlockPresenceType.Have?n.addHave(o):n.addDontHave(o)}),t.blocks.length>0?(await Promise.all(t.blocks.map(async s=>{let o=await Nq.digest(s),a=Ny.createV0(o);n.addBlock(a,s)})),n):(t.payload.length>0&&(await Promise.all(t.payload.map(async s=>{if(!s.prefix||!s.data)return;let o=g3t(s.prefix),a=o[0],c=o[1],u=o[2],l=u===Nq.code?Nq:e[u];if(!l)throw b3t(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let d=await l.digest(s.data),h=Ny.create(a,c,d);n.addBlock(h,s.data)})),n.setPendingBytes(t.pendingBytes)),n)};In.blockPresenceSize=r=>r.bytes.length+1;In.Entry=FAe;In.WantType={Block:qu.Wantlist.WantType.Block,Have:qu.Wantlist.WantType.Have};In.BlockPresenceType={Have:qu.BlockPresenceType.Have,DontHave:qu.BlockPresenceType.DontHave};KAe.exports=In});var Q1=y((iVt,jAe)=>{f();"use strict";var Bq=1e3;jAe.exports={maxProvidersPerRequest:3,providerRequestTimeout:10*Bq,hasBlockTimeout:15*Bq,provideTimeout:15*Bq,kMaxPriority:Math.pow(2,31)-1,maxListeners:1e3,wantlistSendDebounceMs:1}});var zAe=y((nVt,VAe)=>{f();VAe.exports=v3t;function v3t(r,e,t){var i=null,n=null,s=function(){i&&(clearTimeout(i),n=null,i=null)},o=function(){var c=n;s(),c&&c()},a=function(){if(!e)return r.apply(this,arguments);var c=this,u=arguments,l=t&&!i;if(s(),n=function(){r.apply(c,u)},i=setTimeout(function(){if(i=null,!l){var d=n;return n=null,d()}},e),l)return n()};return a.cancel=s,a.flush=o,a}});var $Ae=y((oVt,HAe)=>{f();"use strict";var w3t=zAe(),_3t=qy(),E3t=cf().logger,{wantlistSendDebounceMs:S3t}=Q1();HAe.exports=class{constructor(e,t,i){this.peerId=t,this.network=i,this.refcnt=1,this._entries=[],this._log=E3t(e,"msgqueue"),this.sendEntries=w3t(this._sendEntries.bind(this),S3t)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new _3t(!1);this._entries.forEach(t=>{t.cancel?e.cancel(t.cid):e.addEntry(t.cid,t.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(t){this._log.error("cant connect to peer %s: %s",this.peerId.toB58String(),t.message);return}this._log("sending message to peer %s",this.peerId.toB58String()),this.network.sendMessage(this.peerId,e).catch(t=>{this._log.error("send error: %s",t.message)})}}});var WAe=y((cVt,GAe)=>{f();"use strict";var Mq=qy(),x3t=W1(),A3t=Q1(),I3t=$Ae(),T3t=cf().logger,{base58btc:R3t}=(ei(),Jr);GAe.exports=class{constructor(e,t,i){this.peers=new Map,this.wantlist=new x3t(i),this.network=t,this._stats=i,this._peerId=e,this._log=T3t(e,"want")}_addEntries(e,t,i){let n=e.map((s,o)=>new Mq.Entry(s,A3t.kMaxPriority-o,Mq.WantType.Block,t));n.forEach(s=>{s.cancel?i?this.wantlist.removeForce(s.cid.toString(R3t)):this.wantlist.remove(s.cid):(this._log("adding to wl"),this.wantlist.add(s.cid,s.priority))});for(let s of this.peers.values())s.addEntries(n)}_startPeerHandler(e){let t=this.peers.get(e.toB58String());if(t){t.refcnt++;return}t=new I3t(this._peerId,e,this.network);let i=new Mq(!0);for(let n of this.wantlist.entries())i.addEntry(n[1].cid,n[1].priority);return t.addMessage(i),this.peers.set(e.toB58String(),t),t}_stopPeerHandler(e){let t=this.peers.get(e.toB58String());!t||(t.refcnt--,!(t.refcnt>0)&&this.peers.delete(e.toB58String()))}wantBlocks(e,t={}){this._addEntries(e,!1),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}}});var eIe=y((uVt,JAe)=>{f();"use strict";var YAe=ia(),{pipe:XAe}=Ar(),C3t=lS(),P3t=qy(),QAe=Q1(),O3t=cf().logger,Lq="/ipfs/bitswap/1.0.0",Uq="/ipfs/bitswap/1.1.0",Fq="/ipfs/bitswap/1.2.0",ZAe=class{constructor(e,t,i,n={}){this._log=O3t(e.peerId,"network"),this._libp2p=e,this._bitswap=t,this._protocols=[Lq],n.b100Only||(this._protocols.unshift(Uq),this._protocols.unshift(Fq)),this._stats=i,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashers=n.hashers||{}}start(){this._running=!0,this._libp2p.handle(this._protocols,this._onConnection);let e=new C3t({multicodecs:this._protocols,handlers:{onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect}});this._registrarId=this._libp2p.registrar.register(e);for(let t of this._libp2p.peerStore.peers.values()){let i=this._libp2p.connectionManager.get(t.id);i&&this._onPeerConnect(i.remotePeer)}}stop(){this._running=!1,this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:t,connection:i}){if(!!this._running){this._log("incoming new bitswap %s connection from %s",e,i.remotePeer.toB58String());try{await XAe(t,YAe.decode(),async n=>{for await(let s of n)try{let o=await P3t.deserialize(s.slice(),this._hashers);await this._bitswap._receiveMessage(i.remotePeer,o)}catch(o){this._bitswap._receiveError(o);break}})}catch(n){this._log(n)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,t,i={}){return this._libp2p.contentRouting.findProviders(e,{timeout:QAe.providerRequestTimeout,maxNumProviders:t})}async findAndConnect(e,t){let i=[];for await(let n of this.findProviders(e,QAe.maxProvidersPerRequest,t))this._log(`connecting to provider ${n.id}`),i.push(this.connectTo(n.id,t).catch(s=>{this._log.error(s)}));await Promise.all(i)}async provide(e,t){await this._libp2p.contentRouting.provide(e,t)}async sendMessage(e,t){if(!this._running)throw new Error("network isn't running");let i=e.toB58String();this._log("sendMessage to %s",i,t);let n=await this._libp2p.dial(e),{stream:s,protocol:o}=await n.newStream([Fq,Uq,Lq]),a;switch(o){case Lq:a=t.serializeToBitswap100();break;case Uq:case Fq:a=t.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+o)}k3t(s,a,this._log),this._updateSentStats(e,t.blocks)}async connectTo(e,t){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,t)}_updateSentStats(e,t){let i=e.toB58String();if(this._stats){for(let n of t.values())this._stats.push(i,"dataSent",n.length);this._stats.push(i,"blocksSent",t.size)}}};async function k3t(r,e,t){try{await XAe([e],YAe.encode(),r)}catch(i){t(i)}}JAe.exports=ZAe});var iIe=y((lVt,rIe)=>{f();"use strict";var q3t=W1(),tIe=class{constructor(e){this.partner=e,this.wantlist=new q3t,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,t,i){this.wantlist.add(e,t,i)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};rIe.exports=tIe});var oIe=y((fVt,sIe)=>{f();"use strict";var nIe=class extends Map{constructor(e,t){super();this._cmp=t||this._defaultSort,this._keys=[];for(let[i,n]of e||[])this.set(i,n)}update(e){if(e<0||e>=this._keys.length)return;let t=this._keys[e];this._keys.splice(e,1);let i=this._find(t);this._keys.splice(i,0,t)}set(e,t){if(this.has(e)){let n=this.indexOf(e);this._keys.splice(n,1)}super.set(e,t);let i=this._find(e);return this._keys.splice(i,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let t=this.indexOf(e);return this._keys.splice(t,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let t=this._find(e);if(this._keys[t]===e)return t;for(let i=1;i<this._keys.length;i++){if(this._keys[t+i]===e)return t+i;if(this._keys[t-i]===e)return t-i}return-1}_find(e){let t=0,i=this._keys.length;for(;t<i;){let n=t+i>>>1,s=this._kCmp(this._keys[n],e);if(s<0)t=n+1;else if(s>0)i=n;else return n}return t}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,t){if(!!e)for(let i of this._keys)e.apply(t,[[i,this.get(i)]])}_defaultSort(e,t){return e[0]<t[0]?-1:t[0]<e[0]?1:0}_kCmp(e,t){return this._cmp([e,this.get(e)],[t,this.get(t)])}};sIe.exports=nIe});var fIe=y((dVt,lIe)=>{f();"use strict";var aIe=oIe(),N3t={hasNewInfo(){return!1},merge(){}},cIe=class{constructor(e=N3t){this._taskMerger=e,this._byPeer=new aIe([],Kq.compare)}pushTasks(e,t){let i=this._byPeer.get(e.toB58String());i||(i=new Kq(e,this._taskMerger)),i.pushTasks(t),this._byPeer.set(e.toB58String(),i)}popTasks(e){let t=this._head();if(t===void 0)return{tasks:[],pendingSize:0};let{tasks:i,pendingSize:n}=t.popTasks(e);if(i.length===0)return{tasks:i,pendingSize:n};let s=t.peerId;return t.isIdle()?this._byPeer.delete(s.toB58String()):this._byPeer.update(0),{peerId:s,tasks:i,pendingSize:n}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,t){let i=this._byPeer.get(t.toB58String());i&&i.remove(e)}tasksDone(e,t){let i=this._byPeer.get(e.toB58String());if(!i)return;let n=this._byPeer.indexOf(e.toB58String());for(let s of t)i.taskDone(s);this._byPeer.update(n)}},Kq=class{constructor(e,t){this.peerId=e,this._taskMerger=t,this._activeTotalSize=0,this._pending=new uIe,this._active=new Set}pushTasks(e){for(let t of e)this._pushTask(t)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let t=this._pending.get(e.topic);if(t){e.priority>t.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,t);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let t=[];for(let i of this._active)i.topic===e.topic&&t.push(i);return t.length===0?!0:this._taskMerger.hasNewInfo(e,t)}popTasks(e){let t=0,i=[],n=this._pending.tasks();for(let s=0;s<n.length&&t<e;s++){let o=n[s];i.push(o),t+=o.size,this._pending.delete(o.topic),this._activeTotalSize+=o.size,this._active.add(o)}return{tasks:i,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,t){return e[1]._pending.length===0?1:t[1]._pending.length===0?-1:e[1]._activeTotalSize===t[1]._activeTotalSize?t[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-t[1]._activeTotalSize}},uIe=class{constructor(){this._tasks=new aIe([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,t)=>e+t.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,t){let i=this._tasks.get(e);if(!i)return;let n=this._tasks.indexOf(e);i.task.priority=t,this._tasks.update(n)}_compare(e,t){return e[1].task.priority===t[1].task.priority?e[1].created-t[1].created:t[1].task.priority-e[1].task.priority}};lIe.exports=cIe});var hIe=y((hVt,dIe)=>{f();"use strict";var D3t={hasNewInfo(r,e){let t=!1,i=!1;for(let n of e)n.data.haveBlock&&(t=!0),n.data.isWantBlock&&(i=!0);return!!(!i&&r.data.isWantBlock||!t&&r.data.haveBlock)},merge(r,e){let t=r.data,i=e.data;!i.haveBlock&&t.haveBlock&&(i.haveBlock=t.haveBlock,i.blockSize=t.blockSize),!i.isWantBlock&&t.isWantBlock&&(i.isWantBlock=!0,(!i.haveBlock||t.haveBlock)&&(i.haveBlock=t.haveBlock,e.size=r.size)),i.isWantBlock&&i.haveBlock&&(e.size=i.blockSize)}};dIe.exports=D3t});var mIe=y((pVt,gIe)=>{f();"use strict";var{CID:jq}=(jc(),Rh),{base58btc:jx}=(ei(),Jr),Z1=qy(),pIe=Z1.WantType,B3t=W1(),M3t=iIe(),L3t=fIe(),U3t=hIe(),{logger:F3t}=cf(),K3t=16*1024,j3t=1024,yIe=class{constructor(e,t,i,n,s={}){this._log=F3t(e,"engine"),this.blockstore=t,this.network=i,this._stats=n,this._opts=this._processOpts(s),this.ledgerMap=new Map,this._running=!1,this._requestQueue=new L3t(U3t)}_processOpts(e){return{maxSizeReplaceHasWithBlock:j3t,targetMessageSize:K3t,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:t,pendingSize:i}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(t.length===0)return;let n=new Z1(!1);n.setPendingBytes(i);let s=[],o=new Map;for(let c of t){let u=jq.parse(c.topic);c.data.haveBlock?c.data.isWantBlock?(s.push(u),o.set(c.topic,c.data)):n.addHave(u):n.addDontHave(u)}let a=await this._getBlocks(s);for(let[c,u]of o){let l=jq.parse(c),d=a.get(c);d?n.addBlock(l,d):u.sendDontHave&&n.addDontHave(l)}if(n.empty){e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,n);for(let[c,u]of a.entries())e&&this.messageSent(e,jq.parse(c),u)}catch(c){this._log.error(c)}e&&this._requestQueue.tasksDone(e,t),this._scheduleProcessTasks()}wantlistForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?i.wantlist.sortedEntries():new Map}ledgerForPeer(e){let t=e.toB58String(),i=this.ledgerMap.get(t);return i?{peer:i.partner,value:i.debtRatio(),sent:i.accounting.bytesSent,recv:i.accounting.bytesRecv,exchanged:i.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let t of this.ledgerMap.values())for(let i of e){let n=t.wantlistContains(i.cid);if(!n)continue;let s=i.data.length,o=this._sendAsBlock(n.wantType,s),a=s;o||(a=Z1.blockPresenceSize(n.cid)),this._requestQueue.pushTasks(t.partner,[{topic:n.cid.toString(jx),priority:n.priority,size:a,data:{blockSize:s,isWantBlock:o,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,t){let i=this._findOrCreate(e);if(t.empty)return;if(t.full&&(i.wantlist=new B3t),this._updateBlockAccounting(t.blocks,i),t.wantlist.size===0){this._scheduleProcessTasks();return}let n=[],s=[];t.wantlist.forEach(o=>{o.cancel?(i.cancelWant(o.cid),n.push(o.cid)):(i.wants(o.cid,o.priority,o.wantType),s.push(o))}),this._cancelWants(e,n),await this._addWants(e,s),this._scheduleProcessTasks()}_cancelWants(e,t){for(let i of t)this._requestQueue.remove(i.toString(jx),e)}async _addWants(e,t){let i=await this._getBlockSizes(t.map(s=>s.cid)),n=[];for(let s of t){let o=s.cid.toString(jx),a=i.get(o);if(a==null)s.sendDontHave&&n.push({topic:o,priority:s.priority,size:Z1.blockPresenceSize(s.cid),data:{isWantBlock:s.wantType===pIe.Block,blockSize:0,haveBlock:!1,sendDontHave:s.sendDontHave}});else{let c=this._sendAsBlock(s.wantType,a),u=a;c||(u=Z1.blockPresenceSize(s.cid)),n.push({topic:o,priority:s.priority,size:u,data:{isWantBlock:c,blockSize:a,haveBlock:!0,sendDontHave:s.sendDontHave}})}this._requestQueue.pushTasks(e,n)}}_sendAsBlock(e,t){return e===pIe.Block||t<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let t=await this._getBlocks(e);return new Map([...t].map(([i,n])=>[i,n.length]))}async _getBlocks(e){let t=new Map;return await Promise.all(e.map(async i=>{try{let n=await this.blockstore.get(i);t.set(i.toString(jx),n)}catch(n){n.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",i,n)}})),t}_updateBlockAccounting(e,t){for(let i of e.values())this._log("got block (%s bytes)",i.length),t.receivedBytes(i.length)}messageSent(e,t,i){let n=this._findOrCreate(e);n.sentBytes(i.length),n.wantlist.remove(t)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){}_findOrCreate(e){let t=e.toB58String(),i=this.ledgerMap.get(t);if(i)return i;let n=new M3t(e);return this.ledgerMap.set(t,n),this._stats&&this._stats.push(t,"peerCount",1),n}start(){this._running=!0}stop(){this._running=!1}};gIe.exports=yIe});var SIe=y((yVt,EIe)=>{f();"use strict";var{EventEmitter:V3t}=yr(),{toString:bIe}=(tt(),et),z3t=Q1(),H3t=cf().logger,vIe=r=>`unwant:${bIe(r.multihash.bytes,"base64")}`,wIe=r=>`block:${bIe(r.multihash.bytes,"base64")}`,_Ie=class extends V3t{constructor(e){super();this.setMaxListeners(z3t.maxListeners),this._log=H3t(e,"notif")}hasBlock(e,t){let i=wIe(e);this._log(i),this.emit(i,t)}wantBlock(e,t={}){if(!e)throw new Error("Not a valid cid");let i=wIe(e),n=vIe(e);return this._log(`wantBlock:${e}`),new Promise((s,o)=>{let a=()=>{this.removeListener(i,c),o(new Error(`Block for ${e} unwanted`))},c=u=>{this.removeListener(n,a),s(u)};this.once(n,a),this.once(i,c),t&&t.signal&&t.signal.addEventListener("abort",()=>{this.removeListener(i,c),this.removeListener(n,a),o(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let t=vIe(e);this._log(t),this.emit(t)}};EIe.exports=_Ie});var TIe=y((gVt,IIe)=>{f();"use strict";var{EventEmitter:$3t}=yr(),xIe=ZP(),AIe=class extends $3t{constructor(e,t){super();this._options=t,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(i=>{this._stats[i]=BigInt(0),this._movingAverages[i]={},this._options.movingAverageIntervals.forEach(n=>{(this._movingAverages[i][n]=xIe(n)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,t){this._enabled&&(this._queue.push([e,t,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let t=e=this._queue.shift();t&&this._applyOp(t)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let t=e-this._frequencyLastTime;t&&Object.keys(this._stats).forEach(i=>{this._updateFrequencyFor(i,t,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,t,i){let n=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let s=n/t*1e3,o=this._movingAverages[e];o||(o=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let c=o[a];c||(c=o[a]=xIe(a)),c.push(i,s)})}_applyOp(e){let t=e[0],i=e[1];if(typeof i!="number")throw new Error(`invalid increment number: ${i}`);Object.prototype.hasOwnProperty.call(this._stats,t)||(this._stats[t]=BigInt(0)),this._stats[t]=BigInt(this._stats[t])+BigInt(i),this._frequencyAccumulators[t]||(this._frequencyAccumulators[t]=0),this._frequencyAccumulators[t]+=i}};IIe.exports=AIe});var kIe=y((mVt,OIe)=>{f();"use strict";var{EventEmitter:G3t}=yr(),RIe=TIe(),CIe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},PIe=class extends G3t{constructor(e=[],t=CIe){super();let i=Object.assign({},CIe,t);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=e,this._options=i,this._enabled=this._options.enabled,this._global=new RIe(e,i),this._global.on("update",n=>this.emit("update",n)),this._peers=new Map}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let t=typeof e!="string"&&e.toB58String?e.toB58String():`${e}`;return this._peers.get(t)}push(e,t,i){if(this._enabled&&(this._global.push(t,i),e)){let n=this._peers.get(e);n||(n=new RIe(this._initialCounters,this._options),this._peers.set(e,n)),n.push(t,i)}}disconnected(e){let t=e.toB58String(),i=this._peers.get(t);i&&(i.stop(),this._peers.delete(t))}};OIe.exports=PIe});var DIe=y((bVt,NIe)=>{f();"use strict";var W3t=WAe(),Y3t=eIe(),X3t=mIe(),Q3t=SIe(),Z3t=cf().logger,J3t=kIe(),{AbortController:ext}=rn(),{anySignal:txt}=hf(),{BlockstoreAdapter:rxt}=uS(),{CID:ixt}=(jc(),Rh),nxt={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},sxt=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],qIe=class extends rxt{constructor(e,t,i={}){super();this._libp2p=e,this._log=Z3t(this.peerId),this._options=Object.assign({},nxt,i),this._stats=new J3t(sxt,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new Y3t(e,this,this._stats,{hashers:i.hashers}),this.blockstore=t,this.engine=new X3t(this.peerId,t,this.network,this._stats),this.wm=new W3t(this.peerId,this.network,this._stats),this.notifications=new Q3t(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,t){try{await this.engine.messageReceived(e,t)}catch(n){this._log("failed to receive message",t)}if(t.blocks.size===0)return;let i=[];for(let[n,s]of t.blocks.entries()){let o=ixt.parse(n);i.push({wasWanted:this.wm.wantlist.contains(o),cid:o,data:s})}this.wm.cancelWants(i.filter(({wasWanted:n})=>n).map(({cid:n})=>n)),await Promise.all(i.map(({cid:n,wasWanted:s,data:o})=>this._handleReceivedBlock(e,n,o,s)))}async _handleReceivedBlock(e,t,i,n){this._log("received block");let s=await this.blockstore.has(t);this._updateReceiveCounters(e.toB58String(),t,i,s),!!n&&await this.put(t,i)}_updateReceiveCounters(e,t,i,n){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",i.length),n&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",i.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,t){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,t={}){let i=(u,l)=>(this.wm.wantBlocks([u],l),this.notifications.wantBlock(u,l)),n=!1,s=async(u,l)=>{try{return await this.blockstore.get(u,l)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;return n||(n=!0,this.network.findAndConnect(u).catch(h=>this._log.error(h))),i(u,l)}},o=new ext,a=t.signal?txt([t.signal,o.signal]):o.signal,c=await Promise.race([this.notifications.wantBlock(e,{signal:a}),s(e,{signal:a})]);return o.abort(),c}async*getMany(e,t={}){for await(let i of e)yield this.get(i,t)}unwant(e){let t=Array.isArray(e)?e:[e];this.wm.unwantBlocks(t),t.forEach(i=>this.notifications.unwantBlock(i))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,t,i){await this.blockstore.put(e,t),this._sendHaveBlockNotifications(e,t)}async*putMany(e,t){for await(let{key:i,value:n}of this.blockstore.putMany(e,t))this._sendHaveBlockNotifications(i,n),yield{key:i,value:n}}_sendHaveBlockNotifications(e,t){this.notifications.hasBlock(e,t),this.engine.receivedBlocks([{cid:e,data:t}]),this.network.provide(e).catch(i=>{this._log.error("Failed to provide: %s",i.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}start(){this.wm.start(),this.network.start(),this.engine.start(),this.started=!0}stop(){this._stats.stop(),this.wm.stop(),this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};NIe.exports=qIe});var MIe=y((vVt,BIe)=>{f();"use strict";var oxt=DIe(),axt=(r,e,t={})=>new oxt(r,e,t);BIe.exports={createBitswap:axt}});var KIe=y((wVt,FIe)=>{f();"use strict";var{BlockstoreAdapter:cxt}=uS(),uxt=Cp(),LIe=Qa(),lxt=Ya(),UIe=class extends cxt{constructor(e,t){super();this.child=e,this.bitswap=t}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,t,i={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,t,i):await this.child.put(e,t,i))}async*putMany(e,t={}){let i=lxt(e,async({key:n})=>!await this.has(n));this.bitswap.isStarted()?yield*this.bitswap.putMany(i,t):yield*this.child.putMany(i,t)}async get(e,t={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,t):this.child.get(e,t)}async*getMany(e,t={}){let i=LIe(),n=LIe();Promise.resolve().then(async()=>{for await(let s of e)!await this.has(s)&&this.bitswap.isStarted()?i.push(s):n.push(s);i.end(),n.end()}),yield*uxt(this.bitswap.getMany(i,t),this.child.getMany(n,t))}async delete(e,t){await this.child.delete(e,t)}async*deleteMany(e,t){yield*this.child.deleteMany(e,t)}async has(e,t={}){return this.child.has(e,t)}async*query(e,t={}){yield*this.child.query(e,t)}async*queryKeys(e,t={}){yield*this.child.queryKeys(e,t)}};FIe.exports=UIe});var VIe=y((_Vt,jIe)=>{f();"use strict";var{createBitswap:fxt}=MIe(),dxt=Rq(),{Multiaddr:hxt}=it(),pxt=ae(),yxt=KIe(),Vx=class{constructor(e,t,i,n,s){this.peerId=e,this.libp2p=t,this.bitswap=i,this.repo=n,this.blockstore=s}static async start({peerId:e,repo:t,print:i,options:n}){t.closed&&await t.open();let s=await t.config.getAll(),o=await dxt({options:n,repo:t,peerId:e,multiaddrs:gxt(e,s),config:s,keychainConfig:void 0});o.keychain&&await o.loadKeychain(),await o.start();for(let u of o.multiaddrs)i(`Swarm listening on ${u}/p2p/${e.toB58String()}`);let a=fxt(o,t.blocks,{statsEnabled:!0});await a.start();let c=new yxt(t.blocks,a);return t.blocks=c,t.pins.blockstore=c,new Vx(e,o,a,t,c)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await Promise.all([e.bitswap.stop(),e.libp2p.stop()])}};jIe.exports=Vx;var gxt=(r,e)=>{let t=r.toB58String(),i=[],n=e.Addresses&&e.Addresses.Swarm||[];for(let s of n){let o=new hxt(s);if(o.protoCodes().includes(mxt))throw pxt(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=o.getPeerId();a&&a!==t&&(o=o.encapsulate(`/p2p/${t}`)),i.push(o)}return i},mxt=479});var HIe=y((EVt,zIe)=>{f();"use strict";var bxt=Oe();zIe.exports=({network:r})=>{async function e(t={}){let i=[],{libp2p:n}=await r.use(t);for(let[s,o]of n.peerStore.peers.entries())i.push({id:s,addrs:o.addresses.map(a=>a.multiaddr)});return i}return bxt(e)}});var GIe=y((SVt,$Ie)=>{f();"use strict";var vxt=Oe();$Ie.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.dial(t,i)}return vxt(e)}});var YIe=y((xVt,WIe)=>{f();"use strict";var wxt=Oe();WIe.exports=({network:r})=>{async function e(t,i={}){let{libp2p:n}=await r.use(i);await n.hangUp(t)}return wxt(e)}});var QIe=y((AVt,XIe)=>{f();"use strict";var _xt=Oe();XIe.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t);return i.multiaddrs}return _xt(e)}});var JIe=y((IVt,ZIe)=>{f();"use strict";var Ext=Oe();ZIe.exports=({network:r})=>{async function e(t={}){let{libp2p:i}=await r.use(t),n=[];for(let[s,o]of i.connections)for(let a of o){let c={addr:a.remoteAddr,peer:s};(t.verbose||t.direction)&&(c.direction=a.stat.direction),t.verbose&&(c.muxer=a.stat.multiplexer,c.latency="n/a",c.streams=[]),n.push(c)}return n}return Ext(e)}});var r4e=y((TVt,t4e)=>{f();"use strict";var Sxt=HIe(),xxt=GIe(),Axt=YIe(),Ixt=QIe(),Txt=JIe(),e4e=class{constructor({network:e}){this.addrs=Sxt({network:e}),this.connect=xxt({network:e}),this.disconnect=Axt({network:e}),this.localAddrs=Ixt({network:e}),this.peers=Txt({network:e})}};t4e.exports=e4e});var n4e=y((RVt,i4e)=>{f();"use strict";var Rxt=rt(),J1={success:!0,time:0,text:""},Cxt=Oe();i4e.exports=({network:r})=>{async function*e(t,i={}){let{libp2p:n}=await r.use();i.count=i.count||10;let s=Rxt.createFromB58String(t),o=n.peerStore.get(s),a=o&&o.id;if(!a){yield{...J1,text:`Looking up peer ${t}`};let l=await n.peerRouting.findPeer(s);a=l&&l.id}if(!a)throw new Error("Peer was not found");yield{...J1,text:`PING ${a.toB58String()}`};let c=0,u=0;for(let l=0;l<i.count;l++)try{let d=await n.ping(a);u+=d,c++,yield{...J1,time:d}}catch(d){yield{...J1,success:!1,text:d.toString()}}if(c){let l=u/c;yield{...J1,text:`Average latency: ${l}ms`}}}return Cxt(e)}});var c4e=y((CVt,a4e)=>{f();"use strict";var s4e=rt(),o4e=ae(),{NotEnabledError:Pxt}=ul(),Oxt=Bm(),Dy=Oe();a4e.exports=({network:r,repo:e})=>{let{get:t,put:i,findProvs:n,findPeer:s,provide:o,query:a}={async get(c,u={}){let{libp2p:l}=await By(r,u);return l._dht.get(c,u)},async*put(c,u,l){let{libp2p:d}=await By(r,l);yield*d._dht.put(c,u)},async*findProvs(c,u={numProviders:20}){let{libp2p:l}=await By(r,u);for await(let d of l._dht.findProviders(c,{maxNumProviders:u.numProviders,signal:u.signal}))yield{id:d.id.toB58String(),addrs:d.addrs}},async findPeer(c,u){let{libp2p:l}=await By(r,u),d=await l._dht.findPeer(s4e.parse(c));return{id:d.id.toB58String(),addrs:d.multiaddrs}},async*provide(c,u={recursive:!1}){let{libp2p:l}=await By(r,u),d=Array.isArray(c)?c:[c];if(!(await Promise.all(d.map(g=>e.blocks.has(g)))).every(g=>g))throw o4e(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(u.recursive)throw o4e(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");for(let g of d)yield l._dht.provide(g)},async*query(c,u){let{libp2p:l}=await By(r,u);for await(let d of l._dht.getClosestPeers(s4e.parse(c).toBytes()))yield{id:d.toB58String(),addrs:[]}}};return{get:Dy(t),put:Dy(i),findProvs:Dy(n),findPeer:Dy(s),provide:Dy(o),query:Dy(a)}};var By=async(r,e)=>{let t=await r.use(e);if(Oxt(t.libp2p,"_config.dht.enabled",!1))return t;throw new Pxt("dht not enabled")}});var l4e=y((PVt,u4e)=>{f();"use strict";var ev=Oe(),kxt=ae(),{NotEnabledError:qxt}=ul(),Nxt=Bm();u4e.exports=({network:r,config:e})=>{let t=Nxt(e||{},"Pubsub.Enabled",!0);return{subscribe:t?ev(i):tv,unsubscribe:t?ev(n):tv,publish:t?ev(s):tv,ls:t?ev(o):tv,peers:t?ev(a):tv};async function i(c,u,l={}){let{libp2p:d}=await r.use(l);return d.pubsub.subscribe(c,u,l)}async function n(c,u,l={}){let{libp2p:d}=await r.use(l);d.pubsub.unsubscribe(c,u,l)}async function s(c,u,l={}){let{libp2p:d}=await r.use(l);if(!u)throw kxt(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(c,u)}async function o(c={}){let{libp2p:u}=await r.use(c);return u.pubsub.getTopics()}async function a(c,u={}){let{libp2p:l}=await r.use(u);return l.pubsub.getSubscribers(c)}};var tv=async()=>{throw new qxt("pubsub not enabled")}});var y4e=y((OVt,p4e)=>{f();"use strict";var Dxt=gr().bind({ignoreUndefined:!0}),{isTest:Bxt}=tg(),Vq=be()("ipfs"),f4e=ae(),{UnixFS:Mxt}=(pi(),ms),d4e=(_t(),Mt),Lxt=(eu(),l_),{identity:h4e}=(Fc(),Uc),{bases:Uxt,hashes:Fxt,codecs:Kxt}=(iw(),yA),jxt=XK(),{AlreadyInitializedError:Vxt}=ul(),{fromString:zxt}=(ft(),ht),Hxt=Mj(),$xt=Uj(),Gxt=iV(),Wxt=sV(),Yxt=cV(),Xxt=L$(),Qxt=dY(),Zxt=UY(),Jxt=jY(),e6t=zY(),t6t=eX(),r6t=gX(),i6t=CX(),n6t=kte(),s6t=Nte(),o6t=Bte(),a6t=mR(),c6t=pre(),u6t=Sre(),l6t=Ire(),f6t=ine(),d6t=Ene(),h6t=Gne(),p6t=tse(),y6t=ase(),g6t=pAe(),m6t=VIe(),b6t=d_(),v6t=r4e(),w6t=n4e(),_6t=c4e(),E6t=l4e(),S6t=GC(),x6t=WC(),A6t=YC(),zx=class{constructor({print:e,storage:t,codecs:i,options:n}){let{peerId:s,repo:o,keychain:a}=t,c=b6t.create(m6t),u=u6t(n.preload),l=Gxt(),d=Wxt({network:c}),h=new Qxt(n),p=Object.values(Fxt);(n.ipld&&n.ipld.hashers?n.ipld.hashers:[]).forEach(P=>p.push(P)),this.hashers=new x6t({hashers:p,loadHasher:n.ipld&&n.ipld.loadHasher});let g=Object.values(Uxt);(n.ipld&&n.ipld.bases?n.ipld.bases:[]).forEach(P=>g.push(P)),this.bases=new A6t({bases:g,loadBase:n.ipld&&n.ipld.loadBase});let b=new Xxt({repo:o,codecs:i}),E=new i6t({codecs:i,hashers:this.hashers,preload:u,repo:o}),v=new Zxt({dns:l,ipns:h,repo:o,codecs:i,peerId:s,isOnline:d,keychain:a,options:n}),A=Yxt({repo:o,codecs:i,bases:this.bases,name:v}),R=new c6t({repo:o,codecs:i,hashers:this.hashers,preload:u}),F=Object.assign(Jxt({repo:o,codecs:i,resolve:A,preload:u}),{local:e6t({repo:t.repo})}),{add:q,addAll:N,cat:z,get:G,ls:Y}=new n6t({preload:u,repo:o,options:n.EXPERIMENTAL}),C=f6t({repo:o,preload:u,hashers:this.hashers,options:n}),m=l6t({files:C,preload:u,options:n.preload});this.preload=u,this.name=v,this.ipns=h,this.pin=b,this.resolve=A,this.block=E,this.refs=F,this.start=Hxt({network:c,peerId:s,repo:o,preload:u,ipns:h,mfsPreload:m,print:e,keychain:a,options:n}),this.stop=$xt({network:c,preload:u,mfsPreload:m,ipns:h,repo:o}),this.dht=_6t({network:c,repo:o}),this.pubsub=E6t({network:c,config:n.config}),this.dns=l,this.isOnline=d,this.id=o6t({network:c,peerId:s}),this.version=s6t({repo:o}),this.bitswap=new t6t({network:c}),this.bootstrap=new r6t({repo:o}),this.config=a6t({repo:o}),this.ping=w6t({network:c}),this.add=q,this.addAll=N,this.cat=z,this.get=G,this.ls=Y,this.dag=R,this.files=C,this.key=new d6t({keychain:a}),this.object=new h6t({preload:u,codecs:i,repo:o}),this.repo=new p6t({repo:o,hashers:this.hashers}),this.stats=new y6t({repo:o,network:c}),this.swarm=new v6t({network:c}),Object.defineProperty(this,"libp2p",{get(){let P=c.try();return P?P.libp2p:void 0}});let w=()=>Promise.reject(f4e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),S=async function*(){throw f4e(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=w,this.diag={cmds:w,net:w,sys:w},this.log={level:w,ls:w,tail:S},this.mount=w,this.codecs=i}async init(){throw new Vxt}static async create(e={}){e=Dxt(T6t(),e);let t=e.init||{},i={name:h4e.name,code:h4e.code,encode:l=>l,decode:l=>l},n=Object.values(Kxt);[d4e,Lxt,i].concat(e.ipld&&e.ipld.codecs||[]).forEach(l=>n.push(l));let s=new S6t({codecs:n,loadCodec:e.ipld&&e.ipld.loadCodec}),o=e.silent?Vq:console.log,a=await g6t.start(o,s,e),c=await a.repo.config.getAll(),u=new zx({storage:a,print:o,codecs:s,options:{...e,config:c}});if(await u.preload.start(),u.ipns.startOffline(a),a.isNew&&!t.emptyRepo){let l=await I6t(u);Vq("adding default assets"),await jxt({addAll:u.addAll,print:o}),Vq("initializing IPNS keyspace"),await u.ipns.initializeKeyspace(a.peerId.privKey,zxt(`/ipfs/${l}`))}return e.start!==!1&&await u.start(),u}};p4e.exports=zx;var I6t=async r=>{let e=d4e.encode({Data:new Mxt({type:"directory"}).marshal(),Links:[]}),t=await r.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await r.pin.add(t),t},T6t=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Bxt,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}})});var B6t=y((kVt,g4e)=>{f();"use strict";var R6t=a6(),C6t=b6(),P6t=rt(),O6t=za(),k6t=sp(),{multiaddr:q6t}=it(),{CID:N6t}=(Ie(),De),{create:D6t}=y4e();g4e.exports={create:D6t,crypto:O6t,isIPFS:k6t,CID:N6t,multiaddr:q6t,PeerId:P6t,globSource:R6t,urlSource:C6t}});return B6t();})();
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return IpfsCore}));
